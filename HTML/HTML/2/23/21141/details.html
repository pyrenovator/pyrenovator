<html><h3>Pattern ID :21141
</h3><img src='67800218.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        super(CKE, self).__init__()

        self.USER_ID = config[&quotUSER_ID_FIELD&quot]
        <a id="change">self.ITEM_ID</a><a id="change"> = config</a><a id="change">[&quotITEM_ID_FIELD&quot]</a>
        self.NEG_ITEM_ID<a id="change"> = config</a><a id="change">[&quotNEG_PREFIX&quot] + self.ITEM_ID</a>
        &#47&#47 todo: 和data部分对接
        self.ENTITY_ID = config[&quotENTITY_ID_FIELD&quot]
        self.RELATION_ID<a id="change"> = config[&quotRELATION_ID_FIELD&quot]</a>
        self.HEAD_ENTITY_ID = config[&quotHEAD_ENTITY_ID_FIELD&quot]
        self.TAIL_ENTITY_ID<a id="change"> = config</a><a id="change">[&quotTAIL_ENTITY_ID_FIELD&quot]</a>
        self.NEG_TAIL_ENTITY_ID = <a id="change">config[&quotNEG_PREFIX&quot]</a> + self.TAIL_ENTITY_ID

        self.n_users = dataset.num(self.USER_ID)
        self.n_items<a id="change"> = dataset</a><a id="change">.num(self.ITEM_ID</a><a id="change">)</a>
        self.n_entities = dataset.num(self.ENTITY_ID)
        self.n_relations<a id="change"> = dataset</a><a id="change">.num(</a>self.RELATION_ID<a id="change">)</a>

        self.embedding_size = config[&quotembedding_size&quot]
        self.kg_embedding_size = config[&quotkg_embedding_size&quot]</code></pre><h3>After Change</h3><pre><code class='java'>
class CKE(KnowledgeRecommender):

    def __init__(self, config, dataset):
        <a id="change">super(CKE, self).__init__(</a>config, dataset<a id="change">)</a>

        self.embedding_size = config[&quotembedding_size&quot]
        self.kg_embedding_size = config[&quotkg_embedding_size&quot]</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 15</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/rucaibox/recbole/commit/b3c5903e4c47f606e27a90aa826d56f6312b1788#diff-ab42f87911b0f659f5fef20cb3283ffb6914390773b425f58f540d970e573d0dL23' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 67800218</div><div id='project'> Project Name: rucaibox/recbole</div><div id='commit'> Commit Name: b3c5903e4c47f606e27a90aa826d56f6312b1788</div><div id='time'> Time: 2020-08-06</div><div id='author'> Author: 2015201909@ruc.edu.cn</div><div id='file'> File Name: model/knowledge_aware_recommender/cke.py</div><div id='m_class'> M Class Name: CKE</div><div id='n_method'> N Class Name: CKE</div><div id='m_method'> M Method Name: __init__(3)</div><div id='n_method'> N Method Name: __init__(3)</div><div id='m_parent_class'> M Parent Class: KnowledgeRecommender</div><div id='n_parent_class'> N Parent Class: KnowledgeRecommender</div><div id='m_file'> M File Name: model/knowledge_aware_recommender/cke.py</div><div id='n_file'> N File Name: model/knowledge_aware_recommender/cke.py</div><div id='m_start'> M Start Line: 23</div><div id='m_end'> M End Line: 38</div><div id='n_start'> N Start Line: 23</div><div id='n_end'> N End Line: 23</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        super(CKE, self).__init__()

        self.USER_ID = config[&quotUSER_ID_FIELD&quot]
        <a id="change">self.ITEM_ID</a><a id="change"> = </a><a id="change">config[&quotITEM_ID_FIELD&quot]</a>
        self.NEG_ITEM_ID<a id="change"> = </a><a id="change">config[&quotNEG_PREFIX&quot] + </a>self.ITEM_ID
        &#47&#47 todo: 和data部分对接
        self.ENTITY_ID<a id="change"> = </a><a id="change">config[&quotENTITY_ID_FIELD&quot]</a>
        self.RELATION_ID<a id="change"> = config[&quotRELATION_ID_FIELD&quot]</a>
        self.HEAD_ENTITY_ID = <a id="change">config[&quotHEAD_ENTITY_ID_FIELD&quot]</a>
        self.TAIL_ENTITY_ID = config[&quotTAIL_ENTITY_ID_FIELD&quot]
        self.NEG_TAIL_ENTITY_ID = config[&quotNEG_PREFIX&quot] + self.TAIL_ENTITY_ID

        self.n_users = dataset.num(self.USER_ID)
        self.n_items<a id="change"> = </a><a id="change">dataset.num(</a>self.ITEM_ID<a id="change">)</a>
        self.n_entities = dataset.num(self.ENTITY_ID)
        self.n_relations<a id="change"> = </a><a id="change">dataset.num(</a>self.RELATION_ID<a id="change">)</a>

        self.embedding_size = config[&quotembedding_size&quot]
        self.kg_embedding_size = config[&quotkg_embedding_size&quot]</code></pre><h3>After Change</h3><pre><code class='java'>
class CKE(KnowledgeRecommender):

    def __init__(self, config, dataset):
        <a id="change">super(CKE, self).__init__(</a>config, dataset<a id="change">)</a>

        self.embedding_size = config[&quotembedding_size&quot]
        self.kg_embedding_size = config[&quotkg_embedding_size&quot]</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/rucaibox/recbole/commit/b3c5903e4c47f606e27a90aa826d56f6312b1788#diff-ab42f87911b0f659f5fef20cb3283ffb6914390773b425f58f540d970e573d0dL22' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 67800219</div><div id='project'> Project Name: rucaibox/recbole</div><div id='commit'> Commit Name: b3c5903e4c47f606e27a90aa826d56f6312b1788</div><div id='time'> Time: 2020-08-06</div><div id='author'> Author: 2015201909@ruc.edu.cn</div><div id='file'> File Name: model/knowledge_aware_recommender/cke.py</div><div id='m_class'> M Class Name: CKE</div><div id='n_method'> N Class Name: CKE</div><div id='m_method'> M Method Name: __init__(3)</div><div id='n_method'> N Method Name: __init__(3)</div><div id='m_parent_class'> M Parent Class: KnowledgeRecommender</div><div id='n_parent_class'> N Parent Class: KnowledgeRecommender</div><div id='m_file'> M File Name: model/knowledge_aware_recommender/cke.py</div><div id='n_file'> N File Name: model/knowledge_aware_recommender/cke.py</div><div id='m_start'> M Start Line: 23</div><div id='m_end'> M End Line: 38</div><div id='n_start'> N Start Line: 23</div><div id='n_end'> N End Line: 23</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    def __init__(self, config, dataset):
        super(NGCF, self).__init__()

        self.USER_ID<a id="change"> = config[&quotUSER_ID_FIELD&quot]</a>
        <a id="change">self.ITEM_ID</a><a id="change"> = </a><a id="change">config[&quotITEM_ID_FIELD&quot]</a>
        self.NEG_ITEM_ID<a id="change"> = </a><a id="change">config[&quotNEG_PREFIX&quot] + </a>self.ITEM_ID
        self.n_users<a id="change"> = </a><a id="change">dataset.num(</a>self.USER_ID<a id="change">)</a>
        self.n_items<a id="change"> = </a><a id="change">dataset.num(</a>self.ITEM_ID<a id="change">)</a>
        self.embedding_size = config[&quotembedding_size&quot]
        self.layers = config[&quotlayers&quot]
        self.layers = [self.embedding_size] + self.layers
        self.node_dropout = config[&quotnode_dropout&quot]
        self.message_dropout = config[&quotmessage_dropout&quot]
        self.device<a id="change"> = </a><a id="change">config[&quotdevice&quot]</a>
        self.delay = <a id="change">config[&quotdelay&quot]</a>
        self.batch_size = config[&quottrain_batch_size&quot]

        self.user_embedding = nn.Embedding(self.n_users, self.embedding_size)
        self.item_embedding = nn.Embedding(self.n_items, self.embedding_size)</code></pre><h3>After Change</h3><pre><code class='java'>
    input_type = InputType.PAIRWISE

    def __init__(self, config, dataset):
        <a id="change">super(NGCF, self).__init__(</a>config, dataset<a id="change">)</a>

        &#47&#47 load dataset info
        self.interaction_matrix = dataset.inter_matrix(form=&quotcsr&quot).astype(np.float32)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/rucaibox/recbole/commit/210deb20fdbedae80baa4e808ed08326a696027f#diff-4aa7e0b0167177bd6adc94840792a7f9e6f5e07d78119378cbe9094d6c0a1284L28' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 67800236</div><div id='project'> Project Name: rucaibox/recbole</div><div id='commit'> Commit Name: 210deb20fdbedae80baa4e808ed08326a696027f</div><div id='time'> Time: 2020-09-12</div><div id='author'> Author: 2015201909@ruc.edu.cn</div><div id='file'> File Name: recbox/model/general_recommender/ngcf.py</div><div id='m_class'> M Class Name: NGCF</div><div id='n_method'> N Class Name: NGCF</div><div id='m_method'> M Method Name: __init__(3)</div><div id='n_method'> N Method Name: __init__(3)</div><div id='m_parent_class'> M Parent Class: GeneralRecommender</div><div id='n_parent_class'> N Parent Class: GeneralRecommender</div><div id='m_file'> M File Name: recbox/model/general_recommender/ngcf.py</div><div id='n_file'> N File Name: recbox/model/general_recommender/ngcf.py</div><div id='m_start'> M Start Line: 29</div><div id='m_end'> M End Line: 57</div><div id='n_start'> N Start Line: 43</div><div id='n_end'> N End Line: 72</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    def __init__(self, config, dataset):
        super(LightGCN, self).__init__()

        self.USER_ID<a id="change"> = </a><a id="change">config[&quotUSER_ID_FIELD&quot]</a>
        <a id="change">self.ITEM_ID</a><a id="change"> = config[&quotITEM_ID_FIELD&quot]</a>
        self.NEG_ITEM_ID<a id="change"> = </a><a id="change">config[&quotNEG_PREFIX&quot] + </a>self.ITEM_ID
        self.latent_dim = config[&quotembedding_size&quot]  &#47&#47 int:the embedding size of lightGCN
        self.n_layers = config[&quotlayers&quot]  &#47&#47 int:the layer num of lightGCN
        self.weight_decay<a id="change"> = </a><a id="change">config[&quotdelay&quot]</a>  &#47&#47 the weight decay for l2 normalizaton
        self.device = <a id="change">config[&quotdevice&quot]</a>

        self.dataset = dataset
        self.num_users<a id="change"> = </a><a id="change">dataset.num(</a>self.USER_ID<a id="change">)</a>
        self.num_items<a id="change"> = </a><a id="change">dataset.num(</a>self.ITEM_ID<a id="change">)</a>

        self.embedding_user = torch.nn.Embedding(num_embeddings=self.num_users, embedding_dim=self.latent_dim)
        self.embedding_item = torch.nn.Embedding(num_embeddings=self.num_items, embedding_dim=self.latent_dim)
        nn.init.xavier_uniform_(self.embedding_user.weight, gain=1)</code></pre><h3>After Change</h3><pre><code class='java'>
    input_type = InputType.PAIRWISE

    def __init__(self, config, dataset):
        <a id="change">super(LightGCN, self).__init__(</a>config, dataset<a id="change">)</a>

        &#47&#47 load dataset info
        self.interaction_matrix = dataset.inter_matrix(form=&quotcoo&quot).astype(np.float32)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/rucaibox/recbole/commit/210deb20fdbedae80baa4e808ed08326a696027f#diff-3e3c8adedc3d6feac75e60a5853bcee4175e81a8a1649aeb7cc144a1a0c8be4cL27' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 67800231</div><div id='project'> Project Name: rucaibox/recbole</div><div id='commit'> Commit Name: 210deb20fdbedae80baa4e808ed08326a696027f</div><div id='time'> Time: 2020-09-12</div><div id='author'> Author: 2015201909@ruc.edu.cn</div><div id='file'> File Name: recbox/model/general_recommender/lightgcn.py</div><div id='m_class'> M Class Name: LightGCN</div><div id='n_method'> N Class Name: LightGCN</div><div id='m_method'> M Method Name: __init__(3)</div><div id='n_method'> N Method Name: __init__(3)</div><div id='m_parent_class'> M Parent Class: GeneralRecommender</div><div id='n_parent_class'> N Parent Class: GeneralRecommender</div><div id='m_file'> M File Name: recbox/model/general_recommender/lightgcn.py</div><div id='n_file'> N File Name: recbox/model/general_recommender/lightgcn.py</div><div id='m_start'> M Start Line: 28</div><div id='m_end'> M End Line: 52</div><div id='n_start'> N Start Line: 28</div><div id='n_end'> N End Line: 51</div><BR>