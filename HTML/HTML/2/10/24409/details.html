<html><h3>Pattern ID :24409
</h3><img src='75751335.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
@pytest.mark.parametrize(&quottest_docs&quot, da_and_dam())
def test_da_text_to_tensor_max_len_1(test_docs):
    vocab = test_docs.get_vocabulary()
    <a id="change">for </a><a id="change">d</a> in test_docs<a id="change">:
        </a><a id="change">d.convert_text_to_tensor(vocab</a><a id="change">, max_length=1)</a>
    np.testing.assert_array_equal(test_docs[0].tensor, [2])
    np.testing.assert_array_equal(test_docs[1].tensor, [3])
    np.testing.assert_array_equal(test_docs[2].tensor, [3])
    <a id="change">for d</a> in test_docs<a id="change">:
        </a><a id="change">d.convert_tensor_to_text(vocab</a><a id="change">)</a>

    assert test_docs[0].text == &quothello&quot
    assert test_docs[1].text == &quotworld&quot
    assert test_docs[2].text == &quotworld&quot</code></pre><h3>After Change</h3><pre><code class='java'>
@pytest.mark.parametrize(&quottest_docs&quot, da_and_dam())
def test_da_text_to_tensor_max_len_1(test_docs):
    vocab = test_docs.get_vocabulary()
    <a id="change">test_docs.apply(</a>lambda d: d.convert_text_to_tensor(vocab, max_length=1)<a id="change">)</a>

    np.testing.assert_array_equal(test_docs[0].tensor, [2])
    np.testing.assert_array_equal(test_docs[1].tensor, [3])
    np.testing.assert_array_equal(test_docs[2].tensor, [3])

    <a id="change">test_docs.apply(</a>lambda d: d.convert_tensor_to_text(vocab)<a id="change">)</a>

    assert test_docs[0].text == &quothello&quot
    assert test_docs[1].text == &quotworld&quot
    assert test_docs[2].text == &quotworld&quot</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/jina-ai/docarray/commit/3c4ba0be634d9fd1a298c6572b03392665764a5e#diff-4fb0663f8c04b0a7ec3a0d30464dea074886e42a5fca4415e5f6ce5b4f6e6312L68' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 75751335</div><div id='project'> Project Name: jina-ai/docarray</div><div id='commit'> Commit Name: 3c4ba0be634d9fd1a298c6572b03392665764a5e</div><div id='time'> Time: 2022-02-01</div><div id='author'> Author: artex.xh@gmail.com</div><div id='file'> File Name: tests/unit/array/mixins/test_text.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_da_text_to_tensor_max_len_1(1)</div><div id='n_method'> N Method Name: test_da_text_to_tensor_max_len_1(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/array/mixins/test_text.py</div><div id='n_file'> N File Name: tests/unit/array/mixins/test_text.py</div><div id='m_start'> M Start Line: 68</div><div id='m_end'> M End Line: 77</div><div id='n_start'> N Start Line: 76</div><div id='n_end'> N End Line: 82</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

@pytest.mark.parametrize(&quottest_docs&quot, da_and_dam())
def test_da_text_to_tensor_max_len_1(test_docs):
    <a id="change">vocab</a> = test_docs.get_vocabulary()
    <a id="change">for </a><a id="change">d</a> in test_docs<a id="change">:
        </a><a id="change">d.convert_text_to_tensor(</a>vocab<a id="change">, max_length=1)</a>
    np.testing.assert_array_equal(test_docs[0].tensor, [2])
    np.testing.assert_array_equal(test_docs[1].tensor, [3])
    np.testing.assert_array_equal(test_docs[2].tensor, [3])
    <a id="change">for d</a> in test_docs<a id="change">:
        </a><a id="change">d.convert_tensor_to_text(</a>vocab<a id="change">)</a>

    assert test_docs[0].text == &quothello&quot
    assert test_docs[1].text == &quotworld&quot
    assert test_docs[2].text == &quotworld&quot</code></pre><h3>After Change</h3><pre><code class='java'>
@pytest.mark.parametrize(&quottest_docs&quot, da_and_dam())
def test_da_text_to_tensor_max_len_1(test_docs):
    vocab = test_docs.get_vocabulary()
    <a id="change">test_docs.apply(</a>lambda d: d.convert_text_to_tensor(vocab, max_length=1)<a id="change">)</a>

    np.testing.assert_array_equal(test_docs[0].tensor, [2])
    np.testing.assert_array_equal(test_docs[1].tensor, [3])
    np.testing.assert_array_equal(test_docs[2].tensor, [3])

    <a id="change">test_docs.apply(</a>lambda d: d.convert_tensor_to_text(vocab)<a id="change">)</a>

    assert test_docs[0].text == &quothello&quot
    assert test_docs[1].text == &quotworld&quot
    assert test_docs[2].text == &quotworld&quot</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/docarray/commit/3c4ba0be634d9fd1a298c6572b03392665764a5e#diff-4fb0663f8c04b0a7ec3a0d30464dea074886e42a5fca4415e5f6ce5b4f6e6312L67' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 75751334</div><div id='project'> Project Name: jina-ai/docarray</div><div id='commit'> Commit Name: 3c4ba0be634d9fd1a298c6572b03392665764a5e</div><div id='time'> Time: 2022-02-01</div><div id='author'> Author: artex.xh@gmail.com</div><div id='file'> File Name: tests/unit/array/mixins/test_text.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_da_text_to_tensor_max_len_1(1)</div><div id='n_method'> N Method Name: test_da_text_to_tensor_max_len_1(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/array/mixins/test_text.py</div><div id='n_file'> N File Name: tests/unit/array/mixins/test_text.py</div><div id='m_start'> M Start Line: 68</div><div id='m_end'> M End Line: 77</div><div id='n_start'> N Start Line: 76</div><div id='n_end'> N End Line: 82</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

@pytest.mark.parametrize(&quottest_docs&quot, da_and_dam())
def test_da_text_to_tensor_non_max_len(test_docs):
    <a id="change">vocab</a> = test_docs.get_vocabulary()
    <a id="change">for </a><a id="change">d</a> in test_docs<a id="change">:
        </a><a id="change">d.convert_text_to_tensor(</a>vocab<a id="change">)</a>
    np.testing.assert_array_equal(test_docs[0].tensor, [2])
    np.testing.assert_array_equal(test_docs[1].tensor, [2, 3])
    np.testing.assert_array_equal(test_docs[2].tensor, [4, 3])
    <a id="change">for d</a> in test_docs<a id="change">:
        </a><a id="change">d.convert_tensor_to_text(</a>vocab<a id="change">)</a>

    assert test_docs[0].text == &quothello&quot
    assert test_docs[1].text == &quothello world&quot
    assert test_docs[2].text == &quotgoodbye world&quot</code></pre><h3>After Change</h3><pre><code class='java'>
@pytest.mark.parametrize(&quottest_docs&quot, da_and_dam())
def test_da_text_to_tensor_non_max_len(test_docs):
    vocab = test_docs.get_vocabulary()
    <a id="change">test_docs.apply(</a>lambda d: d.convert_text_to_tensor(vocab)<a id="change">)</a>
    np.testing.assert_array_equal(test_docs[0].tensor, [2])
    np.testing.assert_array_equal(test_docs[1].tensor, [2, 3])
    np.testing.assert_array_equal(test_docs[2].tensor, [4, 3])
    <a id="change">test_docs.apply(</a>lambda d: d.convert_tensor_to_text(vocab)<a id="change">)</a>

    assert test_docs[0].text == &quothello&quot
    assert test_docs[1].text == &quothello world&quot
    assert test_docs[2].text == &quotgoodbye world&quot</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/docarray/commit/3c4ba0be634d9fd1a298c6572b03392665764a5e#diff-4fb0663f8c04b0a7ec3a0d30464dea074886e42a5fca4415e5f6ce5b4f6e6312L35' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 75751333</div><div id='project'> Project Name: jina-ai/docarray</div><div id='commit'> Commit Name: 3c4ba0be634d9fd1a298c6572b03392665764a5e</div><div id='time'> Time: 2022-02-01</div><div id='author'> Author: artex.xh@gmail.com</div><div id='file'> File Name: tests/unit/array/mixins/test_text.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_da_text_to_tensor_non_max_len(1)</div><div id='n_method'> N Method Name: test_da_text_to_tensor_non_max_len(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/array/mixins/test_text.py</div><div id='n_file'> N File Name: tests/unit/array/mixins/test_text.py</div><div id='m_start'> M Start Line: 36</div><div id='m_end'> M End Line: 45</div><div id='n_start'> N Start Line: 46</div><div id='n_end'> N End Line: 50</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

@pytest.mark.parametrize(&quottest_docs&quot, da_and_dam())
def test_da_text_to_tensor_max_len_3(test_docs):
    <a id="change">vocab</a> = test_docs.get_vocabulary()
    <a id="change">for </a><a id="change">d</a> in test_docs<a id="change">:
        </a><a id="change">d.convert_text_to_tensor(</a>vocab<a id="change">, max_length=3)</a>
    np.testing.assert_array_equal(test_docs[0].tensor, [0, 0, 2])
    np.testing.assert_array_equal(test_docs[1].tensor, [0, 2, 3])
    np.testing.assert_array_equal(test_docs[2].tensor, [0, 4, 3])
    <a id="change">for d</a> in test_docs<a id="change">:
        </a><a id="change">d.convert_tensor_to_text(</a>vocab<a id="change">)</a>

    assert test_docs[0].text == &quothello&quot
    assert test_docs[1].text == &quothello world&quot
    assert test_docs[2].text == &quotgoodbye world&quot</code></pre><h3>After Change</h3><pre><code class='java'>
@pytest.mark.parametrize(&quottest_docs&quot, da_and_dam())
def test_da_text_to_tensor_max_len_3(test_docs):
    vocab = test_docs.get_vocabulary()
    <a id="change">test_docs.apply(</a>lambda d: d.convert_text_to_tensor(vocab, max_length=3)<a id="change">)</a>

    np.testing.assert_array_equal(test_docs[0].tensor, [0, 0, 2])
    np.testing.assert_array_equal(test_docs[1].tensor, [0, 2, 3])
    np.testing.assert_array_equal(test_docs[2].tensor, [0, 4, 3])

    <a id="change">test_docs.apply(</a>lambda d: d.convert_tensor_to_text(vocab)<a id="change">)</a>

    assert test_docs[0].text == &quothello&quot
    assert test_docs[1].text == &quothello world&quot
    assert test_docs[2].text == &quotgoodbye world&quot</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/docarray/commit/3c4ba0be634d9fd1a298c6572b03392665764a5e#diff-4fb0663f8c04b0a7ec3a0d30464dea074886e42a5fca4415e5f6ce5b4f6e6312L51' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 75751332</div><div id='project'> Project Name: jina-ai/docarray</div><div id='commit'> Commit Name: 3c4ba0be634d9fd1a298c6572b03392665764a5e</div><div id='time'> Time: 2022-02-01</div><div id='author'> Author: artex.xh@gmail.com</div><div id='file'> File Name: tests/unit/array/mixins/test_text.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_da_text_to_tensor_max_len_3(1)</div><div id='n_method'> N Method Name: test_da_text_to_tensor_max_len_3(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/array/mixins/test_text.py</div><div id='n_file'> N File Name: tests/unit/array/mixins/test_text.py</div><div id='m_start'> M Start Line: 52</div><div id='m_end'> M End Line: 61</div><div id='n_start'> N Start Line: 60</div><div id='n_end'> N End Line: 66</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    texts = [&quota short phrase&quot, &quotword&quot, &quotthis is a much longer sentence&quot]
    da.clear()
    da.extend(Document(text=t) for t in texts)
    <a id="change">vocab</a> = da.get_vocabulary()

    &#47&#47 encoding
    <a id="change">for </a><a id="change">d</a> in da<a id="change">:
        </a><a id="change">d.convert_text_to_tensor(</a>vocab<a id="change">, max_length=10)</a>

    &#47&#47 decoding
    <a id="change">for d</a> in da<a id="change">:
        </a><a id="change">d.convert_tensor_to_text(</a>vocab<a id="change">)</a>

    assert texts
    assert da.texts == texts
</code></pre><h3>After Change</h3><pre><code class='java'>
    vocab = da.get_vocabulary()

    &#47&#47 encoding
    <a id="change">da.apply(</a>lambda d: d.convert_text_to_tensor(vocab, max_length=10)<a id="change">)</a>

    &#47&#47 decoding
    <a id="change">da.apply(</a>lambda d: d.convert_tensor_to_text(vocab)<a id="change">)</a>

    assert texts
    assert da.texts == texts
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/docarray/commit/3c4ba0be634d9fd1a298c6572b03392665764a5e#diff-4fb0663f8c04b0a7ec3a0d30464dea074886e42a5fca4415e5f6ce5b4f6e6312L83' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 75751338</div><div id='project'> Project Name: jina-ai/docarray</div><div id='commit'> Commit Name: 3c4ba0be634d9fd1a298c6572b03392665764a5e</div><div id='time'> Time: 2022-02-01</div><div id='author'> Author: artex.xh@gmail.com</div><div id='file'> File Name: tests/unit/array/mixins/test_text.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_convert_text_tensor_random_text(1)</div><div id='n_method'> N Method Name: test_convert_text_tensor_random_text(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/array/mixins/test_text.py</div><div id='n_file'> N File Name: tests/unit/array/mixins/test_text.py</div><div id='m_start'> M Start Line: 87</div><div id='m_end'> M End Line: 97</div><div id='n_start'> N Start Line: 97</div><div id='n_end'> N End Line: 100</div><BR>