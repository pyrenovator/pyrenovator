<html><h3>Pattern ID :21952
</h3><img src='69787402.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
def match(truths, priors, labels, loc_t, conf_t, overlap_t, idx, multi_anchor=True):
     Match each prior box with the ground truth box 

    overlaps = <a id="change">jaccard(truths</a>, <a id="change">point_form(</a>priors<a id="change">)) if multi_anchor</a><a id="change"> else centerness(truths</a>, <a id="change">priors</a><a id="change">)</a>
    (best_truth_overlap, best_truth_idx) = overlaps.max(0)
    (best_prior_overlap, best_prior_idx) = overlaps.max(1)
    best_truth_overlap.index_fill_(0, best_prior_idx, 1)  &#47&#47 ensure best prior
    for j in range(best_prior_idx.size(0)):</code></pre><h3>After Change</h3><pre><code class='java'>
def match(truths, priors, labels, loc_t, conf_t, overlap_t, idx):
     Match each prior box with the ground truth box 

    overlaps = <a id="change">jaccard(</a>truths, <a id="change">point_form(</a>priors<a id="change">))</a>
    (best_truth_overlap, best_truth_idx) = overlaps.max(0)
    (best_prior_overlap, best_prior_idx) = overlaps.max(1)
    best_truth_overlap.index_fill_(0, best_prior_idx, 1)  &#47&#47 ensure best prior
    for j in range(best_prior_idx.size(0)):</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/zhangheng19931123/mutualguide/commit/d077af1cebb5a92b12f0c678eae7e23996ba0e9c#diff-7cd6c36c75963c973216f2c18eee2df1b14116478cf12d69c842b403bdc1329fL39' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 69787402</div><div id='project'> Project Name: zhangheng19931123/mutualguide</div><div id='commit'> Commit Name: d077af1cebb5a92b12f0c678eae7e23996ba0e9c</div><div id='time'> Time: 2021-11-06</div><div id='author'> Author: heng.zhang@irisa.fr</div><div id='file'> File Name: utils/box/box_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: match(7)</div><div id='n_method'> N Method Name: match(8)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: utils/box/box_utils.py</div><div id='n_file'> N File Name: utils/box/box_utils.py</div><div id='m_start'> M Start Line: 62</div><div id='m_end'> M End Line: 65</div><div id='n_start'> N Start Line: 39</div><div id='n_end'> N End Line: 39</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
def match(truths, priors, labels, loc_t, conf_t, overlap_t, idx, multi_anchor=True):
     Match each prior box with the ground truth box 

    overlaps = <a id="change">jaccard(</a>truths, <a id="change">point_form(</a>priors<a id="change">)) if multi_anchor</a><a id="change"> else centerness(</a>truths, priors<a id="change">)</a>
    (best_truth_overlap, best_truth_idx) = overlaps.max(0)
    (best_prior_overlap, best_prior_idx) = overlaps.max(1)
    best_truth_overlap.index_fill_(0, best_prior_idx, 1)  &#47&#47 ensure best prior
    for j in range(best_prior_idx.size(0)):</code></pre><h3>After Change</h3><pre><code class='java'>
def match(truths, priors, labels, loc_t, conf_t, overlap_t, idx):
     Match each prior box with the ground truth box 

    overlaps = <a id="change">jaccard(</a>truths, <a id="change">point_form(</a>priors<a id="change">))</a>
    (best_truth_overlap, best_truth_idx) = overlaps.max(0)
    (best_prior_overlap, best_prior_idx) = overlaps.max(1)
    best_truth_overlap.index_fill_(0, best_prior_idx, 1)  &#47&#47 ensure best prior
    for j in range(best_prior_idx.size(0)):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/zhangheng19931123/mutualguide/commit/d077af1cebb5a92b12f0c678eae7e23996ba0e9c#diff-7cd6c36c75963c973216f2c18eee2df1b14116478cf12d69c842b403bdc1329fL62' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 69787403</div><div id='project'> Project Name: zhangheng19931123/mutualguide</div><div id='commit'> Commit Name: d077af1cebb5a92b12f0c678eae7e23996ba0e9c</div><div id='time'> Time: 2021-11-06</div><div id='author'> Author: heng.zhang@irisa.fr</div><div id='file'> File Name: utils/box/box_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: match(7)</div><div id='n_method'> N Method Name: match(8)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: utils/box/box_utils.py</div><div id='n_file'> N File Name: utils/box/box_utils.py</div><div id='m_start'> M Start Line: 62</div><div id='m_end'> M End Line: 65</div><div id='n_start'> N Start Line: 39</div><div id='n_end'> N End Line: 39</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    topk = 15 if multi_anchor else 5
    reg_overlaps = jaccard(truths, decode(regress, priors))
    pred_classifs = <a id="change">jaccard(</a>truths, <a id="change">point_form(</a>priors<a id="change">)) if multi_anchor</a><a id="change"> else centerness(</a>truths, priors<a id="change">)</a>
    classif = classif.sigmoid().t()[labels - 1, :]
    pred_classifs = pred_classifs ** ((sigma - classif) / sigma)
    reg_overlaps[reg_overlaps != reg_overlaps.max(dim=0, keepdim=True)[0]] = 0.0
    pred_classifs[pred_classifs != pred_classifs.max(dim=0, keepdim=True)[0]] = 0.0</code></pre><h3>After Change</h3><pre><code class='java'>

    num_obj = truths.size()[0]
    reg_overlaps = jaccard(truths, decode(regress, priors))
    pred_classifs = <a id="change">jaccard(</a>truths, <a id="change">point_form(</a>priors<a id="change">))</a>
    classif = classif.sigmoid().t()[labels - 1, :]
    pred_classifs = pred_classifs ** ((sigma - classif + 1e-6) / sigma)
    reg_overlaps[reg_overlaps != reg_overlaps.max(dim=0, keepdim=True)[0]] = 0.0
    pred_classifs[pred_classifs != pred_classifs.max(dim=0, keepdim=True)[0]] = 0.0</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/zhanghengdev/mutualguide/commit/d077af1cebb5a92b12f0c678eae7e23996ba0e9c#diff-7cd6c36c75963c973216f2c18eee2df1b14116478cf12d69c842b403bdc1329fL77' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 69787404</div><div id='project'> Project Name: zhanghengdev/mutualguide</div><div id='commit'> Commit Name: d077af1cebb5a92b12f0c678eae7e23996ba0e9c</div><div id='time'> Time: 2021-11-06</div><div id='author'> Author: heng.zhang@irisa.fr</div><div id='file'> File Name: utils/box/box_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: mutual_match(12)</div><div id='n_method'> N Method Name: mutual_match(12)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: utils/box/box_utils.py</div><div id='n_file'> N File Name: utils/box/box_utils.py</div><div id='m_start'> M Start Line: 82</div><div id='m_end'> M End Line: 86</div><div id='n_start'> N Start Line: 56</div><div id='n_end'> N End Line: 58</div><BR>