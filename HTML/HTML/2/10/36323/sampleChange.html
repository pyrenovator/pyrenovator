<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        sess.close()

        bokeh_session.server_session.close("test complete")
        <a id="change">os.killpg(os</a><a id="change">.getpgid(</a>process.pid<a id="change">)</a>, signal.SIGTERM<a id="change">)</a>

    def test_eval_scores_with_spatial_svd_pruner(self):

        pruner = SpatialSvdPruner()</code></pre><h3>After Change</h3><pre><code class='java'>

        layer_db.mark_picked_layers([layer1, layer2])

        <a id="change">process = </a>None
        <a id="change">try:
            </a>url, process = start_bokeh_server_session()
            bokeh_session = BokehServerSession(url=url, session_id="compression")

            &#47&#47 Instantiate child
            greedy_algo = comp_ratio_select.GreedyCompRatioSelectAlgo(layer_db=layer_db, pruner=pruner,
                                                                      cost_calculator=SpatialSvdCostCalculator(),
                                                                      eval_func=eval_func, eval_iterations=20,
                                                                      cost_metric=CostMetric.mac, target_comp_ratio=0.5,
                                                                      num_candidates=10, use_monotonic_fit=True,
                                                                      saved_eval_scores_dict=None,
                                                                      comp_ratio_rounding_algo=None, use_cuda=False,
                                                                      bokeh_session=bokeh_session)

            eval_dict = greedy_algo._compute_eval_scores_for_all_comp_ratio_candidates()

            self.assertEqual(50, eval_dict[&quotconv2d/Conv2D&quot][Decimal(&quot0.5&quot)])
            self.assertEqual(60, eval_dict[&quotconv2d/Conv2D&quot][Decimal(&quot0.4&quot)])

            self.assertEqual(11, eval_dict[&quotconv2d_1/Conv2D&quot][Decimal(&quot0.9&quot)])

            tf.compat.v1.reset_default_graph()
            sess.close()

            bokeh_session.server_session.close("test complete")
        finally:
            <a id="change">if process</a>:
                <a id="change">process.terminate()</a>
                <a id="change">process.join()</a>

    def test_eval_scores_with_spatial_svd_pruner(self):

        pruner = SpatialSvdPruner()</code></pre>