<html><h3>Pattern ID :4418
</h3><img src='16199159.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        resnet18_model = models.resnet18(pretrained=True)
        &#47&#47 Create a layer database
        orig_layer_db = <a id="change">LayerDatabase(</a>resnet18_model<a id="change">, input_shape=(1, 3, 224, 224))</a>
        &#47&#47 Copy the db
        comp_layer_db = copy.deepcopy(orig_layer_db)

        data_loader = create_fake_data_loader(dataset_size=dataset_size, batch_size=batch_size,</code></pre><h3>After Change</h3><pre><code class='java'>
        model = models.resnet18().eval()

        &#47&#47 Create a layer database
        input_shape = (<a id="change">1</a><a id="change">, 3, 224, 224</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        orig_layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        &#47&#47 Copy the db
        comp_layer_db = copy.deepcopy(orig_layer_db)
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 21</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-9b25476fb2da8f869ee35ce9419b3da607dfef7ab80ff8d1ea47426f6edcaac5L668' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199159</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_channel_pruning.py</div><div id='m_class'> M Class Name: TestTrainingExtensionsChannelPruning</div><div id='n_method'> N Class Name: TestTrainingExtensionsChannelPruning</div><div id='m_method'> M Method Name: test_prune_layer_with_seq(1)</div><div id='n_method'> N Method Name: test_prune_layer_with_seq(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_channel_pruning.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_channel_pruning.py</div><div id='m_start'> M Start Line: 668</div><div id='m_end'> M End Line: 670</div><div id='n_start'> N Start Line: 673</div><div id='n_end'> N End Line: 678</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        model = mnist_model.Net()

        &#47&#47 Create a layer database
        layer_db = <a id="change">LayerDatabase(</a>model<a id="change">, input_shape=(1, 1, 28, 28))</a>

        fc1 = layer_db.find_layer_by_name(&quotfc1&quot)
        conv2 = layer_db.find_layer_by_name(&quotconv2&quot)
        pruner = WeightSvdPruner()</code></pre><h3>After Change</h3><pre><code class='java'>
        model = mnist_model.Net()

        &#47&#47 Create a layer database
        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        fc1 = layer_db.find_layer_by_name(&quotfc1&quot)
        conv2 = layer_db.find_layer_by_name(&quotconv2&quot)
        pruner = WeightSvdPruner()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-c42f32b8a0f85feab2002db274fffa2b8fde4199a13226b1ca9323937294407dL835' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199415</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='m_class'> M Class Name: TestWeightSvdPruning</div><div id='n_method'> N Class Name: TestWeightSvdPruning</div><div id='m_method'> M Method Name: test_prune_model_2_layers(1)</div><div id='n_method'> N Method Name: test_prune_model_2_layers(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='m_start'> M Start Line: 837</div><div id='m_end'> M End Line: 840</div><div id='n_start'> N Start Line: 879</div><div id='n_end'> N End Line: 884</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        resnet18_model.eval()

        &#47&#47 Create a layer database
        orig_layer_db = <a id="change">LayerDatabase(</a>resnet18_model<a id="change">, input_shape=(1, 3, 224, 224))</a>

        data_loader = create_fake_data_loader(dataset_size=dataset_size, batch_size=batch_size,
                                              image_size=(3, 224, 224))
</code></pre><h3>After Change</h3><pre><code class='java'>
        model.eval()

        &#47&#47 Create a layer database
        input_shape = (<a id="change">1</a><a id="change">, 3, 224, 224</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        orig_layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        data_loader = create_fake_data_loader(dataset_size=dataset_size, batch_size=batch_size,
                                              image_size=(3, 224, 224))
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-9b25476fb2da8f869ee35ce9419b3da607dfef7ab80ff8d1ea47426f6edcaac5L752' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199156</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_channel_pruning.py</div><div id='m_class'> M Class Name: TestTrainingExtensionsChannelPruning</div><div id='n_method'> N Class Name: TestTrainingExtensionsChannelPruning</div><div id='m_method'> M Method Name: test_prune_model_with_seq(1)</div><div id='n_method'> N Method Name: test_prune_model_with_seq(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_channel_pruning.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_channel_pruning.py</div><div id='m_start'> M Start Line: 761</div><div id='m_end'> M End Line: 765</div><div id='n_start'> N Start Line: 774</div><div id='n_end'> N End Line: 780</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                                 90, 80, 70, 60, 50, 40, 30, 20, 10,
                                 50]

        layer_db = <a id="change">LayerDatabase(</a>model<a id="change">, input_shape=(1, 1, 28, 28))</a>
        pruner = SpatialSvdPruner()
        comp_ratio_select_algo = GreedyCompRatioSelectAlgo(layer_db, pruner, SpatialSvdCostCalculator(),
                                                           mock_eval, 20, CostMetric.mac, Decimal(0.5),
                                                           10, True, None, rounding_algo, True, bokeh_session=None)</code></pre><h3>After Change</h3><pre><code class='java'>
                                 90, 80, 70, 60, 50, 40, 30, 20, 10,
                                 50]

        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        pruner = SpatialSvdPruner()
        comp_ratio_select_algo = GreedyCompRatioSelectAlgo(layer_db, pruner, SpatialSvdCostCalculator(),
                                                           mock_eval, 20, CostMetric.mac, Decimal(0.5),</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-35eba8c088a48c81602b918a3947a20563e6f318606c1f1edc6dbae1d80533a1L82' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199380</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_compression_algo.py</div><div id='m_class'> M Class Name: TestTrainingExtensionsCompressionAlgo</div><div id='n_method'> N Class Name: TestTrainingExtensionsCompressionAlgo</div><div id='m_method'> M Method Name: testSpatialSvd(1)</div><div id='n_method'> N Method Name: testSpatialSvd(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_compression_algo.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_compression_algo.py</div><div id='m_start'> M Start Line: 86</div><div id='m_end'> M End Line: 98</div><div id='n_start'> N Start Line: 87</div><div id='n_end'> N End Line: 101</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        logger.debug(self.id())
        model = MnistModel().to("cpu")

        layer_database = <a id="change">LayerDatabase(model=model, input_shape=(1, 1, 28, 28))</a>

        with unittest.mock.patch(&quotaimet_torch.svd.layer_selector_deprecated.LayerSelectorDeprecated._perform_layer_selection&quot):
            layer_selector = ls.LayerSelectorDeprecated(
                aimet_torch.svd.svd_intf_defs_deprecated.LayerSelectionScheme.top_n_layers, None, layer_database,</code></pre><h3>After Change</h3><pre><code class='java'>
        logger.debug(self.id())
        model = MnistModel().to("cpu")

        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        with unittest.mock.patch(&quotaimet_torch.svd.layer_selector_deprecated.LayerSelectorDeprecated._perform_layer_selection&quot):
            layer_selector = ls.LayerSelectorDeprecated(
                aimet_torch.svd.svd_intf_defs_deprecated.LayerSelectionScheme.top_n_layers, None, layer_db,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-c42f32b8a0f85feab2002db274fffa2b8fde4199a13226b1ca9323937294407dL146' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199348</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='m_class'> M Class Name: TestTrainingExtensionsSvd</div><div id='n_method'> N Class Name: TestTrainingExtensionsSvd</div><div id='m_method'> M Method Name: test_pick_compression_layers_top_n_layers(1)</div><div id='n_method'> N Method Name: test_pick_compression_layers_top_n_layers(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='m_start'> M Start Line: 152</div><div id='m_end'> M End Line: 156</div><div id='n_start'> N Start Line: 155</div><div id='n_end'> N End Line: 163</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        logger.debug(self.id())
        model = MnistModel().to("cpu")

        layer_database = <a id="change">LayerDatabase(model=model, input_shape=(1, 1, 28, 28))</a>

        with unittest.mock.patch(&quotaimet_torch.svd.layer_selector_deprecated.LayerSelectorDeprecated._perform_layer_selection&quot):
            layer_selector = ls.LayerSelectorDeprecated(
                aimet_torch.svd.svd_intf_defs_deprecated.LayerSelectionScheme.top_x_percent, None, layer_database, percent_thresh=None)</code></pre><h3>After Change</h3><pre><code class='java'>
        logger.debug(self.id())
        model = MnistModel().to("cpu")

        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        with unittest.mock.patch(&quotaimet_torch.svd.layer_selector_deprecated.LayerSelectorDeprecated._perform_layer_selection&quot):
            layer_selector = ls.LayerSelectorDeprecated(
                aimet_torch.svd.svd_intf_defs_deprecated.LayerSelectionScheme.top_x_percent, None, layer_db,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-c42f32b8a0f85feab2002db274fffa2b8fde4199a13226b1ca9323937294407dL115' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199316</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='m_class'> M Class Name: TestTrainingExtensionsSvd</div><div id='n_method'> N Class Name: TestTrainingExtensionsSvd</div><div id='m_method'> M Method Name: test_pick_compression_layers_top_x_percent(1)</div><div id='n_method'> N Method Name: test_pick_compression_layers_top_x_percent(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='m_start'> M Start Line: 120</div><div id='m_end'> M End Line: 124</div><div id='n_start'> N Start Line: 120</div><div id='n_end'> N End Line: 128</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    def test_choose_best_ranks(self):

        model = MnistModel().to("cpu")
        layer_database = <a id="change">LayerDatabase(model=model, input_shape=(1, 1, 28, 28))</a>
        run_model_return_values = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
        run_model = unittest.mock.Mock(side_effect=run_model_return_values)

        with unittest.mock.patch(&quotaimet_torch.layer_database.LayerDatabase&quot):</code></pre><h3>After Change</h3><pre><code class='java'>

        model = MnistModel().to("cpu")

        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        run_model_return_values = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
        run_model = unittest.mock.Mock(side_effect=run_model_return_values)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-c42f32b8a0f85feab2002db274fffa2b8fde4199a13226b1ca9323937294407dL492' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199252</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='m_class'> M Class Name: TestTrainingExtensionsSvd</div><div id='n_method'> N Class Name: TestTrainingExtensionsSvd</div><div id='m_method'> M Method Name: test_choose_best_ranks(1)</div><div id='n_method'> N Method Name: test_choose_best_ranks(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='m_start'> M Start Line: 495</div><div id='m_end'> M End Line: 495</div><div id='n_start'> N Start Line: 516</div><div id='n_end'> N End Line: 520</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        model = mnist_torch_model.Net()

        &#47&#47 Create a layer database
        orig_layer_db = <a id="change">LayerDatabase(</a>model<a id="change">, input_shape=(1, 1, 28, 28))</a>
        &#47&#47 Copy the db
        comp_layer_db = copy.deepcopy(orig_layer_db)

        conv1 = comp_layer_db.find_layer_by_name(&quotconv1&quot)</code></pre><h3>After Change</h3><pre><code class='java'>
        model = mnist_torch_model.Net()

        &#47&#47 Create a layer database
        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        orig_layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        &#47&#47 Copy the db
        comp_layer_db = copy.deepcopy(orig_layer_db)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-4cc614988016b23f3745170c04ff8d6af607d1ed4fe72aa32acba271009a1f3dL211' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199155</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_spatial_svd.py</div><div id='m_class'> M Class Name: TestSpatialSvdPruning</div><div id='n_method'> N Class Name: TestSpatialSvdPruning</div><div id='m_method'> M Method Name: test_prune_model_2_layers(1)</div><div id='n_method'> N Method Name: test_prune_model_2_layers(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_spatial_svd.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_spatial_svd.py</div><div id='m_start'> M Start Line: 213</div><div id='m_end'> M End Line: 216</div><div id='n_start'> N Start Line: 217</div><div id='n_end'> N End Line: 222</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        model = mnist_torch_model.Net().to(&quotcpu&quot)

        layer_db = <a id="change">LayerDatabase(</a>model<a id="change">, input_shape=(1, 1, 28, 28))</a>
        layer1 = layer_db.find_layer_by_name(&quotconv1&quot)
        layer_db.mark_picked_layers([layer1])

        eval_func.side_effect = [90, 80, 70, 60, 50, 40, 30, 20, 10]</code></pre><h3>After Change</h3><pre><code class='java'>

        model = mnist_torch_model.Net().to(&quotcpu&quot)

        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        layer1 = layer_db.find_layer_by_name(&quotconv1&quot)
        layer_db.mark_picked_layers([layer1])
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-6617fc5fd3f78b0d762e3d55f99afd617e811bb79dff68d1167aa1e201029121L84' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199409</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_comp_ratio_select.py</div><div id='m_class'> M Class Name: TestTrainingExtensionsCompRatioSelect</div><div id='n_method'> N Class Name: TestTrainingExtensionsCompRatioSelect</div><div id='m_method'> M Method Name: test_per_layer_eval_scores(1)</div><div id='n_method'> N Method Name: test_per_layer_eval_scores(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_comp_ratio_select.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_comp_ratio_select.py</div><div id='m_start'> M Start Line: 92</div><div id='m_end'> M End Line: 94</div><div id='n_start'> N Start Line: 93</div><div id='n_end'> N End Line: 97</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        model = mnist_model.Net()

        &#47&#47 Create a layer database
        orig_layer_db = <a id="change">LayerDatabase(</a>model<a id="change">, input_shape=(1, 1, 28, 28))</a>
        &#47&#47 Copy the db
        comp_layer_db = copy.deepcopy(orig_layer_db)

        conv2 = comp_layer_db.find_layer_by_name(&quotconv2&quot)</code></pre><h3>After Change</h3><pre><code class='java'>
        model = mnist_model.Net()

        &#47&#47 Create a layer database
        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        orig_layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        &#47&#47 Copy the db
        comp_layer_db = copy.deepcopy(orig_layer_db)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-c42f32b8a0f85feab2002db274fffa2b8fde4199a13226b1ca9323937294407dL803' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199377</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='m_class'> M Class Name: TestWeightSvdPruning</div><div id='n_method'> N Class Name: TestWeightSvdPruning</div><div id='m_method'> M Method Name: test_prune_layer(1)</div><div id='n_method'> N Method Name: test_prune_layer(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='m_start'> M Start Line: 805</div><div id='m_end'> M End Line: 808</div><div id='n_start'> N Start Line: 844</div><div id='n_end'> N End Line: 849</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        model = mnist_torch_model.Net()

        &#47&#47 Create a layer database
        orig_layer_db = <a id="change">LayerDatabase(</a>model<a id="change">, input_shape=(1, 1, 28, 28))</a>
        &#47&#47 Copy the db
        comp_layer_db = copy.deepcopy(orig_layer_db)

        conv1 = comp_layer_db.find_layer_by_name(&quotconv1&quot)</code></pre><h3>After Change</h3><pre><code class='java'>
        model = mnist_torch_model.Net()

        &#47&#47 Create a layer database
        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        orig_layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        &#47&#47 Copy the db
        comp_layer_db = copy.deepcopy(orig_layer_db)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-4cc614988016b23f3745170c04ff8d6af607d1ed4fe72aa32acba271009a1f3dL169' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199569</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_spatial_svd.py</div><div id='m_class'> M Class Name: TestSpatialSvdPruning</div><div id='n_method'> N Class Name: TestSpatialSvdPruning</div><div id='m_method'> M Method Name: test_prune_layer(1)</div><div id='n_method'> N Method Name: test_prune_layer(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_spatial_svd.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_spatial_svd.py</div><div id='m_start'> M Start Line: 171</div><div id='m_end'> M End Line: 174</div><div id='n_start'> N Start Line: 172</div><div id='n_end'> N End Line: 177</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        rounding_algo.round.side_effect = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9,
                                             0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]
        model = mnist_torch_model.Net()
        layer_db = <a id="change">LayerDatabase(</a>model<a id="change">, input_shape=(1, 1, 28, 28))</a>

        selected_layers = [layer for layer in layer_db if isinstance(layer.module, nn.Conv2d)]
        layer_db.mark_picked_layers(selected_layers)
</code></pre><h3>After Change</h3><pre><code class='java'>
        rounding_algo.round.side_effect = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9,
                                             0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]
        model = mnist_torch_model.Net()
        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        selected_layers = [layer for layer in layer_db if isinstance(layer.module, nn.Conv2d)]
        layer_db.mark_picked_layers(selected_layers)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-6617fc5fd3f78b0d762e3d55f99afd617e811bb79dff68d1167aa1e201029121L283' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199408</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_comp_ratio_select.py</div><div id='m_class'> M Class Name: TestTrainingExtensionsCompRatioSelect</div><div id='n_method'> N Class Name: TestTrainingExtensionsCompRatioSelect</div><div id='m_method'> M Method Name: test_select_per_layer_comp_ratios_with_spatial_svd_pruner(1)</div><div id='n_method'> N Method Name: test_select_per_layer_comp_ratios_with_spatial_svd_pruner(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_comp_ratio_select.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_comp_ratio_select.py</div><div id='m_start'> M Start Line: 292</div><div id='m_end'> M End Line: 293</div><div id='n_start'> N Start Line: 305</div><div id='n_end'> N End Line: 308</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        model = mnist_torch_model.Net().to(&quotcpu&quot)

        layer_db = <a id="change">LayerDatabase(</a>model<a id="change">, input_shape=(1, 1, 28, 28))</a>
        layer1 = layer_db.find_layer_by_name(&quotconv2&quot)
        layer_db.mark_picked_layers([layer1])
        layer2 = layer_db.find_layer_by_name(&quotfc2&quot)
        layer_db.mark_picked_layers([layer2])</code></pre><h3>After Change</h3><pre><code class='java'>
        compute_network_cost.return_value = (500,500)

        model = mnist_torch_model.Net().to(&quotcpu&quot)
        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        layer1 = layer_db.find_layer_by_name(&quotconv2&quot)
        layer_db.mark_picked_layers([layer1])
        layer2 = layer_db.find_layer_by_name(&quotfc2&quot)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-6617fc5fd3f78b0d762e3d55f99afd617e811bb79dff68d1167aa1e201029121L320' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199167</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_comp_ratio_select.py</div><div id='m_class'> M Class Name: TestTrainingExtensionsCompRatioSelect</div><div id='n_method'> N Class Name: TestTrainingExtensionsCompRatioSelect</div><div id='m_method'> M Method Name: test_comp_ratio_select_tar(1)</div><div id='n_method'> N Method Name: test_comp_ratio_select_tar(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_comp_ratio_select.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_comp_ratio_select.py</div><div id='m_start'> M Start Line: 338</div><div id='m_end'> M End Line: 340</div><div id='n_start'> N Start Line: 350</div><div id='n_end'> N End Line: 353</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        intf_defs = aimet_torch.svd.svd_intf_defs_deprecated

        layer_database = <a id="change">LayerDatabase(model=model, input_shape=(1, 1, 28, 28))</a>
        with unittest.mock.patch(&quotaimet_torch.layer_database.LayerDatabase&quot):
            with unittest.mock.patch(&quotaimet_torch.svd.layer_selector_deprecated.LayerSelectorDeprecated&quot):
                svd = s.SvdImpl(model=model, run_model=None, run_model_iterations=1, input_shape=(1, 1, 28, 28),
                                compression_type=intf_defs.CompressionTechnique.svd,</code></pre><h3>After Change</h3><pre><code class='java'>

        intf_defs = aimet_torch.svd.svd_intf_defs_deprecated

        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        with unittest.mock.patch(&quotaimet_torch.layer_database.LayerDatabase&quot):
            with unittest.mock.patch(&quotaimet_torch.svd.layer_selector_deprecated.LayerSelectorDeprecated&quot):
                svd = s.SvdImpl(model=model, run_model=None, run_model_iterations=1, input_shape=(1, 1, 28, 28),</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-c42f32b8a0f85feab2002db274fffa2b8fde4199a13226b1ca9323937294407dL766' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199423</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='m_class'> M Class Name: TestTrainingExtensionsSvd</div><div id='n_method'> N Class Name: TestTrainingExtensionsSvd</div><div id='m_method'> M Method Name: test_split_manual_rank(1)</div><div id='n_method'> N Method Name: test_split_manual_rank(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='m_start'> M Start Line: 773</div><div id='m_end'> M End Line: 773</div><div id='n_start'> N Start Line: 803</div><div id='n_end'> N End Line: 811</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        logger.debug(self.id())
        model = mnist_model.Net().to("cpu")

        layer_database = <a id="change">LayerDatabase(model=model, input_shape=(1, 1, 28, 28))</a>

        with unittest.mock.patch(&quotaimet_torch.svd.layer_selector_deprecated.LayerSelectorDeprecated&quot):
            svd = s.SvdImpl(model=model, run_model=mnist_model.evaluate, run_model_iterations=1,
                            input_shape=(1, 1, 28, 28),</code></pre><h3>After Change</h3><pre><code class='java'>
        logger.debug(self.id())
        model = mnist_model.Net().to("cpu")

        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        with unittest.mock.patch(&quotaimet_torch.svd.layer_selector_deprecated.LayerSelectorDeprecated&quot):
            svd = s.SvdImpl(model=model, run_model=mnist_model.evaluate, run_model_iterations=1,
                            input_shape=(1, 1, 28, 28),</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-c42f32b8a0f85feab2002db274fffa2b8fde4199a13226b1ca9323937294407dL194' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199164</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='m_class'> M Class Name: TestTrainingExtensionsSvd</div><div id='n_method'> N Class Name: TestTrainingExtensionsSvd</div><div id='m_method'> M Method Name: test_split_conv_layer_with_mo(1)</div><div id='n_method'> N Method Name: test_split_conv_layer_with_mo(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='m_start'> M Start Line: 199</div><div id='m_end'> M End Line: 207</div><div id='n_start'> N Start Line: 207</div><div id='n_end'> N End Line: 221</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        model = mnist_torch_model.Net().to(&quotcpu&quot)

        layer_db = <a id="change">LayerDatabase(</a>model<a id="change">, input_shape=(1, 1, 28, 28))</a>
        layer1 = layer_db.find_layer_by_name(&quotconv1&quot)
        layer2 = layer_db.find_layer_by_name(&quotconv2&quot)
        layer_db.mark_picked_layers([layer1, layer2])
</code></pre><h3>After Change</h3><pre><code class='java'>

        model = mnist_torch_model.Net().to(&quotcpu&quot)

        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        layer1 = layer_db.find_layer_by_name(&quotconv1&quot)
        layer2 = layer_db.find_layer_by_name(&quotconv2&quot)
        layer_db.mark_picked_layers([layer1, layer2])</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-6617fc5fd3f78b0d762e3d55f99afd617e811bb79dff68d1167aa1e201029121L113' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199621</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_comp_ratio_select.py</div><div id='m_class'> M Class Name: TestTrainingExtensionsCompRatioSelect</div><div id='n_method'> N Class Name: TestTrainingExtensionsCompRatioSelect</div><div id='m_method'> M Method Name: test_eval_scores(1)</div><div id='n_method'> N Method Name: test_eval_scores(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_comp_ratio_select.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_comp_ratio_select.py</div><div id='m_start'> M Start Line: 120</div><div id='m_end'> M End Line: 122</div><div id='n_start'> N Start Line: 126</div><div id='n_end'> N End Line: 130</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        orig_model = Net()
        orig_model.eval()
        &#47&#47 Create a layer database
        orig_layer_db = <a id="change">LayerDatabase(</a>orig_model<a id="change">, input_shape=(1, 1, 28, 28))</a>
        dataset_size = 1000
        batch_size = 10
        &#47&#47 max out number of batches
        number_of_batches = 100</code></pre><h3>After Change</h3><pre><code class='java'>
        orig_model.eval()

        &#47&#47 Create a layer database
        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        orig_layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>orig_model, dummy_input<a id="change">)</a>

        dataset_size = 1000
        batch_size = 10
        &#47&#47 max out number of batches</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-9b25476fb2da8f869ee35ce9419b3da607dfef7ab80ff8d1ea47426f6edcaac5L689' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199364</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_channel_pruning.py</div><div id='m_class'> M Class Name: TestTrainingExtensionsChannelPruning</div><div id='n_method'> N Class Name: TestTrainingExtensionsChannelPruning</div><div id='m_method'> M Method Name: test_prune_model(1)</div><div id='n_method'> N Method Name: test_prune_model(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_channel_pruning.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_channel_pruning.py</div><div id='m_start'> M Start Line: 718</div><div id='m_end'> M End Line: 721</div><div id='n_start'> N Start Line: 727</div><div id='n_end'> N End Line: 733</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        model = mnist_torch_model.Net()

        &#47&#47 Create a layer database
        layer_db = <a id="change">LayerDatabase(</a>model<a id="change">, input_shape=(1, 1, 28, 28))</a>

        layer1 = layer_db.find_layer_by_name(&quotconv1&quot)
        layer2 = layer_db.find_layer_by_name(&quotconv2&quot)
        layer_db.mark_picked_layers([layer1, layer2])</code></pre><h3>After Change</h3><pre><code class='java'>
        model = mnist_torch_model.Net()

        &#47&#47 Create a layer database
        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        layer1 = layer_db.find_layer_by_name(&quotconv1&quot)
        layer2 = layer_db.find_layer_by_name(&quotconv2&quot)
        layer_db.mark_picked_layers([layer1, layer2])</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-6617fc5fd3f78b0d762e3d55f99afd617e811bb79dff68d1167aa1e201029121L139' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199620</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_comp_ratio_select.py</div><div id='m_class'> M Class Name: TestTrainingExtensionsCompRatioSelect</div><div id='n_method'> N Class Name: TestTrainingExtensionsCompRatioSelect</div><div id='m_method'> M Method Name: test_eval_scores_with_spatial_svd_pruner(1)</div><div id='n_method'> N Method Name: test_eval_scores_with_spatial_svd_pruner(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_comp_ratio_select.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_comp_ratio_select.py</div><div id='m_start'> M Start Line: 146</div><div id='m_end'> M End Line: 162</div><div id='n_start'> N Start Line: 155</div><div id='n_end'> N End Line: 173</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                                 11, 21, 31, 35, 40, 45, 50, 55, 60]

        model = mnist_torch_model.Net()
        layer_db = <a id="change">LayerDatabase(</a>model<a id="change">, input_shape=(1, 1, 28, 28))</a>

        layer1 = layer_db.find_layer_by_name(&quotconv1&quot)
        layer2 = layer_db.find_layer_by_name(&quotconv2&quot)
        selected_layers = [layer1, layer2]</code></pre><h3>After Change</h3><pre><code class='java'>
                                 11, 21, 31, 35, 40, 45, 50, 55, 60]

        model = mnist_torch_model.Net()
        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        layer1 = layer_db.find_layer_by_name(&quotconv1&quot)
        layer2 = layer_db.find_layer_by_name(&quotconv2&quot)
        selected_layers = [layer1, layer2]</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-6617fc5fd3f78b0d762e3d55f99afd617e811bb79dff68d1167aa1e201029121L214' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199297</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_comp_ratio_select.py</div><div id='m_class'> M Class Name: TestTrainingExtensionsCompRatioSelect</div><div id='n_method'> N Class Name: TestTrainingExtensionsCompRatioSelect</div><div id='m_method'> M Method Name: test_select_per_layer_comp_ratios(1)</div><div id='n_method'> N Method Name: test_select_per_layer_comp_ratios(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_comp_ratio_select.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_comp_ratio_select.py</div><div id='m_start'> M Start Line: 224</div><div id='m_end'> M End Line: 225</div><div id='n_start'> N Start Line: 235</div><div id='n_end'> N End Line: 238</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        orig_model = mnist_torch_model.Net()
        orig_model.eval()
        &#47&#47 Create a layer database
        orig_layer_db = <a id="change">LayerDatabase(</a>orig_model<a id="change">, input_shape=(1, 1, 28, 28))</a>
        &#47&#47 Copy the db
        comp_layer_db = copy.deepcopy(orig_layer_db)

        dataset_size = 100</code></pre><h3>After Change</h3><pre><code class='java'>
        orig_model.eval()

        &#47&#47 Create a layer database
        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        orig_layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>orig_model, dummy_input<a id="change">)</a>

        &#47&#47 Copy the db
        comp_layer_db = copy.deepcopy(orig_layer_db)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-9b25476fb2da8f869ee35ce9419b3da607dfef7ab80ff8d1ea47426f6edcaac5L631' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199552</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_channel_pruning.py</div><div id='m_class'> M Class Name: TestTrainingExtensionsChannelPruning</div><div id='n_method'> N Class Name: TestTrainingExtensionsChannelPruning</div><div id='m_method'> M Method Name: test_prune_layer(1)</div><div id='n_method'> N Method Name: test_prune_layer(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_channel_pruning.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_channel_pruning.py</div><div id='m_start'> M Start Line: 633</div><div id='m_end'> M End Line: 636</div><div id='n_start'> N Start Line: 634</div><div id='n_end'> N End Line: 640</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        logger.debug(self.id())
        model = MnistModel().to("cpu")

        layer_database = <a id="change">LayerDatabase(model=model, input_shape=(1, 1, 28, 28))</a>

        with unittest.mock.patch(&quotaimet_torch.svd.layer_selector_deprecated.LayerSelectorDeprecated._perform_layer_selection&quot):
            layer_selector = ls.LayerSelectorDeprecated(
                aimet_torch.svd.svd_intf_defs_deprecated.LayerSelectionScheme.manual, None, layer_database, layers_to_compress=[model.conv2])</code></pre><h3>After Change</h3><pre><code class='java'>
        logger.debug(self.id())
        model = MnistModel().to("cpu")

        input_shape = (<a id="change">1</a><a id="change">, 1, 28, 28</a>)
        dummy_input<a id="change"> = </a><a id="change">create_rand_tensors_given_shapes(</a>input_shape<a id="change">)</a>
        layer_db<a id="change"> = </a><a id="change">LayerDatabase(</a>model, dummy_input<a id="change">)</a>

        with unittest.mock.patch(&quotaimet_torch.svd.layer_selector_deprecated.LayerSelectorDeprecated._perform_layer_selection&quot):
            layer_selector = ls.LayerSelectorDeprecated(
                aimet_torch.svd.svd_intf_defs_deprecated.LayerSelectionScheme.manual, None, layer_db,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/c54d5ac080bc9165913ddcd7ad3277c86d68fe9f#diff-c42f32b8a0f85feab2002db274fffa2b8fde4199a13226b1ca9323937294407dL177' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16199372</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: c54d5ac080bc9165913ddcd7ad3277c86d68fe9f</div><div id='time'> Time: 2021-04-05</div><div id='author'> Author: quic_hitameht@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='m_class'> M Class Name: TestTrainingExtensionsSvd</div><div id='n_method'> N Class Name: TestTrainingExtensionsSvd</div><div id='m_method'> M Method Name: test_pick_compression_layers_manual(1)</div><div id='n_method'> N Method Name: test_pick_compression_layers_manual(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/test/python/test_weight_svd.py</div><div id='m_start'> M Start Line: 182</div><div id='m_end'> M End Line: 186</div><div id='n_start'> N Start Line: 187</div><div id='n_end'> N End Line: 195</div><BR>