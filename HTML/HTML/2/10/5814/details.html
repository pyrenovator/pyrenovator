<html><h3>Pattern ID :5814
</h3><img src='20515403.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    name = _get_name(is_aff_model)
    tags = ["u-net", "cell-segmentation", "htm", "high-throughput-microscopt", "segmentation", "cells",
            "covid-antibody-test", "covid-19", "sars-cov-2", "immunofluorescence"]
    tags += ["boundary-prediction"]<a id="change"> if </a>is_aff_model<a id="change"> else [</a>"affinity-prediction"<a id="change"></a>]

    &#47&#47 eventually we should refactor the citation logic
    covid_if_pub = "https://doi.org/10.1002/bies.202000257"</code></pre><h3>After Change</h3><pre><code class='java'>
        cite["segmentation algorithm"] = covid_if_pub

    doc = _get_doc(is_aff_model, checkpoint, name)
    <a id="change">if </a>is_aff_model:
        offsets<a id="change"> = </a>[
            [-1, 0], [0, -1],
            [-3, 0], [0, -3],
            <a id="change">[-9</a>, 0<a id="change"></a>], [0, -9],
            <a id="change">[</a>-27, 0<a id="change"></a>], [0, -27]
        ]
        config<a id="change"> = </a>{"mws": {"offsets": offsets}}
    else:
        config<a id="change"> = </a><a id="change">{}</a>

    if additional_formats is None:
        additional_formats = []
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 9</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/constantinpape/torch-em/commit/5780bd3c9261f68965a2d26f642c5f6d7f510ed9#diff-c1b71af8a8e5153c9ee2f0e7d92c12e34eb0b5048734649f236b0aa16643309dL50' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 20515403</div><div id='project'> Project Name: constantinpape/torch-em</div><div id='commit'> Commit Name: 5780bd3c9261f68965a2d26f642c5f6d7f510ed9</div><div id='time'> Time: 2021-12-07</div><div id='author'> Author: constantin.pape@embl.de</div><div id='file'> File Name: experiments/covid-if/export_bioimageio_model.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: export_to_bioimageio(5)</div><div id='n_method'> N Method Name: export_to_bioimageio(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: experiments/covid-if/export_bioimageio_model.py</div><div id='n_file'> N File Name: experiments/covid-if/export_bioimageio_model.py</div><div id='m_start'> M Start Line: 50</div><div id='m_end'> M End Line: 72</div><div id='n_start'> N Start Line: 79</div><div id='n_end'> N End Line: 115</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    tags = ["u-net", "mitochondria-segmentation",
            "segmentation", "mito-em", "mitochondria"]
    tags += <a id="change">[</a>"boundary-prediction"<a id="change"></a>]<a id="change"> if </a>is_aff_model<a id="change"> else </a>["affinity-prediction"]

    cite = get_default_citations(
        model="AnisotropicUNet",</code></pre><h3>After Change</h3><pre><code class='java'>
        is_aff_model = False

    name, desc = _get_name_and_description(is_aff)
    <a id="change">if </a>is_aff_model:
        offsets<a id="change"> = </a>[
            [-1, 0, 0], [0, -1, 0], [0, 0, -1],
            [-2, 0, 0], [0, -3, 0], <a id="change">[</a>0, 0, -3<a id="change"></a>],
            [-3, 0, 0], <a id="change">[0</a>, -9, 0<a id="change"></a>], [0, 0, -9]
        ]
        config<a id="change"> = </a><a id="change">{</a>"mws": {"offsets": offsets}<a id="change">}</a>
    else:
        config<a id="change"> = </a>{}

    cite = get_default_citations(
        model="AnisotropicUNet",</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/constantinpape/torch-em/commit/1928bde5678b710f40748422e066826657b4633d#diff-1a906b3aaee5de3028e716c426db408449f0369544074ed89adb9fc635af6966L74' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 20515388</div><div id='project'> Project Name: constantinpape/torch-em</div><div id='commit'> Commit Name: 1928bde5678b710f40748422e066826657b4633d</div><div id='time'> Time: 2021-12-16</div><div id='author'> Author: c.pape@gmx.net</div><div id='file'> File Name: experiments/mito-em/export_bioimageio_model.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: export_to_bioimageio(5)</div><div id='n_method'> N Method Name: export_to_bioimageio(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: experiments/mito-em/export_bioimageio_model.py</div><div id='n_file'> N File Name: experiments/mito-em/export_bioimageio_model.py</div><div id='m_start'> M Start Line: 82</div><div id='m_end'> M End Line: 98</div><div id='n_start'> N Start Line: 81</div><div id='n_end'> N End Line: 108</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            gpu_ids = [] if not torch.cuda.is_available() else [1]
        elif mode == "test":
            nprocesses = 1
            gpu_ids = <a id="change">[]</a><a id="change"> if </a>not torch.cuda.is_available()<a id="change"> else </a>[0]
        else:
            raise NotImplementedError("mode must be &quottrain&quot, &quotvalid&quot, or &quottest&quot.")
</code></pre><h3>After Change</h3><pre><code class='java'>
                gpu_ids = [torch.cuda.device_count()]
        elif mode == "test":
            nprocesses = 1
            <a id="change">if </a>not torch.cuda.is_available():
                gpu_ids<a id="change"> = </a><a id="change">[]</a>
            elif torch.cuda.device_count() == 1:
                gpu_ids<a id="change"> = [0</a>]
            elif torch.cuda.device_count() &gt; 1:
                gpu_ids<a id="change"> = </a><a id="change">[</a>torch.cuda.device_count()<a id="change"></a>]
        else:
            raise NotImplementedError("mode must be &quottrain&quot, &quotvalid&quot, or &quottest&quot.")
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/allenai/allenact/commit/446a8e040e4777383edf7d77f9747d6cdae56702#diff-a3576ce9bd467911e474438a1a9cba4e51b2f98f18fb54bed6de990c979a8a63L117' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 20515398</div><div id='project'> Project Name: allenai/allenact</div><div id='commit'> Commit Name: 446a8e040e4777383edf7d77f9747d6cdae56702</div><div id='time'> Time: 2020-02-12</div><div id='author'> Author: klemenk@ip-172-16-3-136.us-west-2.compute.internal</div><div id='file'> File Name: experiments/pointnav_habitat_rgb_deterministic.py</div><div id='m_class'> M Class Name: PointNavHabitatRGBDeterministicExperimentConfig</div><div id='n_method'> N Class Name: PointNavHabitatRGBDeterministicExperimentConfig</div><div id='m_method'> M Method Name: machine_params(2)</div><div id='n_method'> N Method Name: machine_params(2)</div><div id='m_parent_class'> M Parent Class: ExperimentConfig</div><div id='n_parent_class'> N Parent Class: ExperimentConfig</div><div id='m_file'> M File Name: experiments/pointnav_habitat_rgb_deterministic.py</div><div id='n_file'> N File Name: experiments/pointnav_habitat_rgb_deterministic.py</div><div id='m_start'> M Start Line: 123</div><div id='m_end'> M End Line: 126</div><div id='n_start'> N Start Line: 123</div><div id='n_end'> N End Line: 137</div><BR>