<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        f1_score(sentence, pred, tags)
        0.50
    
    <a id="change">entityres</a> = <a id="change">[]</a>
    entityall = <a id="change">[]</a>
    <a id="change">for idx</a>, (t, p) in <a id="change">enumerate(</a><a id="change">zip(</a>tags, preds<a id="change">)):
        </a>entityres<a id="change"> = </a><a id="change">calculate(sents</a><a id="change">[idx]</a>, p, <a id="change">entityres</a><a id="change">)</a>
        <a id="change">entityall</a><a id="change"> = </a><a id="change">calculate(sents</a><a id="change">[idx]</a>, t, entityall<a id="change">)</a>

    &#47&#47 print("pred:", entityres)
    &#47&#47 print("labels:", entityall)
    nb_correct = len(<a id="change">[i for i in entityres if i in entityall]</a>)
    nb_pred<a id="change"> = len(</a>entityres<a id="change">)</a>
    nb_true<a id="change"> = len(entityall</a><a id="change">)</a>

    p = nb_correct / nb_pred if nb_pred &gt; 0 else 0
    r = nb_correct / nb_true if nb_true &gt; 0 else 0
    score = 2 * p * r / (p + r) if p + r &gt; 0 else 0</code></pre><h3>After Change</h3><pre><code class='java'>


def f1_score(y_true, y_pred):
    true_entities<a id="change"> = set(</a><a id="change">get_entities(</a>y_true<a id="change">))</a>
    <a id="change">pred_entities</a> = <a id="change">set(</a><a id="change">get_entities(</a>y_pred<a id="change">))</a>
    nb_correct = <a id="change">len(</a>true_entities<a id="change"> & pred_entities</a><a id="change">)</a>
    nb_pred<a id="change"> = len(pred_entities</a><a id="change">)</a>
    nb_true = len(true_entities)

    p = nb_correct / nb_pred if nb_pred &gt; 0 else 0
    r = nb_correct / nb_true if nb_true &gt; 0 else 0</code></pre>