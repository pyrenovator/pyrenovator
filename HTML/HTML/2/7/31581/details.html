<html><h3>Pattern ID :31581
</h3><img src='92248413.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        &#47&#47 Compute heatmaps as preprocessing step
        label_heatmaps = []
        <a id="change">for </a>idx, <a id="change">y</a> in enumerate(<a id="change">tqdm(</a>self.labels<a id="change">)</a>)<a id="change">:
            </a>x = Image.open(os.path.join(root_directory, self.image_names[idx])).convert(
                "RGB" &#47&#47didn&quott do this for DLC
            )  &#47&#47 Rick&quots images have 1 color channel; change to 3.
            if transform:
                x, y = transform(images = np.expand_dims(x, axis = 0), keypoints = np.expand_dims(y, axis = 0)) &#47&#47check transform and normalization
            x = x.squeeze(0)
            y<a id="change"> = </a>y.squeeze(0)
            x = self.torch_transform(x)
            y_heatmap = draw_keypoints(y, x.shape[-2], x.shape[-1], self.output_shape, sigma = 5)
            label_heatmaps.append(y_heatmap)</code></pre><h3>After Change</h3><pre><code class='java'>
        self.fully_labeled_idxs = self.get_fully_labeled_idxs()
        print(self.fully_labeled_idxs)
        self.image_names = [self.image_names[idx] for idx in self.fully_labeled_idxs]
        self.labels<a id="change"> = </a><a id="change">[self.labels[idx] for idx in self.fully_labeled_idxs]</a>
        print(len(self.image_names), len(self.labels))
        &#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47

        self.downsample_factor = 2 &#47&#47could change to 0, 2, 3, or 4</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/danbider/lightning-pose/commit/545a2f0293f923aca78924357ba161baf71f2982#diff-0779795c0a8a233449cfa9c0bd55d45453213457b10fa40da3e5a32966494943L80' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 92248413</div><div id='project'> Project Name: danbider/lightning-pose</div><div id='commit'> Commit Name: 545a2f0293f923aca78924357ba161baf71f2982</div><div id='time'> Time: 2021-07-15</div><div id='author'> Author: ubuntu@ip-172-31-72-121.ec2.internal</div><div id='file'> File Name: pose_est_nets/datasets/datasets.py</div><div id='m_class'> M Class Name: DLCHeatmapDataset</div><div id='n_method'> N Class Name: DLCHeatmapDataset</div><div id='m_method'> M Method Name: __init__(5)</div><div id='n_method'> N Method Name: __init__(5)</div><div id='m_parent_class'> M Parent Class: torch.utils.data.Dataset</div><div id='n_parent_class'> N Parent Class: torch.utils.data.Dataset</div><div id='m_file'> M File Name: pose_est_nets/datasets/datasets.py</div><div id='n_file'> N File Name: pose_est_nets/datasets/datasets.py</div><div id='m_start'> M Start Line: 80</div><div id='m_end'> M End Line: 137</div><div id='n_start'> N Start Line: 80</div><div id='n_end'> N End Line: 114</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    subwrds = []
    logger.info("generating subwrd lists...")
    <a id="change">for </a>i, <a id="change">line</a> in enumerate(<a id="change">tqdm(</a>lines<a id="change">)</a>)<a id="change">:
        </a>ids<a id="change"> = </a>tokenizer.sp.encode_as_ids(line)
        &#47&#47 filter out sentence that is too short or to long
        if len(ids) &gt; 0 and len(ids) &lt; 400:
            subwrds.append(ids)</code></pre><h3>After Change</h3><pre><code class='java'>

    if add_txt is not None:
        all_wrds = add_txt
        chars_lst = <a id="change">[c for c in "_".join(all_wrds)]</a>
        all_chars<a id="change"> = </a>" ".join(chars_lst)

    with gzip.open(data_path, "rt") as f_in:
        for snt_id, line in enumerate(f_in):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/speechbrain/speechbrain/commit/057bf8612902186a15a1b491180d503ff1872c49#diff-4337ab4eb452d3bf669f89476cdd3ebe00df732cc3949a73af09402f83531ff7L113' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 92248426</div><div id='project'> Project Name: speechbrain/speechbrain</div><div id='commit'> Commit Name: 057bf8612902186a15a1b491180d503ff1872c49</div><div id='time'> Time: 2020-10-28</div><div id='author'> Author: jzhong9@u.rochester.edu</div><div id='file'> File Name: recipes/LibriSpeech/librispeech_lm_prepare.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: create_hdf5(5)</div><div id='n_method'> N Method Name: create_hdf5(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: recipes/LibriSpeech/librispeech_lm_prepare.py</div><div id='n_file'> N File Name: recipes/LibriSpeech/librispeech_lm_prepare.py</div><div id='m_start'> M Start Line: 135</div><div id='m_end'> M End Line: 195</div><div id='n_start'> N Start Line: 150</div><div id='n_end'> N End Line: 186</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    files = list(data_dir.glob(&quot**/*.mid&quot))
    &#47&#47 files = files[:1000]

    <a id="change">for f</a> in <a id="change">tqdm(</a>files<a id="change">):
        </a>try:
            mid<a id="change"> = </a>mido.MidiFile(f)
        except Exception:
            continue
        </code></pre><h3>After Change</h3><pre><code class='java'>
def main(data_path, dest_path, n_jobs=4):
    data_dir = Path(data_path)
    files = list(data_dir.glob(&quot**/*.mid&quot))
    files_out = <a id="change">[
        (Path(dest_path) / f.relative_to(data_path))
        for f in files]</a>
    parents<a id="change"> = </a>{g.parent for g in files_out}
    for parent in list(parents):
        parent.mkdir(parents=True, exist_ok=True)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/intelligent-instruments-lab/iil-python-tools/commit/dbb5cf68b2b6902addf71a598302850beb1473cf#diff-9d738772070de4df243e741743f664299e8ce7ef188e1d5d6f035c83cce242d9L9' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 92248434</div><div id='project'> Project Name: intelligent-instruments-lab/iil-python-tools</div><div id='commit'> Commit Name: dbb5cf68b2b6902addf71a598302850beb1473cf</div><div id='time'> Time: 2022-02-21</div><div id='author'> Author: victor.shepardson@gmail.com</div><div id='file'> File Name: scripts/lakh_prep.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(3)</div><div id='n_method'> N Method Name: main(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: scripts/lakh_prep.py</div><div id='n_file'> N File Name: scripts/lakh_prep.py</div><div id='m_start'> M Start Line: 11</div><div id='m_end'> M End Line: 43</div><div id='n_start'> N Start Line: 41</div><div id='n_end'> N End Line: 56</div><BR>