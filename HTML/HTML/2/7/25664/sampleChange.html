<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        if not hasattr(args, "stage_to_device_map"):
            raise ValueError("Need stage_to_device_map to infer number of GPUs")
        else:
            n_unique_gpus = len(<a id="change">set(</a>args.stage_to_device_map<a id="change">)</a>)
            supremum_staleness<a id="change"> = </a>n_unique_gpus
            print(f"-I- auto inferring supremum_staleness of {supremum_staleness}")

    elif supremum_staleness is not None:
        assert isinstance(supremum_staleness, int)

    <a id="change">if supremum_staleness is not None</a> and supremum_staleness &gt; -1:
        print(f"-I- using supremum_staleness of {supremum_staleness}")

        if sched_name in {&quot1f1b&quot, "virtual_stages_1f1b"}:
            kw[&quotsupremum_staleness&quot] = supremum_staleness
            sched_name<a id="change"> = </a>"virtual_stages_1f1b"

    return AVAILABLE_WORK_SCHEDULERS.get(sched_name)(args.step_every, **kw)
</code></pre><h3>After Change</h3><pre><code class='java'>
    kw = {}

    if sched_name == "virtual_stages_1f1b":
        <a id="change">kw[&quotnum_gpus&quot] = </a>_get_num_unique_gpus(args)
        kw[&quotsupremum_staleness&quot] = _get_supremum_staleness(args)

    return AVAILABLE_WORK_SCHEDULERS.get(sched_name)(args.step_every, **kw)</code></pre>