<html><h3>Pattern ID :22740
</h3><img src='72198469.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

    def test_unpack_multiple(self):
        mapper = UnpackingMapper()
        dataset = <a id="change">Dataset(
            </a>[
                <a id="change">{</a>"a": [0.1, 1.1, 2.1, 3.1], "b": [0.2, 1.2, 2.2, 3.2]<a id="change">}</a>,
                <a id="change">{</a>"a": [4.1, 5.1], "b": [4.2, 5.2]<a id="change">}</a>,
            ]<a id="change">
        )</a>
        dataset = mapper.map(dataset)

        self.assertEqual(len(dataset), 6)
        for i in range(6):</code></pre><h3>After Change</h3><pre><code class='java'>
    def test_unpack_multiple(self):
        mapper = UnpackingMapper()
        dataset = [
            <a id="change">{</a>"a": [0.1, 1.1, 2.1, 3.1], "b": [0.2, 1.2, 2.2, 3.2]<a id="change">}</a>,
            <a id="change">{</a>"a": [4.1, 5.1], "b": [4.2, 5.2]<a id="change">}</a>,
        ]
        dataset = mapper.map(dataset)
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/allenai/smashed/commit/ca56e9d56d9610d025668a7fa2f3e46639d2f923#diff-ec121538e8d05ea5a5f526c2d90e8098acd775842440179bbf0cd8f5e2163ed4L18' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 72198469</div><div id='project'> Project Name: allenai/smashed</div><div id='commit'> Commit Name: ca56e9d56d9610d025668a7fa2f3e46639d2f923</div><div id='time'> Time: 2022-09-08</div><div id='author'> Author: luca@soldaini.net</div><div id='file'> File Name: tests/test_unpacking_mapper.py</div><div id='m_class'> M Class Name: TestUnpackingMapper</div><div id='n_method'> N Class Name: TestUnpackingMapper</div><div id='m_method'> M Method Name: test_unpack_multiple(1)</div><div id='n_method'> N Method Name: test_unpack_multiple(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: tests/test_unpacking_mapper.py</div><div id='n_file'> N File Name: tests/test_unpacking_mapper.py</div><div id='m_start'> M Start Line: 18</div><div id='m_end'> M End Line: 23</div><div id='n_start'> N Start Line: 18</div><div id='n_end'> N End Line: 21</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    def test_map(self):
        mapper = FlattenMapper(field="input_ids")
        dataset = <a id="change">Dataset(
            </a>[
                <a id="change">{</a>"input_ids": [[1, 2, 3, 4], [5, 6, 7, 8]]<a id="change">}</a>,
                <a id="change">{</a>"input_ids": [[9, 10, 11, 12], [13, 14, 15, 16]]<a id="change">}</a>,
            ]<a id="change">
        )</a>
        new_dataset = mapper.map(dataset)
        assert new_dataset == [
            {"input_ids": [1, 2, 3, 4, 5, 6, 7, 8]},
            {"input_ids": [9, 10, 11, 12, 13, 14, 15, 16]},</code></pre><h3>After Change</h3><pre><code class='java'>
    def test_map(self):
        mapper = FlattenMapper(field="input_ids")
        dataset = [
            <a id="change">{</a>"input_ids": [[1, 2, 3, 4], [5, 6, 7, 8]]<a id="change">}</a>,
            <a id="change">{</a>"input_ids": [[9, 10, 11, 12], [13, 14, 15, 16]]<a id="change">}</a>,
        ]
        new_dataset = mapper.map(dataset)
        assert new_dataset == [</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/allenai/smashed/commit/ca56e9d56d9610d025668a7fa2f3e46639d2f923#diff-8276bc6a7e7975f6610e1bbda535d252c3b0400a9d1a25cb385a2254f01fa574L17' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 72198445</div><div id='project'> Project Name: allenai/smashed</div><div id='commit'> Commit Name: ca56e9d56d9610d025668a7fa2f3e46639d2f923</div><div id='time'> Time: 2022-09-08</div><div id='author'> Author: luca@soldaini.net</div><div id='file'> File Name: tests/test_shape_mappers.py</div><div id='m_class'> M Class Name: TestFlattenMapper</div><div id='n_method'> N Class Name: TestFlattenMapper</div><div id='m_method'> M Method Name: test_map(1)</div><div id='n_method'> N Method Name: test_map(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: tests/test_shape_mappers.py</div><div id='n_file'> N File Name: tests/test_shape_mappers.py</div><div id='m_start'> M Start Line: 19</div><div id='m_end'> M End Line: 24</div><div id='n_start'> N Start Line: 19</div><div id='n_end'> N End Line: 22</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        Test that TokenizationMapper returns the right fields
        and is doing something right
        mapper = TokenizerMapper(input_field="text", tokenizer=self.tokenizer)
        dataset = <a id="change">Dataset(
            </a>[
                <a id="change">{
                    </a>"text": [
                        "This is a sentence.",
                        "This is two sentences. Here is the second one.",
                    ]<a id="change">
                }</a>,
                <a id="change">{
                    </a>"text": [
                        "This is a separate instance.",
                        "This",
                        "is",
                        "some",
                        "tokens",
                        ".",
                    ]<a id="change">
                }</a>,
            ]<a id="change">
        )</a>
        new_dataset = mapper.map(dataset)

        &#47&#47 same num dicts
        self.assertEqual(len(dataset), len(new_dataset))</code></pre><h3>After Change</h3><pre><code class='java'>
        and is doing something right
        mapper = TokenizerMapper(input_field="text", tokenizer=self.tokenizer)
        dataset = [
            <a id="change">{
                </a>"text": [
                    "This is a sentence.",
                    "This is two sentences. Here is the second one.",
                ]<a id="change">
            }</a>,
            <a id="change">{
                </a>"text": [
                    "This is a separate instance.",
                    "This",
                    "is",
                    "some",
                    "tokens",
                    ".",
                ]<a id="change">
            }</a>,
        ]
        new_dataset = mapper.map(dataset)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/allenai/smashed/commit/ca56e9d56d9610d025668a7fa2f3e46639d2f923#diff-f99544564768a9238027a1e3b401efb5be9574704c620c02a9009585cdcdf9e5L77' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 72198471</div><div id='project'> Project Name: allenai/smashed</div><div id='commit'> Commit Name: ca56e9d56d9610d025668a7fa2f3e46639d2f923</div><div id='time'> Time: 2022-09-08</div><div id='author'> Author: luca@soldaini.net</div><div id='file'> File Name: tests/test_tokenize_mappers.py</div><div id='m_class'> M Class Name: TestTokenizerMapper</div><div id='n_method'> N Class Name: TestTokenizerMapper</div><div id='m_method'> M Method Name: test_map(1)</div><div id='n_method'> N Method Name: test_map(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: tests/test_tokenize_mappers.py</div><div id='n_file'> N File Name: tests/test_tokenize_mappers.py</div><div id='m_start'> M Start Line: 81</div><div id='m_end'> M End Line: 100</div><div id='n_start'> N Start Line: 80</div><div id='n_end'> N End Line: 97</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    def test_unpack_multiple(self):
        mapper = UnpackingMapper()
        dataset = <a id="change">Dataset(
            </a>[
                <a id="change">{</a>"a": [0.1, 1.1, 2.1, 3.1], "b": [0.2, 1.2, 2.2, 3.2]<a id="change">}</a>,
                <a id="change">{</a>"a": [4.1, 5.1], "b": [4.2, 5.2]<a id="change">}</a>,
            ]<a id="change">
        )</a>
        dataset = mapper.map(dataset)

        self.assertEqual(len(dataset), 6)
        for i in range(6):</code></pre><h3>After Change</h3><pre><code class='java'>
    def test_unpack_multiple(self):
        mapper = UnpackingMapper()
        dataset = [
            <a id="change">{</a>"a": [0.1, 1.1, 2.1, 3.1], "b": [0.2, 1.2, 2.2, 3.2]<a id="change">}</a>,
            <a id="change">{</a>"a": [4.1, 5.1], "b": [4.2, 5.2]<a id="change">}</a>,
        ]
        dataset = mapper.map(dataset)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/allenai/smashed/commit/ca56e9d56d9610d025668a7fa2f3e46639d2f923#diff-ec121538e8d05ea5a5f526c2d90e8098acd775842440179bbf0cd8f5e2163ed4L16' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 72198465</div><div id='project'> Project Name: allenai/smashed</div><div id='commit'> Commit Name: ca56e9d56d9610d025668a7fa2f3e46639d2f923</div><div id='time'> Time: 2022-09-08</div><div id='author'> Author: luca@soldaini.net</div><div id='file'> File Name: tests/test_unpacking_mapper.py</div><div id='m_class'> M Class Name: TestUnpackingMapper</div><div id='n_method'> N Class Name: TestUnpackingMapper</div><div id='m_method'> M Method Name: test_unpack_multiple(1)</div><div id='n_method'> N Method Name: test_unpack_multiple(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: tests/test_unpacking_mapper.py</div><div id='n_file'> N File Name: tests/test_unpacking_mapper.py</div><div id='m_start'> M Start Line: 18</div><div id='m_end'> M End Line: 23</div><div id='n_start'> N Start Line: 18</div><div id='n_end'> N End Line: 21</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        mapper = UnpackingMapper(
            fields_to_unpack=["a"], ignored_behavior="drop"
        )
        dataset = <a id="change">Dataset(
            </a>[<a id="change">{</a>"a": [0, 1, 2, 3], "b": "hello"<a id="change">}</a>, <a id="change">{</a>"a": [4, 5], "b": "hello"<a id="change">}</a>]<a id="change">
        )</a>

        dropped_dataset = mapper.map(dataset)
        self.assertEqual(len(dropped_dataset), 6)
        for i in range(6):</code></pre><h3>After Change</h3><pre><code class='java'>
            fields_to_unpack=["a"], ignored_behavior="drop"
        )
        dataset = [
            <a id="change">{</a>"a": [0, 1, 2, 3], "b": "hello"<a id="change">}</a>,
            <a id="change">{</a>"a": [4, 5], "b": "hello"<a id="change">}</a>,
        ]

        dropped_dataset = mapper.map(dataset)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/allenai/smashed/commit/ca56e9d56d9610d025668a7fa2f3e46639d2f923#diff-ec121538e8d05ea5a5f526c2d90e8098acd775842440179bbf0cd8f5e2163ed4L32' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 72198464</div><div id='project'> Project Name: allenai/smashed</div><div id='commit'> Commit Name: ca56e9d56d9610d025668a7fa2f3e46639d2f923</div><div id='time'> Time: 2022-09-08</div><div id='author'> Author: luca@soldaini.net</div><div id='file'> File Name: tests/test_unpacking_mapper.py</div><div id='m_class'> M Class Name: TestUnpackingMapper</div><div id='n_method'> N Class Name: TestUnpackingMapper</div><div id='m_method'> M Method Name: test_unpack_multiple_while_skipping_fields(1)</div><div id='n_method'> N Method Name: test_unpack_multiple_while_skipping_fields(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: tests/test_unpacking_mapper.py</div><div id='n_file'> N File Name: tests/test_unpacking_mapper.py</div><div id='m_start'> M Start Line: 36</div><div id='m_end'> M End Line: 38</div><div id='n_start'> N Start Line: 34</div><div id='n_end'> N End Line: 37</div><BR>