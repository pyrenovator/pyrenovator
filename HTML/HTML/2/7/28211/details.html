<html><h3>Pattern ID :28211
</h3><img src='83361703.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    def step_single(self, img: torch.Tensor, **kwargs):
        img = img.unsqueeze(0)                  &#47&#47 add batch dim
        track_bboxes, track_ids = self.step_batch(img, **kwargs)
        <a id="change">return </a>track_bboxes[0]<a id="change">, track_ids[0]</a>    &#47&#47 remove batch dim

    def update(self, bboxes, labels, scores, embeddings, **kwargs):
        detection_threshold = kwargs.get("detection_threshold", self.detection_threshold)</code></pre><h3>After Change</h3><pre><code class='java'>
    def step_single(self, img: torch.Tensor, **kwargs):
        img = img.unsqueeze(0)                  &#47&#47 add batch dim
        out = self.step_batch(img, **kwargs)
        out<a id="change"> = </a><a id="change">{k: v[0] for k,v in out.items()}</a>  &#47&#47 remove batch dim
        <a id="change">return </a>out 

    def update(self, bboxes, labels, scores, embeddings, **kwargs):
        detection_threshold = kwargs.get("detection_threshold", self.detection_threshold)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 7</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/gau-nernst/centernet-lightning/commit/249b4ebe9c085563d2f8a19837e18d886562a1e4#diff-ca721a49e525ff45a8163e5a1376189506310ff21254b78dc40ed9047eb5a2fdL115' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 83361703</div><div id='project'> Project Name: gau-nernst/centernet-lightning</div><div id='commit'> Commit Name: 249b4ebe9c085563d2f8a19837e18d886562a1e4</div><div id='time'> Time: 2021-08-01</div><div id='author'> Author: gau.nernst@yahoo.com.sg</div><div id='file'> File Name: src/models/tracker.py</div><div id='m_class'> M Class Name: Tracker</div><div id='n_method'> N Class Name: Tracker</div><div id='m_method'> M Method Name: step_single(2)</div><div id='n_method'> N Method Name: step_single(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/models/tracker.py</div><div id='n_file'> N File Name: src/models/tracker.py</div><div id='m_start'> M Start Line: 115</div><div id='m_end'> M End Line: 116</div><div id='n_start'> N Start Line: 120</div><div id='n_end'> N End Line: 122</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        init_ft_cnt = len(self.strategy_adapter.fts_optim_view(sched[0]["params"]))
        total_ft_cnt = len([p for phase in sched for p in self.strategy_adapter.fts_optim_view(sched[phase]["params"])])
        expected_grad_params = req_grad_opt == init_ft_cnt
        <a id="change">return </a>no_grad_cnt<a id="change">, init_ft_cnt, total_ft_cnt, req_grad_opt, expected_grad_params</a>

    def _validate_opt_init(self) -&gt; None:
        Validate the user-initialized optimizer state (necessary for fine-tuning phase 0) and warn user if
        appropriate.</code></pre><h3>After Change</h3><pre><code class='java'>
                    p_diff_summary["optim_params"].append(n)
                if p in sched_grad_param_set:
                    p_diff_summary["phase_0_params"].append(n)
        p_diff_summary<a id="change"> = </a><a id="change">{k: self.strategy_adapter.logical_param_translation(v) for k, v in p_diff_summary.items()}</a>
        <a id="change">return </a>no_grad_cnt, init_ft_cnt, total_ft_cnt, p_diff_summary

    @staticmethod
    def _grad_mismatch_feedback(w_msg: str, param_diff_summary: Dict) -&gt; str:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/speediedan/finetuning-scheduler/commit/956653716799e9bb88b5015f399bda463a408b8b#diff-2d4f76c6f0c8223fab0ac9c5108a651abdb2c3dd1e3bf3f7db29dbe500990ab3L1391' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 83361702</div><div id='project'> Project Name: speediedan/finetuning-scheduler</div><div id='commit'> Commit Name: 956653716799e9bb88b5015f399bda463a408b8b</div><div id='time'> Time: 2023-02-08</div><div id='author'> Author: danny.dale@gmail.com</div><div id='file'> File Name: src/finetuning_scheduler/fts_supporters.py</div><div id='m_class'> M Class Name: ScheduleImplMixin</div><div id='n_method'> N Class Name: ScheduleImplMixin</div><div id='m_method'> M Method Name: _inspect_fts_opt_state(1)</div><div id='n_method'> N Method Name: _inspect_fts_opt_state(1)</div><div id='m_parent_class'> M Parent Class: ABC</div><div id='n_parent_class'> N Parent Class: ABC</div><div id='m_file'> M File Name: src/finetuning_scheduler/fts_supporters.py</div><div id='n_file'> N File Name: src/finetuning_scheduler/fts_supporters.py</div><div id='m_start'> M Start Line: 1400</div><div id='m_end'> M End Line: 1405</div><div id='n_start'> N Start Line: 1407</div><div id='n_end'> N End Line: 1427</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    if val_loss &lt; best_val_loss and budget &gt; budget_per_train:
        estimator.cleanup()
        estimator.fit(X_train_all, y_train_all, budget, **fit_kwargs)
    <a id="change">return </a>val_loss<a id="change">, train_loss, train_time</a>


def compute_estimator(</code></pre><h3>After Change</h3><pre><code class='java'>
        if isinstance(total_train_loss, list):
            train_loss = [v / n for v in total_train_loss]
        elif isinstance(total_train_loss, dict):
            train_loss<a id="change"> = </a><a id="change">{k: v / n for k, v in total_train_loss.items()}</a>
        else:
            train_loss = total_train_loss / n
    pred_time /= n
    budget -= time.time() - start_time
    if val_loss &lt; best_val_loss and budget &gt; budget_per_train:
        estimator.cleanup()
        estimator.fit(X_train_all, y_train_all, budget, **fit_kwargs)
    <a id="change">return </a>val_loss, train_loss, train_time, pred_time


def compute_estimator(</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/flaml/commit/072e9e458819324f9f9436c3febeb034e80e6f4f#diff-ffd1c277543ea643fd48c6a9577f8274c23f54f9966abaf8776a81be8a2d924aL180' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 83361699</div><div id='project'> Project Name: microsoft/flaml</div><div id='commit'> Commit Name: 072e9e458819324f9f9436c3febeb034e80e6f4f</div><div id='time'> Time: 2021-07-10</div><div id='author'> Author: wang.chi@microsoft.com</div><div id='file'> File Name: flaml/ml.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: evaluate_model_CV(10)</div><div id='n_method'> N Method Name: evaluate_model_CV(10)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: flaml/ml.py</div><div id='n_file'> N File Name: flaml/ml.py</div><div id='m_start'> M Start Line: 185</div><div id='m_end'> M End Line: 260</div><div id='n_start'> N Start Line: 192</div><div id='n_end'> N End Line: 276</div><BR>