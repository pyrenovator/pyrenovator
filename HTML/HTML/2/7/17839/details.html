<html><h3>Pattern ID :17839
</h3><img src='58565941.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        if self.flat:

            <a id="change">try:
                </a>state<a id="change"> = </a>torch.FloatTensor(state).to(device)

            <a id="change">except</a>:
                <a id="change">print("Except: Lİne 80"</a><a id="change">)</a>

        else:
            state = torch.FloatTensor(np.expand_dims(state, axis=0)).to(device)
        return self.actor(state).cpu().data.numpy().flatten()</code></pre><h3>After Change</h3><pre><code class='java'>
        if self.flat:
            &#47&#47 TODO: add try, except if error occurs
            &#47&#47 reshape tensor([14]) to tensor([1,14])
            state<a id="change"> = </a>torch.FloatTensor(<a id="change">state.reshape(</a>1, -1<a id="change">)</a>).to(device)   &#47&#47 @riza: torch.FloatTensor(state).to(device)
        else:
            state = torch.FloatTensor(np.expand_dims(state, axis=0)).to(device)
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/rizavelioglu/challenge-aido_rl-il/commit/694a1efd6fbaa593abaa6a56c460a3f61ad611b6#diff-fada037ad086638e65c7ae77e3d223963e9afaa26326aab0ea718f4013176e43L81' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 58565941</div><div id='project'> Project Name: rizavelioglu/challenge-aido_rl-il</div><div id='commit'> Commit Name: 694a1efd6fbaa593abaa6a56c460a3f61ad611b6</div><div id='time'> Time: 2020-02-18</div><div id='author'> Author: rzavelioglu@gmail.com</div><div id='file'> File Name: model.py</div><div id='m_class'> M Class Name: DDPG</div><div id='n_method'> N Class Name: DDPG</div><div id='m_method'> M Method Name: predict(2)</div><div id='n_method'> N Method Name: predict(2)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: model.py</div><div id='n_file'> N File Name: model.py</div><div id='m_start'> M Start Line: 81</div><div id='m_end'> M End Line: 87</div><div id='n_start'> N Start Line: 82</div><div id='n_end'> N End Line: 82</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        gradcheck(self.wf.pos2cmo, self.pos)

        assert(torch.allclose(dcmo.sum(), dcmo_grad.sum()))
        <a id="change">try:
            </a>a<a id="change"> = </a>dcmo.sum(-1).sum(-1)
            b = dcmo_grad.sum(-2)
            assert(torch.allclose(a, b))
        <a id="change">except</a>:
            <a id="change">print(&quot  === Warning test_grad_cmo partial sum is failing !!&quot</a><a id="change">)</a>

    def test_hess_cmo(self):
        Hessian of the correlated MOs.
        val = self.wf.pos2cmo(self.pos)</code></pre><h3>After Change</h3><pre><code class='java'>
        dcmo = dcmo.permute(1, 2, 3, 0)
        shape = (self.nbatch, self.wf.nelec,
                 self.wf.nmo_opt, self.wf.nelec, 3)
        dcmo = <a id="change">dcmo.reshape(</a>*<a id="change">shape)</a>
        dcmo<a id="change"> = </a>dcmo.sum(2).sum(1)

        dcmo_grad = grad(cmo, self.pos,
                         grad_outputs=torch.ones_like(cmo))[0]</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/nlesc-jcer/qmctorch/commit/a021a83abc01bb42653765ae3bdae08ade39dc02#diff-28b5d2d372ee31838f784156a9aa46c987069100f086366b103157da91257035L152' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 58565940</div><div id='project'> Project Name: nlesc-jcer/qmctorch</div><div id='commit'> Commit Name: a021a83abc01bb42653765ae3bdae08ade39dc02</div><div id='time'> Time: 2021-01-19</div><div id='author'> Author: nicolas.gm.renaud@gmail.com</div><div id='file'> File Name: tests/test_wavefunction_generic_correlated_orbital.py</div><div id='m_class'> M Class Name: TestCorrelatedOrbitalWF</div><div id='n_method'> N Class Name: TestCorrelatedOrbitalWF</div><div id='m_method'> M Method Name: test_grad_cmo(1)</div><div id='n_method'> N Method Name: test_grad_cmo(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: tests/test_wavefunction_generic_correlated_orbital.py</div><div id='n_file'> N File Name: tests/test_wavefunction_generic_correlated_orbital.py</div><div id='m_start'> M Start Line: 156</div><div id='m_end'> M End Line: 176</div><div id='n_start'> N Start Line: 146</div><div id='n_end'> N End Line: 158</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        if self.flat:

            <a id="change">try:
                </a>state<a id="change"> = </a>torch.FloatTensor(state).to(device)

            <a id="change">except</a>:
                <a id="change">print("Except: Lİne 80"</a><a id="change">)</a>

        else:
            state = torch.FloatTensor(np.expand_dims(state, axis=0)).to(device)
        return self.actor(state).cpu().data.numpy().flatten()</code></pre><h3>After Change</h3><pre><code class='java'>
        if self.flat:
            &#47&#47 TODO: add try, except if error occurs
            &#47&#47 reshape tensor([14]) to tensor([1,14])
            state<a id="change"> = </a>torch.FloatTensor(<a id="change">state.reshape(</a>1, -1<a id="change">)</a>).to(device)   &#47&#47 @riza: torch.FloatTensor(state).to(device)
        else:
            state = torch.FloatTensor(np.expand_dims(state, axis=0)).to(device)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/rizavelioglu/challenge-aido_rl-il/commit/7a2f0226600065a96a102650a1ed3452aaadf571#diff-e3481f5f0b6fbfb50ed71786e1b8b08e3d53f57c007c5f8758aa3b222f650e2bL74' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 58565937</div><div id='project'> Project Name: rizavelioglu/challenge-aido_rl-il</div><div id='commit'> Commit Name: 7a2f0226600065a96a102650a1ed3452aaadf571</div><div id='time'> Time: 2020-02-18</div><div id='author'> Author: rzavelioglu@gmail.com</div><div id='file'> File Name: duckietown_rl/ddpg.py</div><div id='m_class'> M Class Name: DDPG</div><div id='n_method'> N Class Name: DDPG</div><div id='m_method'> M Method Name: predict(2)</div><div id='n_method'> N Method Name: predict(2)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: duckietown_rl/ddpg.py</div><div id='n_file'> N File Name: duckietown_rl/ddpg.py</div><div id='m_start'> M Start Line: 81</div><div id='m_end'> M End Line: 87</div><div id='n_start'> N Start Line: 82</div><div id='n_end'> N End Line: 82</div><BR>