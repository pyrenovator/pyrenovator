<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        mm(N,k,1,f,f @ N,1,1,f,1)-&gt;(N,k,1,f,1); view-&gt;(N,k*c_in,f)
        W: (N, c_out, f)
        &quot&quot&quot
        return self.conv(((<a id="change">adj.unsqueeze(2</a><a id="change">)</a><a id="change"> @ </a><a id="change">x.unsqueeze(-1</a><a id="change">)</a>.unsqueeze(1)).view(x.size(0), self.in_channels, self.in_features))).view(x.size(0), self.out_channels, self.out_features)

    def feature_adjacency(self, x, y):
        &quot&quot&quot</code></pre><h3>After Change</h3><pre><code class='java'>
        &quot&quot&quot
        &#47&#47&#47&#47&#47&#47 TODO current adj is symetric TODO try conv2d
        &#47&#47(adj@ x.unsqueeze(-1).unsqueeze(1)).view(x.size(0), self.in_channels, self.in_features)
        return self.conv(<a id="change">torch.einsum(&quotnkcaf,ncf-&gt;nkca&quot</a>, adj, x<a id="change">)</a>).view(x.size(0), self.out_channels, self.out_features)

    def feature_adjacency(self, x, y):
        &quot&quot&quot</code></pre>