<html><h3>Pattern ID :36406
</h3><img src='102996455.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                if do_print:
                    print(&quotresources:&quot, resources)

                <a id="change">try:
                    </a>estimated_runtime = node.estimate_runtime(resources)
                <a id="change">except </a>Exception as e:
                    <a id="change">print(&quotTime estimator errors out.  &quot
                          &quotDefaulting estimated time to 1 day.&quot</a><a id="change">)</a>
                    <a id="change">print(</a>&quotError: {}&quot.format(str(e))<a id="change">)</a>
                    estimated_runtime = 1 * 24 * 3600
                if minimize_cost:
                    estimated_cost = resources.get_cost(estimated_runtime)
                else:</code></pre><h3>After Change</h3><pre><code class='java'>
                    print(&quotresources:&quot, resources)

                if num_resources == 1 and node.estimate_runtime_func is None:
                    <a id="change">print(&quotTime estimator not set and only one possible &quot
                          &quotresource choice; defaulting estimated time to 1 hr.&quot</a><a id="change">)</a>
                    estimated_runtime = 1 * 3600
                else:
                    estimated_runtime = node.estimate_runtime(resources)
                if minimize_cost:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/skypilot-org/skypilot/commit/b8d9669b1a46a70a91e7061d44e4ba3630a4878b#diff-29e1580cd3110f2187424743b65ddc99b9765416938cba77e17c26d4f4cad76dL129' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 102996455</div><div id='project'> Project Name: skypilot-org/skypilot</div><div id='commit'> Commit Name: b8d9669b1a46a70a91e7061d44e4ba3630a4878b</div><div id='time'> Time: 2021-10-14</div><div id='author'> Author: zongheng.y@gmail.com</div><div id='file'> File Name: prototype/sky/optimizer.py</div><div id='m_class'> M Class Name: Optimizer</div><div id='n_method'> N Class Name: Optimizer</div><div id='m_method'> M Method Name: _optimize_cost(2)</div><div id='n_method'> N Method Name: _optimize_cost(2)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: prototype/sky/optimizer.py</div><div id='n_file'> N File Name: prototype/sky/optimizer.py</div><div id='m_start'> M Start Line: 138</div><div id='m_end'> M End Line: 154</div><div id='n_start'> N Start Line: 129</div><div id='n_end'> N End Line: 158</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    from jina.serve.networking import GrpcConnectionPool
    from jina.types.request.control import ControlRequest

    <a id="change">try:
        </a>GrpcConnectionPool.send_request_sync(
            request=ControlRequest(&quotSTATUS&quot),
            target=addr,
        )
    <a id="change">except </a>grpc.RpcError as e:
        <a id="change">print(&quotThe pod is unhealthy&quot</a><a id="change">)</a>
        <a id="change">print(</a>e<a id="change">)</a>
        raise e

    print(&quotThe pod is healthy&quot)
</code></pre><h3>After Change</h3><pre><code class='java'>
    if not is_ready:
        raise Exception(&quotPod is unhealthy&quot)

    <a id="change">print(&quotThe Pod is healthy&quot</a><a id="change">)</a>


if __name__ == &quot__main__&quot:
    </code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/ef662b529b2a2eecea7bb99759a9f7b9d86d3062#diff-1390d8bba9a9cd055a139b7103238c28c71758369eef980b2778e5b8de3d1558L1' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 102996454</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: ef662b529b2a2eecea7bb99759a9f7b9d86d3062</div><div id='time'> Time: 2022-06-08</div><div id='author'> Author: joan.martinez@jina.ai</div><div id='file'> File Name: jina/resources/health_check/pod.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: check_health_pod(1)</div><div id='n_method'> N Method Name: check_health_pod(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: jina/resources/health_check/pod.py</div><div id='n_file'> N File Name: jina/resources/health_check/pod.py</div><div id='m_start'> M Start Line: 11</div><div id='m_end'> M End Line: 21</div><div id='n_start'> N Start Line: 1</div><div id='n_end'> N End Line: 13</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    &#47&#47 evaluate objective, constraints, violation, and penalty function at x
    def evaluateAtX(self,x_in):
        <a id="change">try: 
            </a>self.at_snap_shot    = False
            self.stat_value      = float("nan")
            self.fn_evals        += 1
            &#47&#47 evaluate objective and its gradient
            [self.f,self.f_grad]      = self.obj_fn(x_in)
            &#47&#47 evaluate constraints and their violations (nested update)
            self.eval_ineq_fn(x_in) 
            self.eval_eq_fn(x_in)
        <a id="change">except </a>Exception as e:
            <a id="change">print(</a>e<a id="change">)</a>   
            <a id="change">print("PyGRANSO userSuppliedFunctionsError: failed to evaluate objective/constraint functions at x."</a><a id="change">)</a>
        
        self.x                   = x_in
        self.feasible_to_tol     = self.is_feasible_to_tol_fn(self.tvi,self.tve);  
        self.tv                  = np.max(self.tvi,self.tve)</code></pre><h3>After Change</h3><pre><code class='java'>
        self.eval_ineq_fn(x_in) 
        self.eval_eq_fn(x_in)

        <a id="change">print("skip try & except in  makePenaltyFunction.evaluateAtX"</a><a id="change">)</a>

        self.x                   = x_in
        self.feasible_to_tol     = self.is_feasible_to_tol_fn(self.tvi,self.tve);  
        self.tv                  = np.max(self.tvi,self.tve)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/sun-umn/pygranso/commit/58eb9b4bbf66bc2b0338605c05812f98fccb5952#diff-b8a4676618b43422eee5e63e1a3b2f625d09e4933fbd172c12779d9ea7694e40L200' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 102996456</div><div id='project'> Project Name: sun-umn/pygranso</div><div id='commit'> Commit Name: 58eb9b4bbf66bc2b0338605c05812f98fccb5952</div><div id='time'> Time: 2021-07-12</div><div id='author'> Author: liang664@umn.edu</div><div id='file'> File Name: python_translation/private/makePenaltyFunction.py</div><div id='m_class'> M Class Name: PanaltyFuctions</div><div id='n_method'> N Class Name: PanaltyFuctions</div><div id='m_method'> M Method Name: evaluateAtX(2)</div><div id='n_method'> N Method Name: evaluateAtX(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: python_translation/private/makePenaltyFunction.py</div><div id='n_file'> N File Name: python_translation/private/makePenaltyFunction.py</div><div id='m_start'> M Start Line: 201</div><div id='m_end'> M End Line: 214</div><div id='n_start'> N Start Line: 214</div><div id='n_end'> N End Line: 223</div><BR>