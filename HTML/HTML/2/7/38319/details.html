<html><h3>Pattern ID :38319
</h3><img src='109565119.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            self.last_len = len

        if abs &lt; 0.1:
            <a id="change">if </a>not self.measured:
                reward = 0
                self.measured = True
                self.last_dist = self.task.calc_distance(goal_position, poker_position)
            else:
                dist = self.task.calc_distance(goal_position, poker_position)
                reward = 1*round(self.last_dist - dist, 5)
                self.last_dist<a id="change"> = </a>dist
            self.a += reward
            self.owner = 0
            &#47&#47 poke_vector = v.Vector(self.prev_poker_position, observation[0:3], self.env)    </code></pre><h3>After Change</h3><pre><code class='java'>
            &#47&#47 align  = np.dot(self.set_vector_len(poke_vector.vector, 1), self.set_vector_len(real_vector.vector, 1))
            &#47&#47 reward = align
        else:
            <a id="change">self.env.p.addUserDebugText(</a>"XXX", <a id="change">[-0.7</a>,<a id="change">0.7</a>,<a id="change">0.7</a>]<a id="change">, lifeTime=0.1, textColorRGB=[125,0,0])</a>
            if self.owner == 0:
              self.last_len = len
            if not self.is_poker_moving(poker_position):
                reward = self.last_len - len</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/incognite-lab/mygym/commit/455742b94e988f8e408d86a83fd656255f506316#diff-f909d23bda0d4385c8f8b25592babf12027365091adcf8cd26de3fa6848d911fL1121' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 109565119</div><div id='project'> Project Name: incognite-lab/mygym</div><div id='commit'> Commit Name: 455742b94e988f8e408d86a83fd656255f506316</div><div id='time'> Time: 2021-08-19</div><div id='author'> Author: gupit@seznam.cz</div><div id='file'> File Name: myGym/envs/rewards.py</div><div id='m_class'> M Class Name: DualPoke</div><div id='n_method'> N Class Name: DualPoke</div><div id='m_method'> M Method Name: compute(2)</div><div id='n_method'> N Method Name: compute(2)</div><div id='m_parent_class'> M Parent Class: Reward</div><div id='n_parent_class'> N Parent Class: Reward</div><div id='m_file'> M File Name: myGym/envs/rewards.py</div><div id='n_file'> N File Name: myGym/envs/rewards.py</div><div id='m_start'> M Start Line: 1121</div><div id='m_end'> M End Line: 1154</div><div id='n_start'> N Start Line: 1121</div><div id='n_end'> N End Line: 1186</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        self.last_align            = align
        self.last_len              = len

        <a id="change">if </a>self.task.check_object_moved(self.env.task_objects[1], 2):
            self.env.episode_over<a id="change">   = </a>True
            self.env.episode_failed = True
            self.env.episode_info   = "too strong poke"
        self.task.check_poke_threshold(observation)</code></pre><h3>After Change</h3><pre><code class='java'>
        len = aim_vector.norm
        align_factor = (align - self.last_align) + 0.5*(self.last_len - len)
        self.env.p.addUserDebugText("align_factor: " + str(align - self.last_align), [-0.5,0.5,0.5], lifeTime=0.1)
        <a id="change">self.env.p.addUserDebugText(</a>"dist_factor: " + str((self.last_len - len)*0.5), <a id="change">[-0.7</a>,<a id="change">0.7</a>,<a id="change">0.7</a>]<a id="change">, lifeTime=0.1)</a>

        self.env.p.addUserDebugText("Align: " + str(round(align, 3)), [0.5,0.5,0.5], lifeTime=0.1)

        if align &gt; 0.95:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/incognite-lab/mygym/commit/2f1c0aa857f09b4521dec2c7afbd652b3ac90334#diff-f909d23bda0d4385c8f8b25592babf12027365091adcf8cd26de3fa6848d911fL917' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 109565123</div><div id='project'> Project Name: incognite-lab/mygym</div><div id='commit'> Commit Name: 2f1c0aa857f09b4521dec2c7afbd652b3ac90334</div><div id='time'> Time: 2021-08-17</div><div id='author'> Author: gupit@seznam.cz</div><div id='file'> File Name: myGym/envs/rewards.py</div><div id='m_class'> M Class Name: DualPoke</div><div id='n_method'> N Class Name: DualPoke</div><div id='m_method'> M Method Name: compute(2)</div><div id='n_method'> N Method Name: compute(2)</div><div id='m_parent_class'> M Parent Class: Reward</div><div id='n_parent_class'> N Parent Class: Reward</div><div id='m_file'> M File Name: myGym/envs/rewards.py</div><div id='n_file'> N File Name: myGym/envs/rewards.py</div><div id='m_start'> M Start Line: 926</div><div id='m_end'> M End Line: 976</div><div id='n_start'> N Start Line: 926</div><div id='n_end'> N End Line: 958</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            reward = self.last_len - len

        if self.env.episode_steps &gt; 25:
            <a id="change">if </a>self.is_poker_moving(poker_position):
                reward<a id="change"> = </a>0
        elif self.env.episode_steps &lt; 2:
            reward = 0
</code></pre><h3>After Change</h3><pre><code class='java'>

        self.finish(observation, poker_position, gripper_position, len, reward)

        <a id="change">self.env.p.addUserDebugText(</a>"Reward: " + str(round(self.env.episode_reward, 7)), <a id="change">[0.7</a>,<a id="change">0.7</a>,<a id="change">0.7</a>]<a id="change">, lifeTime=0.1)</a>
        return reward

    def init(self, observation):
        &#47&#47 load positions</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/incognite-lab/mygym/commit/c848e8553244882cac642a44706273bda9e0fc94#diff-f909d23bda0d4385c8f8b25592babf12027365091adcf8cd26de3fa6848d911fL1100' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 109565152</div><div id='project'> Project Name: incognite-lab/mygym</div><div id='commit'> Commit Name: c848e8553244882cac642a44706273bda9e0fc94</div><div id='time'> Time: 2021-08-19</div><div id='author'> Author: gupit@seznam.cz</div><div id='file'> File Name: myGym/envs/rewards.py</div><div id='m_class'> M Class Name: DualPoke</div><div id='n_method'> N Class Name: DualPoke</div><div id='m_method'> M Method Name: compute(2)</div><div id='n_method'> N Method Name: compute(2)</div><div id='m_parent_class'> M Parent Class: Reward</div><div id='n_parent_class'> N Parent Class: Reward</div><div id='m_file'> M File Name: myGym/envs/rewards.py</div><div id='n_file'> N File Name: myGym/envs/rewards.py</div><div id='m_start'> M Start Line: 1109</div><div id='m_end'> M End Line: 1134</div><div id='n_start'> N Start Line: 1105</div><div id='n_end'> N End Line: 1146</div><BR>