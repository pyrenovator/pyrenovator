<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    &#47&#47 merge stats/actions/dones from all trajectories into one big dataset
    &#47&#47 (we use same naming convention as `imitation` here)
    merged_trajectories = {&quotobs&quot: [], &quotnext_obs&quot: [], &quotacts&quot: [], &quotdones&quot: []}
    <a id="change">for </a>traj in trajectories<a id="change">:
        &#47&#47 we slice to :-1 so that we can have a meaningful next_obs
        </a>merged_trajectories[&quotobs&quot]<a id="change"> += </a>traj[&quotstates&quot][:-1]
        merged_trajectories[&quotnext_obs&quot] += traj[&quotstates&quot][1:]
        merged_trajectories[&quotacts&quot]<a id="change"> += </a>traj[&quotactions&quot][:-1]
        merged_trajectories[&quotdones&quot]<a id="change"> += </a>traj[&quotdones&quot][:-1]
    dataset_dict = {
        key: np.stack(values, axis=0)
        for key, values in merged_trajectories.items()</code></pre><h3>After Change</h3><pre><code class='java'>
    cat_nobs = np.concatenate(trajectories[&quotobs&quot][1:], axis=0)
    &#47&#47 the remaining entries don&quott need any special stacking, so we just
    &#47&#47 concatenate them
    cat_acts<a id="change"> = </a><a id="change">np.concatenate(</a>trajectories[&quotacts&quot]<a id="change">, axis=0)</a>
    cat_infos = np.concatenate(trajectories[&quotinfos&quot], axis=0)
    cat_rews = np.concatenate(trajectories[&quotrews&quot], axis=0)
    cat_dones = np.concatenate(trajectories[&quotdones&quot], axis=0)
</code></pre>