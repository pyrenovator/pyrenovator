<html><h3>Pattern ID :32461
</h3><img src='94618663.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            dataset = context.test
        dataset = dataset.sample(self.n_samples, random_state=self.random_state, drop_na_label=True)
        df = select_from_dataframe(dataset.data, self.columns, self.ignore_columns)
        <a id="change">if </a>self.num_nearest_neighbors &gt;= len(df):
            logger.warning(&quotPassed num_nearest_neighbors %s which is greater than the number of samples in the dataset&quot
                           , self.num_nearest_neighbors)
            self.num_nearest_neighbors<a id="change"> = </a>len(df) - 1

        &#47&#47 Calculate distances matrix and retrieve nearest neighbors based on distance matrix.
        df_cols_for_gower = df[dataset.cat_features + dataset.numerical_features]</code></pre><h3>After Change</h3><pre><code class='java'>
            raise NotEnoughSamplesError(
                f&quotThere are not enough samples to run this check, found only {format_number(df.shape[0])} samples.&quot)

        start_time = <a id="change">time.time()</a>
        gower_distance.calculate_nearest_neighbours_distances(
            cat_data=df[dataset.cat_features].iloc[:DATASET_TIME_EVALUATION_SIZE],
            numeric_data=df[dataset.numerical_features].iloc[:DATASET_TIME_EVALUATION_SIZE],
            num_neighbours=int(min(np.sqrt(DATASET_TIME_EVALUATION_SIZE), num_neighbours)))
        predicted_time_to_run_in_seconds<a id="change"> = </a>((<a id="change">time.time()</a> - start_time) / 130000)<a id="change"> * </a>(df.shape[0] ** 2)
        if predicted_time_to_run_in_seconds &gt; self.timeout &gt; 0:
            raise DeepchecksTimeoutError(
                f&quotAborting check: calculation was projected to finish in {predicted_time_to_run_in_seconds} seconds, &quot</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/deepchecks/deepchecks/commit/f4d1e6dd3180f2023e097578bb36158f21e97d68#diff-2b9ab4a9f3de8eac81a959eff1ecb7a8fc5d2e5374110fc5dadd7fa4e5ab52edL87' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 94618663</div><div id='project'> Project Name: deepchecks/deepchecks</div><div id='commit'> Commit Name: f4d1e6dd3180f2023e097578bb36158f21e97d68</div><div id='time'> Time: 2022-05-12</div><div id='author'> Author: 67195469+Nadav-Barak@users.noreply.github.com</div><div id='file'> File Name: deepchecks/tabular/checks/integrity/outlier_sample_detection.py</div><div id='m_class'> M Class Name: OutlierSampleDetection</div><div id='n_method'> N Class Name: OutlierSampleDetection</div><div id='m_method'> M Method Name: run_logic(3)</div><div id='n_method'> N Method Name: run_logic(3)</div><div id='m_parent_class'> M Parent Class: SingleDatasetCheck</div><div id='n_parent_class'> N Parent Class: SingleDatasetCheck</div><div id='m_file'> M File Name: deepchecks/tabular/checks/integrity/outlier_sample_detection.py</div><div id='n_file'> N File Name: deepchecks/tabular/checks/integrity/outlier_sample_detection.py</div><div id='m_start'> M Start Line: 87</div><div id='m_end'> M End Line: 122</div><div id='n_start'> N Start Line: 100</div><div id='n_end'> N End Line: 143</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            dataset = context.test
        dataset = dataset.sample(self.n_samples, random_state=self.random_state, drop_na_label=True)
        df = select_from_dataframe(dataset.data, self.columns, self.ignore_columns)
        <a id="change">if </a>self.num_nearest_neighbors &gt;= len(df):
            logger.warning(&quotPassed num_nearest_neighbors %s which is greater than the number of samples in the dataset&quot
                           , self.num_nearest_neighbors)
            self.num_nearest_neighbors<a id="change"> = </a>len(df) - 1

        &#47&#47 Calculate distances matrix and retrieve nearest neighbors based on distance matrix.
        df_cols_for_gower = df[dataset.cat_features + dataset.numerical_features]</code></pre><h3>After Change</h3><pre><code class='java'>
            raise NotEnoughSamplesError(
                f&quotThere are not enough samples to run this check, found only {format_number(df.shape[0])} samples.&quot)

        start_time = <a id="change">time.time()</a>
        gower_distance.calculate_nearest_neighbours_distances(
            cat_data=df[dataset.cat_features].iloc[:DATASET_TIME_EVALUATION_SIZE],
            numeric_data=df[dataset.numerical_features].iloc[:DATASET_TIME_EVALUATION_SIZE],
            num_neighbours=int(min(np.sqrt(DATASET_TIME_EVALUATION_SIZE), num_neighbours)))
        predicted_time_to_run_in_seconds<a id="change"> = </a>((<a id="change">time.time() - </a>start_time) / 130000) * (df.shape[0] ** 2)
        if predicted_time_to_run_in_seconds &gt; self.timeout &gt; 0:
            raise DeepchecksTimeoutError(
                f&quotAborting check: calculation was projected to finish in {predicted_time_to_run_in_seconds} seconds, &quot</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/deepchecks/deepchecks/commit/f4d1e6dd3180f2023e097578bb36158f21e97d68#diff-2b9ab4a9f3de8eac81a959eff1ecb7a8fc5d2e5374110fc5dadd7fa4e5ab52edL81' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 94618662</div><div id='project'> Project Name: deepchecks/deepchecks</div><div id='commit'> Commit Name: f4d1e6dd3180f2023e097578bb36158f21e97d68</div><div id='time'> Time: 2022-05-12</div><div id='author'> Author: 67195469+Nadav-Barak@users.noreply.github.com</div><div id='file'> File Name: deepchecks/tabular/checks/integrity/outlier_sample_detection.py</div><div id='m_class'> M Class Name: OutlierSampleDetection</div><div id='n_method'> N Class Name: OutlierSampleDetection</div><div id='m_method'> M Method Name: run_logic(3)</div><div id='n_method'> N Method Name: run_logic(3)</div><div id='m_parent_class'> M Parent Class: SingleDatasetCheck</div><div id='n_parent_class'> N Parent Class: SingleDatasetCheck</div><div id='m_file'> M File Name: deepchecks/tabular/checks/integrity/outlier_sample_detection.py</div><div id='n_file'> N File Name: deepchecks/tabular/checks/integrity/outlier_sample_detection.py</div><div id='m_start'> M Start Line: 87</div><div id='m_end'> M End Line: 122</div><div id='n_start'> N Start Line: 100</div><div id='n_end'> N End Line: 143</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
  elif FLAGS.use_gpu:
    logging.info(&quotUse GPU&quot)

  <a id="change">if </a>FLAGS.use_gpu:
    strategy = tf.distribute.MirroredStrategy()
  else:
    logging.info(&quotUse TPU at %s&quot,
                 FLAGS.tpu if FLAGS.tpu is not None else &quotlocal&quot)
    resolver<a id="change"> = </a>tf.distribute.cluster_resolver.TPUClusterResolver(tpu=FLAGS.tpu)
    tf.config.experimental_connect_to_cluster(resolver)
    tf.tpu.experimental.initialize_tpu_system(resolver)
    strategy = tf.distribute.TPUStrategy(resolver)</code></pre><h3>After Change</h3><pre><code class='java'>
        logging.info(
          &quotStarting to run eval step %s of epoch: %s&quot, step, epoch + 1)

      test_start_time = <a id="change">time.time()</a>
      test_step(test_iterator)
      ms_per_example<a id="change"> = </a>(<a id="change">time.time() - test_start_time) * 1e6 / </a>eval_batch_size
      metrics[&quottest/ms_per_example&quot].update_state(ms_per_example)

    logging.info(</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/google/uncertainty-baselines/commit/9ecb3b3be23c87f66826ff1849bb00f300f08cec#diff-c0dad55b7c4da0505ac0983a30aacb4601c60336bdcc59e000cc02bfc9086df7L79' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 94618660</div><div id='project'> Project Name: google/uncertainty-baselines</div><div id='commit'> Commit Name: 9ecb3b3be23c87f66826ff1849bb00f300f08cec</div><div id='time'> Time: 2021-01-10</div><div id='author'> Author: 20114038+nband@users.noreply.github.com</div><div id='file'> File Name: baselines/diabetic_retinopathy_detection/deterministic.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(1)</div><div id='n_method'> N Method Name: main(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: baselines/diabetic_retinopathy_detection/deterministic.py</div><div id='n_file'> N File Name: baselines/diabetic_retinopathy_detection/deterministic.py</div><div id='m_start'> M Start Line: 85</div><div id='m_end'> M End Line: 142</div><div id='n_start'> N Start Line: 97</div><div id='n_end'> N End Line: 268</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        try:
            eutil_response = _get_eutil_records("efetch", id)
            ERROR = _get(eutil_response, ["eFetchResult", "ERROR"])
            <a id="change">if </a>ERROR:
                raise RuntimeError(ERROR)
            pubmedEfetchReponse<a id="change"> = </a>PubmedEfetchResponse(**eutil_response)
            pubmedArticle = pubmedEfetchReponse.PubmedArticleSet.PubmedArticle
        except Exception as e:
            print(f"Error encountered in uids_to_docs {e}")</code></pre><h3>After Change</h3><pre><code class='java'>
        upper = min([lower + MAX_EFETCH_RETMAX, num_uids])
        id = uids[lower:upper]
        try:
            start_time = <a id="change">time.time()</a>
            eutil_response = _get_eutil_records("efetch", id, rettype="medline", retmode="text")
            duration<a id="change"> = time.time()</a><a id="change"> - </a>start_time
            logging.info(
                f"Retrieved docs {lower} through {upper - 1} of {num_uids - 1} in {duration}s"
            )</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/pathwaycommons/semantic-search/commit/286b58fa7bd3c31c5323f6e8186c9a849b3a01d0#diff-d19c4cf1908195d73e95a33dfb441841355e98c175bf897793590f3d9a796527L207' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 94618671</div><div id='project'> Project Name: pathwaycommons/semantic-search</div><div id='commit'> Commit Name: 286b58fa7bd3c31c5323f6e8186c9a849b3a01d0</div><div id='time'> Time: 2021-03-12</div><div id='author'> Author: anweshianavadya@gmail.com</div><div id='file'> File Name: semantic_search/ncbi.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: uids_to_docs(1)</div><div id='n_method'> N Method Name: uids_to_docs(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: semantic_search/ncbi.py</div><div id='n_file'> N File Name: semantic_search/ncbi.py</div><div id='m_start'> M Start Line: 209</div><div id='m_end'> M End Line: 230</div><div id='n_start'> N Start Line: 121</div><div id='n_end'> N End Line: 132</div><BR>