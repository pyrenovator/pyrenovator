<html><h3>Pattern ID :21670
</h3><img src='69186639.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    models = glob("data/testmodels/**.pb")
    for model in models:
        latency = predictor.predict(model)
        print(<a id="change">model.split("/")[-1]</a>, latency)


def test_onnx_models(args, predictor):</code></pre><h3>After Change</h3><pre><code class='java'>
    models = glob("data/testmodels/**.pb")
    for model in models:
        latency = predictor.predict(model)
        logging.debug(<a id="change">os.path.basename(model</a><a id="change">)</a>, latency)


def test_onnx_models(args, predictor):</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/microsoft/nn-meter/commit/448475797cc75fd29715e4c3a4303a39e35e6a00#diff-27419e27638ba26c3b055e9daca00840a52779aa0e76b06c6a2a68d128abffb0L30' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 69186639</div><div id='project'> Project Name: microsoft/nn-meter</div><div id='commit'> Commit Name: 448475797cc75fd29715e4c3a4303a39e35e6a00</div><div id='time'> Time: 2021-07-21</div><div id='author'> Author: jiahangxu@microsoft.com</div><div id='file'> File Name: demo.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_pb_models(2)</div><div id='n_method'> N Method Name: test_pb_models(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: demo.py</div><div id='n_file'> N File Name: demo.py</div><div id='m_start'> M Start Line: 30</div><div id='m_end'> M End Line: 32</div><div id='n_start'> N Start Line: 31</div><div id='n_end'> N End Line: 33</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    url = "https://github.com/Lynazhang/nnmeter/releases/download/0.1/ir_graphs.zip"
    download_from_url(url, "data/testmodels")
    models = glob("data/testmodels/**.json")
    for <a id="change">model</a> in models:
        latency = predictor.predict(model)
        print(<a id="change">model.split("/")[-1]</a>, latency)


def test_pb_models(args, predictor):</code></pre><h3>After Change</h3><pre><code class='java'>
    url = "https://github.com/Lynazhang/nnmeter/releases/download/0.1/ir_graphs.zip"
    download_from_url(url, "data/testmodels")
    models = glob("data/testmodels/**.json")
    for <a id="change">model</a> in models:
        latency = predictor.predict(model)
        logging.debug(<a id="change">os.path.basename(</a>model<a id="change">)</a>, latency)


def test_pb_models(args, predictor):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/nn-meter/commit/448475797cc75fd29715e4c3a4303a39e35e6a00#diff-27419e27638ba26c3b055e9daca00840a52779aa0e76b06c6a2a68d128abffb0L9' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 69186638</div><div id='project'> Project Name: microsoft/nn-meter</div><div id='commit'> Commit Name: 448475797cc75fd29715e4c3a4303a39e35e6a00</div><div id='time'> Time: 2021-07-21</div><div id='author'> Author: jiahangxu@microsoft.com</div><div id='file'> File Name: demo.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_ir_graphs(2)</div><div id='n_method'> N Method Name: test_ir_graphs(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: demo.py</div><div id='n_file'> N File Name: demo.py</div><div id='m_start'> M Start Line: 17</div><div id='m_end'> M End Line: 19</div><div id='n_start'> N Start Line: 18</div><div id='n_end'> N End Line: 20</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 Create an R-tree to index the dataset
        self.index = Index(interleaved=False, properties=Property(dimension=3))
        fileglob = os.path.join(root, "**.tif")
        for i, <a id="change">filename</a> in enumerate(glob.iglob(fileglob, recursive=True)):
            with rasterio.open(filename) as src:
                with WarpedVRT(src, crs=self.crs) as vrt:
                    minx, miny, maxx, maxy = vrt.bounds
            &#47&#47 https://www.nrcs.usda.gov/Internet/FSE_DOCUMENTS/nrcs141p2_015644.pdf
            date = <a id="change">filename.split("_")[-1]</a>.replace(".tif", "")
            time = datetime.strptime(date, "%Y%m%d")
            timestamp = time.timestamp()
            coords = (minx, maxx, miny, maxy, timestamp, timestamp)</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 Create an R-tree to index the dataset
        self.index = Index(interleaved=False, properties=Property(dimension=3))
        fileglob = os.path.join(root, "**", self.filename_glob)
        for i, <a id="change">filename</a> in enumerate(glob.iglob(fileglob, recursive=True)):
            match = re.match(self.filename_regex, <a id="change">os.path.basename(</a>filename<a id="change">)</a>)
            if match is not None:
                with rasterio.open(filename) as src:
                    with WarpedVRT(src, crs=self.crs) as vrt:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/torchgeo/commit/a207f0ee5a748c6744b66ea9555ce3428e5f16b2#diff-3cc4eff9096df1112628345cddc0bd1f910f1edf80ea53d0463854dc08aeee08L42' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 69186637</div><div id='project'> Project Name: microsoft/torchgeo</div><div id='commit'> Commit Name: a207f0ee5a748c6744b66ea9555ce3428e5f16b2</div><div id='time'> Time: 2021-08-02</div><div id='author'> Author: ajstewart426@gmail.com</div><div id='file'> File Name: torchgeo/datasets/naip.py</div><div id='m_class'> M Class Name: NAIP</div><div id='n_method'> N Class Name: NAIP</div><div id='m_method'> M Method Name: __init__(4)</div><div id='n_method'> N Method Name: __init__(4)</div><div id='m_parent_class'> M Parent Class: GeoDataset</div><div id='n_parent_class'> N Parent Class: GeoDataset</div><div id='m_file'> M File Name: torchgeo/datasets/naip.py</div><div id='n_file'> N File Name: torchgeo/datasets/naip.py</div><div id='m_start'> M Start Line: 66</div><div id='m_end'> M End Line: 75</div><div id='n_start'> N Start Line: 83</div><div id='n_end'> N End Line: 96</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    &#47&#47 load predictors
    predictors = {}
    ps = glob(ppath + "/**.pkl")
    for <a id="change">p</a> in ps:
        pname = <a id="change">p.split("/")[-1]</a>.replace(".pkl", "")
        with open(p, "rb") as f:
            print("load predictor", p)
            model = pickle.load(f)</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47 load predictors
    predictors = {}
    ps = glob(os.path.join(ppath, "**.pkl"))
    for <a id="change">p</a> in ps:
        pname =  <a id="change">os.path.basename(</a>p<a id="change">)</a>.replace(".pkl", "")
        with open(p, "rb") as f:
            print("load predictor", p)
            model = pickle.load(f)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/nn-meter/commit/f83a73f63e1962e0d077fe4e4676f20a82977b5b#diff-d5df506960ba4ce57aded8d2ceb7b287a7377ae983a9b4f0d4555ac27b204000L9' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 69186636</div><div id='project'> Project Name: microsoft/nn-meter</div><div id='commit'> Commit Name: f83a73f63e1962e0d077fe4e4676f20a82977b5b</div><div id='time'> Time: 2021-07-19</div><div id='author'> Author: jiahangxu@microsoft.com</div><div id='file'> File Name: nn_meter/prediction/load_predictors.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: loading_to_local(2)</div><div id='n_method'> N Method Name: loading_to_local(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: nn_meter/prediction/load_predictors.py</div><div id='n_file'> N File Name: nn_meter/prediction/load_predictors.py</div><div id='m_start'> M Start Line: 9</div><div id='m_end'> M End Line: 34</div><div id='n_start'> N Start Line: 18</div><div id='n_end'> N End Line: 35</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    url = "https://github.com/Lynazhang/nnmeter/releases/download/0.1/onnx_models.zip"
    download_from_url(url, "data/testmodels")
    models = glob("data/testmodels/**.onnx")
    for <a id="change">model</a> in models:
        latency = predictor.predict(model)
        print(<a id="change">model.split("/")[-1]</a>, latency)


def test_pytorch_models(args, predictor):</code></pre><h3>After Change</h3><pre><code class='java'>
    url = "https://github.com/Lynazhang/nnmeter/releases/download/0.1/onnx_models.zip"
    download_from_url(url, "data/testmodels")
    models = glob("data/testmodels/**.onnx")
    for <a id="change">model</a> in models:
        latency = predictor.predict(model)
        logging.debug(<a id="change">os.path.basename(</a>model<a id="change">)</a>, latency)


def test_pytorch_models(args, predictor):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/nn-meter/commit/448475797cc75fd29715e4c3a4303a39e35e6a00#diff-27419e27638ba26c3b055e9daca00840a52779aa0e76b06c6a2a68d128abffb0L35' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 69186635</div><div id='project'> Project Name: microsoft/nn-meter</div><div id='commit'> Commit Name: 448475797cc75fd29715e4c3a4303a39e35e6a00</div><div id='time'> Time: 2021-07-21</div><div id='author'> Author: jiahangxu@microsoft.com</div><div id='file'> File Name: demo.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_onnx_models(2)</div><div id='n_method'> N Method Name: test_onnx_models(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: demo.py</div><div id='n_file'> N File Name: demo.py</div><div id='m_start'> M Start Line: 43</div><div id='m_end'> M End Line: 45</div><div id='n_start'> N Start Line: 44</div><div id='n_end'> N End Line: 46</div><BR>