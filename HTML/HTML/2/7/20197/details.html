<html><h3>Pattern ID :20197
</h3><img src='65910380.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        dists = np.linalg.norm(a - b, axis=1)
        dists = (dists[:-1] + dists[1:]) * 0.5
        s = np.sum(dists) * 0.5 * (sa + sb) / area
        <a id="change">return </a>abs(1 - s)

@attrs
class CaptionsMatcher(AnnotationMatcher):</code></pre><h3>After Change</h3><pre><code class='java'>
        b = _approx(b.points, segments)
        dists = np.linalg.norm(a - b, axis=1)
        dists = dists[:-1] + dists[1:]
        a_steps<a id="change"> = </a>np.linalg.norm(a[1:] - a[:-1], axis=1)
        b_steps<a id="change"> = </a>np.linalg.norm(b[1:] - b[:-1], axis=1)

        &#47&#47 For the common bbox we can&quott use
        &#47&#47 - the AABB (axis-alinged bbox) of a point set
        &#47&#47 - the exterior of a point set
        &#47&#47 - the convex hull of a point set
        &#47&#47 because these soultions won&quott be correctly normalized.
        &#47&#47 The lines can have multiple self-intersections, which can give
        &#47&#47 the inter-line area more than internal area of the options above,
        &#47&#47 producing the value of the distance outside of the [0; 1] range.
        &#47&#47
        &#47&#47 Instead, we can compute the upper boundary for the inter-line
        &#47&#47 area based on the maximum point distance and line length.
        max_area = np.max(dists) * max(np.sum(a_steps), np.sum(b_steps))

        area<a id="change"> = </a>np.dot(dists, a_steps<a id="change"> + </a>b_steps) * 0.5 * 0.5 / max_area

        <a id="change">return </a><a id="change">abs(</a>1 - area<a id="change">)</a>

@attrs
class CaptionsMatcher(AnnotationMatcher):
    def match_annotations(self, sources):</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 7</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/openvinotoolkit/datumaro/commit/4b53be73721c23738592db619b89fdb1cc18f2fe#diff-4a402f8d83ffab43f9ba3e1831858f8a09933ac4251dc5960d53abf1bc7db43eL771' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 65910380</div><div id='project'> Project Name: openvinotoolkit/datumaro</div><div id='commit'> Commit Name: 4b53be73721c23738592db619b89fdb1cc18f2fe</div><div id='time'> Time: 2021-12-22</div><div id='author'> Author: maxim.zhiltsov@intel.com</div><div id='file'> File Name: datumaro/components/operations.py</div><div id='m_class'> M Class Name: LineMatcher</div><div id='n_method'> N Class Name: LineMatcher</div><div id='m_method'> M Method Name: distance(2)</div><div id='n_method'> N Method Name: distance(2)</div><div id='m_parent_class'> M Parent Class: _ShapeMatcher</div><div id='n_parent_class'> N Parent Class: _ShapeMatcher</div><div id='m_file'> M File Name: datumaro/components/operations.py</div><div id='n_file'> N File Name: datumaro/components/operations.py</div><div id='m_start'> M Start Line: 771</div><div id='m_end'> M End Line: 785</div><div id='n_start'> N Start Line: 776</div><div id='n_end'> N End Line: 809</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    for x in range(100):
        for y in range(100):
            if x * y == no and y * 0.49 &lt; x &lt; y * 1.51:
                <a id="change">return </a>(x, y)


class ResizeMe(object):</code></pre><h3>After Change</h3><pre><code class='java'>

def get_rows_cols(no,width,height,act_size):

    act_h<a id="change"> = </a>act_size[1]
    act_w<a id="change"> = </a>act_size[0]
    ratio<a id="change"> = </a>act_h<a id="change"> / </a>act_w

    answers = {}
    for x in range(100):
        for y in range(100):
            if x * y == no:
                answers[<a id="change">abs(</a>((x*height)/(y*width))-ratio<a id="change">)</a>] = [x, y]

    <a id="change">return </a>answers[sorted(answers.keys())[0]][0], answers[sorted(answers.keys())[0]][1]

class ResizeMe(object):
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/lewis-morris/mapextrackt/commit/f6b06d3f6c38aa8dd6a8a69aec5ebee0e90c0e07#diff-0d12abc618f3f1098870552d69b9d8d20b6e4cc3a51310f1fca84303d112c076L13' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 65910364</div><div id='project'> Project Name: lewis-morris/mapextrackt</div><div id='commit'> Commit Name: f6b06d3f6c38aa8dd6a8a69aec5ebee0e90c0e07</div><div id='time'> Time: 2020-05-05</div><div id='author'> Author: lewis.morris@gmail.com</div><div id='file'> File Name: MapExtrakt/extractor.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: get_rows_cols(4)</div><div id='n_method'> N Method Name: get_rows_cols(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: MapExtrakt/extractor.py</div><div id='n_file'> N File Name: MapExtrakt/extractor.py</div><div id='m_start'> M Start Line: 13</div><div id='m_end'> M End Line: 17</div><div id='n_start'> N Start Line: 13</div><div id='n_end'> N End Line: 25</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
def calcDistTwoParams(params1, params2):
    &quot&quot&quot distance metric between two parameters of planes.
    &quot&quot&quot
    <a id="change">return </a>np.linalg.norm(abs(np.array(params1)-np.array(params2)))


def projectPointOnPlane(point, norm, point_in_plane):</code></pre><h3>After Change</h3><pre><code class='java'>
def calcDistTwoParams(params1, params2, scale_angle, scale_dist):
    &quot&quot&quot distance metric between two parameters of planes.
    &quot&quot&quot
    params1<a id="change"> = </a>np.array(params1)
    params2<a id="change"> = </a>np.array(params2)

    &#47&#47 &#47&#47 recaclulate params
    &#47&#47 params1[:-1] = recalcDirectionalAngles(params1[:-1])
    &#47&#47 params2[:-1] = recalcDirectionalAngles(params2[:-1])

    dist<a id="change"> = </a>params1<a id="change"> - </a>params2

    &#47&#47 return np.linalg.norm(dist)
    <a id="change">return </a>np.sum(<a id="change">abs(</a>dist<a id="change">)</a>)

def recalcDirectionalAngles(params):
    a, b, c = [np.cos(np.deg2rad(params[0])),</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/gml16/rl-medical/commit/abe6cab879e3a521418828329a86df80603ade97#diff-513c06037e1715d5a77073d1e7bcf39a24f53a2737d6591816e67b2d58b4d259L316' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 65910358</div><div id='project'> Project Name: gml16/rl-medical</div><div id='commit'> Commit Name: abe6cab879e3a521418828329a86df80603ade97</div><div id='time'> Time: 2018-04-17</div><div id='author'> Author: aa16914@aemella.doc.ic.ac.uk</div><div id='file'> File Name: examples/AutomaticViewPlanning/DQN/detectPlaneHelper.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: calcDistTwoParams(4)</div><div id='n_method'> N Method Name: calcDistTwoParams(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: examples/AutomaticViewPlanning/DQN/detectPlaneHelper.py</div><div id='n_file'> N File Name: examples/AutomaticViewPlanning/DQN/detectPlaneHelper.py</div><div id='m_start'> M Start Line: 319</div><div id='m_end'> M End Line: 319</div><div id='n_start'> N Start Line: 401</div><div id='n_end'> N End Line: 414</div><BR>