<html><h3>Pattern ID :42024
</h3><img src='117752898.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        for i in inputs:
            inf_inputs.append(Perturbation.perturb_tensor(i, self.reg_params.n_samples).float().cuda())

        inf_output<a id="change"> = </a><a id="change">self.model(</a>inf_inputs<a id="change">)</a>
        inf_loss = torch.nn.functional.binary_cross_entropy_with_logits(inf_output, expanded_logits)

        gradients = torch.autograd.grad(inf_loss, inf_inputs, create_graph=True)
        grads = [Regularization.get_batch_norm(gradients[k], loss=inf_loss,</code></pre><h3>After Change</h3><pre><code class='java'>
        expanded_logits = Perturbation.get_expanded_logits(logits, self.reg_params.n_samples)

        inf_inputs = []
        inf_inputs_len<a id="change"> = </a><a id="change">[]</a>
        <a id="change">for </a>ind, <a id="change">i</a> in enumerate(inputs[0])<a id="change">:
            </a>inf_inputs.append(Perturbation.perturb_tensor(i, self.reg_params.n_samples).float().cuda())
            <a id="change">inf_inputs_len.append(</a>Perturbation.perturb_tensor(inputs[1][ind], self.reg_params.n_samples,False)<a id="change">)</a>

        inf_output = self.model([inf_inputs, inf_inputs_len], training=True)
        inf_loss = torch.nn.functional.binary_cross_entropy_with_logits(inf_output, expanded_logits)
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/pliang279/multibench/commit/c54605f2e0f9be6777682e7598449cf2b1cd3898#diff-f4bce8db7d62d54b2e245f6f2fd4f98ade42a4c0b4cea1530884e70b1042de26L228' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 117752898</div><div id='project'> Project Name: pliang279/multibench</div><div id='commit'> Commit Name: c54605f2e0f9be6777682e7598449cf2b1cd3898</div><div id='time'> Time: 2021-04-07</div><div id='author'> Author: ztwu_nil@zju.edu.cn</div><div id='file'> File Name: objective_functions/regularization.py</div><div id='m_class'> M Class Name: RegularizationLoss</div><div id='n_method'> N Class Name: RegularizationLoss</div><div id='m_method'> M Method Name: forward(3)</div><div id='n_method'> N Method Name: forward(3)</div><div id='m_parent_class'> M Parent Class: torch.nn.Module</div><div id='n_parent_class'> N Parent Class: torch.nn.Module</div><div id='m_file'> M File Name: objective_functions/regularization.py</div><div id='n_file'> N File Name: objective_functions/regularization.py</div><div id='m_start'> M Start Line: 228</div><div id='m_end'> M End Line: 243</div><div id='n_start'> N Start Line: 233</div><div id='n_end'> N End Line: 250</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        for i in inputs:
            inf_inputs.append(Perturbation.perturb_tensor(i, self.reg_params.n_samples).float().cuda())

        inf_output<a id="change"> = </a><a id="change">self.model(</a>inf_inputs<a id="change">)</a>
        inf_loss = torch.nn.functional.binary_cross_entropy_with_logits(inf_output, expanded_logits)

        gradients = torch.autograd.grad(inf_loss, inf_inputs, create_graph=True)
        grads = [Regularization.get_batch_norm(gradients[k], loss=inf_loss,</code></pre><h3>After Change</h3><pre><code class='java'>
        expanded_logits = Perturbation.get_expanded_logits(logits, self.reg_params.n_samples)

        inf_inputs = []
        inf_inputs_len<a id="change"> = </a><a id="change">[]</a>
        <a id="change">for </a>ind, <a id="change">i</a> in enumerate(inputs[0])<a id="change">:
            </a>inf_inputs.append(Perturbation.perturb_tensor(i, self.reg_params.n_samples).float().cuda())
            <a id="change">inf_inputs_len.append(</a>Perturbation.perturb_tensor(inputs[1][ind], self.reg_params.n_samples,False)<a id="change">)</a>

        inf_output = self.model([inf_inputs, inf_inputs_len], training=True)
        inf_loss = torch.nn.functional.binary_cross_entropy_with_logits(inf_output, expanded_logits)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/pliang279/multibench/commit/0e0c7a49dc117cdb06f01380158e60a7ab4e0040#diff-f4bce8db7d62d54b2e245f6f2fd4f98ade42a4c0b4cea1530884e70b1042de26L224' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 117752924</div><div id='project'> Project Name: pliang279/multibench</div><div id='commit'> Commit Name: 0e0c7a49dc117cdb06f01380158e60a7ab4e0040</div><div id='time'> Time: 2021-04-07</div><div id='author'> Author: ztwu_nil@zju.edu.cn</div><div id='file'> File Name: objective_functions/regularization.py</div><div id='m_class'> M Class Name: RegularizationLoss</div><div id='n_method'> N Class Name: RegularizationLoss</div><div id='m_method'> M Method Name: forward(3)</div><div id='n_method'> N Method Name: forward(3)</div><div id='m_parent_class'> M Parent Class: torch.nn.Module</div><div id='n_parent_class'> N Parent Class: torch.nn.Module</div><div id='m_file'> M File Name: objective_functions/regularization.py</div><div id='n_file'> N File Name: objective_functions/regularization.py</div><div id='m_start'> M Start Line: 228</div><div id='m_end'> M End Line: 243</div><div id='n_start'> N Start Line: 233</div><div id='n_end'> N End Line: 250</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        uu = UnNormalizeTransform()
        for inputs in dloader:
            inputs = inputs.to(self.device)
            outputs<a id="change"> = </a><a id="change">self.model(</a>inputs<a id="change">)</a>
            for out in outputs:
                save_image(uu(out), &quot{}_{}.png&quot.format(eval_img_prefix, n))
                n += 1</code></pre><h3>After Change</h3><pre><code class='java'>

        &quot&quot&quot
        for model_output in self._eval_model(dloader):
            ret_batch<a id="change"> = </a><a id="change">[]</a>
            <a id="change">for img</a> in model_output<a id="change">:
                </a>img = img.detach()
                if not untransform is None:
                    img = untransform(img)
                <a id="change">ret_batch.append(</a>img<a id="change">)</a>

            yield torch.stack(ret_batch)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/anderzzz/monkey_caput/commit/b02a753f05762e4bfb07f3388c39b395e124f1db#diff-73ca065a1507fa7f366f4dc4d4aa76d6e7375c37359da911eccf7e14fbf6fd5bL77' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 117752921</div><div id='project'> Project Name: anderzzz/monkey_caput</div><div id='commit'> Commit Name: b02a753f05762e4bfb07f3388c39b395e124f1db</div><div id='time'> Time: 2020-10-28</div><div id='author'> Author: ohrn.anders@gmail.com</div><div id='file'> File Name: ae_learner.py</div><div id='m_class'> M Class Name: AELearner</div><div id='n_method'> N Class Name: AELearner</div><div id='m_method'> M Method Name: eval_model(3)</div><div id='n_method'> N Method Name: eval_model(3)</div><div id='m_parent_class'> M Parent Class: _Learner</div><div id='n_parent_class'> N Parent Class: _Learner</div><div id='m_file'> M File Name: ae_learner.py</div><div id='n_file'> N File Name: ae_learner.py</div><div id='m_start'> M Start Line: 79</div><div id='m_end'> M End Line: 93</div><div id='n_start'> N Start Line: 122</div><div id='n_end'> N End Line: 130</div><BR>