<html><h3>Pattern ID :41072
</h3><img src='115772599.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    def __iter__(self):

        if not self.use_tf_sample:
            <a id="change">batch_idxs_dict</a> = <a id="change">defaultdict(</a>list<a id="change">)</a>

            <a id="change">for </a>pid in self.pids<a id="change">:
                </a><a id="change">idxs = </a><a id="change">copy.deepcopy(</a><a id="change">self.index_dic[pid])</a>
                <a id="change">if len(idxs) &lt; self.num_instances</a>:
                    idxs<a id="change"> = </a><a id="change">np.random.choice(idxs</a><a id="change">, size=self.num_instances, replace=True)</a>
                <a id="change">random.shuffle(idxs</a><a id="change">)</a>
                <a id="change">batch_idxs = </a><a id="change">[]</a>
                <a id="change">for </a><a id="change">idx</a> in <a id="change">idxs</a><a id="change">:
                    batch_idxs</a><a id="change">.append(idx</a><a id="change">)</a>
                    <a id="change">if len(batch_idxs) == self.num_instances</a>:
                        <a id="change">batch_idxs_dict[pid].append(batch_idxs</a><a id="change">)</a>
                        batch_idxs<a id="change"> = </a><a id="change">[]</a>

            avai_pids = copy.deepcopy(self.pids)
            final_idxs = []
            </code></pre><h3>After Change</h3><pre><code class='java'>
    def __iter__(self):

        if not self.use_tf_sample:
            batch_idxs_dict = <a id="change">self.get_batch_idxs_dict()</a>
            avai_pids = copy.deepcopy(self.pids)
            final_idxs = []
            
            if not self.use_all_sample:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 24</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/tencentyouturesearch/personreid-cacenet/commit/d55da0f5c4ad72dcdc503f62330ce785bfafb1e7#diff-0def00086a8a59cc8ec09a58ad88ec5d0a1cc0b5181d1e456c94564775e02a8eL48' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 115772599</div><div id='project'> Project Name: tencentyouturesearch/personreid-cacenet</div><div id='commit'> Commit Name: d55da0f5c4ad72dcdc503f62330ce785bfafb1e7</div><div id='time'> Time: 2021-01-06</div><div id='author'> Author: fufuyu@tencent.com</div><div id='file'> File Name: utils/sampler.py</div><div id='m_class'> M Class Name: RandomIdentitySampler</div><div id='n_method'> N Class Name: RandomIdentitySampler</div><div id='m_method'> M Method Name: __iter__(1)</div><div id='n_method'> N Method Name: __iter__(1)</div><div id='m_parent_class'> M Parent Class: Sampler</div><div id='n_parent_class'> N Parent Class: Sampler</div><div id='m_file'> M File Name: utils/sampler.py</div><div id='n_file'> N File Name: utils/sampler.py</div><div id='m_start'> M Start Line: 48</div><div id='m_end'> M End Line: 62</div><div id='n_start'> N Start Line: 66</div><div id='n_end'> N End Line: 66</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if self.shuffle:
            np.random.seed(self.epoch + self.seed)
        if not self.use_tf_sample:
            <a id="change">batch_idxs_dict</a> = <a id="change">defaultdict(</a>list<a id="change">)</a>
            <a id="change">for </a><a id="change">pid</a> in self.pids<a id="change">:
                </a><a id="change">idxs = </a><a id="change">copy.deepcopy(</a><a id="change">self.index_dic[pid])</a>
                <a id="change">if len(idxs) &lt; self.num_instances</a>:
                    idxs<a id="change"> = </a><a id="change">np.random.choice(</a>idxs<a id="change">, size=self.num_instances, replace=True)</a>
                <a id="change">random.shuffle(</a>idxs<a id="change">)</a>
                &#47&#47 print(&quotaaa&quot)
                <a id="change">batch_idxs = </a><a id="change">[]</a>
                <a id="change">for </a><a id="change">idx</a> in idxs<a id="change">:
                    </a><a id="change">batch_idxs.append(</a>idx<a id="change">)</a>
                    <a id="change">if len(batch_idxs) == self.num_instances</a>:
                        <a id="change">batch_idxs_dict[pid].append(</a>batch_idxs<a id="change">)</a>
                        batch_idxs<a id="change"> = </a><a id="change">[]</a>

            avai_pids = copy.deepcopy(self.pids)
            final_idxs = []
</code></pre><h3>After Change</h3><pre><code class='java'>
        if self.shuffle:
            np.random.seed(self.epoch + self.seed)
        if not self.use_tf_sample:
            batch_idxs_dict = <a id="change">self.get_batch_idxs_dict()</a>

            avai_pids = copy.deepcopy(self.pids)
            final_idxs = []
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tencentyouturesearch/personreid-cacenet/commit/d55da0f5c4ad72dcdc503f62330ce785bfafb1e7#diff-0def00086a8a59cc8ec09a58ad88ec5d0a1cc0b5181d1e456c94564775e02a8eL134' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 115772602</div><div id='project'> Project Name: tencentyouturesearch/personreid-cacenet</div><div id='commit'> Commit Name: d55da0f5c4ad72dcdc503f62330ce785bfafb1e7</div><div id='time'> Time: 2021-01-06</div><div id='author'> Author: fufuyu@tencent.com</div><div id='file'> File Name: utils/sampler.py</div><div id='m_class'> M Class Name: DistributeRandomIdentitySampler</div><div id='n_method'> N Class Name: DistributeRandomIdentitySampler</div><div id='m_method'> M Method Name: __iter__(1)</div><div id='n_method'> N Method Name: __iter__(1)</div><div id='m_parent_class'> M Parent Class: RandomIdentitySampler</div><div id='n_parent_class'> N Parent Class: RandomIdentitySampler</div><div id='m_file'> M File Name: utils/sampler.py</div><div id='n_file'> N File Name: utils/sampler.py</div><div id='m_start'> M Start Line: 138</div><div id='m_end'> M End Line: 152</div><div id='n_start'> N Start Line: 143</div><div id='n_end'> N End Line: 143</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    def __iter__(self):

        if not self.use_tf_sample:
            <a id="change">batch_idxs_dict</a> = <a id="change">defaultdict(</a>list<a id="change">)</a>

            <a id="change">for </a><a id="change">pid</a> in self.pids<a id="change">:
                </a><a id="change">idxs = </a><a id="change">copy.deepcopy(</a><a id="change">self.index_dic[pid])</a>
                <a id="change">if len(idxs) &lt; self.num_instances</a>:
                    idxs<a id="change"> = </a><a id="change">np.random.choice(</a>idxs<a id="change">, size=self.num_instances, replace=True)</a>
                <a id="change">random.shuffle(</a>idxs<a id="change">)</a>
                <a id="change">batch_idxs = </a><a id="change">[]</a>
                <a id="change">for </a><a id="change">idx</a> in idxs<a id="change">:
                    </a><a id="change">batch_idxs.append(</a>idx<a id="change">)</a>
                    <a id="change">if len(batch_idxs) == self.num_instances</a>:
                        <a id="change">batch_idxs_dict[pid].append(</a>batch_idxs<a id="change">)</a>
                        batch_idxs<a id="change"> = </a><a id="change">[]</a>

            avai_pids = copy.deepcopy(self.pids)
            final_idxs = []
            </code></pre><h3>After Change</h3><pre><code class='java'>
    def __iter__(self):

        if not self.use_tf_sample:
            batch_idxs_dict = <a id="change">self.get_batch_idxs_dict()</a>
            avai_pids = copy.deepcopy(self.pids)
            final_idxs = []
            
            if not self.use_all_sample:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tencentyouturesearch/personreid-youreid/commit/d55da0f5c4ad72dcdc503f62330ce785bfafb1e7#diff-0def00086a8a59cc8ec09a58ad88ec5d0a1cc0b5181d1e456c94564775e02a8eL45' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 115772601</div><div id='project'> Project Name: tencentyouturesearch/personreid-youreid</div><div id='commit'> Commit Name: d55da0f5c4ad72dcdc503f62330ce785bfafb1e7</div><div id='time'> Time: 2021-01-06</div><div id='author'> Author: fufuyu@tencent.com</div><div id='file'> File Name: utils/sampler.py</div><div id='m_class'> M Class Name: RandomIdentitySampler</div><div id='n_method'> N Class Name: RandomIdentitySampler</div><div id='m_method'> M Method Name: __iter__(1)</div><div id='n_method'> N Method Name: __iter__(1)</div><div id='m_parent_class'> M Parent Class: Sampler</div><div id='n_parent_class'> N Parent Class: Sampler</div><div id='m_file'> M File Name: utils/sampler.py</div><div id='n_file'> N File Name: utils/sampler.py</div><div id='m_start'> M Start Line: 48</div><div id='m_end'> M End Line: 62</div><div id='n_start'> N Start Line: 66</div><div id='n_end'> N End Line: 66</div><BR>