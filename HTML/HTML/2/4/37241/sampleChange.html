<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        acc = []
        f1 = []
        for emo_ind in range(4):
            preds_i<a id="change"> = </a><a id="change">np.argmax(</a>preds[:, emo_ind]<a id="change">, axis=-1)</a>
            truths_i = truths[:, emo_ind]
            acc.append(torch.sum(truths_i == preds_i).item() / len(preds))
            f1.append(f1_score(truths_i, preds_i, average=&quotweighted&quot))
    else:</code></pre><h3>After Change</h3><pre><code class='java'>
    truths: (bs, num_emotions)
    &quot&quot&quot

    total = <a id="change">preds.size(0</a><a id="change">)</a>
    num_emo = preds.size(1)

    preds = preds.cpu().detach()
    truths = truths.cpu().detach()</code></pre>