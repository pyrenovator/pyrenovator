<html><h3>Pattern ID :27469
</h3><img src='81579613.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                    tts, train_size = splits[0],
                    test_size = splits[1], shuffle = False)
                setattr(self, split_names[0],
                        {k: <a id="change">int(</a>v<a id="change">)</a> for k, v in np.array(
                            list(self._data.items()))[split_1]})
                setattr(self, split_names[1],
                        {k: int(v) for k, v in np.array(</code></pre><h3>After Change</h3><pre><code class='java'>
                "Cannot split data after it has been batched. "
                "Run split before batching, and use the relevant"
                "properties to access the split data.")
        <a id="change">if </a><a id="change">hasattr(</a>self, <a id="change">&quot_block_split&quot</a><a id="change">)</a>:
            raise NotImplementedError(
                "Cannot further split already split data.")
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/project-agml/agml/commit/1e3651fa2fa9662489f3c5c08afcd54c7a00153a#diff-e0a3282bb43d5a72e9d96185e32f78ed2115f88edf4f07780d763b71bd49e952L234' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 81579613</div><div id='project'> Project Name: project-agml/agml</div><div id='commit'> Commit Name: 1e3651fa2fa9662489f3c5c08afcd54c7a00153a</div><div id='time'> Time: 2021-10-02</div><div id='author'> Author: 67437306+amogh7joshi@users.noreply.github.com</div><div id='file'> File Name: agml/data/segmentation.py</div><div id='m_class'> M Class Name: AgMLSemanticSegmentationDataLoader</div><div id='n_method'> N Class Name: AgMLSemanticSegmentationDataLoader</div><div id='m_method'> M Method Name: split(5)</div><div id='n_method'> N Method Name: split(5)</div><div id='m_parent_class'> M Parent Class: AgMLDataLoader</div><div id='n_parent_class'> N Parent Class: AgMLDataLoader</div><div id='m_file'> M File Name: agml/data/segmentation.py</div><div id='n_file'> N File Name: agml/data/segmentation.py</div><div id='m_start'> M Start Line: 234</div><div id='m_end'> M End Line: 287</div><div id='n_start'> N Start Line: 235</div><div id='n_end'> N End Line: 333</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    buf_size = 0
    if use_limit_buf:
        buf_size = <a id="change">int(</a>np.ceil(cuda_row_num * 0.1)<a id="change">)</a>

    torch.cuda.reset_peak_memory_stats()
    device = torch.device(&quotcuda:0&quot)
    with Timer() as timer:</code></pre><h3>After Change</h3><pre><code class='java'>
                    if it == 200:
                        break

    <a id="change">if </a><a id="change">hasattr(</a>model, <a id="change">&quotcache_weight_mgr&quot</a><a id="change">)</a>:
        model.cache_weight_mgr.print_comm_stats()

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/freqcacheembedding/commit/ad06327b975d92dfcabbc0c1965ad459e4f62dad#diff-3f3f0e579a0b39958321387c8a7db5c9b349b6db8179a2f3ce681563afc7e165L21' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 81579598</div><div id='project'> Project Name: hpcaitech/freqcacheembedding</div><div id='commit'> Commit Name: ad06327b975d92dfcabbc0c1965ad459e4f62dad</div><div id='time'> Time: 2022-10-17</div><div id='author'> Author: fangjiarui123@gmail.com</div><div id='file'> File Name: benchmark/benchmark_cache.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: benchmark_cache_embedding(7)</div><div id='n_method'> N Method Name: benchmark_cache_embedding(7)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: benchmark/benchmark_cache.py</div><div id='n_file'> N File Name: benchmark/benchmark_cache.py</div><div id='m_start'> M Start Line: 29</div><div id='m_end'> M End Line: 93</div><div id='n_start'> N Start Line: 74</div><div id='n_end'> N End Line: 77</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            assert module.dilation == 1 or (module.dilation == (1,1)), (
                "Dilation should equal 1 before conversion, maybe the model is "
                "already converted?")
            module.dilation = (<a id="change">int(</a>stride_so_far[0]<a id="change">)</a>, int(stride_so_far[1]))
</code></pre><h3>After Change</h3><pre><code class='java'>
    -------

    
    <a id="change">if </a>not <a id="change">hasattr(</a>axis, <a id="change">&quot__len__&quot</a><a id="change">)</a>:
        axis = [axis]
    assert all([ax in [2,3] for ax in axis]), "Only 2 and 3 allowed for axis"
    axis = np.array(axis) - 2</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/braindecode/braindecode/commit/270aa47bf790d37f0bc80ea67c31ef35c0fdd277#diff-246f0db21c29b86f02b8b250f7b2248396acc4e38e5d4dbb97a6d7b0ec2dda82L23' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 81579609</div><div id='project'> Project Name: braindecode/braindecode</div><div id='commit'> Commit Name: 270aa47bf790d37f0bc80ea67c31ef35c0fdd277</div><div id='time'> Time: 2017-07-04</div><div id='author'> Author: robintibor@gmail.com</div><div id='file'> File Name: braindecode/torch_ext/util.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: to_dense_prediction_model(2)</div><div id='n_method'> N Method Name: to_dense_prediction_model(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: braindecode/torch_ext/util.py</div><div id='n_file'> N File Name: braindecode/torch_ext/util.py</div><div id='m_start'> M Start Line: 23</div><div id='m_end'> M End Line: 33</div><div id='n_start'> N Start Line: 23</div><div id='n_end'> N End Line: 56</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            sequence_output = outputs[0]

            &#47&#47 Select only the masked tokens for the classifier
            max_number_of_masked_tokens = <a id="change">int(</a>labels.size(1) * 0.25<a id="change">)</a>
            masked_lm_labels, masked_lm_positions = torch.topk(labels, k=max_number_of_masked_tokens, dim=1)
            masked_output = self.gather_indices(sequence_output, masked_lm_positions)

            prediction_scores = self.lm_head(masked_output)</code></pre><h3>After Change</h3><pre><code class='java'>
            outputs = self.roberta(input_ids, attention_mask=attention_mask)
            sequence_output = outputs[0]

            <a id="change">if </a><a id="change">hasattr(</a>self.config, <a id="change">"max_num_masked_tokens"</a><a id="change">)</a>:
                &#47&#47 Select only the masked tokens for the classifier
                labels, positions = torch.topk(labels, k=self.config.max_num_masked_tokens, dim=1)
                sequence_output = self.gather_indices(sequence_output, positions)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/optimum-graphcore/commit/066b742fa0859d8862a26e13d86b439a7acb561e#diff-e6bb8260cba471d97c88459de99e2cd076bc2b8ccd368430dd4d393ae914cdd1L163' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 81579602</div><div id='project'> Project Name: huggingface/optimum-graphcore</div><div id='commit'> Commit Name: 066b742fa0859d8862a26e13d86b439a7acb561e</div><div id='time'> Time: 2022-09-13</div><div id='author'> Author: jincheng@graphcore.ai</div><div id='file'> File Name: optimum/graphcore/models/roberta/modeling_roberta.py</div><div id='m_class'> M Class Name: PipelinedRobertaForMaskedLM</div><div id='n_method'> N Class Name: PipelinedRobertaForMaskedLM</div><div id='m_method'> M Method Name: forward(4)</div><div id='n_method'> N Method Name: forward(4)</div><div id='m_parent_class'> M Parent Class: PipelineMixin,RobertaForMaskedLM</div><div id='n_parent_class'> N Parent Class: PipelineMixin,RobertaForMaskedLM</div><div id='m_file'> M File Name: optimum/graphcore/models/roberta/modeling_roberta.py</div><div id='n_file'> N File Name: optimum/graphcore/models/roberta/modeling_roberta.py</div><div id='m_start'> M Start Line: 169</div><div id='m_end'> M End Line: 177</div><div id='n_start'> N Start Line: 166</div><div id='n_end'> N End Line: 176</div><BR>