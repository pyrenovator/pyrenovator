<html><h3>Pattern ID :17423
</h3><img src='57735088.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    def sample(self, batch, basename):
        self.set_input(batch[0], batch[2], batch[1])
        self.forward()
        tensor_to_plot<a id="change"> = </a>torch.cat([self.fake_B, self.real_B], 3)
        img = vutils.make_grid(tensor_to_plot)
        <a id="change">vutils.save_image(</a>tensor_to_plot, basename + "_construct.png"<a id="change">)</a>
        self.set_input(torch.randn(1, self.embedding_dim).repeat(batch[0].shape[0], 1), batch[2], batch[1])
        self.forward()
        tensor_to_plot = torch.cat([self.fake_B, self.real_A], 3)
        vutils.save_image(tensor_to_plot, basename + "_generate.png")</code></pre><h3>After Change</h3><pre><code class='java'>
        with torch.no_grad():
            self.set_input(batch[0], batch[2], batch[1])
            self.forward()
            tensor_to_plot<a id="change"> = </a>torch.cat([self.fake_B, self.real_B], 3)
            img = vutils.make_grid(tensor_to_plot)
            <a id="change">vutils.save_image(</a>tensor_to_plot, basename + "_construct.png"<a id="change">)</a>
            &quot&quot&quot
            maybe we don&quott need generate_img...?
            self.set_input(torch.randn(1, self.embedding_dim).repeat(batch[0].shape[0], 1), batch[2], batch[1])
            self.forward()</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/euphoriayan/zi2zi-pytorch/commit/d18cdce2416d812c3944db8aef913e06879b022b#diff-62e0d959e50d9f4003df8124a1c19d98c77320268642d433b1cc28c58cf73a85L204' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 57735088</div><div id='project'> Project Name: euphoriayan/zi2zi-pytorch</div><div id='commit'> Commit Name: d18cdce2416d812c3944db8aef913e06879b022b</div><div id='time'> Time: 2020-06-29</div><div id='author'> Author: ysq58000@foxmail.com</div><div id='file'> File Name: model/model.py</div><div id='m_class'> M Class Name: Zi2ZiModel</div><div id='n_method'> N Class Name: Zi2ZiModel</div><div id='m_method'> M Method Name: sample(3)</div><div id='n_method'> N Method Name: sample(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: model/model.py</div><div id='n_file'> N File Name: model/model.py</div><div id='m_start'> M Start Line: 204</div><div id='m_end'> M End Line: 212</div><div id='n_start'> N Start Line: 215</div><div id='n_end'> N End Line: 227</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

                save_file_path_deblur_input = os.path.join(save_path_deblur, iformat, &quotinput&quot, &quot{:02d}.{}&quot.format(j+1, iformat))
                save_file_path_deblur_output = os.path.join(save_path_deblur, iformat, &quotoutput&quot, &quot{:02d}.{}&quot.format(j+1, iformat))
                save_file_path_deblur_gt<a id="change"> = </a>os.path.join(save_path_deblur, iformat, &quotgt&quot, &quot{:02d}.{}&quot.format(j+1, iformat))

                vutils.save_image(inp, &quot{}&quot.format(save_file_path_deblur_input), nrow=1, padding = 0, normalize = False)
                vutils.save_image(output, &quot{}&quot.format(save_file_path_deblur_output), nrow=1, padding = 0, normalize = False)
                <a id="change">vutils.save_image(</a>gt, &quot{}&quot.format(save_file_path_deblur_gt)<a id="change">, nrow=1, padding = 0, normalize = False)</a>

        &#47&#47 video average
        PSNR_mean_total += PSNR_mean</code></pre><h3>After Change</h3><pre><code class='java'>

                if gt_file_path_list is not None:
                    Path(os.path.join(save_path_deblur, iformat, &quotgt&quot)).mkdir(parents=True, exist_ok=True)
                    save_file_path_deblur_gt<a id="change"> = </a>os.path.join(save_path_deblur, iformat, &quotgt&quot, &quot{:02d}.{}&quot.format(j+1, iformat))
                    <a id="change">vutils.save_image(</a>gt, &quot{}&quot.format(save_file_path_deblur_gt)<a id="change">, nrow=1, padding = 0, normalize = False)</a>


        &#47&#47 video average</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/codeslake/pvdnet/commit/a731e53a93bdd93dfd5dadc78e456978ba14ccf0#diff-0d966d6c14a6b78bc80ed395e2fe33e014e91bcaafdde33608359324e66a914bL66' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 57735089</div><div id='project'> Project Name: codeslake/pvdnet</div><div id='commit'> Commit Name: a731e53a93bdd93dfd5dadc78e456978ba14ccf0</div><div id='time'> Time: 2021-03-15</div><div id='author'> Author: codeslake@gmail.com</div><div id='file'> File Name: eval.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: eval_quan_qual(1)</div><div id='n_method'> N Method Name: eval_quan_qual(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: eval.py</div><div id='n_file'> N File Name: eval.py</div><div id='m_start'> M Start Line: 160</div><div id='m_end'> M End Line: 168</div><div id='n_start'> N Start Line: 160</div><div id='n_end'> N End Line: 174</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        return {&quotval_loss&quot: avg_loss, &quotlog&quot: tensorboard_logs}

    def sample_images(self):
        samples<a id="change"> = </a>self.model.sample(self.params[&quotbatch_size&quot], self.curr_device).cpu()
        <a id="change">vutils.save_image(</a>samples.data,
                          f"{self.logger.save_dir}{self.logger.name}/version_{self.logger.version}/"
                          f"{self.logger.name}_{self.current_epoch}.png"<a id="change">,
                          normalize=True,
                          nrow=int(math.sqrt(self.params[&quotbatch_size&quot])))</a>

        &#47&#47 Get sample reconstruction image
        test_input, _ = next(iter(self.sample_dataloader))
        test_input = test_input.to(self.curr_device)</code></pre><h3>After Change</h3><pre><code class='java'>
                          normalize=True,
                          nrow=int(math.sqrt(self.params[&quotbatch_size&quot])))

        samples<a id="change"> = </a>self.model.sample(self.params[&quotbatch_size&quot],
                                    self.curr_device,
                                    labels = test_label).cpu()
        <a id="change">vutils.save_image(</a>samples.data,
                          f"{self.logger.save_dir}{self.logger.name}/version_{self.logger.version}/"
                          f"{self.logger.name}_{self.current_epoch}.png"<a id="change">,
                          normalize=True,
                          nrow=int(math.sqrt(self.params[&quotbatch_size&quot])))</a>


        del test_input, recons, samples
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/antixk/pytorch-vae/commit/2946d7a0b9e31eb023ca60f8793656fe97cc198a#diff-b2f3f93dba319f5dec38bff9562c88bdf781e8c5134de6d45fcd75542c976b87L70' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 57735092</div><div id='project'> Project Name: antixk/pytorch-vae</div><div id='commit'> Commit Name: 2946d7a0b9e31eb023ca60f8793656fe97cc198a</div><div id='time'> Time: 2020-01-23</div><div id='author'> Author: anandkrish894@gmail.com</div><div id='file'> File Name: experiment.py</div><div id='m_class'> M Class Name: VAEXperiment</div><div id='n_method'> N Class Name: VAEXperiment</div><div id='m_method'> M Method Name: sample_images(1)</div><div id='n_method'> N Method Name: sample_images(1)</div><div id='m_parent_class'> M Parent Class: pl.LightningModule</div><div id='n_parent_class'> N Parent Class: pl.LightningModule</div><div id='m_file'> M File Name: experiment.py</div><div id='n_file'> N File Name: experiment.py</div><div id='m_start'> M Start Line: 71</div><div id='m_end'> M End Line: 76</div><div id='n_start'> N Start Line: 74</div><div id='n_end'> N End Line: 89</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            
        fake_images = fake_images.mul(0.5).add(0.5).squeeze().cpu()
        
        image_grid<a id="change"> = </a>utils.make_grid(fake_images, nrow=self.save_row_number)
        
        <a id="change">utils.save_image(</a>image_grid, os.path.join(self.image_save_path, &quot{}.png&quot.format(self.cfg.PROJECT_NAME))<a id="change">)</a>
        &#47&#47 save images one by one
        &#47&#47 toPIL = transforms.ToPILImage()
        &#47&#47 for i, image in enumerate(fake_images):</code></pre><h3>After Change</h3><pre><code class='java'>
                image = toPIL(image)
                image.save(os.path.join(self.image_save_path, &quot{}.png&quot.format(i)))
        else:
            image_grid<a id="change"> = </a>utils.make_grid(fake_images, nrow=self.save_row_number)
            <a id="change">utils.save_image(</a>image_grid, os.path.join(self.image_save_path, &quot{}.png&quot.format(self.cfg.PROJECT_NAME))<a id="change">)</a>
        

        </code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/luzhixing12345/anime-wgan/commit/c3ccaea9514b0fc10c38fdd21ea94e07cc286a9f#diff-cd76ff4f46cfd07c0afbdc08af2004430492c58a024a3f17cdb9bbeb299413f8L83' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 57735094</div><div id='project'> Project Name: luzhixing12345/anime-wgan</div><div id='commit'> Commit Name: c3ccaea9514b0fc10c38fdd21ea94e07cc286a9f</div><div id='time'> Time: 2022-05-16</div><div id='author'> Author: luzhixing12345@163.com</div><div id='file'> File Name: model/BaseModule.py</div><div id='m_class'> M Class Name: BasicGAN</div><div id='n_method'> N Class Name: BasicGAN</div><div id='m_method'> M Method Name: generate_images(1)</div><div id='n_method'> N Method Name: generate_images(1)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: model/BaseModule.py</div><div id='n_file'> N File Name: model/BaseModule.py</div><div id='m_start'> M Start Line: 95</div><div id='m_end'> M End Line: 99</div><div id='n_start'> N Start Line: 96</div><div id='n_end'> N End Line: 110</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47                   normalize=True,
        &#47&#47                   nrow=int(math.sqrt(self.params[&quotbatch_size&quot])))

        samples<a id="change"> = </a>self.model.sample(self.params[&quotbatch_size&quot],
                                    self.curr_device,
                                    labels = test_label).cpu()
        <a id="change">vutils.save_image(</a>samples.data,
                          f"{self.logger.save_dir}{self.logger.name}/version_{self.logger.version}/"
                          f"{self.logger.name}_{self.current_epoch}.png"<a id="change">,
                          normalize=True,
                          nrow=int(math.sqrt(self.params[&quotbatch_size&quot])))</a>


        del test_input, recons, samples
</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47                   nrow=12)

        try:
            samples<a id="change"> = </a>self.model.sample(144,
                                        self.curr_device,
                                        labels = test_label).cpu()
            <a id="change">vutils.save_image(</a>samples.data,
                              f"{self.logger.save_dir}{self.logger.name}/version_{self.logger.version}/"
                              f"{self.logger.name}_{self.current_epoch}.png"<a id="change">,
                              normalize=True,
                              nrow=12)</a>
        except:
            raise RuntimeWarning(&quotNo sampler for the VAE model is proviced. Continuing...&quot)

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/antixk/pytorch-vae/commit/330681d5b01126be50ee4d64433252591e50452e#diff-b2f3f93dba319f5dec38bff9562c88bdf781e8c5134de6d45fcd75542c976b87L65' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 57735085</div><div id='project'> Project Name: antixk/pytorch-vae</div><div id='commit'> Commit Name: 330681d5b01126be50ee4d64433252591e50452e</div><div id='time'> Time: 2020-02-14</div><div id='author'> Author: anandkrish894@gmail.com</div><div id='file'> File Name: experiment.py</div><div id='m_class'> M Class Name: VAEXperiment</div><div id='n_method'> N Class Name: VAEXperiment</div><div id='m_method'> M Method Name: sample_images(1)</div><div id='n_method'> N Method Name: sample_images(1)</div><div id='m_parent_class'> M Parent Class: pl.LightningModule</div><div id='n_parent_class'> N Parent Class: pl.LightningModule</div><div id='m_file'> M File Name: experiment.py</div><div id='n_file'> N File Name: experiment.py</div><div id='m_start'> M Start Line: 68</div><div id='m_end'> M End Line: 93</div><div id='n_start'> N Start Line: 68</div><div id='n_end'> N End Line: 96</div><BR>