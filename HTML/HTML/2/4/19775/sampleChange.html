<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        a: "KeyedJaggedTensor",
        b: "KeyedJaggedTensor",
    ) -&gt; "KeyedJaggedTensor":
        if <a id="change">a.stride()</a> != b.stride():
            raise ValueError(
                f"Can only merge KJTs of the same stride ({a.stride()}, {b.stride()})."
            )</code></pre><h3>After Change</h3><pre><code class='java'>
        weight_list: List[torch.Tensor] = []
        length_list: List[torch.Tensor] = []

        <a id="change">for </a>kjt in kjt_list<a id="change">:
            </a>if kjt.stride() != stride:
                raise ValueError(
                    f"Can only merge KJTs of the same stride ({stride} != kjt.stride())"
                )
            curr_is_weighted: bool = kjt.weights_or_none() is not None
            if is_weighted != curr_is_weighted:
                raise ValueError("Can&quott merge weighted KJT with unweighted KJT")

            if <a id="change">kjt._length_per_key is None</a>:
                has_length_per_key = False

            if has_length_per_key:</code></pre>