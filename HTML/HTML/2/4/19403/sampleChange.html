<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        else:
            self.update_J_Broyden(h, self.prev_Y[0], self.current_Y)

        <a id="change">with torch</a><a id="change">.no_grad():
            </a>self.update_hess()
            self.update_grad(self.current_Y)
        self.iteration += 1
    </code></pre><h3>After Change</h3><pre><code class='java'>
            self.L = min(1e9, self.L * self.Lup)
            return
        elif self.iteration &gt; 0:
            print("LM loss, best loss, L: ", loss.item(), np.nanmin(self.loss_history[:-1]), np.nanmin(self.loss_history[:-1]) - <a id="change">loss.item()</a>, self.L)
            rho = self.rho(np.nanmin(self.loss_history[:-1]), loss, h)
            self.rho_history.append(rho)
            print("rho: ", rho.item())</code></pre>