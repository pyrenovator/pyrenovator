<html><h3>Pattern ID :29652
</h3><img src='87924124.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    timer = Timer()
    epochs = num_epochs

    train_set_size = <a id="change">int(</a>train_percent<a id="change">*</a>num_data_points<a id="change">)</a>
    val_set_size = int(val_percent*num_data_points)
    eval_start = train_set_size

    for _ in range(epochs):</code></pre><h3>After Change</h3><pre><code class='java'>

    for _ in range(epochs):

        for image, text in <a id="change">tqdm(</a>train_loader<a id="change">)</a>:
            
            diffusion_prior.train()
            
            input_args = dict(image_embed=image)
            if dp_condition_on_text_encodings:
                input_args<a id="change"> = </a>dict(**input_args, text = text)
            else:
                input_args = dict(**input_args, text_embed=text)
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/lucidrains/dalle2-pytorch/commit/4a59dea4cfad72176f35700296adfbc28e205598#diff-283456789c9565d0a8ad235fc41b44188f310b3043c3bcdeb6678f1958a57b51L179' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 87924124</div><div id='project'> Project Name: lucidrains/dalle2-pytorch</div><div id='commit'> Commit Name: 4a59dea4cfad72176f35700296adfbc28e205598</div><div id='time'> Time: 2022-05-15</div><div id='author'> Author: 51308183+nousr@users.noreply.github.com</div><div id='file'> File Name: train_diffusion_prior.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(32)</div><div id='n_method'> N Method Name: train(29)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: train_diffusion_prior.py</div><div id='n_file'> N File Name: train_diffusion_prior.py</div><div id='m_start'> M Start Line: 200</div><div id='m_end'> M End Line: 343</div><div id='n_start'> N Start Line: 179</div><div id='n_end'> N End Line: 369</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

                p_bar.update()

    _threshold_number = <a id="change">int(</a>_number_all_funds<a id="change"> * </a>threshold<a id="change">)</a>
    calendar = [date for date in _list_all_date if _list_all_date[date] &gt;= _threshold_number]

    return calendar
</code></pre><h3>After Change</h3><pre><code class='java'>
    
    logger.info(f"count how many funds have founded in this day......")
    _dict_count_founding = {date:_number_all_funds for date in _dict_count_trade.keys()}   &#47&#47 dict{date:count}
    with <a id="change">tqdm(total=_number_all_funds)</a> as p_bar:
        with ProcessPoolExecutor(max_workers=max_workers) as executor:
            for date_list in executor.map(_fun, file_list[:_number_all_funds]):
                oldest_date<a id="change"> = </a>sorted(date_list)[0]  &#47&#47 this fund haven&quott found before this day
                for date in _dict_count_founding.keys():
                    if date &lt; oldest_date:
                        _dict_count_founding[date] -= 1</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/11412727ef9089863b88f4d58b332513350cb115#diff-5028716407720ea33d7e0fa3921ac328c29103dd0822f7102c648ff8edbf0481L107' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 87924119</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: 11412727ef9089863b88f4d58b332513350cb115</div><div id='time'> Time: 2021-03-07</div><div id='author'> Author: zhangdao@buaa.edu.cn</div><div id='file'> File Name: scripts/data_collector/utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: get_calendar_list_by_ratio(5)</div><div id='n_method'> N Method Name: get_calendar_list_by_ratio(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: scripts/data_collector/utils.py</div><div id='n_file'> N File Name: scripts/data_collector/utils.py</div><div id='m_start'> M Start Line: 129</div><div id='m_end'> M End Line: 147</div><div id='n_start'> N Start Line: 108</div><div id='n_end'> N End Line: 160</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            &#47&#47 length = 101

            cap.set(cv2.CAP_PROP_FPS, 25)
            length = <a id="change">int(</a>cap<a id="change">.get(cv2.CAP_PROP_FRAME_COUNT) / 6 * </a>5<a id="change">)</a>
            count = 0
            &#47&#47 Running a loop to each frame and saving it in the created folder
            while cap.isOpened():
                count += 1</code></pre><h3>After Change</h3><pre><code class='java'>

def video2img_train(zipfile_train, save_to="image_data/train_data"):
    &#47&#47 Running a loop through all the zipped training file to extract all video and then extract 100 frames from each.
    for i in <a id="change">tqdm(</a>range(1, 76)<a id="change">)</a>:
        if i &lt; 10:
            zipfilename = &quottraining80_0&quot + str(i) + &quot.zip&quot
        else:
            zipfilename = &quottraining80_&quot + str(i) + &quot.zip&quot
        &#47&#47 Accessing the zipfile i
        archive = zipfile.ZipFile(zipfile_train + zipfilename, &quotr&quot)
        zipfilename = zipfilename.split(&quot.zip&quot)[0]

        &#47&#47 Extracting all videos in it and saving it all to the new folder with same name as zipped one
        archive.extractall(&quotunzippedData/&quot + zipfilename)

        &#47&#47 Running a loop over all the videos in the zipped file and extracting 100 frames from each
        for file_name in tqdm(archive.namelist()):
            cap = cv2.VideoCapture(&quotunzippedData/&quot + zipfilename + &quot/&quot + file_name)

            file_name = (file_name.split(&quot.mp4&quot))[0]
            save_path<a id="change"> = </a>os.path.join(save_to, file_name)
            &#47&#47 Creating folder to save all the 100 frames from the video
            try:
                if not os.path.exists(save_path):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/liaorongfan/deeppersonality/commit/ce122760e5cb05dd7588040c8cf6e3fac099abf9#diff-18b089b4bdf8ffa9f3b77901324ca9a0d333fad0082874610e7140a0d1cf04f3L56' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 87924129</div><div id='project'> Project Name: liaorongfan/deeppersonality</div><div id='commit'> Commit Name: ce122760e5cb05dd7588040c8cf6e3fac099abf9</div><div id='time'> Time: 2021-09-21</div><div id='author'> Author: 15670381505@163.com</div><div id='file'> File Name: dpcv/data/utils/video_to_image.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: video2img_train(2)</div><div id='n_method'> N Method Name: video2img_train(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: dpcv/data/utils/video_to_image.py</div><div id='n_file'> N File Name: dpcv/data/utils/video_to_image.py</div><div id='m_start'> M Start Line: 56</div><div id='m_end'> M End Line: 100</div><div id='n_start'> N Start Line: 56</div><div id='n_end'> N End Line: 96</div><BR>