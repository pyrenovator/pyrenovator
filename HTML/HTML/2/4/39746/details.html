<html><h3>Pattern ID :39746
</h3><img src='113211423.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        )
        &#47&#47 Ensure that keypoints outside the image are not visible
        self.assertTrue((aug_joints[joints_outside_image, 2] == 0).all())
        self.assertTrue((aug_joints[~joints_outside_image<a id="change">, 2</a>] != 0).all())

    def test_keypoints_horizontal_flip(self):
        image = np.random.rand(640, 480, 3)</code></pre><h3>After Change</h3><pre><code class='java'>
        y = np.arange(image.shape[0])
        xv, yv = np.meshgrid(x, y, indexing="xy")

        joints<a id="change"> = </a>np.stack([xv.flatten(), yv.flatten(), <a id="change">np.ones_like(</a>yv.flatten()<a id="change">)</a>], axis=-1)  &#47&#47 [N, 3]
        joints<a id="change"> = </a>joints.reshape((-1, 1, 3)).repeat(17, axis=1)  &#47&#47 [N, 17, 3]

        aug = KeypointsRandomAffineTransform(min_scale=0.8, max_scale=1.2, max_rotation=30, max_translate=0.5, prob=1, image_pad_value=0, mask_pad_value=0)
        aug_image, aug_mask, aug_joints, _, _ = aug(image, mask, joints, None, None)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/deci-ai/super-gradients/commit/cdc2f989667388ddf52be7c611b82eb7f44a7c74#diff-beac75d00e246b79476e214f72981cef09bdb69a98fb32aeb8a4c51cee33caa1L17' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 113211423</div><div id='project'> Project Name: deci-ai/super-gradients</div><div id='commit'> Commit Name: cdc2f989667388ddf52be7c611b82eb7f44a7c74</div><div id='time'> Time: 2023-03-16</div><div id='author'> Author: ekhvedchenya@gmail.com</div><div id='file'> File Name: tests/unit_tests/transforms_test.py</div><div id='m_class'> M Class Name: TestTransforms</div><div id='n_method'> N Class Name: TestTransforms</div><div id='m_method'> M Method Name: test_keypoints_random_affine(1)</div><div id='n_method'> N Method Name: test_keypoints_random_affine(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: tests/unit_tests/transforms_test.py</div><div id='n_file'> N File Name: tests/unit_tests/transforms_test.py</div><div id='m_start'> M Start Line: 19</div><div id='m_end'> M End Line: 30</div><div id='n_start'> N Start Line: 17</div><div id='n_end'> N End Line: 40</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            prev_rejected = not accepted

        rk_state = (fnew, tnew, ynew, h)
        return rk_state<a id="change">, t1_achieved</a>

class RK23(RKAdaptiveStepSolver):
    error_estimator_order = 2</code></pre><h3>After Change</h3><pre><code class='java'>
            if accepted:
                factor = torch.minimum(torch.full_like(new_factor, self.max_factor), new_factor)
                if prev_rejected:
                    factor<a id="change"> = </a>torch.minimum(<a id="change">torch.ones_like(</a>factor<a id="change">)</a>, factor)
                not_t1_achieved = torch.logical_not(t1_achieved)
                h[not_t1_achieved]<a id="change"> *= </a>factor[not_t1_achieved]

            else:
                factor = torch.maximum(torch.full_like(new_factor, self.min_factor), new_factor)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/xitorch/xitorch/commit/c6f0785664d60d1310778d43f14a3464660ea4d9#diff-1483d3ea142df8ec6c0e99905625e2421b3c2854fb87878e7255748ac68ae5a4L85' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 113211405</div><div id='project'> Project Name: xitorch/xitorch</div><div id='commit'> Commit Name: c6f0785664d60d1310778d43f14a3464660ea4d9</div><div id='time'> Time: 2021-12-30</div><div id='author'> Author: firman.kasim@gmail.com</div><div id='file'> File Name: xitorch/_impls/integrate/ivp/adaptive_rk.py</div><div id='m_class'> M Class Name: RKAdaptiveStepSolver</div><div id='n_method'> N Class Name: RKAdaptiveStepSolver</div><div id='m_method'> M Method Name: _single_step(3)</div><div id='n_method'> N Method Name: _single_step(3)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: xitorch/_impls/integrate/ivp/adaptive_rk.py</div><div id='n_file'> N File Name: xitorch/_impls/integrate/ivp/adaptive_rk.py</div><div id='m_start'> M Start Line: 85</div><div id='m_end'> M End Line: 122</div><div id='n_start'> N Start Line: 125</div><div id='n_end'> N End Line: 165</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    
    Returns D_e and D_o of setting 1 in the paper.
    
    dataset_e<a id="change">, dataset_o</a> = dataset_split_replay(dataset1, split_x)
    dataset_e[&quotflag&quot] = np.ones_like(dataset_e[&quotterminals&quot])
    dataset_o[&quotflag&quot] = np.zeros_like(dataset_o[&quotterminals&quot])
    return dataset_e, dataset_o</code></pre><h3>After Change</h3><pre><code class='java'>
    dataset_o[&quotflag&quot] = np.zeros_like(dataset_o[&quotterminals&quot])
    dataset_e, dataset_o_extra = dataset_split_expert(dataset1, split_x, exp_num)
    dataset_e[&quotflag&quot] = np.ones_like(dataset_e[&quotterminals&quot])
    dataset_o_extra[&quotflag&quot]<a id="change"> = </a><a id="change">np.ones_like(</a>dataset_o_extra[&quotterminals&quot]<a id="change">)</a>
    for key in dataset_o.keys():
        dataset_o[key]<a id="change"> = </a>np.concatenate([dataset_o[key], dataset_o_extra[key]], 0)
    return dataset_e, dataset_o

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ryanxhr/dwbc/commit/a1e9d8a068c478128dea0b07d55a375b064eab7e#diff-4a7de7f4ff6ba613447501d006265ff78387a94ba0c62dc90798d507a259573eL49' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 113211419</div><div id='project'> Project Name: ryanxhr/dwbc</div><div id='commit'> Commit Name: a1e9d8a068c478128dea0b07d55a375b064eab7e</div><div id='time'> Time: 2023-01-04</div><div id='author'> Author: xuhaoran8@jd.com</div><div id='file'> File Name: get_dataset.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: dataset_setting1(4)</div><div id='n_method'> N Method Name: dataset_setting1(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: get_dataset.py</div><div id='n_file'> N File Name: get_dataset.py</div><div id='m_start'> M Start Line: 49</div><div id='m_end'> M End Line: 55</div><div id='n_start'> N Start Line: 49</div><div id='n_end'> N End Line: 60</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        tail_mask = torch.arange(T, device=output.device).unsqueeze(0) &gt;= feat_lengths.unsqueeze(1)
        output[tail_mask] = 0

    return output<a id="change">, feat_lengths, alpha_sum.to(dtype), delay</a>
    return {
        "cif_out": [output],
        "cif_lengths": [feat_lengths],
        "alpha_sum": [alpha_sum.to(dtype)],</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 extend 1 fire and upscale the weights
        if extend_mask.any():
            &#47&#47 (B, T, C), may have infs so need the mask
            upscale<a id="change"> = </a>(
                <a id="change">torch.ones_like(</a>output<a id="change">)</a>
                .scatter(
                    1,
                    feat_lengths.view(B, 1, 1).expand(-1, -1, C),
                    beta / tail_weights.view(B, 1, 1).expand(-1, -1, C),
                )
            )
            output[extend_mask]<a id="change"> *= </a>upscale[extend_mask]
            feat_lengths += extend_mask.long()
            T = feat_lengths.max()
        output = output[:, :T, :]</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/george0828zhang/torch_cif/commit/68e2689c475308cd5043cf1d25c49891b23e946a#diff-32b811c4bee1b0d13968dded1dd3f2123be4bbc3124e6e5811c83d4fab99a456L23' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 113211417</div><div id='project'> Project Name: george0828zhang/torch_cif</div><div id='commit'> Commit Name: 68e2689c475308cd5043cf1d25c49891b23e946a</div><div id='time'> Time: 2022-02-23</div><div id='author'> Author: cc.chang0828@gmail.com</div><div id='file'> File Name: cif.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: cif_function(7)</div><div id='n_method'> N Method Name: cif_function(9)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: cif.py</div><div id='n_file'> N File Name: cif.py</div><div id='m_start'> M Start Line: 29</div><div id='m_end'> M End Line: 216</div><div id='n_start'> N Start Line: 27</div><div id='n_end'> N End Line: 197</div><BR>