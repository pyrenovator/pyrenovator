<html><h3>Pattern ID :10628
</h3><img src='36869922.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

def test_numericalize_adds_unknown_token(simple_vocab: Vocab):
    out = simple_vocab.numericalize(["a", "b", "c", "$"])
    <a id="change">assert </a>out == [5, 6, 7, simple_vocab.unknown_idx]


def test_numericalize_decode_is_bidirectionally_correct(simple_vocab: Vocab):</code></pre><h3>After Change</h3><pre><code class='java'>

def test_numericalize_adds_unknown_token(simple_vocab: Vocab):
    out = simple_vocab.numericalize(["a", "b", "c", "$"])
    expected<a id="change"> = </a><a id="change">torch.Tensor([</a>5, 6, 7, simple_vocab.unknown_idx<a id="change"></a>]<a id="change">)</a>
    assert (out == expected).all()


def test_numericalize_decode_is_bidirectionally_correct(simple_vocab: Vocab):</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/scart97/thunder-speech/commit/cde5060a2d5d8d5a0f73ec7a97839f3e469073a4#diff-484d77cbd3b69e31911bf99d11ca0033d61d9652f11c5c129be0c30b8b598f48L26' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 36869922</div><div id='project'> Project Name: scart97/thunder-speech</div><div id='commit'> Commit Name: cde5060a2d5d8d5a0f73ec7a97839f3e469073a4</div><div id='time'> Time: 2021-03-26</div><div id='author'> Author: scart.lucas@gmail.com</div><div id='file'> File Name: tests/test_text_vocab.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_numericalize_adds_unknown_token(1)</div><div id='n_method'> N Method Name: test_numericalize_adds_unknown_token(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_text_vocab.py</div><div id='n_file'> N File Name: tests/test_text_vocab.py</div><div id='m_start'> M Start Line: 26</div><div id='m_end'> M End Line: 26</div><div id='n_start'> N Start Line: 31</div><div id='n_end'> N End Line: 32</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        }))

    def test_all(self):
        <a id="change">assert </a>(self._DEMO_1 == self._DEMO_1).all()
        assert not (self._DEMO_1 == self._DEMO_2).all()

    def test_tolist(self):</code></pre><h3>After Change</h3><pre><code class='java'>
        }))

    def test_all(self):
        t1<a id="change"> = </a><a id="change">ttorch.Tensor({
            </a>&quota&quot: [True, True],
            &quotb&quot: {&quotx&quot: [[True, True, ], [True, True, ]]}<a id="change">
        }</a><a id="change">)</a>.all()
        assert isinstance(t1, torch.Tensor)
        assert t1.dtype == torch.bool
        assert t1</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/opendilab/di-treetensor/commit/f6e128a69ff108c161be319dc8a34264ab11eaf9#diff-de9c19d7e7748448be18bf5d285cdceafe2b32f97cb6b8d8f3a850d8539ec7fdL71' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 36869923</div><div id='project'> Project Name: opendilab/di-treetensor</div><div id='commit'> Commit Name: f6e128a69ff108c161be319dc8a34264ab11eaf9</div><div id='time'> Time: 2021-09-20</div><div id='author'> Author: killog@126.com</div><div id='file'> File Name: test/torch/test_tensor.py</div><div id='m_class'> M Class Name: TestTorchTensor</div><div id='n_method'> N Class Name: TestTorchTensor</div><div id='m_method'> M Method Name: test_all(1)</div><div id='n_method'> N Method Name: test_all(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: test/torch/test_tensor.py</div><div id='n_file'> N File Name: test/torch/test_tensor.py</div><div id='m_start'> M Start Line: 72</div><div id='m_end'> M End Line: 72</div><div id='n_start'> N Start Line: 73</div><div id='n_end'> N End Line: 87</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    predictions = torch.zeros(4, 10, 8)
    out_cost = cost(predictions, targets, lengths)
    <a id="change">assert </a>torch.all(torch.eq(out_cost, 1))
</code></pre><h3>After Change</h3><pre><code class='java'>
        device = torch.device("cuda")
        cost = ComputeCost(cost_type="transducer", blank_index=0)
        log_probs = (
            <a id="change">torch.Tensor(
                </a>[
                    [
                        [
                            [0.1, 0.6, 0.1, 0.1, 0.1],
                            <a id="change">[</a>0.1, 0.1, 0.6, 0.1, 0.1<a id="change"></a>],
                            [0.1, 0.1, 0.2, 0.8, 0.1],
                        ],
                        [
                            [0.1, 0.6, 0.1, 0.1, 0.1],
                            [0.1, 0.1, 0.2, 0.1, 0.1],
                            [0.7, 0.1, 0.2, 0.1, 0.1],
                        ],
                    ]
                ]<a id="change">
            )</a>
            .cuda()
            .requires_grad_()
            .log_softmax(dim=-1)
        )
        targets = torch.Tensor([[1, 2]]).to(device).int()
        probs_length = torch.Tensor([1.0]).to(device)
        target_length = torch.Tensor([1.0]).to(device)
        out_cost<a id="change"> = </a>cost(log_probs, targets, [probs_length, target_length])
        assert out_cost.item() == 4.49566650390625
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/speechbrain/speechbrain/commit/bd2a2aa5da0f2df26486cff5f602d1f8f97f57a0#diff-586d938827924995c7cc168f3a403eb172a62983ede41ecdac6890edeb518bd9L4' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 36869920</div><div id='project'> Project Name: speechbrain/speechbrain</div><div id='commit'> Commit Name: bd2a2aa5da0f2df26486cff5f602d1f8f97f57a0</div><div id='time'> Time: 2020-05-18</div><div id='author'> Author: a.heba@irit.fr</div><div id='file'> File Name: tests/unittests/test_losses.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_losses(0)</div><div id='n_method'> N Method Name: test_losses(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unittests/test_losses.py</div><div id='n_file'> N File Name: tests/unittests/test_losses.py</div><div id='m_start'> M Start Line: 28</div><div id='m_end'> M End Line: 35</div><div id='n_start'> N Start Line: 33</div><div id='n_end'> N End Line: 61</div><BR>