<html><h3>Pattern ID :15427
</h3><img src='52377006.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                confidence[:, task:task + 1] = avg_test_var

            predictions = self.scaler.inverse_transform(predictions)
            confidence<a id="change"> = </a>(self.scaler.inverse_transform(predictions +
                                                        confidence) -
                          <a id="change">self.scaler.inverse_transform(</a>predictions -
                                                        confidence<a id="change">)</a>)/2

            return predictions, confidence
</code></pre><h3>After Change</h3><pre><code class='java'>
            confidence[:, task:task + 1] = np.sqrt(avg_test_var)

        predictions = self.scaler.inverse_transform(predictions)
        <a id="change">return </a>predictions<a id="change">, self._scale_confidence(confidence)</a>


class RandomForestEstimator(DroppingEstimator):
    def compute_confidence(self, test_predictions):</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/aamini/chemprop/commit/59f9255e22db612b12c615473cfe42eb0fdb7630#diff-924093af4f0b2f23d513401ba28883251a8f99c68b3c14268d44a9dc4be67f5bL106' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 52377006</div><div id='project'> Project Name: aamini/chemprop</div><div id='commit'> Commit Name: 59f9255e22db612b12c615473cfe42eb0fdb7630</div><div id='time'> Time: 2019-10-01</div><div id='author'> Author: liortulip@gmail.com</div><div id='file'> File Name: chemprop/train/confidence_estimator.py</div><div id='m_class'> M Class Name: GaussianProcessEstimator</div><div id='n_method'> N Class Name: GaussianProcessEstimator</div><div id='m_method'> M Method Name: compute_confidence(2)</div><div id='n_method'> N Method Name: compute_confidence(2)</div><div id='m_parent_class'> M Parent Class: DroppingEstimator</div><div id='n_parent_class'> N Parent Class: DroppingEstimator</div><div id='m_file'> M File Name: chemprop/train/confidence_estimator.py</div><div id='n_file'> N File Name: chemprop/train/confidence_estimator.py</div><div id='m_start'> M Start Line: 106</div><div id='m_end'> M End Line: 143</div><div id='n_start'> N Start Line: 110</div><div id='n_end'> N End Line: 139</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            )
        else:
            &#47&#47 Apply denormalization
            pred_durations<a id="change"> = </a><a id="change">duration_out_scaler.inverse_transform(
                </a>max_mu.squeeze(0).cpu().data.numpy()<a id="change">
            )</a>
    else:
        &#47&#47 (T, D_out)
        pred_durations = (
            duration_model.inference(x, [x.shape[1]]).squeeze(0).cpu().data.numpy()</code></pre><h3>After Change</h3><pre><code class='java'>
            max_mu.squeeze(0).cpu().data.numpy()
        )

        <a id="change">return </a>max_mu<a id="change">, max_sigma_sq</a>
    else:
        &#47&#47 (T, D_out)
        pred_durations = (
            duration_model.inference(x, [x.shape[1]]).squeeze(0).cpu().data.numpy()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/r9y9/nnsvs/commit/62d633dac20c0e1e7adb346ea1fc83685a45727d#diff-128b2fc235a6273484455e56085dfa453023a77ecec68818f4c45c640a85918cL233' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 52377005</div><div id='project'> Project Name: r9y9/nnsvs</div><div id='commit'> Commit Name: 62d633dac20c0e1e7adb346ea1fc83685a45727d</div><div id='time'> Time: 2022-03-11</div><div id='author'> Author: zryuichi@gmail.com</div><div id='file'> File Name: nnsvs/gen.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: predict_duration(11)</div><div id='n_method'> N Method Name: predict_duration(11)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: nnsvs/gen.py</div><div id='n_file'> N File Name: nnsvs/gen.py</div><div id='m_start'> M Start Line: 281</div><div id='m_end'> M End Line: 304</div><div id='n_start'> N Start Line: 291</div><div id='n_end'> N End Line: 303</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            confidence[:, task] = avg_test_var

        predictions = self.scaler.inverse_transform(predictions)
        confidence<a id="change"> = </a>(<a id="change">self.scaler.inverse_transform(</a>predictions +
                                                    confidence<a id="change">)</a> -
                        self.scaler.inverse_transform(predictions -
                                                    confidence))/2
</code></pre><h3>After Change</h3><pre><code class='java'>

        predictions = self.scaler.inverse_transform(predictions)

        <a id="change">return </a>predictions<a id="change">,  self._scale_confidence(confidence)</a>


class EnsembleEstimator(ConfidenceEstimator):
    def __init__(self, train_data, val_data, test_data, scaler, args):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/aamini/chemprop/commit/59f9255e22db612b12c615473cfe42eb0fdb7630#diff-924093af4f0b2f23d513401ba28883251a8f99c68b3c14268d44a9dc4be67f5bL145' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 52377004</div><div id='project'> Project Name: aamini/chemprop</div><div id='commit'> Commit Name: 59f9255e22db612b12c615473cfe42eb0fdb7630</div><div id='time'> Time: 2019-10-01</div><div id='author'> Author: liortulip@gmail.com</div><div id='file'> File Name: chemprop/train/confidence_estimator.py</div><div id='m_class'> M Class Name: RandomForestEstimator</div><div id='n_method'> N Class Name: RandomForestEstimator</div><div id='m_method'> M Method Name: compute_confidence(2)</div><div id='n_method'> N Method Name: compute_confidence(2)</div><div id='m_parent_class'> M Parent Class: DroppingEstimator</div><div id='n_parent_class'> N Parent Class: DroppingEstimator</div><div id='m_file'> M File Name: chemprop/train/confidence_estimator.py</div><div id='n_file'> N File Name: chemprop/train/confidence_estimator.py</div><div id='m_start'> M Start Line: 161</div><div id='m_end'> M End Line: 171</div><div id='n_start'> N Start Line: 159</div><div id='n_end'> N End Line: 165</div><BR>