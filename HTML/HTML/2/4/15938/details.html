<html><h3>Pattern ID :15938
</h3><img src='53698179.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        output_file, tabular2graph):
    node_embeddings_file = node_embeddings_dir + "/" + node_embeddings_name + ".pt"
    mapped_node_embeddings_file = node_embeddings_dir + "/" + node_embeddings_name + "_mapped.pt"
    nmap_file = <a id="change">os.path.join(</a>partition_dir, "nmap.pt"<a id="change">)</a>

    with open(tabular2graph, "r") as file:
        config = yaml.safe_load(file)
</code></pre><h3>After Change</h3><pre><code class='java'>
            &quot"{}" is not an existing file&quot.format(node_embeddings_file)
        )
    node_emb = torch.load(node_embeddings_file)
    node_emb_arr<a id="change"> = node_emb.cpu()</a><a id="change">.detach().numpy()</a>
    node_emb_dict = {i: val for i, val in enumerate(node_emb_arr)}

    for i, node in enumerate(col_map.keys()):
        emb = pd.DataFrame(df[col_map[node]].map(node_emb_dict).tolist()).add_prefix(</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/oap-project/cloudtik/commit/d3bb0c12099085345b5c51e00a195cb273de8a30#diff-6c8e11a85a323acc07ef84e35a61168f5ef52d843ee9d5ee46b3016a2045d847L17' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 53698179</div><div id='project'> Project Name: oap-project/cloudtik</div><div id='commit'> Commit Name: d3bb0c12099085345b5c51e00a195cb273de8a30</div><div id='time'> Time: 2023-06-09</div><div id='author'> Author: haifeng.chen@intel.com</div><div id='file'> File Name: python/cloudtik/runtime/ai/modeling/graph_modeling/graph_sage/modeling/map_embeddings.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: map_embeddings(5)</div><div id='n_method'> N Method Name: map_embeddings(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: python/cloudtik/runtime/ai/modeling/graph_modeling/graph_sage/modeling/map_embeddings.py</div><div id='n_file'> N File Name: python/cloudtik/runtime/ai/modeling/graph_modeling/graph_sage/modeling/map_embeddings.py</div><div id='m_start'> M Start Line: 17</div><div id='m_end'> M End Line: 96</div><div id='n_start'> N Start Line: 112</div><div id='n_end'> N End Line: 165</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    img_fastmarch_output = sitk.GetImageFromArray(fastmarch_output)
    img_fastmarch_output.SetSpacing(spacing_raw)
    sitk.WriteImage(
        img_fastmarch_output, <a id="change">os.path.join(</a>image_folder, "image3d_dis1.nii.gz"<a id="change">)</a>
    )

    img_geodistkraster_output = sitk.GetImageFromArray(geodistkraster_output)
    img_geodistkraster_output.SetSpacing(spacing_raw)</code></pre><h3>After Change</h3><pre><code class='java'>
    seed_image_pt = seed_image_pt.to(device)

    tic = time.time()
    toivanenraster_output<a id="change"> = </a>np.squeeze(
        <a id="change">FastGeodis.generalised_geodesic3d_toivanen(
            input_image_pt, seed_image_pt, spacing, 1e10, 1.0, 4
        )
        .detach()
        .cpu()
        .numpy()</a>
    )
    toivanenraster_time = time.time() - tic
    
    tic = time.time()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/masadcv/fastgeodis/commit/a1906e989649c1f0b8fdbed147c1d576ac5c41f3#diff-d887faa28cfc61b3a52b0d171df805c6719ecc67166d4658c3360e84a2333a91L31' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 53698178</div><div id='project'> Project Name: masadcv/fastgeodis</div><div id='commit'> Commit Name: a1906e989649c1f0b8fdbed147c1d576ac5c41f3</div><div id='time'> Time: 2022-07-22</div><div id='author'> Author: muhammad.asad@kcl.ac.uk</div><div id='file'> File Name: samples/demo3d.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: demo_geodesic_distance3d(2)</div><div id='n_method'> N Method Name: demo_geodesic_distance3d(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: samples/demo3d.py</div><div id='n_file'> N File Name: samples/demo3d.py</div><div id='m_start'> M Start Line: 33</div><div id='m_end'> M End Line: 204</div><div id='n_start'> N Start Line: 17</div><div id='n_end'> N End Line: 181</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            PAD_TOKEN_ID = tokenizer.convert_tokens_to_ids([&quot[PAD]&quot])[0]
            while PAD_TOKEN_ID in prediction:                               &#47&#47 移除label中的 [PAD] token
                prediction.remove(PAD_TOKEN_ID)
            label_tokens.append(<a id="change">&quot&quot.join(</a>tokenizer.convert_ids_to_tokens(prediction)<a id="change">)</a>)
        
        used = time.time() - start_time
        print(f&quotUsed {used}s.&quot)</code></pre><h3>After Change</h3><pre><code class='java'>
            input_ids=tokenized_output[&quotinput_ids&quot].to(device),
            token_type_ids=tokenized_output[&quottoken_type_ids&quot].to(device)).logits
        
        predictions = <a id="change">convert_logits_to_ids(logits, tokenized_output[&quotmask_positions&quot]).cpu().numpy()</a>.tolist()  &#47&#47 (batch, label_num)
        predictions = verbalizer.batch_find_main_label(predictions)                                             &#47&#47 找到子label属于的主label
        predictions<a id="change"> = </a>[ele[&quotlabel&quot] for ele in predictions]
        used = time.time() - start_time
        print(f&quotUsed {used}s.&quot)
        return predictions</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/harderthenharder/transformers_tasks/commit/bf825bb22c43795f1e3a08cf8969ddc613051e76#diff-d21cbf985c91e426e300ad72220f1590149c9d24d0ec7884d541c3fd92d79b6bL41' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 53698175</div><div id='project'> Project Name: harderthenharder/transformers_tasks</div><div id='commit'> Commit Name: bf825bb22c43795f1e3a08cf8969ddc613051e76</div><div id='time'> Time: 2022-11-30</div><div id='author'> Author: pankeyu@pankeyus-MacBook-Pro.local</div><div id='file'> File Name: prompt_tasks/p-tuning/inference.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: inference(1)</div><div id='n_method'> N Method Name: inference(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: prompt_tasks/p-tuning/inference.py</div><div id='n_file'> N File Name: prompt_tasks/p-tuning/inference.py</div><div id='m_start'> M Start Line: 50</div><div id='m_end'> M End Line: 69</div><div id='n_start'> N Start Line: 59</div><div id='n_end'> N End Line: 80</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    total_files = len(file_names)

    for index in range(total_files):
        lr_image_path = <a id="change">os.path.join(</a>config.lr_dir, file_names[index]<a id="change">)</a>
        sr_image_path = os.path.join(config.sr_dir, file_names[index])
        hr_image_path = os.path.join(config.hr_dir, file_names[index])

        print(f"Processing `{os.path.abspath(hr_image_path)}`...")</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 Cal PSNR
        total_psnr += 10. * torch.log10(1. / torch.mean((sr_y_tensor - hr_y_tensor) ** 2))

        sr_y_image<a id="change"> = sr_y_tensor.mul_(255.0).cpu()</a><a id="change">.squeeze_(0).squeeze_(0).numpy()</a>
        sr_image = np.array([sr_y_image, bic_ycbcr[..., 1], bic_ycbcr[..., 2]]).transpose([1, 2, 0])
        sr_image = np.clip(imgproc.convert_ycbcr_to_rgb(sr_image), 0.0, 255.0).astype(np.uint8)
        sr_image = Image.fromarray(sr_image)
        sr_image.save(sr_image_path)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/lornatang/fsrcnn-pytorch/commit/5a0ecdd432cc264e98e446689348e5565a84ac1f#diff-58b7fc05c0526d9a9b3c0b50dda416fcbf0a654e696da4b6df82cbb5a6b2dcfcL27' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 53698173</div><div id='project'> Project Name: lornatang/fsrcnn-pytorch</div><div id='commit'> Commit Name: 5a0ecdd432cc264e98e446689348e5565a84ac1f</div><div id='time'> Time: 2021-11-19</div><div id='author'> Author: liuchangyu1111@gmail.com</div><div id='file'> File Name: validate.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: validate.py</div><div id='n_file'> N File Name: validate.py</div><div id='m_start'> M Start Line: 53</div><div id='m_end'> M End Line: 95</div><div id='n_start'> N Start Line: 63</div><div id='n_end'> N End Line: 98</div><BR>