<html><h3>Pattern ID :22111
</h3><img src='70056670.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        true_score = row[idx]

        &#47&#47 remove current label from scores
        row<a id="change"> = </a><a id="change">row.clone()</a>
        row[idx] = float("-Inf")

        &#47&#47 follow LibKGE protocol for ranking and ties
        rank = int(torch.sum(row &gt; true_score, dtype=torch.long))</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47 get the scores of the true target subjects/objects
    idx = 0 if direction == "s" else 2
    targets = test_spo[:, idx].long()
    arange<a id="change"> = </a>torch.arange(<a id="change">len(</a>targets<a id="change">)</a>, dtype=torch.long, device="cpu")
    true_scores = scores[arange, targets].view(-1, 1)

    &#47&#47 remove the true subjects/objects from the scores so they don&quott factor in rankings</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/tsafavi/codex/commit/3dddca246e4fb616cef251bafb32dac648e8eedb#diff-7473d3c6ae8fdca415f05877da582b17af17f591a0a1312717bb10fd4da4b992L129' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 70056670</div><div id='project'> Project Name: tsafavi/codex</div><div id='commit'> Commit Name: 3dddca246e4fb616cef251bafb32dac648e8eedb</div><div id='time'> Time: 2020-07-08</div><div id='author'> Author: tsafavi@umich.edu</div><div id='file'> File Name: scripts/baseline.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: evaluate_rankings(5)</div><div id='n_method'> N Method Name: evaluate_rankings(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: scripts/baseline.py</div><div id='n_file'> N File Name: scripts/baseline.py</div><div id='m_start'> M Start Line: 129</div><div id='m_end'> M End Line: 151</div><div id='n_start'> N Start Line: 129</div><div id='n_end'> N End Line: 148</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        self.mix_prob = mix_prob

    def forward(self, clean_waveform, clean_len):
        babbled_waveform<a id="change"> = </a><a id="change">clean_waveform.clone()</a>
        clean_len = (clean_len * clean_waveform.shape[1]).unsqueeze(1)
        batch_size = len(clean_waveform)

        &#47&#47 Don&quott mix (return early) 1-`mix_prob` portion of the batches</code></pre><h3>After Change</h3><pre><code class='java'>
        
        babbled_waveform = waveforms.clone()
        clean_len = (clean_len * waveforms.shape[1]).unsqueeze(1)
        batch_size<a id="change"> = </a><a id="change">len(</a>waveforms<a id="change">)</a>

        &#47&#47 Don&quott mix (return early) 1-`mix_prob` portion of the batches
        if torch.rand(1) &gt; self.mix_prob:
            return babbled_waveform</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/speechbrain/speechbrain/commit/84dc71648827262f8e75cd4744ae87cedbbfc294#diff-ef8b6f991a9b7ae57f5a46dd563bace5d8980a13b59fd9e5db2dc9b1034afab3L784' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 70056664</div><div id='project'> Project Name: speechbrain/speechbrain</div><div id='commit'> Commit Name: 84dc71648827262f8e75cd4744ae87cedbbfc294</div><div id='time'> Time: 2020-04-03</div><div id='author'> Author: plantinga.peter@gmail.com</div><div id='file'> File Name: speechbrain/processing/speech_augmentation.py</div><div id='m_class'> M Class Name: AddBabble</div><div id='n_method'> N Class Name: AddBabble</div><div id='m_method'> M Method Name: forward(3)</div><div id='n_method'> N Method Name: forward(3)</div><div id='m_parent_class'> M Parent Class: torch.nn.Module</div><div id='n_parent_class'> N Parent Class: torch.nn.Module</div><div id='m_file'> M File Name: speechbrain/processing/speech_augmentation.py</div><div id='n_file'> N File Name: speechbrain/processing/speech_augmentation.py</div><div id='m_start'> M Start Line: 785</div><div id='m_end'> M End Line: 795</div><div id='n_start'> N Start Line: 780</div><div id='n_end'> N End Line: 789</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    def handle_sample_response(self, sample_response):
        batch_id = sample_response.index.batch_id
        outputs = sample_response.outputs.clone()
        counts<a id="change"> = </a><a id="change">sample_response.counts.clone()</a>
        ret = self.manager.recv_sample(batch_id, outputs, counts)
        inputs, outputs, counts = ret
        index = MicroBatchIndex(batch_id, 0, 1)
        reindex_peer = self.comm.other_peers.local_reindex</code></pre><h3>After Change</h3><pre><code class='java'>
                self.manager.recv_feature(
                    batch_id, rank, len(res), features)
                continue
            index<a id="change"> = </a>MicroBatchIndex(batch_id, rank, <a id="change">len(</a>res<a id="change">)</a>)
            req = FeatureRequest(
                index, self.comm.global_rank, group_peers[rank], nodes)
            self.sync.request_queues[group_peers[rank]].put(req)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quiver-team/torch-quiver/commit/45c305a8da8b1ec8bead6a706f4959421780de2a#diff-0aaab1efeff5b5a87fa7351fc401595a5bd8533309dec24d4bd3336d317f6b1cL226' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 70056663</div><div id='project'> Project Name: quiver-team/torch-quiver</div><div id='commit'> Commit Name: 45c305a8da8b1ec8bead6a706f4959421780de2a</div><div id='time'> Time: 2021-10-05</div><div id='author'> Author: ee_dalong@163.com</div><div id='file'> File Name: benchmarks/ogbn_products_sage/proc.py</div><div id='m_class'> M Class Name: DataProcess</div><div id='n_method'> N Class Name: DataProcess</div><div id='m_method'> M Method Name: handle_sample_response(2)</div><div id='n_method'> N Method Name: handle_sample_response(2)</div><div id='m_parent_class'> M Parent Class: QuiverProcess</div><div id='n_parent_class'> N Parent Class: QuiverProcess</div><div id='m_file'> M File Name: benchmarks/ogbn_products_sage/proc.py</div><div id='n_file'> N File Name: benchmarks/ogbn_products_sage/proc.py</div><div id='m_start'> M Start Line: 227</div><div id='m_end'> M End Line: 236</div><div id='n_start'> N Start Line: 220</div><div id='n_end'> N End Line: 268</div><BR>