<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        true_score = row[idx]

        &#47&#47 remove current label from scores
        row<a id="change"> = </a><a id="change">row.clone()</a>
        row[idx] = float("-Inf")

        &#47&#47 follow LibKGE protocol for ranking and ties
        rank = int(torch.sum(row &gt; true_score, dtype=torch.long))</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47 get the scores of the true target subjects/objects
    idx = 0 if direction == "s" else 2
    targets = test_spo[:, idx].long()
    arange<a id="change"> = </a>torch.arange(<a id="change">len(</a>targets<a id="change">)</a>, dtype=torch.long, device="cpu")
    true_scores = scores[arange, targets].view(-1, 1)

    &#47&#47 remove the true subjects/objects from the scores so they don&quott factor in rankings</code></pre>