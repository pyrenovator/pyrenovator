<html><h3>Pattern ID :25424
</h3><img src='77640274.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        criterion = LogitPairwiseLoss()
        pos_inner_data = torch.ones(2, 1) * 3
        neg_inner_data = - torch.ones(2, 3) * 3
        loss = <a id="change">criterion(pos_inner_data, neg_inner_data).item()</a>

        pos_loss = - np.log(sigmoid(
            pos_inner_data.to("cpu").detach().numpy()
        )).sum()</code></pre><h3>After Change</h3><pre><code class='java'>
        neg_item_emb = torch.ones(3, 2, 5)

        user_bias = torch.zeros(3, 1)
        pos_item_bias = torch.zeros(3, 1)<a id="change"> * </a>2
        neg_item_bias = <a id="change">torch.zeros(</a>3, 2, 1<a id="change">)</a>

        loss<a id="change"> = </a>criterion(
            user_emb, pos_item_emb, neg_item_emb,
            user_bias, pos_item_bias, neg_item_bias
        ).item()</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/hand10ryo/pytorchcml/commit/bab75ff79e4e34d4bb9332eda0fcd9eb2e2a0628#diff-9a1fa018b8ccf34ae51dbf00c1745004f13ad236b464974b6ed5a2909b629910L26' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 77640274</div><div id='project'> Project Name: hand10ryo/pytorchcml</div><div id='commit'> Commit Name: bab75ff79e4e34d4bb9332eda0fcd9eb2e2a0628</div><div id='time'> Time: 2021-04-25</div><div id='author'> Author: hand10ryo@yahoo.co.jp</div><div id='file'> File Name: tests/losses/test_LogitPairwiseLoss.py</div><div id='m_class'> M Class Name: TestLogitPairwiseLoss</div><div id='n_method'> N Class Name: TestLogitPairwiseLoss</div><div id='m_method'> M Method Name: test_forward(1)</div><div id='n_method'> N Method Name: test_forward(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: tests/losses/test_LogitPairwiseLoss.py</div><div id='n_file'> N File Name: tests/losses/test_LogitPairwiseLoss.py</div><div id='m_start'> M Start Line: 26</div><div id='m_end'> M End Line: 37</div><div id='n_start'> N Start Line: 27</div><div id='n_end'> N End Line: 41</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    diff_tensor = torch.subtract(predictions, targets)
    for idx, theta in enumerate(parameters):
        mul_tensor = torch.matmul(diff_tensor, inputs[:, idx:idx + 1])
        updated_param.append(theta - (learning_rate * (<a id="change">torch.sum(mul_tensor).item()</a> / len(predictions))))

    return torch.FloatTensor(updated_param)
</code></pre><h3>After Change</h3><pre><code class='java'>
               predictions: np.ndarray,
               parameters: np.ndarray):

    updated_param = <a id="change">np.zeros(</a>parameters.shape<a id="change">, dtype=np.float64)</a>

    diff_arr = np.subtract(predictions, targets)

    for idx, theta in enumerate(parameters):
        mul_arr = np.matmul(diff_arr, inputs[:, idx:idx + 1])
        updated_param[idx]<a id="change"> += </a>theta - learning_rate<a id="change"> / </a>predictions.shape[0] * np.sum(mul_arr, dtype=np.float64)

    return updated_param
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/govindansriram/cobraml/commit/f0db299c51b0dc3f67917bac00f46a342eaa6fe2#diff-d4f9bcec12e741f05df1828033f8370da6f6feae9beb99252b34568ec6f50f83L4' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 77640259</div><div id='project'> Project Name: govindansriram/cobraml</div><div id='commit'> Commit Name: f0db299c51b0dc3f67917bac00f46a342eaa6fe2</div><div id='time'> Time: 2021-07-27</div><div id='author'> Author: sriramgovindanwork@gmail.com</div><div id='file'> File Name: Optimizers/GradientDescent.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: batch_grad(5)</div><div id='n_method'> N Method Name: batch_grad(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: Optimizers/GradientDescent.py</div><div id='n_file'> N File Name: Optimizers/GradientDescent.py</div><div id='m_start'> M Start Line: 4</div><div id='m_end'> M End Line: 12</div><div id='n_start'> N Start Line: 4</div><div id='n_end'> N End Line: 18</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            for i in range(batch_size):
                j = gt_select_units_num[i]
                if j &lt; select_size:
                    nums = min(units_size - 1, <a id="change">entity_nums[i].item()</a>)
                    nums = torch.tensor(nums, dtype=entity_nums.dtype, device=entity_nums.device)
                    gt_units[i, j] = L.tensor_one_hot(nums, units_size).long()
</code></pre><h3>After Change</h3><pre><code class='java'>
            select_size = gt_units.shape[1]
            units_size = gt_units.shape[2]

            padding = <a id="change">torch.zeros(</a>batch_size, 1, units_size<a id="change">, dtype=gt_units.dtype, device=gt_units.device)</a>
            token = torch.tensor(AHP.max_entities<a id="change"> - </a>1, dtype=padding.dtype, device=padding.device)
            padding[:, 0] = L.tensor_one_hot(token, units_size).reshape(-1)
            gt_units<a id="change"> = </a>torch.cat([gt_units, padding], dim=1)
            print(&quotgt_units&quot, gt_units) if debug else None
            print(&quotgt_units.shape&quot, gt_units.shape) if debug else None
            gt_units[torch.arange(batch_size), gt_select_units_num] = L.tensor_one_hot(entity_nums, units_size).long()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/liuruoze/mini-alphastar/commit/915eac43e5d4020880519d5c9094dc622a9acdfb#diff-7978248a58b83c8226c5cf781b99297dbb195bb84c7db92daa76f7c45a310454L162' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 77640265</div><div id='project'> Project Name: liuruoze/mini-alphastar</div><div id='commit'> Commit Name: 915eac43e5d4020880519d5c9094dc622a9acdfb</div><div id='time'> Time: 2021-12-15</div><div id='author'> Author: liuruoze@163.com</div><div id='file'> File Name: alphastarmini/core/arch/arch_model.py</div><div id='m_class'> M Class Name: ArchModel</div><div id='n_method'> N Class Name: ArchModel</div><div id='m_method'> M Method Name: sl_forward(9)</div><div id='n_method'> N Method Name: sl_forward(9)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: alphastarmini/core/arch/arch_model.py</div><div id='n_file'> N File Name: alphastarmini/core/arch/arch_model.py</div><div id='m_start'> M Start Line: 188</div><div id='m_end'> M End Line: 204</div><div id='n_start'> N Start Line: 188</div><div id='n_end'> N End Line: 212</div><BR>