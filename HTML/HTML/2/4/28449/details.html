<html><h3>Pattern ID :28449
</h3><img src='84208272.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        )

    classifier = PredictionHead(cfg.DATASET.NUM_CLASSES, cfg.CNN.OUTPUT_SHAPE)
    <a id="change">return </a>nn.Sequential(context_cnn, classifier)
</code></pre><h3>After Change</h3><pre><code class='java'>

    classifier = PredictionHead(cfg.DATASET.NUM_CLASSES, cfg.CNN.OUTPUT_SHAPE)
    net = nn.Sequential(context_cnn, classifier)
    optim<a id="change"> = </a><a id="change">torch.optim.SGD(
        net.parameters()</a><a id="change">, lr=cfg.SOLVER.BASE_LR, momentum=cfg.SOLVER.MOMENTUM, weight_decay=cfg.SOLVER.WEIGHT_DECAY
    )</a>
    model = CNNTransformerTrainer(model=net, optim=optim.state_dict(), cfg=cfg)
    return model, optim
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/pykale/pykale/commit/87a2deef0835f53ddf25dba3cf7f312e04d0b31b#diff-ad5f871cdd9a1156cc97bcb2fad2bb30c2a58c1901095bab9cec65c8df25614bL99' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 84208272</div><div id='project'> Project Name: pykale/pykale</div><div id='commit'> Commit Name: 87a2deef0835f53ddf25dba3cf7f312e04d0b31b</div><div id='time'> Time: 2023-03-29</div><div id='author'> Author: 93381130+HaolinWang2001@users.noreply.github.com</div><div id='file'> File Name: examples/cifar_cnntransformer/model.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: get_model(1)</div><div id='n_method'> N Method Name: get_model(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: examples/cifar_cnntransformer/model.py</div><div id='n_file'> N File Name: examples/cifar_cnntransformer/model.py</div><div id='m_start'> M Start Line: 99</div><div id='m_end'> M End Line: 100</div><div id='n_start'> N Start Line: 104</div><div id='n_end'> N End Line: 110</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    def __new__(cls, **kwargs):
        x = super(Optimizer, cls).__new__(**kwargs)
        <a id="change">return </a>x.optimizer


def create_loss_function(type):</code></pre><h3>After Change</h3><pre><code class='java'>
        if self.type==&quotRMSprop&quot:
            self.optimizer=torch.optim.RMSprop(self.classifier.parameters(), self.learning_rate)
        if self.type==&quotSGD&quot:
            self.optimizer<a id="change">=</a><a id="change">torch.optim.SGD(self.classifier.parameters()</a>, self.learning_rate<a id="change">)</a>
        return self.optimizer


def create_loss_function(type):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/radtorch/radtorch/commit/74eba02269194c439ff9240c292170a18abc83c0#diff-203dbc007b1e7a27456d652e0fd87290400c8cf18342d22638277a19a4266119L80' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 84208269</div><div id='project'> Project Name: radtorch/radtorch</div><div id='commit'> Commit Name: 74eba02269194c439ff9240c292170a18abc83c0</div><div id='time'> Time: 2020-04-06</div><div id='author'> Author: elbanan@users.noreply.github.com</div><div id='file'> File Name: radtorch/test.py</div><div id='m_class'> M Class Name: Optimizer</div><div id='n_method'> N Class Name: Optimizer</div><div id='m_method'> M Method Name: __new__(1)</div><div id='n_method'> N Method Name: __new__(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: radtorch/test.py</div><div id='n_file'> N File Name: radtorch/test.py</div><div id='m_start'> M Start Line: 81</div><div id='m_end'> M End Line: 82</div><div id='n_start'> N Start Line: 64</div><div id='n_end'> N End Line: 74</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        print(&quotepoch&quot, epoch, &quot:&quot, loss.item())

    <a id="change">return </a>ann


def test(ann):</code></pre><h3>After Change</h3><pre><code class='java'>
        optimizer = torch.optim.Adam(model.parameters(), lr=lr,
                                     weight_decay=args.weight_decay)
    else:
        optimizer<a id="change"> = </a><a id="change">torch.optim.SGD(model.parameters()</a><a id="change">, lr=lr,
                                    momentum=0.9, weight_decay=args.weight_decay)</a>
    for epoch in range(args.E):
        cnt = 0
        for (seq, label) in Dtr:
            cnt += 1</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ki-ljl/fedavg-numpy-pytorch-tff/commit/81ddcb66553dfbf12ad249af37c295376953f44e#diff-23d4bb2ba01aa66e0632d18429d5174281f1c47f275b761bd140e5325ef34213L150' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 84208270</div><div id='project'> Project Name: ki-ljl/fedavg-numpy-pytorch-tff</div><div id='commit'> Commit Name: 81ddcb66553dfbf12ad249af37c295376953f44e</div><div id='time'> Time: 2022-03-03</div><div id='author'> Author: lijunliang.ki@gmail.com</div><div id='file'> File Name: algorithms/fedavg-pytorch.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(3)</div><div id='n_method'> N Method Name: train(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: algorithms/fedavg-pytorch.py</div><div id='n_file'> N File Name: algorithms/fedavg-pytorch.py</div><div id='m_start'> M Start Line: 150</div><div id='m_end'> M End Line: 171</div><div id='n_start'> N Start Line: 135</div><div id='n_end'> N End Line: 166</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            print("Client[{}] Traning. Epoch {}/{}, Loss {:.4f}, Time {:.2f}s".
                  format(id, epoch + 1, epochs, loss_sum,
                         time() - time_begin))
        <a id="change">return </a>SerializationTool.serialize_model(model)

    def train(self, model_parameters, epochs, lr, batch_size, id_list, cuda):
        Train local model with different dataset according to id in id_list.</code></pre><h3>After Change</h3><pre><code class='java'>
        SerializationTool.deserialize_model(self._model, model_parameters)
        epochs = 5
        criterion = torch.nn.CrossEntropyLoss()
        optimizer<a id="change"> = </a><a id="change">torch.optim.SGD(self._model.parameters()</a><a id="change">, lr=0.1)</a>
        self._model.train()

        for _ in range(epochs):
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/smilelab-fl/fedlab/commit/16befdf9173a4b4f4430f456b5353765c6d4d3e3#diff-e01aa4d5e3a24cb22ed367c39c0994beb14dac9396433f905576a6531ad38c42L102' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 84208271</div><div id='project'> Project Name: smilelab-fl/fedlab</div><div id='commit'> Commit Name: 16befdf9173a4b4f4430f456b5353765c6d4d3e3</div><div id='time'> Time: 2021-08-08</div><div id='author'> Author: 928255708@qq.com</div><div id='file'> File Name: fedlab/core/client/serial_trainer.py</div><div id='m_class'> M Class Name: SerialTrainer</div><div id='n_method'> N Class Name: SerialTrainer</div><div id='m_method'> M Method Name: _train_alone(4)</div><div id='n_method'> N Method Name: _train_alone(8)</div><div id='m_parent_class'> M Parent Class: ClientTrainer</div><div id='n_parent_class'> N Parent Class: ClientTrainer</div><div id='m_file'> M File Name: fedlab/core/client/serial_trainer.py</div><div id='n_file'> N File Name: fedlab/core/client/serial_trainer.py</div><div id='m_start'> M Start Line: 102</div><div id='m_end'> M End Line: 137</div><div id='n_start'> N Start Line: 98</div><div id='n_end'> N End Line: 119</div><BR>