<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
		inputs = self.raw_time_series[:, 0, :].clone().unsqueeze(1).to(self.model.device)
		for _ in range(100):
			val_x_pred = self.model.get_prediction_trace(inputs)
			pvar<a id="change"> = </a>PVarianceLoss()(val_x_pred, <a id="change">self.raw_time_series.to(</a>val_x_pred.device<a id="change">)</a>)
			val_pvars.append(to_numpy(pvar).item())
		print(f"Validation PVariance: {np.mean(val_pvars):.3f}")
		return x_pred, self.raw_time_series</code></pre><h3>After Change</h3><pre><code class='java'>
			with torch.no_grad():
				pvar = PVarianceLoss()(x_pred, self.true_time_series.to(x_pred.device))
				mse = torch.nn.MSELoss()(x_pred, self.true_time_series.to(x_pred.device))
				val_pvar<a id="change"> = </a><a id="change">self.validate(</a>1<a id="change">)</a>
				progress_bar.set_postfix({
					"pvar": to_numpy(pvar).item(),
					"val_pvar": val_pvar,
					"MSE": to_numpy(mse).item()</code></pre>