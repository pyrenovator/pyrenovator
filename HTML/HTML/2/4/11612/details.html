<html><h3>Pattern ID :11612
</h3><img src='39287143.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        
        print("开始录音......")
        frames = []
        for i in range(0, <a id="change">int(</a>self.rate<a id="change"> / </a>self.chunk * record_seconds<a id="change">)</a>):
            data = self.stream.read(self.chunk)
            frames.append(data)
</code></pre><h3>After Change</h3><pre><code class='java'>
        print("开始录音......")
        num_frames = int(record_seconds * self.sample_rate)
        data = self.default_mic.record(samplerate=self.sample_rate, numframes=num_frames, channels=self.channels)
        audio_data<a id="change"> = </a><a id="change">data.squeeze()</a>
        print("录音已结束!")
        if save_path is not None:
            os.makedirs(os.path.dirname(save_path), exist_ok=True)
            soundfile.write(save_path, data=data, samplerate=self.sample_rate)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/yeyupiaoling/voiceprintrecognition-pytorch/commit/5c4517b82c3634a6908e35f143fb908e35fd71d8#diff-daa3f561c21def600c9ecfb843318cbd4498759e57be78a86047a8bba251d271L24' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 39287143</div><div id='project'> Project Name: yeyupiaoling/voiceprintrecognition-pytorch</div><div id='commit'> Commit Name: 5c4517b82c3634a6908e35f143fb908e35fd71d8</div><div id='time'> Time: 2023-03-23</div><div id='author'> Author: yeyupiaoling@foxmail.com</div><div id='file'> File Name: mvector/utils/record.py</div><div id='m_class'> M Class Name: RecordAudio</div><div id='n_method'> N Class Name: RecordAudio</div><div id='m_method'> M Method Name: record(3)</div><div id='n_method'> N Method Name: record(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: mvector/utils/record.py</div><div id='n_file'> N File Name: mvector/utils/record.py</div><div id='m_start'> M Start Line: 31</div><div id='m_end'> M End Line: 45</div><div id='n_start'> N Start Line: 24</div><div id='n_end'> N End Line: 30</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    &#47&#47 Get shape of input feature map and number of queries per object
    d, h, w = backbone_features.shape[-3:]
    num_queries = model_out[&quotpred_logits&quot].shape[-2]
    num_queries_per_object = <a id="change">int(</a>num_queries<a id="change"> / </a>20<a id="change">)</a>

    &#47&#47 Put everything to cpu
    model_out = {k: v.cpu().squeeze().reshape(20, num_queries_per_object, -1) for k, v in model_out.items() if k not in (&quotaux_outputs&quot, &quotpred_seg&quot)}
    seg_mask, backbone_features, dec_attn_weights = seg_mask.cpu().squeeze(), backbone_features.cpu(), dec_attn_weights.cpu().reshape(20, num_queries_per_object, -1)</code></pre><h3>After Change</h3><pre><code class='java'>
    dec_attn_weights = dec_attn_weights.mean(dim=0)

    if list(seg_mask.shape[1:]) != final_shape:
        seg_mask<a id="change"> = </a><a id="change">F.interpolate(seg_mask[None].float(), final_shape).squeeze()</a>

    &#47&#47 Get shape of input feature map and number of queries per object
    d, h, w = backbone_features.shape[-3:]
    num_queries = model_out[&quotpred_logits&quot].shape[-2]</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/bwittmann/transoar/commit/a2569c325e153054b88cf40cce54edd4c4f592a7#diff-743e05ef3ea5a1002871054ec996fa9b7f136e3e97159dba8836842c65faa64bL217' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 39287151</div><div id='project'> Project Name: bwittmann/transoar</div><div id='commit'> Commit Name: a2569c325e153054b88cf40cce54edd4c4f592a7</div><div id='time'> Time: 2022-06-21</div><div id='author'> Author: bastian.wittmann@tum.de</div><div id='file'> File Name: transoar/utils/visualization.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: save_attn_visualization(10)</div><div id='n_method'> N Method Name: save_attn_visualization(8)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: transoar/utils/visualization.py</div><div id='n_file'> N File Name: transoar/utils/visualization.py</div><div id='m_start'> M Start Line: 225</div><div id='m_end'> M End Line: 230</div><div id='n_start'> N Start Line: 219</div><div id='n_end'> N End Line: 265</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        
        print("开始录音......")
        frames = []
        for i in range(0, <a id="change">int(</a>self.rate<a id="change"> / </a>self.chunk * record_seconds<a id="change">)</a>):
            data = self.stream.read(self.chunk)
            frames.append(data)
</code></pre><h3>After Change</h3><pre><code class='java'>
        print("开始录音......")
        num_frames = int(record_seconds * self.sample_rate)
        data = self.default_mic.record(samplerate=self.sample_rate, numframes=num_frames, channels=self.channels)
        audio_data<a id="change"> = </a><a id="change">data.squeeze()</a>
        print("录音已结束!")
        if save_path is not None:
            os.makedirs(os.path.dirname(save_path), exist_ok=True)
            soundfile.write(save_path, data=data, samplerate=self.sample_rate)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/yeyupiaoling/audioclassification-pytorch/commit/4e40d2876f4e146adf88a406af712366ff36d830#diff-372e3443ea76f582317c62a8b741bc051cfefd414fae0fda934132a60f131ef8L23' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 39287149</div><div id='project'> Project Name: yeyupiaoling/audioclassification-pytorch</div><div id='commit'> Commit Name: 4e40d2876f4e146adf88a406af712366ff36d830</div><div id='time'> Time: 2023-03-23</div><div id='author'> Author: yeyupiaoling@foxmail.com</div><div id='file'> File Name: macls/utils/record.py</div><div id='m_class'> M Class Name: RecordAudio</div><div id='n_method'> N Class Name: RecordAudio</div><div id='m_method'> M Method Name: record(3)</div><div id='n_method'> N Method Name: record(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: macls/utils/record.py</div><div id='n_file'> N File Name: macls/utils/record.py</div><div id='m_start'> M Start Line: 31</div><div id='m_end'> M End Line: 45</div><div id='n_start'> N Start Line: 24</div><div id='n_end'> N End Line: 30</div><BR>