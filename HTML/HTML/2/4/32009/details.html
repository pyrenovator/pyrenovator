<html><h3>Pattern ID :32009
</h3><img src='93513538.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            tg, tg2 = torch.distributions.Geometric(prob),torch.distributions.Geometric(prob2)
            assert np.allclose(jg.entropy().data,tg.entropy().numpy())
            x = np.random.randint(1,10)
            <a id="change">assert </a>np.allclose(jg.log_prob(x),tg.log_prob(torch.tensor(x)))
            &#47&#47 print(jd.kl_divergence(jg,jg2),torch.distributions.kl_divergence(tg,tg2))
            assert np.allclose(jd.kl_divergence(jg,jg2),torch.distributions.kl_divergence(tg,tg2))
</code></pre><h3>After Change</h3><pre><code class='java'>
            tg, tg2 = torch.distributions.Geometric(prob),torch.distributions.Geometric(prob2)
            np.testing.assert_allclose(jg.entropy().data,tg.entropy().numpy(), atol=1e-4)
            x = np.random.randint(1,10)
            <a id="change">np.testing.assert_allclose(</a><a id="change">jg.log_prob(</a>x<a id="change">)</a>,<a id="change">tg.log_prob(</a>torch.tensor(x)<a id="change">)</a><a id="change">, atol=1e-4)</a>
            &#47&#47 print(jd.kl_divergence(jg,jg2),torch.distributions.kl_divergence(tg,tg2))
            np.testing.assert_allclose(jd.kl_divergence(jg,jg2),torch.distributions.kl_divergence(tg,tg2), atol=1e-4)

if __name__ == "__main__":</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/jittor/jittor/commit/4ec2bfacb22034e3b3cddbd1d73e3b9c45accecb#diff-77a4333402bd2ffe550b5dee1fbbf6addf80e5724d4ffd9f346a1998a194aaddL101' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 93513538</div><div id='project'> Project Name: jittor/jittor</div><div id='commit'> Commit Name: 4ec2bfacb22034e3b3cddbd1d73e3b9c45accecb</div><div id='time'> Time: 2021-06-17</div><div id='author'> Author: randonlang@gmail.com</div><div id='file'> File Name: python/jittor/test/test_distributions.py</div><div id='m_class'> M Class Name: TestOneHot</div><div id='n_method'> N Class Name: TestOneHot</div><div id='m_method'> M Method Name: test_geometric(1)</div><div id='n_method'> N Method Name: test_geometric(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: python/jittor/test/test_distributions.py</div><div id='n_file'> N File Name: python/jittor/test/test_distributions.py</div><div id='m_start'> M Start Line: 101</div><div id='m_end'> M End Line: 105</div><div id='n_start'> N Start Line: 139</div><div id='n_end'> N End Line: 143</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        for _ in range(4):
            nx = np.random.randint(0,9)    
            x[_,nx] = 1
        <a id="change">assert </a>np.allclose(jc.log_prob(jt.array(x)),tc.log_prob(torch.tensor(x)))
        assert np.allclose(jd.kl_divergence(jc,jc2),torch.distributions.kl_divergence(tc,tc2))

    def test_cate(self):</code></pre><h3>After Change</h3><pre><code class='java'>
        for _ in range(4):
            nx = np.random.randint(0,9)    
            x[_,nx] = 1
        <a id="change">np.testing.assert_allclose(jc.log_prob(</a>jt.array(x)<a id="change">)</a>,<a id="change">tc.log_prob(</a>torch.tensor(x)<a id="change">), atol=1e-5)</a>
        assert np.allclose(jd.kl_divergence(jc,jc2),torch.distributions.kl_divergence(tc,tc2))

    def test_cate(self):
        a = jd.Categorical(jt.array([0.25, 0.25, 0.25, 0.25]))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jittor/jittor/commit/4ec2bfacb22034e3b3cddbd1d73e3b9c45accecb#diff-77a4333402bd2ffe550b5dee1fbbf6addf80e5724d4ffd9f346a1998a194aaddL22' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 93513542</div><div id='project'> Project Name: jittor/jittor</div><div id='commit'> Commit Name: 4ec2bfacb22034e3b3cddbd1d73e3b9c45accecb</div><div id='time'> Time: 2021-06-17</div><div id='author'> Author: randonlang@gmail.com</div><div id='file'> File Name: python/jittor/test/test_distributions.py</div><div id='m_class'> M Class Name: TestOneHot</div><div id='n_method'> N Class Name: TestOneHot</div><div id='m_method'> M Method Name: test_one_hot(1)</div><div id='n_method'> N Method Name: test_one_hot(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: python/jittor/test/test_distributions.py</div><div id='n_file'> N File Name: python/jittor/test/test_distributions.py</div><div id='m_start'> M Start Line: 34</div><div id='m_end'> M End Line: 41</div><div id='n_start'> N Start Line: 34</div><div id='n_end'> N End Line: 41</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            tn = torch.distributions.Normal(mu,sigma)
            assert np.allclose(jn.entropy().data,tn.entropy().numpy())
            x = np.random.uniform(-1,1)
            <a id="change">assert </a>np.allclose(jn.log_prob(x),tn.log_prob(torch.tensor(x)))
            mu2 = np.random.uniform(-1,1)
            sigma2 = np.random.uniform(0,2)
            jn2 = jd.Normal(mu2,sigma2)</code></pre><h3>After Change</h3><pre><code class='java'>
            tn = torch.distributions.Normal(mu,sigma)
            assert np.allclose(jn.entropy().data,tn.entropy().numpy())
            x = np.random.uniform(-1,1)
            <a id="change">np.testing.assert_allclose(jn.log_prob(</a>x<a id="change">)</a>,<a id="change">tn.log_prob(</a>torch.tensor(x)<a id="change">))</a>
            mu2 = np.random.uniform(-1,1)
            sigma2 = np.random.uniform(0,2)
            jn2 = jd.Normal(mu2,sigma2)
            tn2 = torch.distributions.Normal(mu2,sigma2)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jittor/jittor/commit/740b9c8552c4533910b58dcb38d88cafba86d530#diff-77a4333402bd2ffe550b5dee1fbbf6addf80e5724d4ffd9f346a1998a194aaddL64' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 93513535</div><div id='project'> Project Name: jittor/jittor</div><div id='commit'> Commit Name: 740b9c8552c4533910b58dcb38d88cafba86d530</div><div id='time'> Time: 2021-09-28</div><div id='author'> Author: randonlang@gmail.com</div><div id='file'> File Name: python/jittor/test/test_distributions.py</div><div id='m_class'> M Class Name: TestOneHot</div><div id='n_method'> N Class Name: TestOneHot</div><div id='m_method'> M Method Name: test_normal(1)</div><div id='n_method'> N Method Name: test_normal(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: python/jittor/test/test_distributions.py</div><div id='n_file'> N File Name: python/jittor/test/test_distributions.py</div><div id='m_start'> M Start Line: 72</div><div id='m_end'> M End Line: 72</div><div id='n_start'> N Start Line: 72</div><div id='n_end'> N End Line: 72</div><BR>