<html><h3>Pattern ID :15171
</h3><img src='51355258.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        return True

    def config(self, **kwargs):
        <a id="change">super().config(</a>kwargs.get("dump_all", None), kwargs.get("exclude", None)<a id="change">)</a>


class DropnaProcessor(Processor):
    def __init__(self, fields_group=None):</code></pre><h3>After Change</h3><pre><code class='java'>
    def config(self, **kwargs):
        attr_list = {"fit_start_time", "fit_end_time"}
        for k, v in kwargs.items():
            <a id="change">if k in attr_list</a> and getattr(self, k, None) is not None:
                setattr(self, k, v)

        for attr in attr_list:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/136830bc2bf8281838d96c22fb0cdd45e93ae16b#diff-7fdf61477b7d24b096bddacd2610e31608739cb1e8faa3529f8798ce0d47a9bdL76' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 51355258</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: 136830bc2bf8281838d96c22fb0cdd45e93ae16b</div><div id='time'> Time: 2021-03-29</div><div id='author'> Author: bxddream@gmail.com</div><div id='file'> File Name: qlib/data/dataset/processor.py</div><div id='m_class'> M Class Name: Processor</div><div id='n_method'> N Class Name: Processor</div><div id='m_method'> M Method Name: config(1)</div><div id='n_method'> N Method Name: config(1)</div><div id='m_parent_class'> M Parent Class: Serializable</div><div id='n_parent_class'> N Parent Class: Serializable</div><div id='m_file'> M File Name: qlib/data/dataset/processor.py</div><div id='n_file'> N File Name: qlib/data/dataset/processor.py</div><div id='m_start'> M Start Line: 76</div><div id='m_end'> M End Line: 76</div><div id='n_start'> N Start Line: 76</div><div id='n_end'> N End Line: 84</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        return True

    def config(self, **kwargs):
        <a id="change">super().config(</a>kwargs.get("dump_all", None), kwargs.get("exclude", None)<a id="change">)</a>


class DropnaProcessor(Processor):
    def __init__(self, fields_group=None):</code></pre><h3>After Change</h3><pre><code class='java'>

    def config(self, **kwargs):
        attr_list = {"fit_start_time", "fit_end_time"}
        for k, <a id="change">v</a> in kwargs.items():
            <a id="change">if </a>k in attr_list and <a id="change">getattr(self, k, None) is not None</a>:
                setattr(self, k, v)

        for attr in attr_list:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/136830bc2bf8281838d96c22fb0cdd45e93ae16b#diff-7fdf61477b7d24b096bddacd2610e31608739cb1e8faa3529f8798ce0d47a9bdL75' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 51355257</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: 136830bc2bf8281838d96c22fb0cdd45e93ae16b</div><div id='time'> Time: 2021-03-29</div><div id='author'> Author: bxddream@gmail.com</div><div id='file'> File Name: qlib/data/dataset/processor.py</div><div id='m_class'> M Class Name: Processor</div><div id='n_method'> N Class Name: Processor</div><div id='m_method'> M Method Name: config(1)</div><div id='n_method'> N Method Name: config(1)</div><div id='m_parent_class'> M Parent Class: Serializable</div><div id='n_parent_class'> N Parent Class: Serializable</div><div id='m_file'> M File Name: qlib/data/dataset/processor.py</div><div id='n_file'> N File Name: qlib/data/dataset/processor.py</div><div id='m_start'> M Start Line: 76</div><div id='m_end'> M End Line: 76</div><div id='n_start'> N Start Line: 76</div><div id='n_end'> N End Line: 84</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            raise ValueError("model is not fitted yet!")

        dl_test = dataset.prepare("test", col_set=["feature", "label"], data_key=DataHandlerLP.DK_I)
        <a id="change">dl_test.config(fillna_type="ffill+bfill")</a>
        test_loader = DataLoader(dl_test, batch_size=self.batch_size, num_workers=self.n_jobs)
        self.model.eval()
        preds = []</code></pre><h3>After Change</h3><pre><code class='java'>
        sample_num = x_values.shape[0]
        preds = []

        for <a id="change">begin</a> in range(sample_num)[:: self.batch_size]:

            <a id="change">if sample_num - begin &lt; self.batch_size</a>:
                end = sample_num
            else:
                end = begin + self.batch_size</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/bee031af68cd0864c8329de13608c2d4feb58fc1#diff-82a48ba3edeb02bda1232a9cf7a21b13b2ab82fa992719af2e4494d6fe969887L206' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 51355256</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: bee031af68cd0864c8329de13608c2d4feb58fc1</div><div id='time'> Time: 2021-07-21</div><div id='author'> Author: yl3851@uw.edu</div><div id='file'> File Name: qlib/contrib/model/pytorch_transformer.py</div><div id='m_class'> M Class Name: TransformerModel</div><div id='n_method'> N Class Name: TransformerModel</div><div id='m_method'> M Method Name: predict(3)</div><div id='n_method'> N Method Name: predict(2)</div><div id='m_parent_class'> M Parent Class: Model</div><div id='n_parent_class'> N Parent Class: Model</div><div id='m_file'> M File Name: qlib/contrib/model/pytorch_transformer.py</div><div id='n_file'> N File Name: qlib/contrib/model/pytorch_transformer.py</div><div id='m_start'> M Start Line: 206</div><div id='m_end'> M End Line: 220</div><div id='n_start'> N Start Line: 222</div><div id='n_end'> N End Line: 243</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            raise ValueError("model is not fitted yet!")

        dl_test = dataset.prepare("test", col_set=["feature", "label"], data_key=DataHandlerLP.DK_I)
        <a id="change">dl_test.config(fillna_type="ffill+bfill")</a>
        test_loader = DataLoader(dl_test, batch_size=self.batch_size, num_workers=self.n_jobs)
        self.model.eval()
        preds = []</code></pre><h3>After Change</h3><pre><code class='java'>
        sample_num = x_values.shape[0]
        preds = []

        for <a id="change">begin</a> in range(sample_num)[:: self.batch_size]:

            <a id="change">if sample_num - begin &lt; self.batch_size</a>:
                end = sample_num
            else:
                end = begin + self.batch_size</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/bee031af68cd0864c8329de13608c2d4feb58fc1#diff-fe0bd624f58dd8fe7dd95d97a1d8ef4de2800a5a92cb439e19aee34c6628b9bfL209' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 51355255</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: bee031af68cd0864c8329de13608c2d4feb58fc1</div><div id='time'> Time: 2021-07-21</div><div id='author'> Author: yl3851@uw.edu</div><div id='file'> File Name: qlib/contrib/model/pytorch_localformer.py</div><div id='m_class'> M Class Name: LocalformerModel</div><div id='n_method'> N Class Name: LocalformerModel</div><div id='m_method'> M Method Name: predict(3)</div><div id='n_method'> N Method Name: predict(2)</div><div id='m_parent_class'> M Parent Class: Model</div><div id='n_parent_class'> N Parent Class: Model</div><div id='m_file'> M File Name: qlib/contrib/model/pytorch_localformer.py</div><div id='n_file'> N File Name: qlib/contrib/model/pytorch_localformer.py</div><div id='m_start'> M Start Line: 209</div><div id='m_end'> M End Line: 223</div><div id='n_start'> N Start Line: 223</div><div id='n_end'> N End Line: 244</div><BR>