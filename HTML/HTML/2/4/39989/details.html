<html><h3>Pattern ID :39989
</h3><img src='113713527.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    dataset_module = dataset_module_factory(
        path, download_config=download_config, force_local_path=local_path, **download_kwargs
    )
    <a id="change">print(
        f"The processing script for dataset {path} can be inspected at {local_path}. "
        f"The main class is in {dataset_module.module_path}. "
        f"You can modify this processing script and use it with `datasets.load_dataset({local_path})`."</a><a id="change">
    )</a>


def inspect_metric(path: str, local_path: str, download_config: Optional[DownloadConfig] = None, **download_kwargs):
    r</code></pre><h3>After Change</h3><pre><code class='java'>
            the attributes of `download_config` if supplied.
    
    dataset_module = dataset_module_factory(path, download_config=download_config, **download_kwargs)
    builder_cls<a id="change"> = </a>import_main_class(dataset_module.module_path, dataset=True)
    module_source_path = inspect.getsourcefile(builder_cls)
    module_source_dirpath = os.path.dirname(module_source_path)
    for dirpath, dirnames, filenames in os.walk(module_source_dirpath):
        dst_dirpath = os.path.join(local_path, os.path.relpath(dirpath, module_source_dirpath))
        <a id="change">os.makedirs(</a>dst_dirpath<a id="change">, exist_ok=True)</a>
        &#47&#47 skipping hidden directories; prune the search
        &#47&#47 [:] for the in-place list modification required by os.walk
        dirnames[:] = [dirname for dirname in dirnames if not dirname.startswith((".", "__"))]
        for filename in filenames:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/huggingface/datasets/commit/8239e7968ddcaaf6a9eff9297a5431478c1e0242#diff-18ce4c83cac98e6a65b00b0bf62b244153c55556f8597ca43c179bfa0d7ad5a7L124' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 113713527</div><div id='project'> Project Name: huggingface/datasets</div><div id='commit'> Commit Name: 8239e7968ddcaaf6a9eff9297a5431478c1e0242</div><div id='time'> Time: 2022-06-09</div><div id='author'> Author: mariosasko777@gmail.com</div><div id='file'> File Name: src/datasets/inspect.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: inspect_dataset(3)</div><div id='n_method'> N Method Name: inspect_dataset(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/datasets/inspect.py</div><div id='n_file'> N File Name: src/datasets/inspect.py</div><div id='m_start'> M Start Line: 124</div><div id='m_end'> M End Line: 128</div><div id='n_start'> N Start Line: 126</div><div id='n_end'> N End Line: 144</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    metric_module = metric_module_factory(
        path, download_config=download_config, force_local_path=local_path, **download_kwargs
    )
    <a id="change">print(
        f"The processing scripts for metric {path} can be inspected at {local_path}. "
        f"The main class is in {metric_module.module_path}. "
        f"You can modify this processing scripts and use it with `datasets.load_metric({local_path})`."</a><a id="change">
    )</a>


def get_dataset_infos(
    path: str,</code></pre><h3>After Change</h3><pre><code class='java'>
        **download_kwargs (additional keyword arguments): optional attributes for DownloadConfig() which will override the attributes in download_config if supplied.
    
    metric_module = metric_module_factory(path, download_config=download_config, **download_kwargs)
    builder_cls<a id="change"> = </a>import_main_class(metric_module.module_path, dataset=False)
    module_source_path = inspect.getsourcefile(builder_cls)
    module_source_dirpath = os.path.dirname(module_source_path)
    for dirpath, dirnames, filenames in os.walk(module_source_dirpath):
        dst_dirpath = os.path.join(local_path, os.path.relpath(dirpath, module_source_dirpath))
        <a id="change">os.makedirs(</a>dst_dirpath<a id="change">, exist_ok=True)</a>
        &#47&#47 skipping hidden directories; prune the search
        dirnames[:] = [dirname for dirname in dirnames if not dirname.startswith((".", "__"))]
        for filename in filenames:
            shutil.copy2(os.path.join(dirpath, filename), os.path.join(dst_dirpath, filename))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/datasets/commit/8239e7968ddcaaf6a9eff9297a5431478c1e0242#diff-18ce4c83cac98e6a65b00b0bf62b244153c55556f8597ca43c179bfa0d7ad5a7L131' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 113713524</div><div id='project'> Project Name: huggingface/datasets</div><div id='commit'> Commit Name: 8239e7968ddcaaf6a9eff9297a5431478c1e0242</div><div id='time'> Time: 2022-06-09</div><div id='author'> Author: mariosasko777@gmail.com</div><div id='file'> File Name: src/datasets/inspect.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: inspect_metric(3)</div><div id='n_method'> N Method Name: inspect_metric(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/datasets/inspect.py</div><div id='n_file'> N File Name: src/datasets/inspect.py</div><div id='m_start'> M Start Line: 149</div><div id='m_end'> M End Line: 153</div><div id='n_start'> N Start Line: 162</div><div id='n_end'> N End Line: 179</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            print(&quottrain_loss&quot,loss)
            
            eval_score = self.evaluation(args, data)
            <a id="change">print(&quoteval_score&quot</a>, eval_score<a id="change">)</a>
            
            if eval_score &gt;= self.best_eval_score:
                best_model = copy.deepcopy(self.model)
                wait = 0</code></pre><h3>After Change</h3><pre><code class='java'>
        self.model = best_model

        if args.save_model:
            pretrained_model_dir<a id="change"> = </a>os.path.join(args.method_output_dir, &quotpretrain&quot)
            if not os.path.exists(pretrained_model_dir):
                <a id="change">os.makedirs(</a>pretrained_model_dir<a id="change">)</a>
            save_model(self.model, pretrained_model_dir)
        
    def get_outputs(self, args, mode = &quoteval&quot):
        </code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/thuiar/textoir/commit/4f0068bc25a3a26da045579505b16f4458389c60#diff-f247534295e46ad22b9247198c94dfeff934046fe3fa4dde83add533bb77c39aL43' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 113713520</div><div id='project'> Project Name: thuiar/textoir</div><div id='commit'> Commit Name: 4f0068bc25a3a26da045579505b16f4458389c60</div><div id='time'> Time: 2021-08-02</div><div id='author'> Author: zhang-hl20@mails.tsinghua.edu.cn</div><div id='file'> File Name: open_intent_discovery/methods/semi_supervised/KCL_BERT/pretrain.py</div><div id='m_class'> M Class Name: PretrainKCLManager</div><div id='n_method'> N Class Name: PretrainKCLManager</div><div id='m_method'> M Method Name: train(3)</div><div id='n_method'> N Method Name: train(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: open_intent_discovery/methods/semi_supervised/KCL_BERT/pretrain.py</div><div id='n_file'> N File Name: open_intent_discovery/methods/semi_supervised/KCL_BERT/pretrain.py</div><div id='m_start'> M Start Line: 51</div><div id='m_end'> M End Line: 81</div><div id='n_start'> N Start Line: 56</div><div id='n_end'> N End Line: 113</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        self.initOutputDir()

    def initOutputDir(self):
        <a id="change">print(&quotdebug output: &quot</a>,self.conf.output_dir<a id="change">)</a>
        if not os.path.exists(self.conf.output_dir):
            os.makedirs(self.conf.output_dir)

    def initCriterion(self):</code></pre><h3>After Change</h3><pre><code class='java'>
        if self.conf.output_dir != &quotoutput&quot:
            LOG.logW("According deepvac standard, you should save model files to output directory.")

        self.output_dir<a id="change"> = </a>&quot{}/{}&quot.format(self.conf.output_dir, self.branch)
        LOG.logI(&quotmodel save dir: {}&quot.format(self.output_dir))
        if not os.path.exists(self.output_dir):
            <a id="change">os.makedirs(</a>self.output_dir<a id="change">)</a>

    def initCriterion(self):
        raise Exception("Not implemented.")
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/deepvac/deepvac/commit/3b213bca0d6d1b367825d4b70cf606d5108b9bf2#diff-11bb5c4c3a591161a919c23224a176d9b4ce4fc8982d195677f0aa5726544e24L182' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 113713531</div><div id='project'> Project Name: deepvac/deepvac</div><div id='commit'> Commit Name: 3b213bca0d6d1b367825d4b70cf606d5108b9bf2</div><div id='time'> Time: 2020-07-31</div><div id='author'> Author: gemfield@civilnet.cn</div><div id='file'> File Name: lib/syszux_deepvac.py</div><div id='m_class'> M Class Name: DeepvacTrain</div><div id='n_method'> N Class Name: DeepvacTrain</div><div id='m_method'> M Method Name: initOutputDir(1)</div><div id='n_method'> N Method Name: initOutputDir(1)</div><div id='m_parent_class'> M Parent Class: Deepvac</div><div id='n_parent_class'> N Parent Class: Deepvac</div><div id='m_file'> M File Name: lib/syszux_deepvac.py</div><div id='n_file'> N File Name: lib/syszux_deepvac.py</div><div id='m_start'> M Start Line: 183</div><div id='m_end'> M End Line: 185</div><div id='n_start'> N Start Line: 183</div><div id='n_end'> N End Line: 189</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    
    
    if os.path.exists(local_dir) and os.path.join(local_dir, hparams_file):
        <a id="change">print("Model already exists locally, loading local copy"</a><a id="change">)</a>
    else:
        _fetch_all_from_hub(hub_modelID, local_dir, **huggingface_kwargs)
    return os.path.join(local_dir, hparams_file)
</code></pre><h3>After Change</h3><pre><code class='java'>

def fetch(local_path, filename, hub_modelID=None, **download_kwargs):

    local_path<a id="change"> = </a>os.path.abspath(local_path)
    local_abs_path = os.path.join(local_path, filename)
    if os.path.isfile(local_abs_path):
        logger.info(
            "Requested file {} exists locally, using local copy.".format(
                filename
            )
        )
    else:
        if hub_modelID is None:
            logger.error(
                "Requested file {} does not exists locally. It can be downloaded from HuggingFace ModelHub using &quothub_modelID&quot argument".format(
                    filename
                )
            )
            raise FileNotFoundError

        <a id="change">os.makedirs(</a>local_path<a id="change">)</a>

        url = huggingface_hub.hf_hub_url(hub_modelID, filename)
        logger.info(
            "Downloading requested file {} from {}.".format(filename, url)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/speechbrain/speechbrain/commit/047a182c95cda8c7cfd48eebe8e51668ef1e1ab8#diff-6332605fb909b83ff80819220ae5281dc964c4ecd14251a925a5f43e8f05e98fL28' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 113713529</div><div id='project'> Project Name: speechbrain/speechbrain</div><div id='commit'> Commit Name: 047a182c95cda8c7cfd48eebe8e51668ef1e1ab8</div><div id='time'> Time: 2021-02-24</div><div id='author'> Author: cornellsamuele@gmail.com</div><div id='file'> File Name: speechbrain/pretrained/fetching.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: fetch(3)</div><div id='n_method'> N Method Name: fetch(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: speechbrain/pretrained/fetching.py</div><div id='n_file'> N File Name: speechbrain/pretrained/fetching.py</div><div id='m_start'> M Start Line: 29</div><div id='m_end'> M End Line: 40</div><div id='n_start'> N Start Line: 25</div><div id='n_end'> N End Line: 56</div><BR>