<html><h3>Pattern ID :22811
</h3><img src='72413745.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    if len(ranks) != len(actors):
        raise RuntimeError("Each actor should correspond to one rank. Got &quot{}&quot "
                           "ranks but &quot{}&quot actors".format(
                               len(ranks), <a id="change">len(</a>actors<a id="change">)</a>))

    if set(ranks) != set(range(len(ranks))):
        raise RuntimeError(</code></pre><h3>After Change</h3><pre><code class='java'>

    if set(ranks) != set(range(len(ranks))):
        got_ranks = "".join([str(r) for r in ranks])
        <a id="change">raise </a><a id="change">RuntimeError(
            f"Ranks must be a permutation from 0 to &quot{len(ranks)}&quot. "
            f"Got &quot{got_ranks}&quot."</a><a id="change">)</a>

    if world_size &lt;= 0:
        raise RuntimeError("World size must be greater than zero. "
                           f"Got &quot{world_size}&quot.")</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/alpa-projects/alpa/commit/7a140edbf65db04159da163f40d5cc9ce89afa65#diff-8ff4ea1c4a31854ac026e322973679c9c1cf44f191934889a5f3318317d3f7bbL180' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 72413745</div><div id='project'> Project Name: alpa-projects/alpa</div><div id='commit'> Commit Name: 7a140edbf65db04159da163f40d5cc9ce89afa65</div><div id='time'> Time: 2022-04-30</div><div id='author'> Author: zhisbug@users.noreply.github.com</div><div id='file'> File Name: alpa/collective/collective.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: create_collective_group(5)</div><div id='n_method'> N Method Name: create_collective_group(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: alpa/collective/collective.py</div><div id='n_file'> N File Name: alpa/collective/collective.py</div><div id='m_start'> M Start Line: 181</div><div id='m_end'> M End Line: 192</div><div id='n_start'> N Start Line: 180</div><div id='n_end'> N End Line: 191</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            x = set_device(input_data, device)
        else:
            if dtypes is None:
                dtypes = [torch.float] * <a id="change">len(</a>input_data<a id="change">)</a>
            input_size = get_correct_input_sizes(input_data)
            x = get_input_tensor(input_size, batch_dim, dtypes, device)

    else:</code></pre><h3>After Change</h3><pre><code class='java'>
            x = set_device(input_data, device)

    if x is None:
        <a id="change">raise </a><a id="change">RuntimeError(
            "Input type is not recognized. Please ensure input_data is valid.\n"
            "For multiple inputs to the network, ensure input_data passed in is "
            "a sequence of tensors or a list of tuple sizes. If you are having "
            "trouble here, please submit a GitHub issue."</a><a id="change">
        )</a>

    return x, input_size

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tyleryep/torchinfo/commit/b3510714cc642b1e896e15b54b25bdb034faa332#diff-2642c7b47aafa9ce78758f30d62959e2a563c9b6b235bdfb512097f808e616c5L192' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 72413748</div><div id='project'> Project Name: tyleryep/torchinfo</div><div id='commit'> Commit Name: b3510714cc642b1e896e15b54b25bdb034faa332</div><div id='time'> Time: 2020-12-24</div><div id='author'> Author: tyep@cs.stanford.edu</div><div id='file'> File Name: torchinfo/torchinfo.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: process_input_data(2)</div><div id='n_method'> N Method Name: process_input_data(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: torchinfo/torchinfo.py</div><div id='n_file'> N File Name: torchinfo/torchinfo.py</div><div id='m_start'> M Start Line: 193</div><div id='m_end'> M End Line: 222</div><div id='n_start'> N Start Line: 217</div><div id='n_end'> N End Line: 241</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                        "set the dataloader with .set_loaders(...)"
                    )

            dataset_size = getattr(self, "dali_epoch_size", None) or <a id="change">len(</a>dataloader.dataset<a id="change">)</a>

            dataset_size = self.trainer.limit_train_batches * dataset_size

            num_devices = 1</code></pre><h3>After Change</h3><pre><code class='java'>
                    data_fraction=data_fraction,
                )
            except:
                <a id="change">raise </a><a id="change">RuntimeError(
                    "Please pass &quotdataset&quot or &quotdata_dir &quot"
                    "and &quottrain_dir&quot as parameters to the model."</a><a id="change">
                )</a>

            dataset_size = self.trainer.limit_train_batches * dataset_size

            num_devices = 1</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/vturrisi/contrastive-learning/commit/eb07a9c7c2872efb1ae83767f59a67fa616a7652#diff-bf0f79abb0e767723150e5fe64a4a5935492d2fcf2eb222cfe5f8c901bcd11b0L379' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 72413735</div><div id='project'> Project Name: vturrisi/contrastive-learning</div><div id='commit'> Commit Name: eb07a9c7c2872efb1ae83767f59a67fa616a7652</div><div id='time'> Time: 2022-05-02</div><div id='author'> Author: vt.turrisi@gmail.com</div><div id='file'> File Name: solo/methods/base.py</div><div id='m_class'> M Class Name: BaseMethod</div><div id='n_method'> N Class Name: BaseMethod</div><div id='m_method'> M Method Name: num_training_steps(1)</div><div id='n_method'> N Method Name: num_training_steps(1)</div><div id='m_parent_class'> M Parent Class: pl.LightningModule</div><div id='n_parent_class'> N Parent Class: pl.LightningModule</div><div id='m_file'> M File Name: solo/methods/base.py</div><div id='n_file'> N File Name: solo/methods/base.py</div><div id='m_start'> M Start Line: 383</div><div id='m_end'> M End Line: 392</div><div id='n_start'> N Start Line: 362</div><div id='n_end'> N End Line: 384</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                    )
                )
                self.writer_batch_size = new_batch_size
                n_batches = <a id="change">len(</a>self.current_rows<a id="change">)</a> // new_batch_size
                n_batches += int(len(self.current_rows) % new_batch_size != 0)
                for i in range(n_batches):
                    pa_array = pa.array(self.current_rows[i * new_batch_size : (i + 1) * new_batch_size], type=type,)</code></pre><h3>After Change</h3><pre><code class='java'>
                new_batch_size = self.writer_batch_size
                while pa_array[0] != first_example:
                    if new_batch_size &lt; 2:
                        <a id="change">raise </a><a id="change">RuntimeError("The given example is too big (&gt;2GB) to fit in an array."</a><a id="change">)</a>
                    new_batch_size = self.writer_batch_size // 2
                    pa_array = pa.array(self.current_rows[:new_batch_size], type=inferred_type)
                logger.warning(
                    "Batch size is too big (&gt;2GB). Reducing it from {} to {}".format(</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/datasets/commit/70e935c3d34ca6330f857250a7f2141bdb1da5c8#diff-cfbde71471ee8cbcd43f21bc37c58f277fb87f153be1d821a91ddbc19534dffdL135' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 72413738</div><div id='project'> Project Name: huggingface/datasets</div><div id='commit'> Commit Name: 70e935c3d34ca6330f857250a7f2141bdb1da5c8</div><div id='time'> Time: 2020-08-14</div><div id='author'> Author: 42851186+lhoestq@users.noreply.github.com</div><div id='file'> File Name: src/nlp/arrow_writer.py</div><div id='m_class'> M Class Name: ArrowWriter</div><div id='n_method'> N Class Name: ArrowWriter</div><div id='m_method'> M Method Name: write_on_file(1)</div><div id='n_method'> N Method Name: write_on_file(1)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: src/nlp/arrow_writer.py</div><div id='n_file'> N File Name: src/nlp/arrow_writer.py</div><div id='m_start'> M Start Line: 155</div><div id='m_end'> M End Line: 159</div><div id='n_start'> N Start Line: 141</div><div id='n_end'> N End Line: 161</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                        "set the dataloader with .set_loaders(...)"
                    )

            dataset_size = getattr(self, "dali_epoch_size", None) or <a id="change">len(</a>dataloader.dataset<a id="change">)</a>

            dataset_size = self.trainer.limit_train_batches * dataset_size

            num_devices = 1</code></pre><h3>After Change</h3><pre><code class='java'>
                    data_fraction=data_fraction,
                )
            except:
                <a id="change">raise </a><a id="change">RuntimeError(
                    "Please pass &quotdataset&quot or &quotdata_dir &quot"
                    "and &quottrain_dir&quot as parameters to the model."</a><a id="change">
                )</a>

            dataset_size = self.trainer.limit_train_batches * dataset_size

            num_devices = 1</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/vturrisi/contrastive-learning/commit/eb07a9c7c2872efb1ae83767f59a67fa616a7652#diff-306471ca72f10d091f7adabfddc03e702f662348314d589d172c5c700eae27abL195' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 72413741</div><div id='project'> Project Name: vturrisi/contrastive-learning</div><div id='commit'> Commit Name: eb07a9c7c2872efb1ae83767f59a67fa616a7652</div><div id='time'> Time: 2022-05-02</div><div id='author'> Author: vt.turrisi@gmail.com</div><div id='file'> File Name: solo/methods/linear.py</div><div id='m_class'> M Class Name: LinearModel</div><div id='n_method'> N Class Name: LinearModel</div><div id='m_method'> M Method Name: num_training_steps(1)</div><div id='n_method'> N Method Name: num_training_steps(1)</div><div id='m_parent_class'> M Parent Class: pl.LightningModule</div><div id='n_parent_class'> N Parent Class: pl.LightningModule</div><div id='m_file'> M File Name: solo/methods/linear.py</div><div id='n_file'> N File Name: solo/methods/linear.py</div><div id='m_start'> M Start Line: 199</div><div id='m_end'> M End Line: 208</div><div id='n_start'> N Start Line: 184</div><div id='n_end'> N End Line: 206</div><BR>