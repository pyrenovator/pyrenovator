<html><h3>Pattern ID :16774
</h3><img src='56078131.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
@pytest.mark.slow
@pytest.mark.timeout(5)
def test_worker_runtime():
    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>

    cancel_event = multiprocessing.Event()

    def start_runtime(args, cancel_event):</code></pre><h3>After Change</h3><pre><code class='java'>
@pytest.mark.slow
@pytest.mark.timeout(5)
def test_worker_runtime():
    args = <a id="change">_generate_pod_args()</a>

    cancel_event = multiprocessing.Event()

    def start_runtime(args, cancel_event):</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 22</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-36e39b1f21263badab624ffcfdbbb85d55fb09bf160fa50148a4ff28dc964d6cL26' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078131</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/unit/serve/runtimes/worker/test_worker_runtime.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_worker_runtime(0)</div><div id='n_method'> N Method Name: test_worker_runtime(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/serve/runtimes/worker/test_worker_runtime.py</div><div id='n_file'> N File Name: tests/unit/serve/runtimes/worker/test_worker_runtime.py</div><div id='m_start'> M Start Line: 26</div><div id='m_end'> M End Line: 26</div><div id='n_start'> N Start Line: 26</div><div id='n_end'> N End Line: 26</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
@pytest.mark.slow
@pytest.mark.timeout(10)
def test_error_in_worker_runtime(monkeypatch):
    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>

    cancel_event = multiprocessing.Event()

    def fail(*args, **kwargs):</code></pre><h3>After Change</h3><pre><code class='java'>
@pytest.mark.slow
@pytest.mark.timeout(10)
def test_error_in_worker_runtime(monkeypatch):
    args = <a id="change">_generate_pod_args()</a>

    cancel_event = multiprocessing.Event()

    def fail(*args, **kwargs):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-36e39b1f21263badab624ffcfdbbb85d55fb09bf160fa50148a4ff28dc964d6cL148' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078130</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/unit/serve/runtimes/worker/test_worker_runtime.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_error_in_worker_runtime(1)</div><div id='n_method'> N Method Name: test_error_in_worker_runtime(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/serve/runtimes/worker/test_worker_runtime.py</div><div id='n_file'> N File Name: tests/unit/serve/runtimes/worker/test_worker_runtime.py</div><div id='m_start'> M Start Line: 149</div><div id='m_end'> M End Line: 149</div><div id='n_start'> N Start Line: 149</div><div id='n_end'> N End Line: 149</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    uses_before=None,
    uses_after=None,
):
    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>
    args.port = port
    args.name = name
    args.pod_cls = &quotHeadRuntime&quot
    args.pod_role = PodRoleType.HEAD</code></pre><h3>After Change</h3><pre><code class='java'>
    uses_before=None,
    uses_after=None,
):
    args = <a id="change">_generate_pod_args()</a>
    args.port = port
    args.name = name
    args.pod_cls = &quotHeadRuntime&quot
    args.pod_role = PodRoleType.HEAD</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-1f1070391f9789736038a804b5b7b0b00ea4b8ef95ab675248cfbdded9ba01c2L526' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078129</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/integration/pods/test_pod.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _create_head_pod(6)</div><div id='n_method'> N Method Name: _create_head_pod(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/integration/pods/test_pod.py</div><div id='n_file'> N File Name: tests/integration/pods/test_pod.py</div><div id='m_start'> M Start Line: 534</div><div id='m_end'> M End Line: 534</div><div id='n_start'> N Start Line: 535</div><div id='n_end'> N End Line: 535</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

@pytest.mark.asyncio
async def test_head_runtime_reflection():
    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>
    cancel_event, handle_queue, runtime_thread = _create_runtime(args)

    assert AsyncNewLoopRuntime.wait_for_ready_or_shutdown(
        timeout=3.0,</code></pre><h3>After Change</h3><pre><code class='java'>

@pytest.mark.asyncio
async def test_head_runtime_reflection():
    args = <a id="change">_generate_pod_args()</a>
    cancel_event, handle_queue, runtime_thread = _create_runtime(args)

    assert AsyncNewLoopRuntime.wait_for_ready_or_shutdown(
        timeout=3.0,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-46388b1e5294ec63024b9aee270cfacdcb1ed75ef72f566884814cfd0f788106L217' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078128</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_head_runtime_reflection(0)</div><div id='n_method'> N Method Name: test_head_runtime_reflection(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='n_file'> N File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_start'> M Start Line: 218</div><div id='m_end'> M End Line: 218</div><div id='n_start'> N Start Line: 218</div><div id='n_end'> N End Line: 218</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def _create_worker_runtime(port, name=&quot&quot, executor=None):
    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>
    args.port = port
    args.name = name
    if executor:
        args.uses = executor</code></pre><h3>After Change</h3><pre><code class='java'>


def _create_worker_runtime(port, name=&quot&quot, executor=None):
    args = <a id="change">_generate_pod_args()</a>
    args.port = port
    args.name = name
    if executor:
        args.uses = executor</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-39c7ed2fd44752d6dc41c63974aea79c7be62389a578b5406983a7a0a68feb6eL685' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078111</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/integration/runtimes/test_runtimes.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _create_worker_runtime(3)</div><div id='n_method'> N Method Name: _create_worker_runtime(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/integration/runtimes/test_runtimes.py</div><div id='n_file'> N File Name: tests/integration/runtimes/test_runtimes.py</div><div id='m_start'> M Start Line: 686</div><div id='m_end'> M End Line: 686</div><div id='n_start'> N Start Line: 687</div><div id='n_end'> N End Line: 687</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def test_uses_before_uses_after():
    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>
    args.polling = PollingType.ALL
    args.uses_before_address = &quotfake_address&quot
    args.uses_after_address = &quotfake_address&quot
    connection_list_dict = {0: [f&quotip1:8080&quot], 1: [f&quotip2:8080&quot], 2: [f&quotip3:8080&quot]}</code></pre><h3>After Change</h3><pre><code class='java'>


def test_uses_before_uses_after():
    args = <a id="change">_generate_pod_args()</a>
    args.polling = PollingType.ALL
    args.uses_before_address = &quotfake_address&quot
    args.uses_after_address = &quotfake_address&quot
    connection_list_dict = {0: [f&quotip1:8080&quot], 1: [f&quotip2:8080&quot], 2: [f&quotip3:8080&quot]}</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-46388b1e5294ec63024b9aee270cfacdcb1ed75ef72f566884814cfd0f788106L69' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078110</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_uses_before_uses_after(0)</div><div id='n_method'> N Method Name: test_uses_before_uses_after(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='n_file'> N File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_start'> M Start Line: 70</div><div id='m_end'> M End Line: 70</div><div id='n_start'> N Start Line: 70</div><div id='n_end'> N End Line: 70</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def _create_worker_runtime(port, name=&quot&quot, executor=None):
    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>
    args.port = port
    args.uses = &quotDummyExec&quot
    args.name = name
    if executor:</code></pre><h3>After Change</h3><pre><code class='java'>


def _create_worker_runtime(port, name=&quot&quot, executor=None):
    args = <a id="change">_generate_pod_args()</a>
    args.port = port
    args.uses = &quotDummyExec&quot
    args.name = name
    if executor:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-a0c088469d6647c5b87b54e2d215bcf20f4020af26824cff4935c3a563b3dbdbL28' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078119</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/integration/runtimes/test_network_failures.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _create_worker_runtime(3)</div><div id='n_method'> N Method Name: _create_worker_runtime(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/integration/runtimes/test_network_failures.py</div><div id='n_file'> N File Name: tests/integration/runtimes/test_network_failures.py</div><div id='m_start'> M Start Line: 29</div><div id='m_end'> M End Line: 29</div><div id='n_start'> N Start Line: 30</div><div id='n_end'> N End Line: 30</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def _create_worker_runtime(port, name=&quot&quot):
    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>
    args.port = port
    args.name = name
    args.uses = &quotStreamerTestExecutor&quot
    with WorkerRuntime(args) as runtime:</code></pre><h3>After Change</h3><pre><code class='java'>


def _create_worker_runtime(port, name=&quot&quot):
    args = <a id="change">_generate_pod_args()</a>
    args.port = port
    args.name = name
    args.uses = &quotStreamerTestExecutor&quot
    with WorkerRuntime(args) as runtime:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-2b7e952032abbc95071f56940f048bd68ae29e079375a2d9ae1f9ba7eabdbb50L21' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078118</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/integration/gateway_streamer/test_gateway_streamer.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _create_worker_runtime(2)</div><div id='n_method'> N Method Name: _create_worker_runtime(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/integration/gateway_streamer/test_gateway_streamer.py</div><div id='n_file'> N File Name: tests/integration/gateway_streamer/test_gateway_streamer.py</div><div id='m_start'> M Start Line: 22</div><div id='m_end'> M End Line: 22</div><div id='n_start'> N Start Line: 22</div><div id='n_end'> N End Line: 22</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    uses_after=None,
    retries=-1,
):
    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>
    args.port = port
    args.name = name
    args.retries = retries
    args.polling = PollingType.ANY if polling == &quotANY&quot else PollingType.ALL</code></pre><h3>After Change</h3><pre><code class='java'>
    uses_after=None,
    retries=-1,
):
    args = <a id="change">_generate_pod_args()</a>
    args.port = port
    args.name = name
    args.retries = retries
    args.polling = PollingType.ANY if polling == &quotANY&quot else PollingType.ALL</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-39c7ed2fd44752d6dc41c63974aea79c7be62389a578b5406983a7a0a68feb6eL695' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078117</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/integration/runtimes/test_runtimes.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _create_head_runtime(7)</div><div id='n_method'> N Method Name: _create_head_runtime(7)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/integration/runtimes/test_runtimes.py</div><div id='n_file'> N File Name: tests/integration/runtimes/test_runtimes.py</div><div id='m_start'> M Start Line: 704</div><div id='m_end'> M End Line: 704</div><div id='n_start'> N Start Line: 705</div><div id='n_end'> N End Line: 705</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def test_regular_data_case():
    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>
    args.polling = PollingType.ANY
    connection_list_dict = {0: [f&quotfake_ip:8080&quot]}
    args.connection_list = json.dumps(connection_list_dict)
    cancel_event, handle_queue, runtime_thread = _create_runtime(args)</code></pre><h3>After Change</h3><pre><code class='java'>


def test_regular_data_case():
    args = <a id="change">_generate_pod_args()</a>
    args.polling = PollingType.ANY
    connection_list_dict = {0: [f&quotfake_ip:8080&quot]}
    args.connection_list = json.dumps(connection_list_dict)
    cancel_event, handle_queue, runtime_thread = _create_runtime(args)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-46388b1e5294ec63024b9aee270cfacdcb1ed75ef72f566884814cfd0f788106L23' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078116</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_regular_data_case(0)</div><div id='n_method'> N Method Name: test_regular_data_case(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='n_file'> N File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_start'> M Start Line: 24</div><div id='m_end'> M End Line: 24</div><div id='n_start'> N Start Line: 24</div><div id='n_end'> N End Line: 24</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def _create_worker_runtime(port, name=&quot&quot, executor=None):
    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>
    args.port = port
    args.name = name
    if executor:
        args.uses = executor</code></pre><h3>After Change</h3><pre><code class='java'>


def _create_worker_runtime(port, name=&quot&quot, executor=None):
    args = <a id="change">_generate_pod_args()</a>
    args.port = port
    args.name = name
    if executor:
        args.uses = executor</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-26f8218e1e7ee1638abe8f85e607a21251db481ccec59c55190fc84944257c00L17' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078115</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/integration/runtimes/test_jina_info.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _create_worker_runtime(3)</div><div id='n_method'> N Method Name: _create_worker_runtime(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/integration/runtimes/test_jina_info.py</div><div id='n_file'> N File Name: tests/integration/runtimes/test_jina_info.py</div><div id='m_start'> M Start Line: 18</div><div id='m_end'> M End Line: 18</div><div id='n_start'> N Start Line: 18</div><div id='n_end'> N End Line: 18</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def _create_head_pod(port, connection_list_dict):
    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>
    args.port = port
    args.name = &quothead&quot
    args.pod_role = PodRoleType.HEAD
    args.polling = PollingType.ANY</code></pre><h3>After Change</h3><pre><code class='java'>


def _create_head_pod(port, connection_list_dict):
    args = <a id="change">_generate_pod_args()</a>
    args.port = port
    args.name = &quothead&quot
    args.pod_role = PodRoleType.HEAD
    args.polling = PollingType.ANY</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-fc235d63ed838f4cc1b59c59e88dac398567a607f5b914b1df5eedbfaec121feL112' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078114</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/integration/pods/container/test_pod.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _create_head_pod(2)</div><div id='n_method'> N Method Name: _create_head_pod(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/integration/pods/container/test_pod.py</div><div id='n_file'> N File Name: tests/integration/pods/container/test_pod.py</div><div id='m_start'> M Start Line: 113</div><div id='m_end'> M End Line: 113</div><div id='n_start'> N Start Line: 114</div><div id='n_end'> N End Line: 114</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
async def test_sigterm_handling(signal, uses_with):
    import time

    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>

    def run(args):

        args.uses = &quotTimeoutExecutor&quot</code></pre><h3>After Change</h3><pre><code class='java'>
async def test_sigterm_handling(signal, uses_with):
    import time

    args = <a id="change">_generate_pod_args()</a>

    def run(args):

        args.uses = &quotTimeoutExecutor&quot</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-7de6a7589b636589713e57264a70e9a0626900cdf1b0b5152bee3dd1cd1b1523L563' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078113</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/integration/dynamic_batching/test_dynamic_batching.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_sigterm_handling(2)</div><div id='n_method'> N Method Name: test_sigterm_handling(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/integration/dynamic_batching/test_dynamic_batching.py</div><div id='n_file'> N File Name: tests/integration/dynamic_batching/test_dynamic_batching.py</div><div id='m_start'> M Start Line: 566</div><div id='m_end'> M End Line: 566</div><div id='n_start'> N Start Line: 566</div><div id='n_end'> N End Line: 566</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def _create_worker_pod(port, name=&quot&quot, executor=None):
    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>
    args.port = port
    args.name = name
    args.no_block_on_start = True
    if executor:</code></pre><h3>After Change</h3><pre><code class='java'>


def _create_worker_pod(port, name=&quot&quot, executor=None):
    args = <a id="change">_generate_pod_args()</a>
    args.port = port
    args.name = name
    args.no_block_on_start = True
    if executor:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-1f1070391f9789736038a804b5b7b0b00ea4b8ef95ab675248cfbdded9ba01c2L516' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078112</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/integration/pods/test_pod.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _create_worker_pod(3)</div><div id='n_method'> N Method Name: _create_worker_pod(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/integration/pods/test_pod.py</div><div id='n_file'> N File Name: tests/integration/pods/test_pod.py</div><div id='m_start'> M Start Line: 517</div><div id='m_end'> M End Line: 517</div><div id='n_start'> N Start Line: 518</div><div id='n_end'> N End Line: 518</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

@pytest.mark.asyncio
async def test_worker_runtime_reflection():
    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>

    cancel_event = multiprocessing.Event()

    def start_runtime(args, cancel_event):</code></pre><h3>After Change</h3><pre><code class='java'>

@pytest.mark.asyncio
async def test_worker_runtime_reflection():
    args = <a id="change">_generate_pod_args()</a>

    cancel_event = multiprocessing.Event()

    def start_runtime(args, cancel_event):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-36e39b1f21263badab624ffcfdbbb85d55fb09bf160fa50148a4ff28dc964d6cL259' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078127</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/unit/serve/runtimes/worker/test_worker_runtime.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_worker_runtime_reflection(0)</div><div id='n_method'> N Method Name: test_worker_runtime_reflection(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/serve/runtimes/worker/test_worker_runtime.py</div><div id='n_file'> N File Name: tests/unit/serve/runtimes/worker/test_worker_runtime.py</div><div id='m_start'> M Start Line: 260</div><div id='m_end'> M End Line: 260</div><div id='n_start'> N Start Line: 260</div><div id='n_end'> N End Line: 260</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def _create_worker_pod(port):
    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>
    args.port = port
    args.name = &quotworker&quot
    args.uses = &quotdocker://worker-runtime&quot
    return ContainerPod(args)</code></pre><h3>After Change</h3><pre><code class='java'>


def _create_worker_pod(port):
    args = <a id="change">_generate_pod_args()</a>
    args.port = port
    args.name = &quotworker&quot
    args.uses = &quotdocker://worker-runtime&quot
    return ContainerPod(args)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-fc235d63ed838f4cc1b59c59e88dac398567a607f5b914b1df5eedbfaec121feL104' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078126</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/integration/pods/container/test_pod.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _create_worker_pod(1)</div><div id='n_method'> N Method Name: _create_worker_pod(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/integration/pods/container/test_pod.py</div><div id='n_file'> N File Name: tests/integration/pods/container/test_pod.py</div><div id='m_start'> M Start Line: 105</div><div id='m_end'> M End Line: 105</div><div id='n_start'> N Start Line: 106</div><div id='n_end'> N End Line: 106</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def _create_worker_runtime(port, name=&quot&quot, executor=None, port_monitoring=None):
    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>
    args.port = port
    args.name = name

    if port_monitoring:</code></pre><h3>After Change</h3><pre><code class='java'>


def _create_worker_runtime(port, name=&quot&quot, executor=None, port_monitoring=None):
    args = <a id="change">_generate_pod_args()</a>
    args.port = port
    args.name = name

    if port_monitoring:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-49d5ef4aca1ff72445b73133654cb83b85ee362d4f802f648bc5696fee3c8484L15' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078125</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/integration/monitoring/test_manual_flow.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _create_worker_runtime(4)</div><div id='n_method'> N Method Name: _create_worker_runtime(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/integration/monitoring/test_manual_flow.py</div><div id='n_file'> N File Name: tests/integration/monitoring/test_manual_flow.py</div><div id='m_start'> M Start Line: 16</div><div id='m_end'> M End Line: 16</div><div id='n_start'> N Start Line: 17</div><div id='n_end'> N End Line: 17</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def _create_worker_runtime(port, name=&quot&quot, executor=None):
    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>
    args.port = port
    args.name = name
    if executor:
        args.uses = executor</code></pre><h3>After Change</h3><pre><code class='java'>


def _create_worker_runtime(port, name=&quot&quot, executor=None):
    args = <a id="change">_generate_pod_args()</a>
    args.port = port
    args.name = name
    if executor:
        args.uses = executor</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-1e08b2a27c4d9dcae60dd82fb47198fd99118266926c41a6637ac800f6bce7c2L12' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078124</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/integration/runtimes/test_gateway_dry_run.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _create_worker_runtime(3)</div><div id='n_method'> N Method Name: _create_worker_runtime(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/integration/runtimes/test_gateway_dry_run.py</div><div id='n_file'> N File Name: tests/integration/runtimes/test_gateway_dry_run.py</div><div id='m_start'> M Start Line: 13</div><div id='m_end'> M End Line: 13</div><div id='n_start'> N Start Line: 14</div><div id='n_end'> N End Line: 14</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
@pytest.mark.parametrize(&quotdisable_reduce&quot, [False, True])
def test_message_merging(disable_reduce):
    if not disable_reduce:
        args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>
    else:
        args = set_pod_parser().parse_args([&quot--no-reduce&quot])
    args.polling = PollingType.ALL
    connection_list_dict = {0: [f&quotip1:8080&quot], 1: [f&quotip2:8080&quot], 2: [f&quotip3:8080&quot]}</code></pre><h3>After Change</h3><pre><code class='java'>
@pytest.mark.parametrize(&quotdisable_reduce&quot, [False, True])
def test_message_merging(disable_reduce):
    if not disable_reduce:
        args = <a id="change">_generate_pod_args()</a>
    else:
        args = _generate_pod_args([&quot--no-reduce&quot])
    args.polling = PollingType.ALL
    connection_list_dict = {0: [f&quotip1:8080&quot], 1: [f&quotip2:8080&quot], 2: [f&quotip3:8080&quot]}</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-46388b1e5294ec63024b9aee270cfacdcb1ed75ef72f566884814cfd0f788106L46' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078123</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_message_merging(1)</div><div id='n_method'> N Method Name: test_message_merging(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='n_file'> N File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_start'> M Start Line: 48</div><div id='m_end'> M End Line: 50</div><div id='n_start'> N Start Line: 48</div><div id='n_end'> N End Line: 48</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        decompress,
    )

    args = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>
    args.polling = PollingType.ANY
    connection_list_dict = {0: [f&quotfake_ip:8080&quot]}
    args.connection_list = json.dumps(connection_list_dict)
    cancel_event, handle_queue, runtime_thread = _create_runtime(args)</code></pre><h3>After Change</h3><pre><code class='java'>
        decompress,
    )

    args = <a id="change">_generate_pod_args()</a>
    args.polling = PollingType.ANY
    connection_list_dict = {0: [f&quotfake_ip:8080&quot]}
    args.connection_list = json.dumps(connection_list_dict)
    cancel_event, handle_queue, runtime_thread = _create_runtime(args)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-46388b1e5294ec63024b9aee270cfacdcb1ed75ef72f566884814cfd0f788106L90' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078122</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_decompress(1)</div><div id='n_method'> N Method Name: test_decompress(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='n_file'> N File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_start'> M Start Line: 107</div><div id='m_end'> M End Line: 107</div><div id='n_start'> N Start Line: 107</div><div id='n_end'> N End Line: 107</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def test_pod_instantiate_start_different_context():
    arg = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>
    pod_args = [arg, arg]
    pods = []
    for args in pod_args:
        pods.append(PodFactory.build_pod(args))</code></pre><h3>After Change</h3><pre><code class='java'>


def test_pod_instantiate_start_different_context():
    arg = <a id="change">_generate_pod_args()</a>
    pod_args = [arg, arg]
    pods = []
    for args in pod_args:
        pods.append(PodFactory.build_pod(args))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-8628c5310a46ee8d8dcabb64bd7ceb8a2a2843d1eafbe6f6a17596d23986fdb5L15' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078121</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/integration/issues/github_2371/test_pod.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_pod_instantiate_start_different_context(0)</div><div id='n_method'> N Method Name: test_pod_instantiate_start_different_context(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/integration/issues/github_2371/test_pod.py</div><div id='n_file'> N File Name: tests/integration/issues/github_2371/test_pod.py</div><div id='m_start'> M Start Line: 16</div><div id='m_end'> M End Line: 16</div><div id='n_start'> N Start Line: 16</div><div id='n_end'> N End Line: 16</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def test_pod_instantiate_start_same_context():
    arg = <a id="change">set_pod_parser().parse_args(</a><a id="change">[])</a>
    pod_args = [arg, arg]

    for args in pod_args:
        pod = PodFactory.build_pod(args)</code></pre><h3>After Change</h3><pre><code class='java'>


def test_pod_instantiate_start_same_context():
    arg = <a id="change">_generate_pod_args()</a>
    pod_args = [arg, arg]

    for args in pod_args:
        pod = PodFactory.build_pod(args)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/87912a37ce7ab3c3b63c12b48d6cdfe31f81742c#diff-8628c5310a46ee8d8dcabb64bd7ceb8a2a2843d1eafbe6f6a17596d23986fdb5L5' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56078120</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 87912a37ce7ab3c3b63c12b48d6cdfe31f81742c</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: evangeline-lun@foxmail.com</div><div id='file'> File Name: tests/integration/issues/github_2371/test_pod.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_pod_instantiate_start_same_context(0)</div><div id='n_method'> N Method Name: test_pod_instantiate_start_same_context(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/integration/issues/github_2371/test_pod.py</div><div id='n_file'> N File Name: tests/integration/issues/github_2371/test_pod.py</div><div id='m_start'> M Start Line: 6</div><div id='m_end'> M End Line: 6</div><div id='n_start'> N Start Line: 6</div><div id='n_end'> N End Line: 6</div><BR>