<html><h3>Pattern ID :34511
</h3><img src='99295531.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            if query_num % 2 == 1:
                seq.append(X)
        elif self.grad_method == &quotsgd&quot:
            for <a id="change">i</a> in range(query_num):
                noise<a id="change"> = </a><a id="change">torch.normal(mean=0.0, std=1.0, size=X.shape, device=X.device)</a>
                X1 = X + sigma * noise
                seq.append(X1)
        elif self.grad_method == &quothess&quot:
            for i in range(query_num):</code></pre><h3>After Change</h3><pre><code class='java'>
        shape = list(X.shape)
        shape[0] = query_num
        if self.grad_method == &quotnes&quot:
            shape[0] = <a id="change">shape[0]</a> // 2
        noise = sigma * torch.normal(mean=0.0, std=1.0, size=shape, device=X.device)

        zeros = torch.zeros_like(X)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/ain-soph/trojanzoo/commit/bc3d366258b45942115b6b86ae8466dac52ac154#diff-6329d4702b9ac5d31d2825508b3b5a6c26f879bb018bf95db5b52d825768d67bL152' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 99295531</div><div id='project'> Project Name: ain-soph/trojanzoo</div><div id='commit'> Commit Name: bc3d366258b45942115b6b86ae8466dac52ac154</div><div id='time'> Time: 2020-06-30</div><div id='author'> Author: ain-soph@live.com</div><div id='file'> File Name: trojanzoo/optim/pgd.py</div><div id='m_class'> M Class Name: PGD</div><div id='n_method'> N Class Name: PGD</div><div id='m_method'> M Method Name: gen_seq(3)</div><div id='n_method'> N Method Name: gen_seq(3)</div><div id='m_parent_class'> M Parent Class: Optimizer</div><div id='n_parent_class'> N Parent Class: Optimizer</div><div id='m_file'> M File Name: trojanzoo/optim/pgd.py</div><div id='n_file'> N File Name: trojanzoo/optim/pgd.py</div><div id='m_start'> M Start Line: 152</div><div id='m_end'> M End Line: 174</div><div id='n_start'> N Start Line: 154</div><div id='n_end'> N End Line: 178</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        local_models = extra_auxiliary_info

        for parameters in local_models:
            for <a id="change">p</a> in parameters:
                &#47&#47 Clip weight
                p.data = p.data / torch.max(torch.ones(size=p.shape),
                                            torch.abs(p.data) / self.w_clip)
                noise<a id="change"> = </a><a id="change">torch.normal(mean=0, std=self.nbafl_scale_u, size=p.shape)</a>
                p.data += noise

    def add_global_noise(
            self,</code></pre><h3>After Change</h3><pre><code class='java'>
    def add_local_noise(self, local_grad: dict):
        for k in local_grad.keys():
            &#47&#47 Clip weight
            local_grad[k] = <a id="change">local_grad[k]</a> / torch.max(torch.ones(size=local_grad[k].shape),
                                            torch.abs(local_grad[k]) / self.w_clip)
        return super().add_local_noise(local_grad=local_grad)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/fedml-ai/fedml/commit/d51b3d4f98d6d0f89f790463f7072719cfb70fca#diff-92fd78f9fe95076938198f5d34e22d366c50a51b4ba1e8a5fa2ec306e3b68846L21' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 99295529</div><div id='project'> Project Name: fedml-ai/fedml</div><div id='commit'> Commit Name: d51b3d4f98d6d0f89f790463f7072719cfb70fca</div><div id='time'> Time: 2022-09-13</div><div id='author'> Author: sshan0731@hotmail.com</div><div id='file'> File Name: python/fedml/core/dp/frames/NbAFL.py</div><div id='m_class'> M Class Name: NbAFL_DP</div><div id='n_method'> N Class Name: NbAFL_DP</div><div id='m_method'> M Method Name: add_local_noise(2)</div><div id='n_method'> N Method Name: add_local_noise(3)</div><div id='m_parent_class'> M Parent Class: BaseDPFrame</div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: python/fedml/core/dp/frames/NbAFL.py</div><div id='n_file'> N File Name: python/fedml/core/dp/frames/NbAFL.py</div><div id='m_start'> M Start Line: 21</div><div id='m_end'> M End Line: 34</div><div id='n_start'> N Start Line: 32</div><div id='n_end'> N End Line: 37</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            if transform["type"] == "random_noise":
                stdev = transform["stdev"]

                <a id="change">deterministic</a> = transform.get("deterministic", True)
                if deterministic:
                    noise<a id="change"> = </a><a id="change">self.rng.normal(loc=0, scale=stdev, size=tuple(input.size()))</a>
                else:
                    noise = np.random.normal(loc=0, scale=stdev, size=tuple(input.size()))

                noise = input.new_tensor(noise, dtype=input.dtype)</code></pre><h3>After Change</h3><pre><code class='java'>
                transformed_input = self.random_noise(transform, transformed_input)
            elif transform["type"] == "random_scale":
                transformed_input = self.random_scale(transform, transformed_input)
            elif <a id="change">transform["type"]</a> == "random_offset":
                transformed_input = self.random_offset(transform, transformed_input)
            else:
                raise NotImplementedError</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/mstoelzle/solving-occlusion/commit/67ab55354ebc53fd4476b6a30f4dbe7ea26d977e#diff-2fdeaffe0a410d245767b8558dbd226bfa2303c80cf4bc29ce9c79f1e90c1840L12' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 99295545</div><div id='project'> Project Name: mstoelzle/solving-occlusion</div><div id='commit'> Commit Name: 67ab55354ebc53fd4476b6a30f4dbe7ea26d977e</div><div id='time'> Time: 2020-10-22</div><div id='author'> Author: maximilian@stoelzle.ch</div><div id='file'> File Name: src/datasets/transforms.py</div><div id='m_class'> M Class Name: Transformer</div><div id='n_method'> N Class Name: Transformer</div><div id='m_method'> M Method Name: __call__(2)</div><div id='n_method'> N Method Name: __call__(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/datasets/transforms.py</div><div id='n_file'> N File Name: src/datasets/transforms.py</div><div id='m_start'> M Start Line: 13</div><div id='m_end'> M End Line: 27</div><div id='n_start'> N Start Line: 13</div><div id='n_end'> N End Line: 23</div><BR>