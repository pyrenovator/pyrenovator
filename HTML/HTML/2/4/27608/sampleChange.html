<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        seq = seq * scales * pi

        x_sinu<a id="change"> = </a><a id="change">repeat(</a>seq, <a id="change">&quoti d -&gt; i j d&quot</a><a id="change">, j = n)</a>
        y_sinu = repeat(seq, &quotj d -&gt; i j d&quot, i = n)

        sin = torch.cat((x_sinu.sin(), y_sinu.sin()), dim = -1)
        cos = torch.cat((x_sinu.cos(), y_sinu.cos()), dim = -1)</code></pre><h3>After Change</h3><pre><code class='java'>
        self.register_buffer(&quotscales&quot, scales)

    def forward(self, x):
        device, dtype, h, w = x.device, x.dtype, *x.shape[<a id="change">-2:</a>]

        seq_x = torch.linspace(-1., 1., steps = h, device = device)
        seq_x = seq_x.unsqueeze(-1)</code></pre>