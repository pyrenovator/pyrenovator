<html><h3>Pattern ID :26132
</h3><img src='78723185.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    def initCriterion(self):
        if self.config.criterion:
            LOG.logI("You configured criterion to {}".format(self.config.criterion))
            <a id="change">return</a>
        self.config.criterion = torch.nn.CrossEntropyLoss()
        LOG.logW("You should set config.criterion in config.py, unless CrossEntropyLoss() is exactly what you need")

    def initCheckpoint(self):</code></pre><h3>After Change</h3><pre><code class='java'>
            self.config.scaler = GradScaler()

    def initCriterion(self):
        if <a id="change">self.config.criterion is None</a>:
            <a id="change">LOG.logE("You should set config.train.criterion in config.py, e.g. config.train.criterion=torch.nn.CrossEntropyLoss()"</a><a id="change">,exit=True)</a>
        LOG.logI("You set config.train.criterion to {}".format(self.config.criterion))

    def initScheduler(self):
        if self.config.scheduler is None:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/deepvac/deepvac/commit/56a3a36e3947a900a0f2c6e613a18b7a81453ba1#diff-2afe76de17f613d7e160beffc61752bd2cec51981e70f0f5779a9a2a63ba3fe2L288' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 78723185</div><div id='project'> Project Name: deepvac/deepvac</div><div id='commit'> Commit Name: 56a3a36e3947a900a0f2c6e613a18b7a81453ba1</div><div id='time'> Time: 2021-05-13</div><div id='author'> Author: gemfield@civilnet.cn</div><div id='file'> File Name: deepvac/core/deepvac.py</div><div id='m_class'> M Class Name: DeepvacTrain</div><div id='n_method'> N Class Name: DeepvacTrain</div><div id='m_method'> M Method Name: initCriterion(1)</div><div id='n_method'> N Method Name: initCriterion(1)</div><div id='m_parent_class'> M Parent Class: Deepvac</div><div id='n_parent_class'> N Parent Class: Deepvac</div><div id='m_file'> M File Name: deepvac/core/deepvac.py</div><div id='n_file'> N File Name: deepvac/core/deepvac.py</div><div id='m_start'> M Start Line: 288</div><div id='m_end'> M End Line: 292</div><div id='n_start'> N Start Line: 349</div><div id='n_end'> N End Line: 351</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            return False

        if not self.config.static_quantize_dir:
            <a id="change">return </a>True
            
        if self.core_config.is_forward_only and self.core_config.test_loader is None:
            LOG.logE("You must set config.core.test_loader in config.py when config.core.static_quantize_dir is enabled.", exit=True)</code></pre><h3>After Change</h3><pre><code class='java'>
            return False

        if self.config.static_quantize_dir:
            if self.deepvac_core_config.is_forward_only and <a id="change">self.deepvac_core_config.test_loader is None</a>:
                <a id="change">LOG.logE("You must set config.core.test_loader in config.py when static_quantize_dir is enabled in TEST."</a><a id="change">, exit=True)</a>
            if not self.deepvac_core_config.is_forward_only and self.deepvac_core_config.val_loader is None:
                LOG.logE("You must set config.core.val_loader in config.py when static_quantize_dir is enabled in TRAIN.", exit=True)
        return True
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/deepvac/deepvac/commit/ea248a449c23fd60cc58e3468799080cd12f0c76#diff-2b059f1e685858930c08e155a3f4a58b27e16024e2c1b89cf2b8348ca12e0852L8' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 78723184</div><div id='project'> Project Name: deepvac/deepvac</div><div id='commit'> Commit Name: ea248a449c23fd60cc58e3468799080cd12f0c76</div><div id='time'> Time: 2021-05-21</div><div id='author'> Author: gemfield@civilnet.cn</div><div id='file'> File Name: deepvac/cast/script.py</div><div id='m_class'> M Class Name: ScriptCast</div><div id='n_method'> N Class Name: ScriptCast</div><div id='m_method'> M Method Name: auditConfig(1)</div><div id='n_method'> N Method Name: auditConfig(1)</div><div id='m_parent_class'> M Parent Class: DeepvacCast</div><div id='n_parent_class'> N Parent Class: DeepvacCast</div><div id='m_file'> M File Name: deepvac/cast/script.py</div><div id='n_file'> N File Name: deepvac/cast/script.py</div><div id='m_start'> M Start Line: 12</div><div id='m_end'> M End Line: 20</div><div id='n_start'> N Start Line: 10</div><div id='n_end'> N End Line: 21</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            return False

        if not self.config.static_quantize_dir:
            <a id="change">return </a>True
            
        if self.core_config.is_forward_only and self.core_config.test_loader is None:
            LOG.logE("You must set config.core.test_loader in config.py when config.core.static_quantize_dir is enabled.", exit=True)</code></pre><h3>After Change</h3><pre><code class='java'>
            return False

        if self.config.static_quantize_dir:
            if self.deepvac_core_config.is_forward_only and <a id="change">self.deepvac_core_config.test_loader is None</a>:
                <a id="change">LOG.logE("You must set config.core.test_loader in config.py when static_quantize_dir is enabled in TEST."</a><a id="change">, exit=True)</a>
            if not self.deepvac_core_config.is_forward_only and self.deepvac_core_config.val_loader is None:
                LOG.logE("You must set config.core.val_loader in config.py when static_quantize_dir is enabled in TRAIN.", exit=True)

        return True</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/deepvac/deepvac/commit/ea248a449c23fd60cc58e3468799080cd12f0c76#diff-e85654e126b393a693f9fe139a841b9a36b8fee43a37097ca67bf43b582e5d0dL8' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 78723187</div><div id='project'> Project Name: deepvac/deepvac</div><div id='commit'> Commit Name: ea248a449c23fd60cc58e3468799080cd12f0c76</div><div id='time'> Time: 2021-05-21</div><div id='author'> Author: gemfield@civilnet.cn</div><div id='file'> File Name: deepvac/cast/trace.py</div><div id='m_class'> M Class Name: TraceCast</div><div id='n_method'> N Class Name: TraceCast</div><div id='m_method'> M Method Name: auditConfig(1)</div><div id='n_method'> N Method Name: auditConfig(1)</div><div id='m_parent_class'> M Parent Class: DeepvacCast</div><div id='n_parent_class'> N Parent Class: DeepvacCast</div><div id='m_file'> M File Name: deepvac/cast/trace.py</div><div id='n_file'> N File Name: deepvac/cast/trace.py</div><div id='m_start'> M Start Line: 12</div><div id='m_end'> M End Line: 20</div><div id='n_start'> N Start Line: 10</div><div id='n_end'> N End Line: 22</div><BR>