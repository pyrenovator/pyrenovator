<html><h3>Pattern ID :31813
</h3><img src='92879385.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        time.sleep(20)
        logger.info(&quotrolling update done in process&quot)
        &#47&#47 add query testing
        query_doc<a id="change"> = </a><a id="change">Document()</a>
        query_doc.text = &quothello world&quot
        response = _query_docs([query_doc.dict()])
        matches = response[&quotsearch&quot][&quotdocs&quot][0].get(&quotmatches&quot)
        logger.info(f&quotgot {len(matches)} matches&quot)</code></pre><h3>After Change</h3><pre><code class='java'>
        time.sleep(30)
        query_doc = Document(text=&quothello world&quot)
        response = query_docs(query_doc)
        matches = <a id="change">response[0]</a>.data.docs[0].matches
        logger.info(f&quotgot {len(matches)} matches&quot)
        assert matches
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/jina-ai/examples/commit/c3ea2eddcc58117b3f28c34ca861e6fd2a341efb#diff-775351c1eb007cb0f7fcfedd56a9a408aa8b73197739e41ca866ee532fa9f058L30' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 92879385</div><div id='project'> Project Name: jina-ai/examples</div><div id='commit'> Commit Name: c3ea2eddcc58117b3f28c34ca861e6fd2a341efb</div><div id='time'> Time: 2021-09-02</div><div id='author'> Author: deepankar.mahapatro@jina.ai</div><div id='file'> File Name: wikipedia-sentences-query-while-indexing/tests/test_query_while_indexing.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_query_while_indexing(0)</div><div id='n_method'> N Method Name: test_query_while_indexing(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: wikipedia-sentences-query-while-indexing/tests/test_query_while_indexing.py</div><div id='n_file'> N File Name: wikipedia-sentences-query-while-indexing/tests/test_query_while_indexing.py</div><div id='m_start'> M Start Line: 30</div><div id='m_end'> M End Line: 52</div><div id='n_start'> N Start Line: 42</div><div id='n_end'> N End Line: 68</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

def run_test(flow, endpoint, port_expose):
    with flow:
        resp<a id="change"> = </a>flow.post(
            endpoint,
            [<a id="change">Document()</a> for _ in range(10)],
            return_results=True,
            port_expose=port_expose,
        )</code></pre><h3>After Change</h3><pre><code class='java'>
    from jina.clients import Client

    gateway_pod_name = (
        <a id="change">core_client.list_namespaced_pod(
            namespace=namespace, label_selector=&quotapp=gateway&quot
        )
        .items[0]</a>
        .metadata.name
    )
    config_path = os.environ[&quotKUBECONFIG&quot]
    import portforward</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/6e9e7ef32f61cab04c6efc7a9f21659d26b50fdb#diff-e3067955c9efade1423c6e293462d207495c677d07e360b0040731f7f39b7c2dL10' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 92879384</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 6e9e7ef32f61cab04c6efc7a9f21659d26b50fdb</div><div id='time'> Time: 2022-01-10</div><div id='author'> Author: joan.martinez@jina.ai</div><div id='file'> File Name: tests/k8s/test_k8s.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: run_test(4)</div><div id='n_method'> N Method Name: run_test(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/k8s/test_k8s.py</div><div id='n_file'> N File Name: tests/k8s/test_k8s.py</div><div id='m_start'> M Start Line: 10</div><div id='m_end'> M End Line: 18</div><div id='n_start'> N Start Line: 78</div><div id='n_end'> N End Line: 110</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if copy:
            from ..document import Document

            chunk<a id="change"> = </a><a id="change">Document(</a>document<a id="change">, copy=True)</a>
        else:
            &#47&#47 note: this is faster than Document(document, copy=False)
            chunk = document
</code></pre><h3>After Change</h3><pre><code class='java'>
            make sure the added chunk is legit.
        
        super().append(document)
        chunk = <a id="change">self[-1]</a>
        if not chunk.mime_type:
            chunk.mime_type = self._ref_doc.mime_type
        chunk.set_attributes(
            parent_id=self._ref_doc.id, granularity=self.granularity, **kwargs</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/ab16cee09446f426fd847d6ff09c4fd117805093#diff-8145e65734e52b25ff2c94880c2036bc424f7be99ddb0ddfdd757986311a93cfL28' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 92879387</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: ab16cee09446f426fd847d6ff09c4fd117805093</div><div id='time'> Time: 2021-08-11</div><div id='author'> Author: joan.martinez@jina.ai</div><div id='file'> File Name: jina/types/arrays/chunk.py</div><div id='m_class'> M Class Name: ChunkArray</div><div id='n_method'> N Class Name: ChunkArray</div><div id='m_method'> M Method Name: append(2)</div><div id='n_method'> N Method Name: append(3)</div><div id='m_parent_class'> M Parent Class: DocumentArray</div><div id='n_parent_class'> N Parent Class: DocumentArray</div><div id='m_file'> M File Name: jina/types/arrays/chunk.py</div><div id='n_file'> N File Name: jina/types/arrays/chunk.py</div><div id='m_start'> M Start Line: 28</div><div id='m_end'> M End Line: 56</div><div id='n_start'> N Start Line: 40</div><div id='n_end'> N End Line: 44</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if copy:
            from ..document import Document

            match<a id="change"> = </a><a id="change">Document(</a>document<a id="change">, copy=True)</a>
        else:
            &#47&#47 note: this is faster than Document(document, copy=False)
            match = document
</code></pre><h3>After Change</h3><pre><code class='java'>
        :rtype: :class:`Document` view
        
        super().append(document)
        match = <a id="change">self[-1]</a>
        match.set_attributes(
            granularity=self.granularity, adjacency=self.adjacency, **kwargs
        )
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/ab16cee09446f426fd847d6ff09c4fd117805093#diff-df8d07964cf7f29a6d184b7b02dada2d6520a9438f762d21ef3f0c32e366f7c0L20' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 92879386</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: ab16cee09446f426fd847d6ff09c4fd117805093</div><div id='time'> Time: 2021-08-11</div><div id='author'> Author: joan.martinez@jina.ai</div><div id='file'> File Name: jina/types/arrays/match.py</div><div id='m_class'> M Class Name: MatchArray</div><div id='n_method'> N Class Name: MatchArray</div><div id='m_method'> M Method Name: append(2)</div><div id='n_method'> N Method Name: append(3)</div><div id='m_parent_class'> M Parent Class: DocumentArray</div><div id='n_parent_class'> N Parent Class: DocumentArray</div><div id='m_file'> M File Name: jina/types/arrays/match.py</div><div id='n_file'> N File Name: jina/types/arrays/match.py</div><div id='m_start'> M Start Line: 20</div><div id='m_end'> M End Line: 41</div><div id='n_start'> N Start Line: 28</div><div id='n_end'> N End Line: 29</div><BR>