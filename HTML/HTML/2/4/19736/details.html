<html><h3>Pattern ID :19736
</h3><img src='64407206.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            if name not in self:
                super().set(name, self.empty_like())
            self[name][rest] = value
        elif <a id="change"></a>convert_mapping and not <a id="change">isinstance(</a>value, NestedDict<a id="change">)</a> and isinstance(value, Mapping):
            self[name] = self.empty_like(**value)
        else:
            if isinstance(value, str):
                try:
                    value<a id="change"> = </a>literal_eval(value)
                except (ValueError, SyntaxError):
                    pass
            super().__setitem__(name, value)</code></pre><h3>After Change</h3><pre><code class='java'>
        ```
        

        <a id="change">while </a>self.getattr("delimiter") in name<a id="change">:
            </a>name, rest = name.split(self.getattr("delimiter"), 1)
            if name not in self:
                self.__missing__(name)
            self, name = self[name], rest</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/zhiyuanchen/chanfig/commit/d4fb1daceb90cda9ee35034b70d5e2717fd195b7#diff-6ee785d24d798798af387b71cb1dacc4ea1f8d72c0cd106b63e80e74c618e16dL914' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 64407206</div><div id='project'> Project Name: zhiyuanchen/chanfig</div><div id='commit'> Commit Name: d4fb1daceb90cda9ee35034b70d5e2717fd195b7</div><div id='time'> Time: 2022-10-31</div><div id='author'> Author: this@zyc.ai</div><div id='file'> File Name: chanfig/config.py</div><div id='m_class'> M Class Name: NestedDict</div><div id='n_method'> N Class Name: NestedDict</div><div id='m_method'> M Method Name: set(4)</div><div id='n_method'> N Method Name: set(4)</div><div id='m_parent_class'> M Parent Class: OrderedDict</div><div id='n_parent_class'> N Parent Class: OrderedDict</div><div id='m_file'> M File Name: chanfig/config.py</div><div id='n_file'> N File Name: chanfig/config.py</div><div id='m_start'> M Start Line: 914</div><div id='m_end'> M End Line: 930</div><div id='n_start'> N Start Line: 918</div><div id='n_end'> N End Line: 927</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 Collect shape information for next layer init
        dummy_input = torch.zeros(self.input_shape)
        dummy_output = layer(dummy_input)
        <a id="change">if </a><a id="change">isinstance(</a>dummy_output, tuple<a id="change">)</a>:
            dummy_output<a id="change"> = </a>dummy_output[0]
        self.input_shape = dummy_output.shape

    def forward(self, x):</code></pre><h3>After Change</h3><pre><code class='java'>
            layer_name = str(len(self._modules))
        elif layer_name in self._modules:
            index = 0
            <a id="change">while </a>f"{layer_name}_{index}" in self._modules<a id="change">:
                </a>index += 1
            layer_name = f"{layer_name}_{index}"

        &#47&#47 Check if it needs to be constructed with input shape</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/speechbrain/speechbrain/commit/2525d5683d49e369453b8e137a12ca4956ce37bb#diff-fe619f33723b92bb5bb63f91b88d67fd1684b5fe5d877d67c7b4450c92b9e595L60' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 64407203</div><div id='project'> Project Name: speechbrain/speechbrain</div><div id='commit'> Commit Name: 2525d5683d49e369453b8e137a12ca4956ce37bb</div><div id='time'> Time: 2020-10-21</div><div id='author'> Author: plantinga.peter@protonmail.com</div><div id='file'> File Name: speechbrain/nnet/containers.py</div><div id='m_class'> M Class Name: Sequential</div><div id='n_method'> N Class Name: Sequential</div><div id='m_method'> M Method Name: append(2)</div><div id='n_method'> N Method Name: append(2)</div><div id='m_parent_class'> M Parent Class: torch.nn.Module</div><div id='n_parent_class'> N Parent Class: torch.nn.Module</div><div id='m_file'> M File Name: speechbrain/nnet/containers.py</div><div id='n_file'> N File Name: speechbrain/nnet/containers.py</div><div id='m_start'> M Start Line: 74</div><div id='m_end'> M End Line: 85</div><div id='n_start'> N Start Line: 88</div><div id='n_end'> N End Line: 104</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 TODO this should cover libnodes in general, not just ONNXOps. This would mean the reduce stuff can be moved
        &#47&#47 out of this class
        for node in self.forward_state.nodes():
            <a id="change">if </a><a id="change">isinstance(</a>node, ONNXOp<a id="change">)</a>:
                for impl in ONNXForward.registered_implementations(
                        node.schema.name):
                    if impl.forward_can_be_applied(node, self.forward_state,
                                                   self.sdfg):
                        &#47&#47 try to apply the expansion
                        class Expansion(ExpandTransformation):
                            environments = []
                            _expansion_result = None

                            @classmethod
                            def expansion(cls, node, state, sdfg):
                                return impl.forward(node, state, sdfg)

                            @classmethod
                            def postprocessing(cls, sdfg, state, expansion):
                                cls._expansion_result = expansion

                        Expansion._match_node<a id="change"> = </a>type(node)
                        Expansion.apply_to(self.sdfg,
                                           verify=False,
                                           match_node=node)</code></pre><h3>After Change</h3><pre><code class='java'>
        forward_subgraph = self._find_subgraph_to_differentiate()

        &#47&#47 expand until there is nothing left to expand
        <a id="change">while </a>self._expand_nodes(forward_subgraph)<a id="change">:
            &#47&#47 Nodes have been expanded again on the expanded graph; recalculate the forward graph
            </a>forward_subgraph = self._find_subgraph_to_differentiate()

        &#47&#47 recursively reverse the subgraph
        self._reverse_subgraph(forward_subgraph)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/spcl/daceml/commit/5bbd591f251c72921f24a5c9679b7fec9b12bb6e#diff-6cd9c1fdaa08e9aa7a98c34f21bf00d97acf37ad7e3c772f84578f89ccb1147eL338' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 64407200</div><div id='project'> Project Name: spcl/daceml</div><div id='commit'> Commit Name: 5bbd591f251c72921f24a5c9679b7fec9b12bb6e</div><div id='time'> Time: 2021-03-01</div><div id='author'> Author: oliverrausch99@gmail.com</div><div id='file'> File Name: daceml/autodiff/backward_pass_generator.py</div><div id='m_class'> M Class Name: BackwardPassGenerator</div><div id='n_method'> N Class Name: BackwardPassGenerator</div><div id='m_method'> M Method Name: backward(1)</div><div id='n_method'> N Method Name: backward(1)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: daceml/autodiff/backward_pass_generator.py</div><div id='n_file'> N File Name: daceml/autodiff/backward_pass_generator.py</div><div id='m_start'> M Start Line: 354</div><div id='m_end'> M End Line: 398</div><div id='n_start'> N Start Line: 417</div><div id='n_end'> N End Line: 425</div><BR>