<html><h3>Pattern ID :27018
</h3><img src='80446187.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    
    if not size % 64 == 0:
        raise ValueError(&quotError: Sorry size {} is not supported!&quot.format(size))
    repeat = (4<a id="change"> if size &lt; 512</a><a id="change"> else </a>5)
    feature_map = [math.ceil(size / 2 ** (3 + i)) for i in range(repeat)]

    mean = []</code></pre><h3>After Change</h3><pre><code class='java'>
    if multi_level:
        feature_map = [math.ceil(size / 2 ** (3 + i)) for i in range(repeat)]
    else:
        feature_map = [<a id="change">math.ceil(</a>size<a id="change"> / </a>2 ** 4<a id="change">)</a>]

    mean = []
    for (k, (f_h, f_w)) in enumerate(zip(feature_map, feature_map)):</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/zhanghengdev/mutualguide/commit/85219f93a8d5b54cb3ed9f06d86bb64d3f6d3552#diff-13648402e27d95cc1033b6e910b2c4ee65ea4edfb9cb32dc617757de61962a6cL12' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 80446187</div><div id='project'> Project Name: zhanghengdev/mutualguide</div><div id='commit'> Commit Name: 85219f93a8d5b54cb3ed9f06d86bb64d3f6d3552</div><div id='time'> Time: 2021-10-02</div><div id='author'> Author: heng.zhang@irisa.fr</div><div id='file'> File Name: utils/box/prior_box.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: PriorBox(5)</div><div id='n_method'> N Method Name: PriorBox(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: utils/box/prior_box.py</div><div id='n_file'> N File Name: utils/box/prior_box.py</div><div id='m_start'> M Start Line: 12</div><div id='m_end'> M End Line: 34</div><div id='n_start'> N Start Line: 12</div><div id='n_end'> N End Line: 45</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    ]

    optimizer_sizes: List[int] = [
        tensor_size * 2<a id="change"> if compute_kernel == EmbeddingComputeKernel.DENSE.value</a><a id="change"> else </a>0
        for tensor_size in tensor_sizes
    ]
</code></pre><h3>After Change</h3><pre><code class='java'>
    optimizer_multipler: float = _get_optimizer_multipler(optimizer_class, shape)

    optimizer_sizes: List[int] = [
        <a id="change">math.ceil(</a>tensor_size<a id="change"> * </a>optimizer_multipler<a id="change">)</a> for tensor_size in tensor_sizes
    ]

    return [</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/facebookresearch/torchrec/commit/b0a039f4baef68d5e1a518cb7e4bafb8a6f55b50#diff-03f056051f1fe77d422eadb7df762af8b375e6dbb1e7f2be7cbe786266aae090L974' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 80446184</div><div id='project'> Project Name: facebookresearch/torchrec</div><div id='commit'> Commit Name: b0a039f4baef68d5e1a518cb7e4bafb8a6f55b50</div><div id='time'> Time: 2022-10-12</div><div id='author'> Author: quytranle@meta.com</div><div id='file'> File Name: torchrec/distributed/planner/shard_estimators.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _calculate_storage_specific_sizes(5)</div><div id='n_method'> N Method Name: _calculate_storage_specific_sizes(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: torchrec/distributed/planner/shard_estimators.py</div><div id='n_file'> N File Name: torchrec/distributed/planner/shard_estimators.py</div><div id='m_start'> M Start Line: 979</div><div id='m_end'> M End Line: 990</div><div id='n_start'> N Start Line: 982</div><div id='n_end'> N End Line: 993</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    ]

    optimizer_sizes: List[int] = [
        tensor_size * 2<a id="change"> if compute_kernel == EmbeddingComputeKernel.DENSE.value</a><a id="change"> else </a>0
        for tensor_size in tensor_sizes
    ]
</code></pre><h3>After Change</h3><pre><code class='java'>
    optimizer_multipler: float = _get_optimizer_multipler(optimizer_class, shape)

    optimizer_sizes: List[int] = [
        <a id="change">math.ceil(</a>tensor_size<a id="change"> * </a>optimizer_multipler<a id="change">)</a> for tensor_size in tensor_sizes
    ]

    return [</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/facebookresearch/torchrec/commit/f63cd2f307f8a7d3f78d40cbc4fdd08fcdc0d53d#diff-03f056051f1fe77d422eadb7df762af8b375e6dbb1e7f2be7cbe786266aae090L974' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 80446183</div><div id='project'> Project Name: facebookresearch/torchrec</div><div id='commit'> Commit Name: f63cd2f307f8a7d3f78d40cbc4fdd08fcdc0d53d</div><div id='time'> Time: 2022-09-29</div><div id='author'> Author: quytranle@fb.com</div><div id='file'> File Name: torchrec/distributed/planner/shard_estimators.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _calculate_storage_specific_sizes(5)</div><div id='n_method'> N Method Name: _calculate_storage_specific_sizes(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: torchrec/distributed/planner/shard_estimators.py</div><div id='n_file'> N File Name: torchrec/distributed/planner/shard_estimators.py</div><div id='m_start'> M Start Line: 979</div><div id='m_end'> M End Line: 990</div><div id='n_start'> N Start Line: 982</div><div id='n_end'> N End Line: 993</div><BR>