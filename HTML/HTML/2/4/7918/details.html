<html><h3>Pattern ID :7918
</h3><img src='28167469.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    def __init__(self, config, engine):
        super().__init__(config, engine)
        if not engine.use_original_metric:
            self._metrics_config[&quotoriginal_metric&quot].persample = <a id="change">Dict(
                name=&quotnmse&quot,
                type=&quotnmse&quot,
                is_special=True,
                comparator=lambda a: -a,
                sort_fn=partial(pot.algorithms.quantization.accuracy_aware_common.utils.sort_by_logit_distance,
                                distance=&quotnmse&quot)
            )</a>
            self._metrics_config[&quotoriginal_metric&quot].ranking = Dict(
                name=&quotnmse&quot,
                type=&quotnmse&quot,
                is_special=True,</code></pre><h3>After Change</h3><pre><code class='java'>
        if not engine.use_original_metric:
            self._metrics_config[&quotoriginal_metric&quot].persample.clear()
            self._metrics_config[&quotoriginal_metric&quot].persample.update(
                <a id="change">{
                    </a>"name": &quotnmse&quot,
                    "type": &quotnmse&quot,
                    "is_special": True,
                    "comparator": lambda a: -a,
                    "sort_fn": partial(
                        pot.algorithms.quantization.accuracy_aware_common.utils.sort_by_logit_distance,
                        distance=&quotnmse&quot)<a id="change">
                }</a>
            )
            self._metrics_config[&quotoriginal_metric&quot].ranking.clear()
            self._metrics_config[&quotoriginal_metric&quot].ranking.update(
                <a id="change">{
                    </a>"name": "nmse",
                    "type": "nmse",
                    "is_special": True,
                    "comparator": lambda a: -a,
                    "sort_fn": partial(pot.algorithms.quantization.accuracy_aware_common.utils.sort_by_logit_distance,
                                       distance=&quotnmse&quot)<a id="change">
                }</a>
            )

    def _get_score(self, model, ranking_subset: List[int], metric_name: str) -&gt; float:
        if self._engine.use_original_metric:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/openvinotoolkit/nncf/commit/315a91e3959c24c4295201fca0a7f29e7390469c#diff-25b7483fa332c9b60ff59cb6d4ce2f90d5e8d3fea70ce79aabe429df7945b6b3L36' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28167469</div><div id='project'> Project Name: openvinotoolkit/nncf</div><div id='commit'> Commit Name: 315a91e3959c24c4295201fca0a7f29e7390469c</div><div id='time'> Time: 2023-01-25</div><div id='author'> Author: vasily.shamporov@intel.com</div><div id='file'> File Name: nncf/openvino/quantization/accuracy_aware.py</div><div id='m_class'> M Class Name: NMSEBasedAccuracyAware</div><div id='n_method'> N Class Name: NMSEBasedAccuracyAware</div><div id='m_method'> M Method Name: __init__(3)</div><div id='n_method'> N Method Name: __init__(3)</div><div id='m_parent_class'> M Parent Class: pot.AccuracyAwareCommon</div><div id='n_parent_class'> N Parent Class: pot.AccuracyAwareCommon</div><div id='m_file'> M File Name: nncf/openvino/quantization/accuracy_aware.py</div><div id='n_file'> N File Name: nncf/openvino/quantization/accuracy_aware.py</div><div id='m_start'> M Start Line: 38</div><div id='m_end'> M End Line: 53</div><div id='n_start'> N Start Line: 36</div><div id='n_end'> N End Line: 58</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

def get_basic_pruning_config(model_size=8):
    config = NNCFConfig()
    config.update(<a id="change">Dict(</a>{
        "model": "basic",
        "input_info":
            {
                "sample_size": [1, model_size, model_size, 1],
            },
        "compression":
            {
                "algorithm": "filter_pruning",
                "pruning_init": 0.5,
                "params": {
                    "prune_first_conv": True,
                }
            }
    }<a id="change">)</a>)
    return config

</code></pre><h3>After Change</h3><pre><code class='java'>

def get_basic_pruning_config(model_size=8):
    config = NNCFConfig()
    config.update(<a id="change">{
        </a>"model": "basic",
        "input_info":
            {
                "sample_size": [1, model_size, model_size, 1],
            },
        "compression":
            <a id="change">{
                </a>"algorithm": "filter_pruning",
                "pruning_init": 0.5,
                "params": {
                    "prune_first_conv": True,
                }<a id="change">
            }
    }</a>)
    return config

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/openvinotoolkit/nncf/commit/315a91e3959c24c4295201fca0a7f29e7390469c#diff-34d86686501a508cd444d49289043f00a8120814053cbe24bf60c0da297fefa1L21' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28167453</div><div id='project'> Project Name: openvinotoolkit/nncf</div><div id='commit'> Commit Name: 315a91e3959c24c4295201fca0a7f29e7390469c</div><div id='time'> Time: 2023-01-25</div><div id='author'> Author: vasily.shamporov@intel.com</div><div id='file'> File Name: tests/tensorflow/pruning/helpers.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: get_basic_pruning_config(1)</div><div id='n_method'> N Method Name: get_basic_pruning_config(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/tensorflow/pruning/helpers.py</div><div id='n_file'> N File Name: tests/tensorflow/pruning/helpers.py</div><div id='m_start'> M Start Line: 23</div><div id='m_end'> M End Line: 37</div><div id='n_start'> N Start Line: 22</div><div id='n_end'> N End Line: 36</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    def __init__(self, config, engine):
        super().__init__(config, engine)
        if not engine.use_original_metric:
            self._metrics_config[&quotoriginal_metric&quot].persample = <a id="change">Dict(
                name=&quotnmse&quot,
                type=&quotnmse&quot,
                is_special=True,
                comparator=lambda a: -a,
                sort_fn=partial(pot.algorithms.quantization.accuracy_aware_common.utils.sort_by_logit_distance,
                                distance=&quotnmse&quot)
            )</a>
            self._metrics_config[&quotoriginal_metric&quot].ranking = Dict(
                name=&quotnmse&quot,
                type=&quotnmse&quot,
                is_special=True,</code></pre><h3>After Change</h3><pre><code class='java'>
        if not engine.use_original_metric:
            self._metrics_config[&quotoriginal_metric&quot].persample.clear()
            self._metrics_config[&quotoriginal_metric&quot].persample.update(
                <a id="change">{
                    </a>"name": &quotnmse&quot,
                    "type": &quotnmse&quot,
                    "is_special": True,
                    "comparator": lambda a: -a,
                    "sort_fn": partial(
                        pot.algorithms.quantization.accuracy_aware_common.utils.sort_by_logit_distance,
                        distance=&quotnmse&quot)<a id="change">
                }</a>
            )
            self._metrics_config[&quotoriginal_metric&quot].ranking.clear()
            self._metrics_config[&quotoriginal_metric&quot].ranking.update(
                <a id="change">{
                    </a>"name": "nmse",
                    "type": "nmse",
                    "is_special": True,
                    "comparator": lambda a: -a,
                    "sort_fn": partial(pot.algorithms.quantization.accuracy_aware_common.utils.sort_by_logit_distance,
                                       distance=&quotnmse&quot)<a id="change">
                }</a>
            )

    def _get_score(self, model, ranking_subset: List[int], metric_name: str) -&gt; float:
        if self._engine.use_original_metric:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/openvinotoolkit/nncf/commit/315a91e3959c24c4295201fca0a7f29e7390469c#diff-25b7483fa332c9b60ff59cb6d4ce2f90d5e8d3fea70ce79aabe429df7945b6b3L35' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28167468</div><div id='project'> Project Name: openvinotoolkit/nncf</div><div id='commit'> Commit Name: 315a91e3959c24c4295201fca0a7f29e7390469c</div><div id='time'> Time: 2023-01-25</div><div id='author'> Author: vasily.shamporov@intel.com</div><div id='file'> File Name: nncf/openvino/quantization/accuracy_aware.py</div><div id='m_class'> M Class Name: NMSEBasedAccuracyAware</div><div id='n_method'> N Class Name: NMSEBasedAccuracyAware</div><div id='m_method'> M Method Name: __init__(3)</div><div id='n_method'> N Method Name: __init__(3)</div><div id='m_parent_class'> M Parent Class: pot.AccuracyAwareCommon</div><div id='n_parent_class'> N Parent Class: pot.AccuracyAwareCommon</div><div id='m_file'> M File Name: nncf/openvino/quantization/accuracy_aware.py</div><div id='n_file'> N File Name: nncf/openvino/quantization/accuracy_aware.py</div><div id='m_start'> M Start Line: 38</div><div id='m_end'> M End Line: 53</div><div id='n_start'> N Start Line: 36</div><div id='n_end'> N End Line: 58</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

def get_basic_quantization_config(model_size=4):
    config = NNCFConfig()
    config.update(<a id="change">Dict(</a>{
        &quotmodel&quot: &quotbasic_quant_conv&quot,
        &quotinput_info&quot:
            {
                &quotsample_size&quot: [1, model_size, model_size, 1],
            },
        &quotcompression&quot:
            {
                &quotalgorithm&quot: &quotquantization&quot,
            }
    }<a id="change">)</a>)
    return config

</code></pre><h3>After Change</h3><pre><code class='java'>

def get_basic_quantization_config(model_size=4):
    config = NNCFConfig()
    config.update(<a id="change">{
        </a>&quotmodel&quot: &quotbasic_quant_conv&quot,
        &quotinput_info&quot:
            {
                &quotsample_size&quot: [1, model_size, model_size, 1],
            },
        &quotcompression&quot:
            <a id="change">{
                </a>&quotalgorithm&quot: &quotquantization&quot<a id="change">,
            }
    }</a>)
    return config

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/openvinotoolkit/nncf/commit/315a91e3959c24c4295201fca0a7f29e7390469c#diff-cace49a38d03514e87f648fefdb8544aeaf51d532fc48e00c06754c147f046b8L19' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28167459</div><div id='project'> Project Name: openvinotoolkit/nncf</div><div id='commit'> Commit Name: 315a91e3959c24c4295201fca0a7f29e7390469c</div><div id='time'> Time: 2023-01-25</div><div id='author'> Author: vasily.shamporov@intel.com</div><div id='file'> File Name: tests/tensorflow/quantization/utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: get_basic_quantization_config(1)</div><div id='n_method'> N Method Name: get_basic_quantization_config(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/tensorflow/quantization/utils.py</div><div id='n_file'> N File Name: tests/tensorflow/quantization/utils.py</div><div id='m_start'> M Start Line: 21</div><div id='m_end'> M End Line: 31</div><div id='n_start'> N Start Line: 20</div><div id='n_end'> N End Line: 30</div><BR>