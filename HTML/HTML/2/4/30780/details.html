<html><h3>Pattern ID :30780
</h3><img src='90704824.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                                                                                     beta, channels_index)
            if cur_iteration == 0 or cur_iteration % 100 == 0:
                logger.debug("After iterations=%d, Total loss=%5f, Recons. loss=%5f, Rounding loss=%5f",
                             cur_iteration, float(total_loss), <a id="change">float(</a>recon_loss<a id="change">)</a>, float(round_loss))

        wrapper.use_soft_rounding.assign(False)
        hard_rounded_weight = wrapper.adaround_weights()</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 across the channels index
        channels_index = len(orig_out_data.shape) - 1

        inp_shape = <a id="change">inp_data.shape[1:]</a>
        inp_layer = tf.keras.Input(shape=inp_shape)
        adaround_out_tensor = wrapper(inp_layer)

        &#47&#47 If followed by an activation function</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/quic/aimet/commit/ad43d566c521ad2f61cfbd2c50ae8105b5a574a4#diff-a80969f5ffd7a06a1bfc06d11ee00cce33cb71d4819172fb96e4557dcf0f834fL136' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 90704824</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: ad43d566c521ad2f61cfbd2c50ae8105b5a574a4</div><div id='time'> Time: 2022-12-14</div><div id='author'> Author: quic_cgulecha@quicinc.com</div><div id='file'> File Name: TrainingExtensions/tensorflow/src/python/aimet_tensorflow/keras/adaround/adaround_optimizer.py</div><div id='m_class'> M Class Name: AdaroundOptimizer</div><div id='n_method'> N Class Name: AdaroundOptimizer</div><div id='m_method'> M Method Name: optimize_rounding(5)</div><div id='n_method'> N Method Name: optimize_rounding(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: TrainingExtensions/tensorflow/src/python/aimet_tensorflow/keras/adaround/adaround_optimizer.py</div><div id='n_file'> N File Name: TrainingExtensions/tensorflow/src/python/aimet_tensorflow/keras/adaround/adaround_optimizer.py</div><div id='m_start'> M Start Line: 136</div><div id='m_end'> M End Line: 165</div><div id='n_start'> N Start Line: 203</div><div id='n_end'> N End Line: 225</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    with open(name, &quotr&quot) as fin:
        for line in fin:
            a, b = line.split()
            ret.append(abs(<a id="change">float(</a>b<a id="change">)</a>))
    return ret

def loadlion(name):</code></pre><h3>After Change</h3><pre><code class='java'>
    with open(name, &quotr&quot) as fin:
        for line in fin:
            a = line.split()
            aa = [float(x) for x in <a id="change">a[1:5]</a>]
            b = entropy(aa)
            c = sum(aa)
            ret1.append(b)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/thudm/swissarmytransformer/commit/87d6ae9cefdb2f104af9d7331409cfd314102e89#diff-9a6aaa29373963aec51b39950ac6b6c6c211d60ac2c6298c0ab7f35e2776bba8L3' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 90704826</div><div id='project'> Project Name: thudm/swissarmytransformer</div><div id='commit'> Commit Name: 87d6ae9cefdb2f104af9d7331409cfd314102e89</div><div id='time'> Time: 2021-10-01</div><div id='author'> Author: dm_thu@qq.com</div><div id='file'> File Name: draw_diff.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: loadbao(1)</div><div id='n_method'> N Method Name: loadbao(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: draw_diff.py</div><div id='n_file'> N File Name: draw_diff.py</div><div id='m_start'> M Start Line: 4</div><div id='m_end'> M End Line: 9</div><div id='n_start'> N Start Line: 9</div><div id='n_end'> N End Line: 18</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        mask = 1.0 - mask_flag

        elem_numel = input_shape[0] * input_shape[1] * input_shape[2] * input_shape[3]
        elem_numel_m = <a id="change">float(</a>elem_numel<a id="change">)</a>

        elem_sum = mask.sum()

        output = input * mask * elem_numel_m / elem_sum</code></pre><h3>After Change</h3><pre><code class='java'>
            if self.data_format == &quotNCHW&quot:
                shape = x.shape[2:]
            else:
                shape = <a id="change">x.shape[1:3]</a>
            for s in shape:
                gamma *= s / (s - self.block_size + 1)

            matrix = torch.rand(x.shape, device=x.device)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/miemie2013/miemiedetection/commit/aabe1f2d364493c30179de6cf7d5c2d0c6ee7258#diff-a8b191246b197a19b67f7091a6ab58484cff81cdb9be1d770800a043a751c910L537' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 90704829</div><div id='project'> Project Name: miemie2013/miemiedetection</div><div id='commit'> Commit Name: aabe1f2d364493c30179de6cf7d5c2d0c6ee7258</div><div id='time'> Time: 2021-12-30</div><div id='author'> Author: 53960695+miemie2013@users.noreply.github.com</div><div id='file'> File Name: mmdet/models/custom_layers.py</div><div id='m_class'> M Class Name: DropBlock</div><div id='n_method'> N Class Name: DropBlock</div><div id='m_method'> M Method Name: forward(2)</div><div id='n_method'> N Method Name: forward(2)</div><div id='m_parent_class'> M Parent Class: torch.nn.Module</div><div id='n_parent_class'> N Parent Class: torch.nn.Module</div><div id='m_file'> M File Name: mmdet/models/custom_layers.py</div><div id='n_file'> N File Name: mmdet/models/custom_layers.py</div><div id='m_start'> M Start Line: 538</div><div id='m_end'> M End Line: 576</div><div id='n_start'> N Start Line: 724</div><div id='n_end'> N End Line: 745</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if config[&quotlw&quot] == &quot&quot:
            lw = [1, ] * len(config[&quotloss&quot])
        else:
            lw = [<a id="change">float(</a>w<a id="change">)</a> for w in config[&quotlw&quot].split(&quot,&quot)]
        assert len(config[&quotloss&quot]) == len(lw), &quotLength of loss and loss_weight should be equal.&quot
        
        self.losses = config[&quotloss&quot]</code></pre><h3>After Change</h3><pre><code class='java'>
        
        self.loss_cluster = {}
        for out_name, loss_casket in loss_config.items():
            self.loss_cluster[out_name] = loss_worker(loss_casket[0], <a id="change">loss_casket[1:]</a>)
            print(&quot{} loss for output \"{}\".&quot.format(self.loss_cluster[out_name].loss_print, out_name))
        
    def forward(self, preds, target, config):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/moothes/salod/commit/f7e568383ce7d5dd4f7582e346e1d86bb6a4b171#diff-d80310b4dcfb770922b3cf407361143525e2384f0e42c3c18145946486038094L141' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 90704823</div><div id='project'> Project Name: moothes/salod</div><div id='commit'> Commit Name: f7e568383ce7d5dd4f7582e346e1d86bb6a4b171</div><div id='time'> Time: 2022-08-18</div><div id='author'> Author: zhouhuajun123@126.com</div><div id='file'> File Name: base/loss.py</div><div id='m_class'> M Class Name: Loss_factory</div><div id='n_method'> N Class Name: Loss_factory</div><div id='m_method'> M Method Name: __init__(2)</div><div id='n_method'> N Method Name: __init__(2)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: base/loss.py</div><div id='n_file'> N File Name: base/loss.py</div><div id='m_start'> M Start Line: 143</div><div id='m_end'> M End Line: 150</div><div id='n_start'> N Start Line: 190</div><div id='n_end'> N End Line: 195</div><BR>