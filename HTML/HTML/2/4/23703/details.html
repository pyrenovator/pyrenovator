<html><h3>Pattern ID :23703
</h3><img src='73909342.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        prompt = num_samples * [prompt]
        prompt_ids = pipeline.prepare_inputs(prompt)

        p_sample<a id="change"> = </a><a id="change">pmap(</a>pipeline.__call__<a id="change">, static_broadcasted_argnums=(3,))</a>

        &#47&#47 shard inputs and rng
        params = replicate(params)
        prng_seed = jax.random.split(prng_seed, num_samples)</code></pre><h3>After Change</h3><pre><code class='java'>
        prng_seed = jax.random.split(prng_seed, num_samples)
        prompt_ids = shard(prompt_ids)

        images<a id="change"> = </a><a id="change">pipeline(</a>prompt_ids, params, prng_seed, num_inference_steps<a id="change">, jit=True)</a>.images

        assert images.shape == (num_samples, 1, 64, 64, 3)
        if jax.device_count() == 8:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/huggingface/diffusers/commit/e3095c5f475d6bfa0a02926cd2397d44d57f44fa#diff-c1c8cf5e89f95b3f20de2aa7637e9030356a16f79d5e852c18654821964ac8f5L66' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 73909342</div><div id='project'> Project Name: huggingface/diffusers</div><div id='commit'> Commit Name: e3095c5f475d6bfa0a02926cd2397d44d57f44fa</div><div id='time'> Time: 2023-04-11</div><div id='author'> Author: pedro@huggingface.co</div><div id='file'> File Name: tests/test_pipelines_flax.py</div><div id='m_class'> M Class Name: FlaxPipelineTests</div><div id='n_method'> N Class Name: FlaxPipelineTests</div><div id='m_method'> M Method Name: test_dummy_all_tpus(1)</div><div id='n_method'> N Method Name: test_dummy_all_tpus(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: tests/test_pipelines_flax.py</div><div id='n_file'> N File Name: tests/test_pipelines_flax.py</div><div id='m_start'> M Start Line: 67</div><div id='m_end'> M End Line: 80</div><div id='n_start'> N Start Line: 66</div><div id='n_end'> N End Line: 77</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        prompt = num_samples * [prompt]
        prompt_ids = pipeline.prepare_inputs(prompt)

        p_sample<a id="change"> = </a><a id="change">pmap(</a>pipeline.__call__<a id="change">, static_broadcasted_argnums=(3,))</a>

        &#47&#47 shard inputs and rng
        params = replicate(params)
        prng_seed = jax.random.split(prng_seed, num_samples)</code></pre><h3>After Change</h3><pre><code class='java'>
        prng_seed = jax.random.split(prng_seed, num_samples)
        prompt_ids = shard(prompt_ids)

        images<a id="change"> = </a><a id="change">pipeline(</a>prompt_ids, params, prng_seed, num_inference_steps<a id="change">, jit=True)</a>.images

        assert images.shape == (num_samples, 1, 512, 512, 3)
        if jax.device_count() == 8:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/diffusers/commit/e3095c5f475d6bfa0a02926cd2397d44d57f44fa#diff-c1c8cf5e89f95b3f20de2aa7637e9030356a16f79d5e852c18654821964ac8f5L182' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 73909341</div><div id='project'> Project Name: huggingface/diffusers</div><div id='commit'> Commit Name: e3095c5f475d6bfa0a02926cd2397d44d57f44fa</div><div id='time'> Time: 2023-04-11</div><div id='author'> Author: pedro@huggingface.co</div><div id='file'> File Name: tests/test_pipelines_flax.py</div><div id='m_class'> M Class Name: FlaxPipelineTests</div><div id='n_method'> N Class Name: FlaxPipelineTests</div><div id='m_method'> M Method Name: test_stable_diffusion_v1_4_bfloat_16_ddim(1)</div><div id='n_method'> N Method Name: test_stable_diffusion_v1_4_bfloat_16_ddim(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: tests/test_pipelines_flax.py</div><div id='n_file'> N File Name: tests/test_pipelines_flax.py</div><div id='m_start'> M Start Line: 208</div><div id='m_end'> M End Line: 221</div><div id='n_start'> N Start Line: 201</div><div id='n_end'> N End Line: 212</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        prompt = num_samples * [prompt]
        prompt_ids = pipeline.prepare_inputs(prompt)

        p_sample<a id="change"> = </a><a id="change">pmap(</a>pipeline.__call__<a id="change">, static_broadcasted_argnums=(3,))</a>

        &#47&#47 shard inputs and rng
        params = replicate(params)
        prng_seed = jax.random.split(prng_seed, num_samples)</code></pre><h3>After Change</h3><pre><code class='java'>
        prng_seed = jax.random.split(prng_seed, num_samples)
        prompt_ids = shard(prompt_ids)

        images<a id="change"> = </a><a id="change">pipeline(</a>prompt_ids, params, prng_seed, num_inference_steps<a id="change">, jit=True)</a>.images

        assert images.shape == (num_samples, 1, 512, 512, 3)
        if jax.device_count() == 8:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/diffusers/commit/e3095c5f475d6bfa0a02926cd2397d44d57f44fa#diff-c1c8cf5e89f95b3f20de2aa7637e9030356a16f79d5e852c18654821964ac8f5L122' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 73909340</div><div id='project'> Project Name: huggingface/diffusers</div><div id='commit'> Commit Name: e3095c5f475d6bfa0a02926cd2397d44d57f44fa</div><div id='time'> Time: 2023-04-11</div><div id='author'> Author: pedro@huggingface.co</div><div id='file'> File Name: tests/test_pipelines_flax.py</div><div id='m_class'> M Class Name: FlaxPipelineTests</div><div id='n_method'> N Class Name: FlaxPipelineTests</div><div id='m_method'> M Method Name: test_stable_diffusion_v1_4_bfloat_16(1)</div><div id='n_method'> N Method Name: test_stable_diffusion_v1_4_bfloat_16(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: tests/test_pipelines_flax.py</div><div id='n_file'> N File Name: tests/test_pipelines_flax.py</div><div id='m_start'> M Start Line: 133</div><div id='m_end'> M End Line: 146</div><div id='n_start'> N Start Line: 128</div><div id='n_end'> N End Line: 139</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        prompt = num_samples * [prompt]
        prompt_ids = pipeline.prepare_inputs(prompt)

        p_sample<a id="change"> = </a><a id="change">pmap(</a>pipeline.__call__<a id="change">, static_broadcasted_argnums=(3,))</a>

        &#47&#47 shard inputs and rng
        params = replicate(params)
        prng_seed = jax.random.split(prng_seed, num_samples)</code></pre><h3>After Change</h3><pre><code class='java'>
        prng_seed = jax.random.split(prng_seed, num_samples)
        prompt_ids = shard(prompt_ids)

        images<a id="change"> = </a><a id="change">pipeline(</a>prompt_ids, params, prng_seed, num_inference_steps<a id="change">, jit=True)</a>.images

        assert images.shape == (num_samples, 1, 512, 512, 3)
        if jax.device_count() == 8:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/diffusers/commit/e3095c5f475d6bfa0a02926cd2397d44d57f44fa#diff-c1c8cf5e89f95b3f20de2aa7637e9030356a16f79d5e852c18654821964ac8f5L91' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 73909339</div><div id='project'> Project Name: huggingface/diffusers</div><div id='commit'> Commit Name: e3095c5f475d6bfa0a02926cd2397d44d57f44fa</div><div id='time'> Time: 2023-04-11</div><div id='author'> Author: pedro@huggingface.co</div><div id='file'> File Name: tests/test_pipelines_flax.py</div><div id='m_class'> M Class Name: FlaxPipelineTests</div><div id='n_method'> N Class Name: FlaxPipelineTests</div><div id='m_method'> M Method Name: test_stable_diffusion_v1_4(1)</div><div id='n_method'> N Method Name: test_stable_diffusion_v1_4(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: tests/test_pipelines_flax.py</div><div id='n_file'> N File Name: tests/test_pipelines_flax.py</div><div id='m_start'> M Start Line: 102</div><div id='m_end'> M End Line: 115</div><div id='n_start'> N Start Line: 99</div><div id='n_end'> N End Line: 110</div><BR>