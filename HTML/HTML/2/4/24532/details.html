<html><h3>Pattern ID :24532
</h3><img src='76244602.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    mode = &quotrandom_sampling&quot

    today = date.today().strftime("%d_%m_%Y")
    <a id="change">if </a>LOCAL: 
        checkpoint_folder = &quotcheckpoints/{}/&quot.format(today)
        try:
            <a id="change">os.makedirs(</a>checkpoint_folder<a id="change">)</a>
        except:
            print(&quotcheckpoint_folder already exists&quot)
            
        if mode == &quotbit_corruption&quot:</code></pre><h3>After Change</h3><pre><code class='java'>

    checkpoint_folder, base_path, cluster_path, sparseFP_vocab_path = setup_paths(expt_name, mode, LOCAL, cosine, multi) 

    trainargs<a id="change"> = </a><a id="change">{
    </a>&quotmodel&quot: &quotFeedforward&quot,
    &quothidden_sizes&quot: [1024, 256],  
    &quotoutput_size&quot: 1,
    &quotdropout&quot: 0.1,  
    
    &quotbatch_size&quot: 64,
    &quotactivation&quot: &quotReLU&quot,  
    &quotoptimizer&quot: torch.optim.Adam,
    &quotlearning_rate&quot:  3e-3, &#47&#47 to try: lr_finder & lr_schedulers 
    &quotepochs&quot: 50,
    &quotearly_stop&quot: True,
    &quotmin_delta&quot: 1e-5, &#47&#47 we just want to watch out for when val_loss increases
    &quotpatience&quot: 3,
    &quotnum_workers&quot: 4,

    &quotcheckpoint&quot: True,
    &quotmodel_seed&quot: 1337,
    &quotrandom_seed&quot: 0, &#47&#47 affects neg rxn sampling since it is random
    
    &quotrctfp_size&quot: 4096, &#47&#47 if fp_type == &quotdiff&quot, ensure that both rctfp_size & prodfp_size are identical!
    &quotprodfp_size&quot: 4096,
    &quotfp_radius&quot: 3,
    &quotfp_type&quot: &quotdiff&quot,
    
    &quotnum_neg_prod&quot: 5, 
    &quotnum_neg_rct&quot: 5,
    &quotnum_bits&quot: 3, 
    &quotnum_neg&quot: 10,
    
    &quotbase_path&quot: base_path, &#47&#47 refer to top of notebook 
    &quotcheckpoint_path&quot: checkpoint_folder,
    &quotcluster_path&quot: cluster_path,
    &quotsparseFP_vocab_path&quot: sparseFP_vocab_path,
    &quotquery_params&quot: {&quotefSearch&quot: 100}, &#47&#47 good value to hit 96% recall
 
    &quotexpt_name&quot: expt_name,
    &quotdevice&quot: torch.device("cuda" if torch.cuda.is_available() else "cpu")<a id="change">
    }</a>   

    model = FeedforwardEBM(trainargs)
    experiment = Experiment(model, trainargs, mode=mode)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/coleygroup/rxn-ebm/commit/70c19fb3c2a4341f00c4c06cbc73fd0ceff714f3#diff-29331b35cc6abfaea1ba66278f85b76aaa7545612953b3519c8793490ab9c150L7' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 76244602</div><div id='project'> Project Name: coleygroup/rxn-ebm</div><div id='commit'> Commit Name: 70c19fb3c2a4341f00c4c06cbc73fd0ceff714f3</div><div id='time'> Time: 2020-09-13</div><div id='author'> Author: linmin001@e.ntu.edu.sg</div><div id='file'> File Name: trainEBM.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: trainEBM(0)</div><div id='n_method'> N Method Name: trainEBM(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: trainEBM.py</div><div id='n_file'> N File Name: trainEBM.py</div><div id='m_start'> M Start Line: 7</div><div id='m_end'> M End Line: 89</div><div id='n_start'> N Start Line: 13</div><div id='n_end'> N End Line: 59</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        self.min_val_loss = np.Inf
        self.result_path = os.path.join(&quotresults&quot, config[&quotsession_name&quot])
        self.checkpoint_path = os.path.join(self.result_path, &quotcheckpoints/chkp.tar&quot)
        <a id="change">if </a>not os.path.exists(self.result_path):
            <a id="change">os.makedirs(</a>self.result_path<a id="change">)</a>

        &#47&#47 load network parameters and optimizer if resuming from previous session
        if config[&quotprevious_session&quot] != "":
            resume_path = "{}/{}/{}".format(&quotresults&quot, config[&quotprevious_session&quot], &quotchkp.tar&quot)</code></pre><h3>After Change</h3><pre><code class='java'>
        self.config = config
        self.max_epochs = self.config[&quottrainer&quot][&quotmax_epochs&quot]
        &#47&#47 self.lr_decay_ee = self.config[&quotoptimizer&quot][&quotlr_decay_ee&quot]
        self.lr_decays<a id="change"> = </a><a id="change">{}</a>  &#47&#47 {i: 0.1 ** (1 / self.lr_decay_ee) for i in range(1, self.max_epochs)}

    def train_epoch(self, epoch):
        </code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/utiasasrl/hero_radar_odometry/commit/47db13d7623cdffa8a11fa4fcb33c9ba320a28b0#diff-fbf874bb8e2b2423c37ca93e9eda9eb3b18b34b3f93de0297bcd280e197fa82eL14' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 76244601</div><div id='project'> Project Name: utiasasrl/hero_radar_odometry</div><div id='commit'> Commit Name: 47db13d7623cdffa8a11fa4fcb33c9ba320a28b0</div><div id='time'> Time: 2020-08-14</div><div id='author'> Author: mona.gridseth@robotics.utias.utoronto.ca</div><div id='file'> File Name: utils/trainer.py</div><div id='m_class'> M Class Name: Trainer</div><div id='n_method'> N Class Name: Trainer</div><div id='m_method'> M Method Name: __init__(7)</div><div id='n_method'> N Method Name: __init__(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: utils/trainer.py</div><div id='n_file'> N File Name: utils/trainer.py</div><div id='m_start'> M Start Line: 36</div><div id='m_end'> M End Line: 59</div><div id='n_start'> N Start Line: 14</div><div id='n_end'> N End Line: 52</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        
        self.output_dir = output_dir
        <a id="change">if </a>self.output_dir:
            <a id="change">os.makedirs(</a>self.output_dir<a id="change">, exist_ok=True)</a>

        self.k = interpolation_k
        self.classification_dict = classification_dict
</code></pre><h3>After Change</h3><pre><code class='java'>
            for class_index, class_code in enumerate(classification_dict.keys())
        }
        self.logits_sub: List[torch.Tensor] = []
        self.pos_sub<a id="change">: List[torch.Tensor] = </a><a id="change">[]</a>
        self.batch_sub: List[torch.Tensor] = []
        self.idx_in_full_cloud_list: List[np.ndarray] = []

    def load_full_las_for_update(self, raw_path: str):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ignf/lidar-deep-segmentation/commit/5c03169ac337f58fbf57200f4c9c12f862752be1#diff-dc0473547424a5c11f5aa2a0bcca38c2589161f3775e14ae8706c479ac0280f7L22' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 76244600</div><div id='project'> Project Name: ignf/lidar-deep-segmentation</div><div id='commit'> Commit Name: 5c03169ac337f58fbf57200f4c9c12f862752be1</div><div id='time'> Time: 2022-06-09</div><div id='author'> Author: charles.gaydon@gmail.com</div><div id='file'> File Name: myria3d/models/interpolation.py</div><div id='m_class'> M Class Name: Interpolator</div><div id='n_method'> N Class Name: Interpolator</div><div id='m_method'> M Method Name: __init__(4)</div><div id='n_method'> N Method Name: __init__(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: myria3d/models/interpolation.py</div><div id='n_file'> N File Name: myria3d/models/interpolation.py</div><div id='m_start'> M Start Line: 27</div><div id='m_end'> M End Line: 61</div><div id='n_start'> N Start Line: 56</div><div id='n_end'> N End Line: 59</div><BR>