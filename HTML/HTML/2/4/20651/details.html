<html><h3>Pattern ID :20651
</h3><img src='66507296.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        &#47&#47 validation metrics
        preds = torch.argmax(logits, dim=1)
        preds, y = preds.cpu()<a id="change">, y.cpu()</a>
        acc = accuracy_score(preds, y)
        self.log(&quotval_loss&quot, loss, on_step=False, on_epoch=True, logger=True, prog_bar=True)
        self.log(&quotval_acc&quot, acc, on_step=False, on_epoch=True, logger=True, prog_bar=True)
</code></pre><h3>After Change</h3><pre><code class='java'>

        &#47&#47 validation metrics
        preds = torch.argmax(logits, dim=1)
        acc = <a id="change">accuracy_score(</a>preds.cpu(), y.cpu()<a id="change">)</a>
        self.log(&quotval_loss&quot, loss, on_step=False, on_epoch=True, logger=True, prog_bar=True)
        self.log(&quotval_acc&quot, acc, on_step=False, on_epoch=True, logger=True, prog_bar=True)

        <a id="change">return </a>loss<a id="change">, acc, preds, y</a>

    &#47&#47 logic for a single testing step
    def test_step(self, batch, batch_idx):
        x, y = batch</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/ashleve/lightning-hydra-template/commit/0030c94b17bdd837b536a177ae3b0725d2c3e74d#diff-e03535cf9a37db01715946f6f12ec50ec7e66db034189f20317e30d3e2d8af02L54' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 66507296</div><div id='project'> Project Name: ashleve/lightning-hydra-template</div><div id='commit'> Commit Name: 0030c94b17bdd837b536a177ae3b0725d2c3e74d</div><div id='time'> Time: 2021-01-09</div><div id='author'> Author: zalewski.ukas@gmail.com</div><div id='file'> File Name: project/pytorch_modules/lightning_models/simple_mnist_classifier.py</div><div id='m_class'> M Class Name: LitModel</div><div id='n_method'> N Class Name: LitModel</div><div id='m_method'> M Method Name: validation_step(3)</div><div id='n_method'> N Method Name: validation_step(3)</div><div id='m_parent_class'> M Parent Class: pl.LightningModule</div><div id='n_parent_class'> N Parent Class: pl.LightningModule</div><div id='m_file'> M File Name: project/pytorch_modules/lightning_models/simple_mnist_classifier.py</div><div id='n_file'> N File Name: project/pytorch_modules/lightning_models/simple_mnist_classifier.py</div><div id='m_start'> M Start Line: 57</div><div id='m_end'> M End Line: 64</div><div id='n_start'> N Start Line: 54</div><div id='n_end'> N End Line: 62</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        &#47&#47 training metrics
        preds = torch.argmax(logits, dim=1)
        preds, y = preds.cpu()<a id="change">, y.cpu()</a>
        acc = accuracy_score(preds, y)
        self.log(&quottrain_loss&quot, loss, on_step=False, on_epoch=True, logger=True, prog_bar=True)
        self.log(&quottrain_acc&quot, acc, on_step=False, on_epoch=True, logger=True, prog_bar=True)
</code></pre><h3>After Change</h3><pre><code class='java'>

        &#47&#47 training metrics
        preds = torch.argmax(logits, dim=1)
        acc = <a id="change">accuracy_score(</a>preds.cpu(), y.cpu()<a id="change">)</a>
        self.log(&quottrain_loss&quot, loss, on_step=False, on_epoch=True, logger=True, prog_bar=True)
        self.log(&quottrain_acc&quot, acc, on_step=False, on_epoch=True, logger=True, prog_bar=True)

        &#47&#47 we can return here anything and then read it in some callback
        <a id="change">return </a>loss<a id="change">, acc, preds, y</a>

    &#47&#47 logic for a single validation step
    def validation_step(self, batch, batch_idx):
        x, y = batch</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ashleve/lightning-hydra-template/commit/0030c94b17bdd837b536a177ae3b0725d2c3e74d#diff-e03535cf9a37db01715946f6f12ec50ec7e66db034189f20317e30d3e2d8af02L36' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 66507295</div><div id='project'> Project Name: ashleve/lightning-hydra-template</div><div id='commit'> Commit Name: 0030c94b17bdd837b536a177ae3b0725d2c3e74d</div><div id='time'> Time: 2021-01-09</div><div id='author'> Author: zalewski.ukas@gmail.com</div><div id='file'> File Name: project/pytorch_modules/lightning_models/simple_mnist_classifier.py</div><div id='m_class'> M Class Name: LitModel</div><div id='n_method'> N Class Name: LitModel</div><div id='m_method'> M Method Name: training_step(3)</div><div id='n_method'> N Method Name: training_step(3)</div><div id='m_parent_class'> M Parent Class: pl.LightningModule</div><div id='n_parent_class'> N Parent Class: pl.LightningModule</div><div id='m_file'> M File Name: project/pytorch_modules/lightning_models/simple_mnist_classifier.py</div><div id='n_file'> N File Name: project/pytorch_modules/lightning_models/simple_mnist_classifier.py</div><div id='m_start'> M Start Line: 39</div><div id='m_end'> M End Line: 48</div><div id='n_start'> N Start Line: 39</div><div id='n_end'> N End Line: 48</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        correct += (results == batch[&quotlabel&quot]).sum()
        tot += outputs.shape[0]

    return correct<a id="change">, tot</a></code></pre><h3>After Change</h3><pre><code class='java'>
        guesses.extend(results.numpy())
        correct.extend(batch[&quotlabel&quot].numpy())

    accuracy = <a id="change">accuracy_score(</a>correct, guesses<a id="change">)</a>
    scores = precision_recall_fscore_support(correct, guesses)
    <a id="change">return </a>accuracy<a id="change">, scores</a></code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tiagomantunes/karen/commit/82e5d2b5eaf27dac3fba554b0f25691f7f82c812#diff-81b53beb0622f06b4d0bc961e5bb5bed36c5cb3828666638fe241d38d4ef5b00L99' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 66507291</div><div id='project'> Project Name: tiagomantunes/karen</div><div id='commit'> Commit Name: 82e5d2b5eaf27dac3fba554b0f25691f7f82c812</div><div id='time'> Time: 2021-06-01</div><div id='author'> Author: tiago.melo.antunes@gmail.com</div><div id='file'> File Name: framework/training.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: eval(3)</div><div id='n_method'> N Method Name: eval(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: framework/training.py</div><div id='n_file'> N File Name: framework/training.py</div><div id='m_start'> M Start Line: 101</div><div id='m_end'> M End Line: 115</div><div id='n_start'> N Start Line: 107</div><div id='n_end'> N End Line: 123</div><BR>