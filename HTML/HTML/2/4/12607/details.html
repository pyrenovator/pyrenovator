<html><h3>Pattern ID :12607
</h3><img src='42791748.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        self.iteration += 1
        self._count_grad_step += 1
        if self.verbose &gt; 1:
            print("taking grad step. Loss to beat: ", np.nanmin(<a id="change">self.loss_history[:-1]</a>))
        for count in range(20):
            Y = self.model.full_sample(self.current_state + self.grad*L, as_representation = True, override_locked = False, flatten = True)
            if self.model.target.has_mask:</code></pre><h3>After Change</h3><pre><code class='java'>
                L /= 10
                continue
            if self.verbose &gt; 1:
                <a id="change">AP_config.ap_logger.info(</a>f"grad step loss: {loss.item()}, L: {L}"<a id="change">)</a>
            if np.nanmin(self.loss_history[:-1]) &gt; loss.item():
                self.loss_history.append(loss.detach().cpu().item())
                self.L = 1.
                self.L_history.append(self.L)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/connorstoneastro/autoprof/commit/10b2a7770d988d066380285137108a388ebd1bad#diff-52615ad08cfc1cfad1befd14d3c383d34ae33d73e933e1359265221e8731fb61L103' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 42791748</div><div id='project'> Project Name: connorstoneastro/autoprof</div><div id='commit'> Commit Name: 10b2a7770d988d066380285137108a388ebd1bad</div><div id='time'> Time: 2023-01-14</div><div id='author'> Author: connorstone628@gmail.com</div><div id='file'> File Name: autoprof/fit/lm.py</div><div id='m_class'> M Class Name: LM</div><div id='n_method'> N Class Name: LM</div><div id='m_method'> M Method Name: grad_step(1)</div><div id='n_method'> N Method Name: grad_step(1)</div><div id='m_parent_class'> M Parent Class: BaseOptimizer</div><div id='n_parent_class'> N Parent Class: BaseOptimizer</div><div id='m_file'> M File Name: autoprof/fit/lm.py</div><div id='n_file'> N File Name: autoprof/fit/lm.py</div><div id='m_start'> M Start Line: 103</div><div id='m_end'> M End Line: 118</div><div id='n_start'> N Start Line: 108</div><div id='n_end'> N End Line: 141</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            try:
                para = get_paragraph_results(es, query, doc)[0][0]
                &#47&#47 truncate to 400 tokens
                para = " ".join(<a id="change">para.split(" ")[:400]</a>)
                found[uid] = {
                    "query": query,
                    "doc": doc,</code></pre><h3>After Change</h3><pre><code class='java'>
            uid = str(i) + "_" + str(k)
            try:
                results = get_paragraph_results(es, query, doc)
                <a id="change">logger.info(</a>f"**RESULTS: {results}"<a id="change">)</a>
                para = results[0][0]
                &#47&#47 truncate to 400 tokens
                para = " ".join(para.split(" "))
                found[uid] = {</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/dod-advana/gamechanger-ml/commit/126673df5269617730131f713ee21ab0b1756b14#diff-5165f6e6957ad14979a1a1325cec005fa30d394246bce83cf45f989c548b8e69L258' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 42791749</div><div id='project'> Project Name: dod-advana/gamechanger-ml</div><div id='commit'> Commit Name: 126673df5269617730131f713ee21ab0b1756b14</div><div id='time'> Time: 2022-03-02</div><div id='author'> Author: dowdy_katherine@bah.com</div><div id='file'> File Name: gamechangerml/src/utilities/es_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: collect_results(5)</div><div id='n_method'> N Method Name: collect_results(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: gamechangerml/src/utilities/es_utils.py</div><div id='n_file'> N File Name: gamechangerml/src/utilities/es_utils.py</div><div id='m_start'> M Start Line: 264</div><div id='m_end'> M End Line: 271</div><div id='n_start'> N Start Line: 270</div><div id='n_end'> N End Line: 279</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        self.iteration += 1
        self._count_grad_step += 1
        if self.verbose &gt; 1:
            print("taking grad step. Loss to beat: ", np.nanmin(<a id="change">self.loss_history[:-1]</a>))
        for count in range(20):
            Y = self.model.full_sample(self.current_state + self.grad*L, as_representation = True, override_locked = False, flatten = True)
            if self.model.target.has_mask:</code></pre><h3>After Change</h3><pre><code class='java'>
                L /= 10
                continue
            if self.verbose &gt; 1:
                <a id="change">AP_config.ap_logger.info(</a>f"grad step loss: {loss.item()}, L: {L}"<a id="change">)</a>
            if np.nanmin(self.loss_history[:-1]) &gt; loss.item():
                self.loss_history.append(loss.detach().cpu().item())
                self.L = 1.
                self.L_history.append(self.L)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/connorstoneastro/autoprof/commit/6a9ca466b2a9f7dd23a7661bddbe588d3676cd17#diff-daabd78fa8f6167a7ea2c6fd6fce88e607b57cd475cf1e759da42fe315dcd1acL102' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 42791750</div><div id='project'> Project Name: connorstoneastro/autoprof</div><div id='commit'> Commit Name: 6a9ca466b2a9f7dd23a7661bddbe588d3676cd17</div><div id='time'> Time: 2023-02-02</div><div id='author'> Author: connorstone628@gmail.com</div><div id='file'> File Name: build/lib/autoprof/fit/lm.py</div><div id='m_class'> M Class Name: LM</div><div id='n_method'> N Class Name: LM</div><div id='m_method'> M Method Name: grad_step(1)</div><div id='n_method'> N Method Name: grad_step(1)</div><div id='m_parent_class'> M Parent Class: BaseOptimizer</div><div id='n_parent_class'> N Parent Class: BaseOptimizer</div><div id='m_file'> M File Name: build/lib/autoprof/fit/lm.py</div><div id='n_file'> N File Name: build/lib/autoprof/fit/lm.py</div><div id='m_start'> M Start Line: 103</div><div id='m_end'> M End Line: 118</div><div id='n_start'> N Start Line: 108</div><div id='n_end'> N End Line: 141</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        processes = set()
        max_process = self.cfg.max_process

        for yt_id in tqdm(<a id="change">self.combined_split[:10]</a>):
            cmd = f"ffmpeg -ss {yt_id[&quotstart&quot]} -i $(youtube-dl -f 22 --get-url https://www.youtube.com/watch?v={yt_id[&quotvid_id&quot]}) -to 10 {video_dir / yt_id[&quotvid_seg_id&quot]}.mp4"
            processes.add(subprocess.Popen(cmd, shell=True))
            if len(processes) &gt;= max_process:</code></pre><h3>After Change</h3><pre><code class='java'>
            vid_seg_id = yt_id["vid_seg_id"]
            out_file = Path(f"{video_dir / vid_seg_id}.mp4")
            if out_file.exists():
                <a id="change">logger.info(</a>f"Skipping Video {vid_seg_id}"<a id="change">)</a>
                continue

            cmd = f"ffmpeg -ss {yt_id[&quotstart&quot]} -i $(youtube-dl -f 22/best --get-url https://www.youtube.com/watch?v={yt_id[&quotvid_id&quot]}) -to 10 {out_file}"
            processes.add(subprocess.Popen(cmd, shell=True))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/theshadow29/vidsitu/commit/22acfb9e7344e3672ee11fb8aaab9ac69b9056fe#diff-664ef4e0fe175ad429c999f84c892ce4b682c527bee965b61a401a9193caa03cL56' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 42791751</div><div id='project'> Project Name: theshadow29/vidsitu</div><div id='commit'> Commit Name: 22acfb9e7344e3672ee11fb8aaab9ac69b9056fe</div><div id='time'> Time: 2021-04-08</div><div id='author'> Author: ark.sadhu2904@gmail.com</div><div id='file'> File Name: prep_data/dwn_yt.py</div><div id='m_class'> M Class Name: YTDown</div><div id='n_method'> N Class Name: YTDown</div><div id='m_method'> M Method Name: download_yt_vids(1)</div><div id='n_method'> N Method Name: download_yt_vids(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: prep_data/dwn_yt.py</div><div id='n_file'> N File Name: prep_data/dwn_yt.py</div><div id='m_start'> M Start Line: 64</div><div id='m_end'> M End Line: 65</div><div id='n_start'> N Start Line: 67</div><div id='n_end'> N End Line: 74</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 e.g. 2speakers/wav8k/min/tr/mix/019o031a_0.27588_01vo030q_-0.27588.wav
        &#47&#47 id of speaker 1 is 019 utterance id is o031a
        &#47&#47 id of speaker 2 is 01v utterance id is 01vo030q
        s1_id = Path(s1_wav).stem.split("_")[0][<a id="change">:3</a>]
        if s1_id not in spk_hashtable.keys():
            <a id="change">spk_hashtable[s1_id]</a> = [s1_wav]
        else:
            spk_hashtable[s1_id].append(s1_wav)
</code></pre><h3>After Change</h3><pre><code class='java'>
    for utt in wsj0_utterances:

        spk_id = Path(utt).stem[:3]
        <a id="change">torchaudio.info(</a>utt<a id="change">)</a>
        assert torchaudio.info(utt).sample_rate == 8000

        &#47&#47 e.g. 2speakers/wav8k/min/tr/mix/019o031a_0.27588_01vo030q_-0.27588.wav
        &#47&#47 id of speaker 1 is 019 utterance id is o031a</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/speechbrain/speechbrain/commit/e716f99a82f8dc90125ddfe0aae214209fa8cc2f#diff-701c0c78c50c407c8c552e20d140dd5a69c30adca30a40a3e152adbdaf78502eL11' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 42791746</div><div id='project'> Project Name: speechbrain/speechbrain</div><div id='commit'> Commit Name: e716f99a82f8dc90125ddfe0aae214209fa8cc2f</div><div id='time'> Time: 2021-01-18</div><div id='author'> Author: cornellsamuele@gmail.com</div><div id='file'> File Name: recipes/WSJ2Mix/separation/dynamic_mixing.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: build_spk_hashtable(1)</div><div id='n_method'> N Method Name: build_spk_hashtable(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: recipes/WSJ2Mix/separation/dynamic_mixing.py</div><div id='n_file'> N File Name: recipes/WSJ2Mix/separation/dynamic_mixing.py</div><div id='m_start'> M Start Line: 13</div><div id='m_end'> M End Line: 27</div><div id='n_start'> N Start Line: 12</div><div id='n_end'> N End Line: 21</div><BR>