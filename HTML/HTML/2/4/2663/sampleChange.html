<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        for i in range(nruns):
            neighbors, distances, distance_vecs = nl(pos, batch)
        end.record()
    <a id="change">if </a>device == "cuda":
        torch.cuda.synchronize()
    &#47&#47 Final time
    return start.elapsed_time(end) / nruns</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47 Warmup
    s = torch.cuda.Stream()
    s.wait_stream(torch.cuda.current_stream())
    <a id="change">with torch</a><a id="change">.cuda.stream(s):
        </a>for i in range(10):
            neighbors, distances, distance_vecs = nl(pos, batch)
    torch.cuda.synchronize()
    nruns = 50</code></pre>