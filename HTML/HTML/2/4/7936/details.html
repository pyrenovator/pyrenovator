<html><h3>Pattern ID :7936
</h3><img src='28180377.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    n, ei = gen_edge_index(10)
    g = qv.new_quiver_from_edge_index(n, ei)
    g.sample_adj(torch.LongTensor([0, 1, 2]), 3)
    <a id="change">assert </a>True


test_quiver()</code></pre><h3>After Change</h3><pre><code class='java'>

def test_quiver():
    n, ei = gen_edge_index(10, gen_non_uniform_adj)
    eid<a id="change"> = </a>torch.LongTensor([100 * ei[0][i] + ei[1][i] for i in range(<a id="change">ei.size(1</a><a id="change">)</a>)])
    g = qv.new_quiver_from_edge_index(n, ei, eid)
    neighbor, eid = g.sample_id(torch.LongTensor([7, 5, 3]), 3)
    print(neighbor)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 6</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/quiver-team/torch-quiver/commit/3f2ae2c0042ff9b3b5e623dc5e97dbb475624b1c#diff-8e500dabeb8c07a21c58f12a60a62b9bf9a7e76abe865c94486366a1eca11899L19' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28180377</div><div id='project'> Project Name: quiver-team/torch-quiver</div><div id='commit'> Commit Name: 3f2ae2c0042ff9b3b5e623dc5e97dbb475624b1c</div><div id='time'> Time: 2020-10-20</div><div id='author'> Author: 41138939+ZenoTan@users.noreply.github.com</div><div id='file'> File Name: examples/quiver_example.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_quiver(0)</div><div id='n_method'> N Method Name: test_quiver(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: examples/quiver_example.py</div><div id='n_file'> N File Name: examples/quiver_example.py</div><div id='m_start'> M Start Line: 19</div><div id='m_end'> M End Line: 20</div><div id='n_start'> N Start Line: 26</div><div id='n_end'> N End Line: 31</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        batch_size = input.size(0)
        time_step = input.size(1)
        feature_dim = input.size(2)
        <a id="change">assert </a>feature_dim == self.n_input

        self.agent1_action = []
        self.agent1_prob = []</code></pre><h3>After Change</h3><pre><code class='java'>

        batch_size = labtest.size(0)
        time_step = labtest.size(1)
        feature_dim<a id="change"> = </a><a id="change">labtest.size(2</a><a id="change">)</a>
        assert feature_dim == self.lab_dim

        self.agent1_action = []
        self.agent1_prob = []</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/yhzhu99/covid-ehr-benchmarks/commit/41e28f49dd30d760c6c439a5cf41590262c9b76b#diff-5fdd32b806c6289f77045eb16c679e729eabff875bba907ebc44d204c4cc7bbaL118' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28180376</div><div id='project'> Project Name: yhzhu99/covid-ehr-benchmarks</div><div id='commit'> Commit Name: 41e28f49dd30d760c6c439a5cf41590262c9b76b</div><div id='time'> Time: 2022-06-24</div><div id='author'> Author: yhzhu99@gmail.com</div><div id='file'> File Name: app/models/backbones/agent.py</div><div id='m_class'> M Class Name: Agent</div><div id='n_method'> N Class Name: Agent</div><div id='m_method'> M Method Name: forward(2)</div><div id='n_method'> N Method Name: forward(3)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: app/models/backbones/agent.py</div><div id='n_file'> N File Name: app/models/backbones/agent.py</div><div id='m_start'> M Start Line: 118</div><div id='m_end'> M End Line: 204</div><div id='n_start'> N Start Line: 117</div><div id='n_end'> N End Line: 201</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            torch.Tensor: loss as a single number for backpropagation
        
        target, lengths = unpack_sequence(target)
        <a id="change">assert </a>not target.requires_grad

        &#47&#47 calculate loss with "none" reduction
        weight = target[1]</code></pre><h3>After Change</h3><pre><code class='java'>
        if isinstance(target, rnn.PackedSequence):
            target, lengths = unpack_sequence(target)
        else:
            lengths<a id="change"> = </a>torch.full((<a id="change">target.size(0</a><a id="change">)</a>,), fill_value=target.size(1), dtype=torch.long, device=target.device)

        losses = self.loss(y_pred, target)
        &#47&#47 weight samples</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jdb78/pytorch-forecasting/commit/92f88552bd5b11a06841b9a2ab967e0ea856e59d#diff-b33317714bfa742fe554f4cce1ee1221e7d5182714f10cfd995f89f71ab1dac1L298' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28180379</div><div id='project'> Project Name: jdb78/pytorch-forecasting</div><div id='commit'> Commit Name: 92f88552bd5b11a06841b9a2ab967e0ea856e59d</div><div id='time'> Time: 2020-12-23</div><div id='author'> Author: beitner.jan@bcg.com</div><div id='file'> File Name: pytorch_forecasting/metrics.py</div><div id='m_class'> M Class Name: MultiHorizonMetric</div><div id='n_method'> N Class Name: MultiHorizonMetric</div><div id='m_method'> M Method Name: update(3)</div><div id='n_method'> N Method Name: update(3)</div><div id='m_parent_class'> M Parent Class: Metric</div><div id='n_parent_class'> N Parent Class: Metric</div><div id='m_file'> M File Name: pytorch_forecasting/metrics.py</div><div id='n_file'> N File Name: pytorch_forecasting/metrics.py</div><div id='m_start'> M Start Line: 311</div><div id='m_end'> M End Line: 321</div><div id='n_start'> N Start Line: 404</div><div id='n_end'> N End Line: 418</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    def __call__(self, x: Tensor, y: Tensor, target: Tensor = None, reduction: str = &quotmean&quot):
        if target is None:
            <a id="change">assert </a>x.size(0) * self.target_per_qry == y.size(0)
            target = torch.arange(
                0, x.size(0) * self.target_per_qry, self.target_per_qry, device=x.device, dtype=torch.long)
        logits = torch.matmul(x, y.transpose(0, 1))</code></pre><h3>After Change</h3><pre><code class='java'>

    def __call__(self, x: Tensor, y: Tensor, target: Tensor = None, reduction: str = &quotmean&quot):
        if target is None:
            target_per_qry<a id="change"> = </a><a id="change">y.size(0</a><a id="change">)</a> // x.size(0)
            target = torch.arange(
                0, x.size(0) * target_per_qry, target_per_qry, device=x.device, dtype=torch.long)
        logits = torch.matmul(x, y.transpose(0, 1))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/texttron/tevatron/commit/cd1aa58c7f84e50022bf45f28c10545bf3fccf22#diff-a477c63de068aae2df3bcf7c1bf70a7d0dda35697bd8fff239d4dd123a0bfb47L11' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28180378</div><div id='project'> Project Name: texttron/tevatron</div><div id='commit'> Commit Name: cd1aa58c7f84e50022bf45f28c10545bf3fccf22</div><div id='time'> Time: 2022-03-21</div><div id='author'> Author: x93ma@edu.uwaterloo.ca</div><div id='file'> File Name: src/tevatron/loss.py</div><div id='m_class'> M Class Name: SimpleContrastiveLoss</div><div id='n_method'> N Class Name: SimpleContrastiveLoss</div><div id='m_method'> M Method Name: __call__(5)</div><div id='n_method'> N Method Name: __call__(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/tevatron/loss.py</div><div id='n_file'> N File Name: src/tevatron/loss.py</div><div id='m_start'> M Start Line: 13</div><div id='m_end'> M End Line: 15</div><div id='n_start'> N Start Line: 11</div><div id='n_end'> N End Line: 13</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
def scale_qk(*xs: Tensor) -&gt; tuple[Tensor, Tensor]:
    Scale the qk tensor by the channel-dimension.

    <a id="change">assert </a>len(xs) == 2

    return tuple(x * math.pow(x.size(-1), -1 / 4) for x in xs)
</code></pre><h3>After Change</h3><pre><code class='java'>
def scale_qk(q: Tensor, k: Tensor) -&gt; tuple[Tensor, Tensor]:
    Scale the qk tensor by the channel-dimension.

    C<a id="change"> = </a><a id="change">q.size(2</a><a id="change">)</a>
    scale = math.pow(C, -1 / 4)

    return q * scale, k * scale
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tfernd/sd-fused/commit/1aa81fa77e91e6f772dc5a1d8765d0ee8b70c88f#diff-c1e5794b6961d9d08e04f1a79bdd0dc4eb5961cf83572ed9eb738c227ba61722L8' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28180372</div><div id='project'> Project Name: tfernd/sd-fused</div><div id='commit'> Commit Name: 1aa81fa77e91e6f772dc5a1d8765d0ee8b70c88f</div><div id='time'> Time: 2022-11-08</div><div id='author'> Author: ThalesFDFernandes@gmai.com</div><div id='file'> File Name: sd_fused/layers/blocks/attention/fn/scale_qk.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: scale_qk(2)</div><div id='n_method'> N Method Name: scale_qk(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: sd_fused/layers/blocks/attention/fn/scale_qk.py</div><div id='n_file'> N File Name: sd_fused/layers/blocks/attention/fn/scale_qk.py</div><div id='m_start'> M Start Line: 11</div><div id='m_end'> M End Line: 13</div><div id='n_start'> N Start Line: 8</div><div id='n_end'> N End Line: 14</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                occluded_elevation_map=output[ChannelEnum.OCCLUDED_ELEVATION_MAP])

        &#47&#47 we require square dimension for now
        <a id="change">assert </a>output[ChannelEnum.GROUND_TRUTH_ELEVATION_MAP].size(0) == output[ChannelEnum.GROUND_TRUTH_ELEVATION_MAP].size(1)
        if type(self.config["size"]) == list:
            assert self.config["size"][0] == self.config["size"][1]
        input_size = output[ChannelEnum.GROUND_TRUTH_ELEVATION_MAP].size(0)</code></pre><h3>After Change</h3><pre><code class='java'>
        assert sample_map.size(0) == sample_map.size(1)
        if type(self.config["size"]) == list:
            assert self.config["size"][0] == self.config["size"][1]
        input_size<a id="change"> = </a><a id="change">sample_map.size(0</a><a id="change">)</a>
        if type(self.config["size"]) == list:
            output_size = self.config["size"][0]
        elif type(self.config["size"]) == int:
            output_size = self.config["size"]</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/mstoelzle/solving-occlusion/commit/5f12931e2f2e6a17cf0ac6ebeea5606ea7e88086#diff-d05cb7733c20f89c5b7ab6f5586e0ec80c2ce069c78312dd5bb6c5765d762ec7L37' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28180374</div><div id='project'> Project Name: mstoelzle/solving-occlusion</div><div id='commit'> Commit Name: 5f12931e2f2e6a17cf0ac6ebeea5606ea7e88086</div><div id='time'> Time: 2020-10-21</div><div id='author'> Author: maximilian@stoelzle.ch</div><div id='file'> File Name: src/datasets/base_dataset.py</div><div id='m_class'> M Class Name: BaseDataset</div><div id='n_method'> N Class Name: BaseDataset</div><div id='m_method'> M Method Name: prepare_item(2)</div><div id='n_method'> N Method Name: prepare_item(2)</div><div id='m_parent_class'> M Parent Class: ABC</div><div id='n_parent_class'> N Parent Class: ABC</div><div id='m_file'> M File Name: src/datasets/base_dataset.py</div><div id='n_file'> N File Name: src/datasets/base_dataset.py</div><div id='m_start'> M Start Line: 56</div><div id='m_end'> M End Line: 104</div><div id='n_start'> N Start Line: 57</div><div id='n_end'> N End Line: 119</div><BR>