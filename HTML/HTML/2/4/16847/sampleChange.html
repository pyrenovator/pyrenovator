<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        return out, _grad

    <a id="change">return </a><a id="change">_fn(</a>inp, scale_param<a id="change">)</a>


def pool_heads(ctx: Context, inp: jnp.ndarray) -&gt; jnp.ndarray:
    return sum_pool(inp, [0, ctx.model.device_halo_size], [(0, 0), (ctx.model.device_halo_size // 2,) * 2])</code></pre><h3>After Change</h3><pre><code class='java'>

        return out, _grad

    <a id="change">return _fn(</a>inp<a id="change">)</a>


def pool_heads(ctx: Context, inp: jnp.ndarray) -&gt; jnp.ndarray:
    return sum_pool(inp, [0, ctx.model.device_halo_size], [(0, 0), (ctx.model.device_halo_size // 2,) * 2])</code></pre>