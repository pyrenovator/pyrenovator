<html><h3>Pattern ID :29314
</h3><img src='86041552.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            with torch.no_grad():
                pl_module.eval()
                out = pl_module(text, x, return_loss=False).long()
                <a id="change">print(</a>out.shape<a id="change">)</a>
                text_seq = out[:, :self.text_seq_len,:]
                print(text_seq.shape)
                img_seq = out[:, self.text_seq_len:,:]        
                print(img_seq.shape)       </code></pre><h3>After Change</h3><pre><code class='java'>
                scale_each=self.scale_each,
                pad_value=self.pad_value,
            )                
            text_title<a id="change"> = "train/text"</a>
            <a id="change">trainer.logger.experiment.add_text(</a>text_title, decoded_text<a id="change">, global_step=trainer.global_step)</a>
            x_title = "train/input"
            trainer.logger.experiment.add_image(x_title, x_grid, global_step=trainer.global_step)
            xrec_title = "train/reconstruction"
            trainer.logger.experiment.add_image(xrec_title, xrec_grid, global_step=trainer.global_step)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/tgisaturday/dalle-lightning/commit/2581c994940a3ccb5d297681ac847d543a1a82bd#diff-a83484d4c7b7ebe0b0e0ade59c8557937a9e940ae331d28b6debb50cefd16ffcL206' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 86041552</div><div id='project'> Project Name: tgisaturday/dalle-lightning</div><div id='commit'> Commit Name: 2581c994940a3ccb5d297681ac847d543a1a82bd</div><div id='time'> Time: 2021-07-26</div><div id='author'> Author: jamesk1228@gmail.com</div><div id='file'> File Name: pl_dalle/callbacks.py</div><div id='m_class'> M Class Name: DalleImageSampler</div><div id='n_method'> N Class Name: DalleImageSampler</div><div id='m_method'> M Method Name: on_train_batch_end(7)</div><div id='n_method'> N Method Name: on_train_batch_end(7)</div><div id='m_parent_class'> M Parent Class: Callback</div><div id='n_parent_class'> N Parent Class: Callback</div><div id='m_file'> M File Name: pl_dalle/callbacks.py</div><div id='n_file'> N File Name: pl_dalle/callbacks.py</div><div id='m_start'> M Start Line: 206</div><div id='m_end'> M End Line: 216</div><div id='n_start'> N Start Line: 206</div><div id='n_end'> N End Line: 261</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                print(&quotfuck&quot)
                &#47&#47generate sample with image provided
                x_rec = pl_module.generate_images(text=text, img = x, filter_thres=0.9)  &#47&#47 topk sampling at 0.9
                <a id="change">print(</a>&quotfuck&quot<a id="change">)</a>
                &#47&#47generate sample without image
                x_gen = pl_module.generate_images(text=text, filter_thres=0.9)  &#47&#47 topk sampling at 0.9

                pl_module.train()  </code></pre><h3>After Change</h3><pre><code class='java'>
                scale_each=self.scale_each,
                pad_value=self.pad_value,
            )                
            text_title<a id="change"> = "train/text"</a>
            <a id="change">trainer.logger.experiment.add_text(</a>text_title, decoded_text<a id="change">, global_step=trainer.global_step)</a>
            x_title = "train/input"
            trainer.logger.experiment.add_image(x_title, x_grid, global_step=trainer.global_step)
            xrec_title = "train/reconstruction"
            trainer.logger.experiment.add_image(xrec_title, xrec_grid, global_step=trainer.global_step)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tgisaturday/dalle-lightning/commit/d5154f7e185c7b737a7bb3b9f1f9048d811cab37#diff-a83484d4c7b7ebe0b0e0ade59c8557937a9e940ae331d28b6debb50cefd16ffcL190' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 86041540</div><div id='project'> Project Name: tgisaturday/dalle-lightning</div><div id='commit'> Commit Name: d5154f7e185c7b737a7bb3b9f1f9048d811cab37</div><div id='time'> Time: 2021-07-26</div><div id='author'> Author: jamesk1228@gmail.com</div><div id='file'> File Name: pl_dalle/callbacks.py</div><div id='m_class'> M Class Name: DalleImageSampler</div><div id='n_method'> N Class Name: DalleImageSampler</div><div id='m_method'> M Method Name: on_train_batch_end(7)</div><div id='n_method'> N Method Name: on_train_batch_end(7)</div><div id='m_parent_class'> M Parent Class: Callback</div><div id='n_parent_class'> N Parent Class: Callback</div><div id='m_file'> M File Name: pl_dalle/callbacks.py</div><div id='n_file'> N File Name: pl_dalle/callbacks.py</div><div id='m_start'> M Start Line: 206</div><div id='m_end'> M End Line: 209</div><div id='n_start'> N Start Line: 202</div><div id='n_end'> N End Line: 246</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            res_path = hydra.utils.to_absolute_path(f"results/{cfg.name}/")
            params = flatten(OmegaConf.to_container(cfg, resolve=True))
            for k, v in params.items():
                <a id="change">print(</a>f"{k} : {v} | {type(v)}"<a id="change">)</a>
            with SummaryWriter(res_path) as w:
                w.add_hparams(params, {"loss": 10})

</code></pre><h3>After Change</h3><pre><code class='java'>
    if cfg.tensorboard:
        writer = SummaryWriter(os.getcwd())
        &#47&#47 Indicate to TensorBoard that the text is preformatted using HTML tags
        text<a id="change"> = f"&lt;pre&gt;{OmegaConf.to_yaml(cfg)}&lt;/pre&gt;"</a>
        <a id="change">writer.add_text(</a>"config", text<a id="change">)</a>
    else:
        writer = None

    &#47&#47 Trainer init</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/dmizr/phuber/commit/a264efba8a4b4e2f10bf1e7fe4141e5dcdf017f3#diff-0486a3c469cb2619e864104b3bd3f8f59ba96a7e18629088c35e6a2b1e9e7389L19' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 86041550</div><div id='project'> Project Name: dmizr/phuber</div><div id='commit'> Commit Name: a264efba8a4b4e2f10bf1e7fe4141e5dcdf017f3</div><div id='time'> Time: 2020-11-27</div><div id='author'> Author: david.mizrahi@epfl.ch</div><div id='file'> File Name: phuber/runner.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(1)</div><div id='n_method'> N Method Name: train(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: phuber/runner.py</div><div id='n_file'> N File Name: phuber/runner.py</div><div id='m_start'> M Start Line: 20</div><div id='m_end'> M End Line: 79</div><div id='n_start'> N Start Line: 21</div><div id='n_end'> N End Line: 79</div><BR>