<html><h3>Pattern ID :6049
</h3><img src='21054432.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            adam.clear_grad()

            if step % args.logging_step == 0:
                print("step {}, loss {}".format(step, <a id="change">loss.numpy()[0]</a>))

    acc = test(model, test_loader)
    print("\ntest acc {}\n".format(acc))</code></pre><h3>After Change</h3><pre><code class='java'>
            adam.clear_grad()

            if step % args.logging_step == 0:
                print("step {}, loss {}".format(step, <a id="change">float(</a>loss<a id="change">)</a>))

    acc = test(model, test_loader)
    print("\ntest acc {}\n".format(acc))</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 8</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/paddlepaddle/paddlenlp/commit/22635acf30b0a1c2bb378b72705291dfda52baea#diff-21a71c764d000a81d39954f892d1f2d004578edd3cbd9a69eccb80dafbab4ddfL243' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 21054432</div><div id='project'> Project Name: paddlepaddle/paddlenlp</div><div id='commit'> Commit Name: 22635acf30b0a1c2bb378b72705291dfda52baea</div><div id='time'> Time: 2022-12-20</div><div id='author'> Author: fangzeyang0904@hotmail.com</div><div id='file'> File Name: examples/language_model/elmo/run_finetune.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: finetune(1)</div><div id='n_method'> N Method Name: finetune(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: examples/language_model/elmo/run_finetune.py</div><div id='n_file'> N File Name: examples/language_model/elmo/run_finetune.py</div><div id='m_start'> M Start Line: 246</div><div id='m_end'> M End Line: 252</div><div id='n_start'> N Start Line: 243</div><div id='n_end'> N End Line: 249</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        loss.backward()
        self.optimizer.minimize(loss)

        return <a id="change">loss.numpy()[0]</a>

    def trainIters(self, n_iters, model_file_path=None):
        iter, running_avg_loss = self.setup_train(model_file_path)
        start = time.time()</code></pre><h3>After Change</h3><pre><code class='java'>
        loss.backward()
        self.optimizer.minimize(loss)

        return <a id="change">float(</a>loss<a id="change">)</a>

    def trainIters(self, n_iters, model_file_path=None):
        iter, running_avg_loss = self.setup_train(model_file_path)
        start = time.time()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/paddlepaddle/paddlenlp/commit/22635acf30b0a1c2bb378b72705291dfda52baea#diff-767f34a53dc9ba119f1c6362fdc1b7241298da5376a0abddc0fcd50db189470cL83' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 21054417</div><div id='project'> Project Name: paddlepaddle/paddlenlp</div><div id='commit'> Commit Name: 22635acf30b0a1c2bb378b72705291dfda52baea</div><div id='time'> Time: 2022-12-20</div><div id='author'> Author: fangzeyang0904@hotmail.com</div><div id='file'> File Name: examples/text_summarization/pointer_summarizer/train.py</div><div id='m_class'> M Class Name: Trainer</div><div id='n_method'> N Class Name: Trainer</div><div id='m_method'> M Method Name: train_one_batch(3)</div><div id='n_method'> N Method Name: train_one_batch(3)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: examples/text_summarization/pointer_summarizer/train.py</div><div id='n_file'> N File Name: examples/text_summarization/pointer_summarizer/train.py</div><div id='m_start'> M Start Line: 135</div><div id='m_end'> M End Line: 140</div><div id='n_start'> N Start Line: 145</div><div id='n_end'> N End Line: 150</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                        step,
                        len(train_dataloader),
                        lr_scheduler.get_lr(),
                        <a id="change">loss.numpy()[0]</a>,
                    )
                )
</code></pre><h3>After Change</h3><pre><code class='java'>
                        step,
                        len(train_dataloader),
                        lr_scheduler.get_lr(),
                        <a id="change">float(</a>loss<a id="change">)</a>,
                    )
                )
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/paddlepaddle/paddlenlp/commit/22635acf30b0a1c2bb378b72705291dfda52baea#diff-8d0572704431b3e50f920efd7c609d402d7298f9870301582830c365967e59dcL81' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 21054423</div><div id='project'> Project Name: paddlepaddle/paddlenlp</div><div id='commit'> Commit Name: 22635acf30b0a1c2bb378b72705291dfda52baea</div><div id='time'> Time: 2022-12-20</div><div id='author'> Author: fangzeyang0904@hotmail.com</div><div id='file'> File Name: applications/document_intelligence/doc_vqa/Extraction/run_docvqa.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(1)</div><div id='n_method'> N Method Name: main(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: applications/document_intelligence/doc_vqa/Extraction/run_docvqa.py</div><div id='n_file'> N File Name: applications/document_intelligence/doc_vqa/Extraction/run_docvqa.py</div><div id='m_start'> M Start Line: 169</div><div id='m_end'> M End Line: 196</div><div id='n_start'> N Start Line: 182</div><div id='n_end'> N End Line: 191</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        network_output = model(im_all, output_more=False)
        loss = realEPE(network_output, label)
        end = time.time()
        loss_cnt.update(<a id="change">loss.numpy()[0]</a>, step)
        print(&quotval epoch {} batch {}/{} run time: {}s read data time {}s loss {}&quot.format(epoch, batch_id, batch_num,
                                                                                     round(end - start, 2),
                                                                                     round(read_data_time, 2),</code></pre><h3>After Change</h3><pre><code class='java'>
        network_output = model(im_all, output_more=False)
        loss = realEPE(network_output, label)
        end = time.time()
        loss_cnt.update(<a id="change">float(</a>loss<a id="change">)</a>, step)
        print(&quotval epoch {} batch {}/{} run time: {}s read data time {}s loss {}&quot.format(epoch, batch_id, batch_num,
                                                                                     round(end - start, 2),
                                                                                     round(read_data_time, 2),</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/paddlepaddle/research/commit/4e5f09c70aadac538d41923640b1eb18b8c6e530#diff-4fd1578e66bcb02396231475e6814f5f06069ce2caada1c8bcfda376f6d71ca4L86' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 21054422</div><div id='project'> Project Name: paddlepaddle/research</div><div id='commit'> Commit Name: 4e5f09c70aadac538d41923640b1eb18b8c6e530</div><div id='time'> Time: 2023-01-16</div><div id='author'> Author: zhouwei25@baidu.com</div><div id='file'> File Name: CV/PWCNet/train.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: val(4)</div><div id='n_method'> N Method Name: val(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: CV/PWCNet/train.py</div><div id='n_file'> N File Name: CV/PWCNet/train.py</div><div id='m_start'> M Start Line: 114</div><div id='m_end'> M End Line: 116</div><div id='n_start'> N Start Line: 114</div><div id='n_end'> N End Line: 116</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            adam.clear_grad()

            if step % args.logging_step == 0:
                print("step %d, loss %.4f" % (step, <a id="change">loss.numpy()[0]</a>))

    acc = test(model, test_loader)
    print("\ntest acc %.4f\n" % acc)</code></pre><h3>After Change</h3><pre><code class='java'>
            adam.clear_grad()

            if step % args.logging_step == 0:
                print("step %d, loss %.4f" % (step, <a id="change">float(</a>loss<a id="change">)</a>))

    acc = test(model, test_loader)
    print("\ntest acc %.4f\n" % acc)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/paddlepaddle/paddlenlp/commit/22635acf30b0a1c2bb378b72705291dfda52baea#diff-49000e3bd67485171430cc235810c24214756f597fd5629d4a16a2109e924b62L177' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 21054425</div><div id='project'> Project Name: paddlepaddle/paddlenlp</div><div id='commit'> Commit Name: 22635acf30b0a1c2bb378b72705291dfda52baea</div><div id='time'> Time: 2022-12-20</div><div id='author'> Author: fangzeyang0904@hotmail.com</div><div id='file'> File Name: examples/language_model/elmo/word2vec_base.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(1)</div><div id='n_method'> N Method Name: train(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: examples/language_model/elmo/word2vec_base.py</div><div id='n_file'> N File Name: examples/language_model/elmo/word2vec_base.py</div><div id='m_start'> M Start Line: 224</div><div id='m_end'> M End Line: 230</div><div id='n_start'> N Start Line: 223</div><div id='n_end'> N End Line: 229</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if step % args.log_freq == 0:
            print(
                "step %d/%d - loss: %.4f - Perplexity: %.4f - %.3fs/step"
                % (step, n_steps_total, <a id="change">loss.numpy()[0]</a>, ppl.numpy()[0], total_time / args.log_freq)
            )
            total_time = 0.0
        if rank == 0 and step % args.save_freq == 0:</code></pre><h3>After Change</h3><pre><code class='java'>
        if step % args.log_freq == 0:
            print(
                "step %d/%d - loss: %.4f - Perplexity: %.4f - %.3fs/step"
                % (step, n_steps_total, <a id="change">float(</a>loss<a id="change">)</a>, float(ppl), total_time / args.log_freq)
            )
            total_time = 0.0
        if rank == 0 and step % args.save_freq == 0:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/paddlepaddle/paddlenlp/commit/22635acf30b0a1c2bb378b72705291dfda52baea#diff-bdd27312b34e7f6b7c2c7177095464e289d4e7df8adb08c2276842219248dc04L34' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 21054411</div><div id='project'> Project Name: paddlepaddle/paddlenlp</div><div id='commit'> Commit Name: 22635acf30b0a1c2bb378b72705291dfda52baea</div><div id='time'> Time: 2022-12-20</div><div id='author'> Author: fangzeyang0904@hotmail.com</div><div id='file'> File Name: examples/language_model/elmo/run_pretrain.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(1)</div><div id='n_method'> N Method Name: train(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: examples/language_model/elmo/run_pretrain.py</div><div id='n_file'> N File Name: examples/language_model/elmo/run_pretrain.py</div><div id='m_start'> M Start Line: 96</div><div id='m_end'> M End Line: 107</div><div id='n_start'> N Start Line: 96</div><div id='n_end'> N End Line: 107</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if step % args.log_freq == 0:
            print(
                "Eval step %d - loss: %.4f - Perplexity: %.4f - %.3fs/step"
                % (step, <a id="change">loss.numpy()[0]</a> * args.unroll_steps, ppl.numpy()[0], total_time / args.log_freq)
            )
            total_time = 0.0
        batch_start_time = time.time()</code></pre><h3>After Change</h3><pre><code class='java'>
        if step % args.log_freq == 0:
            print(
                "Eval step %d - loss: %.4f - Perplexity: %.4f - %.3fs/step"
                % (step, <a id="change">float(</a>loss<a id="change">)</a> * args.unroll_steps, float(ppl), total_time / args.log_freq)
            )
            total_time = 0.0
        batch_start_time = time.time()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/paddlepaddle/paddlenlp/commit/22635acf30b0a1c2bb378b72705291dfda52baea#diff-58a83bb7f8756cc3a4061e73f8a93d2d601a641926a2e87baa0290962fd8d564L29' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 21054413</div><div id='project'> Project Name: paddlepaddle/paddlenlp</div><div id='commit'> Commit Name: 22635acf30b0a1c2bb378b72705291dfda52baea</div><div id='time'> Time: 2022-12-20</div><div id='author'> Author: fangzeyang0904@hotmail.com</div><div id='file'> File Name: examples/language_model/elmo/run_eval.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: eval(1)</div><div id='n_method'> N Method Name: eval(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: examples/language_model/elmo/run_eval.py</div><div id='n_file'> N File Name: examples/language_model/elmo/run_eval.py</div><div id='m_start'> M Start Line: 67</div><div id='m_end'> M End Line: 77</div><div id='n_start'> N Start Line: 64</div><div id='n_end'> N End Line: 74</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                    print(&quotValidation trained_id:{}, epoch:{}, batch_id:{}, time:{}s, val_loss:{}.&quot.format(train_id, epoch+1,
                                                                                                            batch_id,
                                                                                                            during_time[:6],
                                                                                                            <a id="change">val_avg_loss.numpy()[0]</a>,
                                                                                                            ))
            acc, acc_cls, iu, mean_iu_val, fwavacc, kappa = val_iou_np.evaluate()
            print(&quotValidation epoch:{}, val_loss{}, val_iou_np:{}&quot.format(epoch+1, test_avg_loss_manager.eval()[0], mean_iu_val))</code></pre><h3>After Change</h3><pre><code class='java'>
                                                               epoch + 1,
                                                               during_time[:6],
                                                               batch_id + 1,
                                                               <a id="change">float(</a>train_avg_loss<a id="change">)</a>,
                                                               lr)
                
                if batch_id % 100 == 0:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/paddlepaddle/research/commit/4e5f09c70aadac538d41923640b1eb18b8c6e530#diff-c567c83b7b81b5325c15fdff4ec85c61ec17bded45da150108bfa1e15910299aL194' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 21054415</div><div id='project'> Project Name: paddlepaddle/research</div><div id='commit'> Commit Name: 4e5f09c70aadac538d41923640b1eb18b8c6e530</div><div id='time'> Time: 2023-01-16</div><div id='author'> Author: zhouwei25@baidu.com</div><div id='file'> File Name: CV/SemSegPaddleDG/train.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(1)</div><div id='n_method'> N Method Name: train(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: CV/SemSegPaddleDG/train.py</div><div id='n_file'> N File Name: CV/SemSegPaddleDG/train.py</div><div id='m_start'> M Start Line: 277</div><div id='m_end'> M End Line: 337</div><div id='n_start'> N Start Line: 277</div><div id='n_end'> N End Line: 337</div><BR>