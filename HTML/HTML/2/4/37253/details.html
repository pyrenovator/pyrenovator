<html><h3>Pattern ID :37253
</h3><img src='107302197.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 do not call into super since this instance is not passing all calls to
        &#47&#47 the nested optimizer

        <a id="change">if steps_per_epoch &lt;= 0</a>:
            raise ValueError("steps_per_epoch must be &gt;= 0")

        self._optimizer<a id="change"> = </a>optimizer
        self._module = module
        self._manager = manager
        self._steps_per_epoch = steps_per_epoch</code></pre><h3>After Change</h3><pre><code class='java'>
            UserWarning,
        )

        <a id="change">manager.initialize(</a>module<a id="change">, epoch=0.0, loggers=loggers)</a>
        self._wrapper = RecipeManagerStepWrapper(
            optimizer,
            optimizer,
            module,</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/neuralmagic/sparseml/commit/35be148dfed1e7ea46e5fbc4e12972d7ccce121a#diff-01855fe341d5c962babcb4b256978110dafabb7c08a61fa93d6866558ab755e3L81' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107302197</div><div id='project'> Project Name: neuralmagic/sparseml</div><div id='commit'> Commit Name: 35be148dfed1e7ea46e5fbc4e12972d7ccce121a</div><div id='time'> Time: 2021-05-12</div><div id='author'> Author: mark@neuralmagic.com</div><div id='file'> File Name: src/sparseml/pytorch/optim/optimizer.py</div><div id='m_class'> M Class Name: ScheduledOptimizer</div><div id='n_method'> N Class Name: ScheduledOptimizer</div><div id='m_method'> M Method Name: __init__(6)</div><div id='n_method'> N Method Name: __init__(6)</div><div id='m_parent_class'> M Parent Class: Optimizer</div><div id='n_parent_class'> N Parent Class: Optimizer</div><div id='m_file'> M File Name: src/sparseml/pytorch/optim/optimizer.py</div><div id='n_file'> N File Name: src/sparseml/pytorch/optim/optimizer.py</div><div id='m_start'> M Start Line: 81</div><div id='m_end'> M End Line: 92</div><div id='n_start'> N Start Line: 84</div><div id='n_end'> N End Line: 98</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
		&quot&quot&quot
		eps = 1E-6

		<a id="change">if self.initial_guess is None</a>:
			X<a id="change"> = </a>self.boundary * (-1 + 2*np.random.rand(self.nwalkers,self.ndim))
		else:
			X = self.initial_guess
</code></pre><h3>After Change</h3><pre><code class='java'>
            X (list) : position of the walkers
        &quot&quot&quot

        <a id="change">self.walkers.initialize(method=&quotuniform&quot)</a>
        fx = pdf(self.walkers.pos)
        ones = np.ones((self.nwalkers,1))

        for istep in range(self.nstep):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/nlesc-jcer/qmctorch/commit/27f7dcb7b89660e95440bb6390c73dbe681d9e07#diff-d54083e63a0303c1d1845e8bd3d9e3f8b5072242e86b486b3cd83dab9263e9bcL23' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107302193</div><div id='project'> Project Name: nlesc-jcer/qmctorch</div><div id='commit'> Commit Name: 27f7dcb7b89660e95440bb6390c73dbe681d9e07</div><div id='time'> Time: 2019-04-24</div><div id='author'> Author: nicolas.gm.renaud@gmail.com</div><div id='file'> File Name: pyCHAMP/sampler/metropolis.py</div><div id='m_class'> M Class Name: METROPOLIS</div><div id='n_method'> N Class Name: METROPOLIS</div><div id='m_method'> M Method Name: generate(2)</div><div id='n_method'> N Method Name: generate(2)</div><div id='m_parent_class'> M Parent Class: SAMPLER_BASE</div><div id='n_parent_class'> N Parent Class: SAMPLER_BASE</div><div id='m_file'> M File Name: pyCHAMP/sampler/metropolis.py</div><div id='n_file'> N File Name: pyCHAMP/sampler/metropolis.py</div><div id='m_start'> M Start Line: 29</div><div id='m_end'> M End Line: 63</div><div id='n_start'> N Start Line: 35</div><div id='n_end'> N End Line: 55</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        self.retain_graph = False  &#47&#47 loss.backward()是否保留计算图
        self.callbacks = []
        &#47&#47 传入Module实例方式
        <a id="change">if module is not None</a>:
            self.module<a id="change"> = </a>module

    def forward(self, *inputs, **kwargs):
        &#47&#47 如果传入了网络结构module，则调用module的forward</code></pre><h3>After Change</h3><pre><code class='java'>
    
    def __init__(self, module=None):
        super(Trainer, self).__init__()
        <a id="change">self.initialize(</a>module<a id="change">)</a>
    
    def initialize(self, module=None):
        &#47&#47 这里主要是为了外面调用用到
        self.global_step, self.local_step, self.total_steps, self.epoch, self.steps_per_epoch, self.train_dataloader = 0, 0, 0, 0, None, None</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tongjilibo/torch4keras/commit/3bbdc3792e75f9e2c8d9722ca10b68bd86f282a8#diff-581b94b0f4bd7b79c5687e60861daad8735c94a1a220b1276f1933d3044c5c06L14' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107302191</div><div id='project'> Project Name: tongjilibo/torch4keras</div><div id='commit'> Commit Name: 3bbdc3792e75f9e2c8d9722ca10b68bd86f282a8</div><div id='time'> Time: 2023-01-22</div><div id='author'> Author: lb@libos-MacBook-Pro.local</div><div id='file'> File Name: torch4keras/model.py</div><div id='m_class'> M Class Name: Trainer</div><div id='n_method'> N Class Name: Trainer</div><div id='m_method'> M Method Name: __init__(2)</div><div id='n_method'> N Method Name: __init__(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: torch4keras/model.py</div><div id='n_file'> N File Name: torch4keras/model.py</div><div id='m_start'> M Start Line: 17</div><div id='m_end'> M End Line: 25</div><div id='n_start'> N Start Line: 16</div><div id='n_end'> N End Line: 16</div><BR>