<html><h3>Pattern ID :32493
</h3><img src='94691436.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            x = x.to(pl_module.device)       
            with torch.no_grad():
                pl_module.eval()
                <a id="change">print(&quotfuck&quot</a><a id="change">)</a>
                &#47&#47generate sample with image provided
                x_rec = pl_module.generate_images(text=text, img = x, filter_thres=0.9)  &#47&#47 topk sampling at 0.9
                print(&quotfuck&quot)
                &#47&#47generate sample without image</code></pre><h3>After Change</h3><pre><code class='java'>
        if trainer.global_step % self.every_n_steps == 0:          
            text, x = batch
            sample_text = text[:1]
            token_list<a id="change"> = </a><a id="change">sample_text.masked_select(sample_text != 0).tolist()</a>
            decoded_text = self.tokenizer.decode(token_list)       
            text = text.to(pl_module.device)
            x = x.to(pl_module.device)       
            with torch.no_grad():</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 7</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/tgisaturday/dalle-lightning/commit/d5154f7e185c7b737a7bb3b9f1f9048d811cab37#diff-a83484d4c7b7ebe0b0e0ade59c8557937a9e940ae331d28b6debb50cefd16ffcL202' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 94691436</div><div id='project'> Project Name: tgisaturday/dalle-lightning</div><div id='commit'> Commit Name: d5154f7e185c7b737a7bb3b9f1f9048d811cab37</div><div id='time'> Time: 2021-07-26</div><div id='author'> Author: jamesk1228@gmail.com</div><div id='file'> File Name: pl_dalle/callbacks.py</div><div id='m_class'> M Class Name: DalleImageSampler</div><div id='n_method'> N Class Name: DalleImageSampler</div><div id='m_method'> M Method Name: on_train_batch_end(7)</div><div id='n_method'> N Method Name: on_train_batch_end(7)</div><div id='m_parent_class'> M Parent Class: Callback</div><div id='n_parent_class'> N Parent Class: Callback</div><div id='m_file'> M File Name: pl_dalle/callbacks.py</div><div id='n_file'> N File Name: pl_dalle/callbacks.py</div><div id='m_start'> M Start Line: 206</div><div id='m_end'> M End Line: 209</div><div id='n_start'> N Start Line: 202</div><div id='n_end'> N End Line: 246</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

  def rfe(self, step=1, rfe_features=1, num_features=20):
    if &quotrfe_feature_rank&quot not in self.__dict__.keys():
      <a id="change">print (&quotRunning Recursive Feature Elimination with&quot</a>,len(self.feature_names),&quotfeatures. This might take some time. Please wait.&quot<a id="change">)</a>
      selector=RFE(estimator=self.classifier, n_features_to_select=rfe_features, step=step)
      selector.fit(self.train_features, self.train_labels)
      self.rfe_feature_rank=selector.ranking_
    df= pd.DataFrame(list(zip(self.feature_names, self.rfe_feature_rank.tolist())), columns=[&quotFeature&quot, &quotRank&quot])</code></pre><h3>After Change</h3><pre><code class='java'>
          self.selector.fit(self.train_features, self.train_labels)
          self.rfe_feature_rank=self.selector.ranking_
        df= pd.DataFrame(list(zip(self.feature_names, self.rfe_feature_rank.tolist())), columns=[&quotFeature&quot, &quotRank&quot])
        best_features_names<a id="change">=</a>[x for x,v in list(zip(G.feature_names, <a id="change">G.selector.support_.tolist()</a>)) if v==True]
        best_features_scores=df.sort_values(by=[&quotRank&quot], ascending=True)
        best_features_table=self.feature_table[best_features_names+[self.label_column]]
        return best_features_scores, best_features_names, best_features_table</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/radtorch/radtorch/commit/a4dccc68cb4935fe0222e31d045079d0523ea640#diff-203dbc007b1e7a27456d652e0fd87290400c8cf18342d22638277a19a4266119L171' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 94691444</div><div id='project'> Project Name: radtorch/radtorch</div><div id='commit'> Commit Name: a4dccc68cb4935fe0222e31d045079d0523ea640</div><div id='time'> Time: 2020-04-11</div><div id='author'> Author: elbanan@users.noreply.github.com</div><div id='file'> File Name: radtorch/test.py</div><div id='m_class'> M Class Name: Feature_selection</div><div id='n_method'> N Class Name: Feature_selection</div><div id='m_method'> M Method Name: rfe(3)</div><div id='n_method'> N Method Name: rfe(4)</div><div id='m_parent_class'> M Parent Class: Classifier</div><div id='n_parent_class'> N Parent Class: Classifier</div><div id='m_file'> M File Name: radtorch/test.py</div><div id='n_file'> N File Name: radtorch/test.py</div><div id='m_start'> M Start Line: 171</div><div id='m_end'> M End Line: 179</div><div id='n_start'> N Start Line: 170</div><div id='n_end'> N End Line: 175</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    if diff_count == 1.0:
        diff_numpy = diff.numpy()
        index_list = np.where(diff_numpy &gt;= 1.0)
        <a id="change">print("index_list:"</a>, index_list<a id="change">)</a> if debug else None
        index = index_list[1][0]
        if index not in worker_type_list and index not in supply_type_list:
            previous_bo.append(index)</code></pre><h3>After Change</h3><pre><code class='java'>
        index = torch.nonzero(diff, as_tuple=True)[-1]
        print("index:", index) if debug else None

        index<a id="change"> = </a><a id="change">index.detach().cpu().numpy().tolist()</a>
        previous_bo.extend(index)

    return previous_bo</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/liuruoze/mini-alphastar/commit/a115d8c35ded3fa3d608df5576d72a17cf941787#diff-7c0e32382d0e7e30a696fe55f56293d282c671f931ec5d2557f646727f46ad0aL122' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 94691446</div><div id='project'> Project Name: liuruoze/mini-alphastar</div><div id='commit'> Commit Name: a115d8c35ded3fa3d608df5576d72a17cf941787</div><div id='time'> Time: 2021-12-10</div><div id='author'> Author: liuruoze@163.com</div><div id='file'> File Name: alphastarmini/lib/utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: calculate_build_order(3)</div><div id='n_method'> N Method Name: calculate_build_order(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: alphastarmini/lib/utils.py</div><div id='n_file'> N File Name: alphastarmini/lib/utils.py</div><div id='m_start'> M Start Line: 126</div><div id='m_end'> M End Line: 145</div><div id='n_start'> N Start Line: 111</div><div id='n_end'> N End Line: 135</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        tokenizer,
        output_data.transpose([1, 2, 0]).tolist()[0][0], bos_id, eos_id)
    print("Model input:", inputs)
    <a id="change">print("Result:"</a>, result<a id="change">)</a>


if __name__ == "__main__":
    args = setup_args()</code></pre><h3>After Change</h3><pre><code class='java'>
    output_data = output_data.transpose([1, 2, 0])

    &#47&#47 Only use the best sequence.
    result<a id="change"> = </a>[
        postprocess_response(tokenizer,
                             <a id="change">sample.tolist()</a>[0], bos_id, eos_id)
        for sample in output_data
    ]
    print("Model input:", inputs)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/paddlepaddle/paddlenlp/commit/521fd43191192a3a828b2ae2cd226e4264f99a91#diff-de114118d9425b8bcb85d62378ec66ff6233de45ee27b556a0626a20d8813432L54' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 94691441</div><div id='project'> Project Name: paddlepaddle/paddlenlp</div><div id='commit'> Commit Name: 521fd43191192a3a828b2ae2cd226e4264f99a91</div><div id='time'> Time: 2022-09-27</div><div id='author'> Author: 380185688@qq.com</div><div id='file'> File Name: paddlenlp/ops/faster_transformer/sample/mbart_inference.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: infer(1)</div><div id='n_method'> N Method Name: infer(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: paddlenlp/ops/faster_transformer/sample/mbart_inference.py</div><div id='n_file'> N File Name: paddlenlp/ops/faster_transformer/sample/mbart_inference.py</div><div id='m_start'> M Start Line: 56</div><div id='m_end'> M End Line: 90</div><div id='n_start'> N Start Line: 61</div><div id='n_end'> N End Line: 113</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        optimizer = optim.Adam(train_params, lr=self.poison_lr)
        criterion = nn.CrossEntropyLoss()

        <a id="change">print("fine-tuning"</a><a id="change">)</a>
        self.model.cuda()
        loss, n_sample = 0.0, 0

        self.model.train()</code></pre><h3>After Change</h3><pre><code class='java'>
                         int(all_num*self.fine_tune_set_ratio), 
                         replace=False)

        fine_tune_imgs<a id="change"> = </a>torch.tensor(self.yt_imgs.tolist()+<a id="change">self.ynt_imgs.tolist()</a>)[fine_tune_inds]
        fine_tune_labels = torch.tensor(self.yt_labels.tolist()+self.ynt_labels.tolist())[fine_tune_inds]

        &#47&#47 only update last layer parameters</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ain-soph/trojanzoo/commit/e1fa2f5536d966e225a2d40eddb80b9725daca34#diff-1e9f08cdcf107dac703ba6ade89c7699ee84615bf2b5cdd4e776168a691df4dfL218' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 94691437</div><div id='project'> Project Name: ain-soph/trojanzoo</div><div id='commit'> Commit Name: e1fa2f5536d966e225a2d40eddb80b9725daca34</div><div id='time'> Time: 2020-06-27</div><div id='author'> Author: zxx5113@lrs-twang01.ist.psu.edu</div><div id='file'> File Name: trojanzoo/attack/backdoor/latent_backdoor.py</div><div id='m_class'> M Class Name: Latent_Backdoor</div><div id='n_method'> N Class Name: Latent_Backdoor</div><div id='m_method'> M Method Name: student_fine_tuning(1)</div><div id='n_method'> N Method Name: student_fine_tuning(1)</div><div id='m_parent_class'> M Parent Class: BadNet</div><div id='n_parent_class'> N Parent Class: BadNet</div><div id='m_file'> M File Name: trojanzoo/attack/backdoor/latent_backdoor.py</div><div id='n_file'> N File Name: trojanzoo/attack/backdoor/latent_backdoor.py</div><div id='m_start'> M Start Line: 231</div><div id='m_end'> M End Line: 249</div><div id='n_start'> N Start Line: 248</div><div id='n_end'> N End Line: 269</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        src_ids = X[:, 0, 0].squeeze().tolist()  &#47&#47 (1, 2, 2, L) -&gt; (1, L) -&gt; (L) -&gt; list
        pred_ids = transformer.predict(X).squeeze().tolist()  &#47&#47 (1, L) -&gt; (L) -&gt; list
        print([tokenizer.id_to_token(src_id) for src_id in src_ids])
        <a id="change">print("-&gt;"</a><a id="change">)</a>
        print([tokenizer.id_to_token(pred_id) for pred_id in pred_ids])


if __name__ == &quot__main__&quot:</code></pre><h3>After Change</h3><pre><code class='java'>
        transformer = fetch_transformer(run, config[&quotmodel&quot], config[&quotver&quot])
        transformer.eval()
        X = InferInputsBuilder(tokenizer, config[&quotmax_length&quot])(srcs=[config[&quotkor&quot]])
        src_ids<a id="change"> = </a><a id="change">X[0, 0, 0].tolist()</a>  &#47&#47 (1, 2, 2, L) -&gt; (L) -&gt; list
        pred_ids = transformer.predict(X).squeeze().tolist()  &#47&#47 (1, L) -&gt; (L) -&gt; list
        pred_ids = pred_ids[: pred_ids.index(tokenizer.eos_token_id)]  &#47&#47 noqa
        print(tokenizer.decode(ids=src_ids), "-&gt;", tokenizer.decode(ids=pred_ids))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/eubinecto/the-clean-transformer/commit/fec218b75568e8fe876d9015cb2cd186661303ef#diff-f5ca89baf936662ded1038bd077b9fdbd9e3d91f08158fc90300fa289f534c45L7' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 94691439</div><div id='project'> Project Name: eubinecto/the-clean-transformer</div><div id='commit'> Commit Name: fec218b75568e8fe876d9015cb2cd186661303ef</div><div id='time'> Time: 2021-12-11</div><div id='author'> Author: eubinecto</div><div id='file'> File Name: main_infer.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: main_infer.py</div><div id='n_file'> N File Name: main_infer.py</div><div id='m_start'> M Start Line: 13</div><div id='m_end'> M End Line: 26</div><div id='n_start'> N Start Line: 17</div><div id='n_end'> N End Line: 24</div><BR>