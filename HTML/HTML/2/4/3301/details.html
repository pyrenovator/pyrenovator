<html><h3>Pattern ID :3301
</h3><img src='12699685.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    print(
        f&quottraining max_memory_allocated {torch.cuda.max_memory_allocated()/1e9} GB, max_memory_reserved {torch.cuda.max_memory_allocated()/1e9} GB&quot
    )
    <a id="change">print(</a>f&quotoverall training time {timer.elapsed:.2f}s&quot<a id="change">)</a>


if __name__ == "__main__":
    with Timer() as timer:</code></pre><h3>After Change</h3><pre><code class='java'>
                    if it == 200:
                        break

    <a id="change">if </a><a id="change">hasattr(</a>model, <a id="change">&quotcache_weight_mgr&quot</a><a id="change">)</a>:
        model.cache_weight_mgr.print_comm_stats()

</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/hpcaitech/freqcacheembedding/commit/ad06327b975d92dfcabbc0c1965ad459e4f62dad#diff-3f3f0e579a0b39958321387c8a7db5c9b349b6db8179a2f3ce681563afc7e165L29' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 12699685</div><div id='project'> Project Name: hpcaitech/freqcacheembedding</div><div id='commit'> Commit Name: ad06327b975d92dfcabbc0c1965ad459e4f62dad</div><div id='time'> Time: 2022-10-17</div><div id='author'> Author: fangjiarui123@gmail.com</div><div id='file'> File Name: benchmark/benchmark_cache.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: benchmark_cache_embedding(7)</div><div id='n_method'> N Method Name: benchmark_cache_embedding(7)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: benchmark/benchmark_cache.py</div><div id='n_file'> N File Name: benchmark/benchmark_cache.py</div><div id='m_start'> M Start Line: 29</div><div id='m_end'> M End Line: 93</div><div id='n_start'> N Start Line: 74</div><div id='n_end'> N End Line: 77</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        super(NodeClassificationAC, self).__init__(args)
        self.args = args
        self.model_name = args.model[0:-3]
        <a id="change">print(</a>self.model_name<a id="change">)</a>
        self.device = args.device

        self.task = build_task(args)</code></pre><h3>After Change</h3><pre><code class='java'>
    def __init__(self, args):
        super(NodeClassificationAC, self).__init__(args)
        
        <a id="change">if </a><a id="change">hasattr(</a>args, <a id="change">&quotmetric&quot</a><a id="change">)</a>:
            self.metric = args.metric
        else:
            self.metric = &quotf1&quot</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/bupt-gamma/openhgnn/commit/52ccb6b8a0bc096c7838b1d47eb755d85b54ef83#diff-9f5129a2ff7af5f5a42b94182d06f2fecb7288a25baef07a5684d04d17766b0dL28' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 12699684</div><div id='project'> Project Name: bupt-gamma/openhgnn</div><div id='commit'> Commit Name: 52ccb6b8a0bc096c7838b1d47eb755d85b54ef83</div><div id='time'> Time: 2021-09-12</div><div id='author'> Author: 75086617+dddg617@users.noreply.github.com</div><div id='file'> File Name: openhgnn/trainerflow/node_classification_ac.py</div><div id='m_class'> M Class Name: NodeClassificationAC</div><div id='n_method'> N Class Name: NodeClassificationAC</div><div id='m_method'> M Method Name: __init__(2)</div><div id='n_method'> N Method Name: __init__(2)</div><div id='m_parent_class'> M Parent Class: BaseFlow</div><div id='n_parent_class'> N Parent Class: BaseFlow</div><div id='m_file'> M File Name: openhgnn/trainerflow/node_classification_ac.py</div><div id='n_file'> N File Name: openhgnn/trainerflow/node_classification_ac.py</div><div id='m_start'> M Start Line: 30</div><div id='m_end'> M End Line: 82</div><div id='n_start'> N Start Line: 32</div><div id='n_end'> N End Line: 77</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            &#47&#47 TODO: rigorously test this with different operations
            &#47&#47 reason: `output_fields` are all calculated differently in
            &#47&#47 different spots for different operations
            <a id="change">print(</a>e<a id="change">)</a>

    @staticmethod
    def clean(
        before_docs: List[Dict[str, Any]],</code></pre><h3>After Change</h3><pre><code class='java'>
        where possible
        
        try:
            <a id="change">if </a><a id="change">hasattr(</a>self.operation, <a id="change">"output_fields"</a><a id="change">)</a>:
                if hasattr(self.operation, "select_fields"):
                    for i, field in enumerate(self.operation.select_fields):
                        self.dataset.update_field_children(</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/relevanceai/relevanceai/commit/a6e6b014654ef2235ad5ca5c3c0419d09950350f#diff-1e8c79b5bef9bd13c14d0c6ca33e6e750fc2743cde2ad154a376ef1b2d12be62L86' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 12699687</div><div id='project'> Project Name: relevanceai/relevanceai</div><div id='commit'> Commit Name: a6e6b014654ef2235ad5ca5c3c0419d09950350f</div><div id='time'> Time: 2022-09-14</div><div id='author'> Author: jacky.wong@relevance.ai</div><div id='file'> File Name: relevanceai/operations_new/ops_manager.py</div><div id='m_class'> M Class Name: OperationManager</div><div id='n_method'> N Class Name: OperationManager</div><div id='m_method'> M Method Name: _store_default_parent_child(1)</div><div id='n_method'> N Method Name: _store_default_parent_child(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: relevanceai/operations_new/ops_manager.py</div><div id='n_file'> N File Name: relevanceai/operations_new/ops_manager.py</div><div id='m_start'> M Start Line: 91</div><div id='m_end'> M End Line: 122</div><div id='n_start'> N Start Line: 91</div><div id='n_end'> N End Line: 122</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            if p.gradient is None:
                continue
            grad = p.gradient
            <a id="change">print(</a>&quotadam grad:&quot, grad<a id="change">)</a>

            state = states[param_idx]

            state[&quotstep&quot] += 1</code></pre><h3>After Change</h3><pre><code class='java'>

    out = tuple(p - p.update for p in params if hasattr(p, &quotupdate&quot))
    for p in params:
        <a id="change">if </a><a id="change">hasattr(</a>p, <a id="change">&quotupdate&quot</a><a id="change">)</a>:
            del p.update
    return out
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/leopard-ai/betty/commit/6d731ca13bf887bb15eefc85c120c681d0d9a1d0#diff-02175463e720b8e991266c8411306e432bbc787fd5644b2cd38a122de76fa8cbL6' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 12699688</div><div id='project'> Project Name: leopard-ai/betty</div><div id='commit'> Commit Name: 6d731ca13bf887bb15eefc85c120c681d0d9a1d0</div><div id='time'> Time: 2022-02-17</div><div id='author'> Author: sangkeuc@andrew.cmu.edu</div><div id='file'> File Name: betty/optim/adam.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: fadam(4)</div><div id='n_method'> N Method Name: fadam(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: betty/optim/adam.py</div><div id='n_file'> N File Name: betty/optim/adam.py</div><div id='m_start'> M Start Line: 12</div><div id='m_end'> M End Line: 49</div><div id='n_start'> N Start Line: 20</div><div id='n_end'> N End Line: 51</div><BR>