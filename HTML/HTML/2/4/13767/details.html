<html><h3>Pattern ID :13767
</h3><img src='45986969.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        P = F.log_softmax(self.vocab_projection(output), dim = -1) &#47&#47 len * b * v

        target_word_prob = torch.gather(P[ : -1], index = datas[1 : ].unsqueeze(-1), dim = -1).squeeze(-1) &#47&#47 len * b
        losses<a id="change"> = </a>-<a id="change">target_word_prob.mean()</a>
        return losses
    
    def generate(self):
        self.eval()</code></pre><h3>After Change</h3><pre><code class='java'>
        output, _ = self.LSTM(data_embedding)  &#47&#47 len * b * h
        logits = self.vocab_projection(output)  &#47&#47 len * b * v

        logits = <a id="change">logits.reshape(-1</a>, self.vocabulary_size<a id="change">)</a>  &#47&#47 (len * b) * v
        target = datas[1:].reshape(-1)  &#47&#47 (len * b)

        losses = F.cross_entropy(logits, target, ignore_index=self.pad_idx)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/rucaibox/textbox/commit/34940a486bff4b4b1f9bad5b47ac10d42e9ddc65#diff-95afcb667272a6319ee5eb3f1fa425503ef826a28dbb4c0c06578866a39a7b8bL22' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 45986969</div><div id='project'> Project Name: rucaibox/textbox</div><div id='commit'> Commit Name: 34940a486bff4b4b1f9bad5b47ac10d42e9ddc65</div><div id='time'> Time: 2020-11-16</div><div id='author'> Author: hglworking@163.com</div><div id='file'> File Name: textbox/module/Generator/SeqGAN_Generator.py</div><div id='m_class'> M Class Name: Generator</div><div id='n_method'> N Class Name: Generator</div><div id='m_method'> M Method Name: pre_train(2)</div><div id='n_method'> N Method Name: pre_train(2)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: textbox/module/Generator/SeqGAN_Generator.py</div><div id='n_file'> N File Name: textbox/module/Generator/SeqGAN_Generator.py</div><div id='m_start'> M Start Line: 22</div><div id='m_end'> M End Line: 28</div><div id='n_start'> N Start Line: 24</div><div id='n_end'> N End Line: 33</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
  image_orig_r = image_orig.view(-1,64*64*3)
  
  rec_loss = torch.norm(image_rec_r - image_orig_r, p=2, dim=1)
  rec_loss<a id="change"> = </a><a id="change">torch.mean(</a>rec_loss<a id="change">)</a>


  return rec_loss
</code></pre><h3>After Change</h3><pre><code class='java'>

  assert image_rec.shape == image_orig.shape, "Assertion error: shape of input should be as same as target"
  
  return torch.lignalg.norm(image_rec.reshape(image_rec.shape[0], -1) - <a id="change">image_orig.reshape(</a>image_orig.shape[0], <a id="change">-1</a><a id="change">)</a>, ord=2, dim=1).mean()

&#47&#47  image_rec_r = image_rec.view(-1,64*64*3)
&#47&#47  image_orig_r = image_orig.view(-1,64*64*3)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/iamigos/avatar-image-generator/commit/fa57a7a92cf07e945309081c52f6a058f91dd3ab#diff-0dea8f2ed8e1f02201083f33bc7fefeba27a90fc5efc15ffd957b24a1fe8b1f9L3' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 45986968</div><div id='project'> Project Name: iamigos/avatar-image-generator</div><div id='commit'> Commit Name: fa57a7a92cf07e945309081c52f6a058f91dd3ab</div><div id='time'> Time: 2021-02-24</div><div id='author'> Author: stevhr@gmail.com</div><div id='file'> File Name: losses/__init__.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: L2_norm(2)</div><div id='n_method'> N Method Name: L2_norm(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: losses/__init__.py</div><div id='n_file'> N File Name: losses/__init__.py</div><div id='m_start'> M Start Line: 5</div><div id='m_end'> M End Line: 12</div><div id='n_start'> N Start Line: 5</div><div id='n_end'> N End Line: 7</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        labels = kmeans.labels_
        lab0 = meter[labels == 0]
        lab1 = meter[labels == 1]
        mean<a id="change"> += </a>[[lab0.mean(), <a id="change">lab1.mean()</a>]]
        std += [[lab0.std(), lab1.std()]]

    </code></pre><h3>After Change</h3><pre><code class='java'>
        kmeans = KMeans(n_clusters=2).fit(meter)
        
        &#47&#47 The mean of a cluster is the cluster centroid
        mean[idx, :] = <a id="change">kmeans.cluster_centers_.reshape(2</a><a id="change">)</a>
        
        &#47&#47 Compute the standard deviation of the points in
        &#47&#47 each cluster
        labels = kmeans.labels_</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/uca-datalab/nilm-thresholding/commit/582dfc731f0f1f268170635bdcc6933cd3eab88c#diff-34fdf11475c005318d3092873f47af42d695c05c936e42693b17521007361b42L191' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 45986971</div><div id='project'> Project Name: uca-datalab/nilm-thresholding</div><div id='commit'> Commit Name: 582dfc731f0f1f268170635bdcc6933cd3eab88c</div><div id='time'> Time: 2020-05-12</div><div id='author'> Author: danipg1409@gmail.com</div><div id='file'> File Name: better_nilm/model/preprocessing.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _get_cluster_centroids(1)</div><div id='n_method'> N Method Name: _get_cluster_centroids(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: better_nilm/model/preprocessing.py</div><div id='n_file'> N File Name: better_nilm/model/preprocessing.py</div><div id='m_start'> M Start Line: 218</div><div id='m_end'> M End Line: 228</div><div id='n_start'> N Start Line: 215</div><div id='n_end'> N End Line: 238</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

  sem_loss = torch.norm(encoder - encoder_rec, p=1, dim=1)
  
  sem_loss<a id="change"> = </a><a id="change">torch.mean(</a>sem_loss<a id="change">)</a>

  return sem_loss 
</code></pre><h3>After Change</h3><pre><code class='java'>

  assert encoder.shape == encoder_rec.shape, "Assertion error: shape of input should be as same as target"
  
  return torch.lignalg.norm(<a id="change">encoder.reshape(</a>encoder.shape[0], <a id="change">-1</a><a id="change">)</a> - encoder_rec.reshape(encoder_rec.shape[0], -1), ord=1, dim=1).mean()


</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/iamigos/avatar-image-generator/commit/fa57a7a92cf07e945309081c52f6a058f91dd3ab#diff-0dea8f2ed8e1f02201083f33bc7fefeba27a90fc5efc15ffd957b24a1fe8b1f9L15' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 45986964</div><div id='project'> Project Name: iamigos/avatar-image-generator</div><div id='commit'> Commit Name: fa57a7a92cf07e945309081c52f6a058f91dd3ab</div><div id='time'> Time: 2021-02-24</div><div id='author'> Author: stevhr@gmail.com</div><div id='file'> File Name: losses/__init__.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: L1_norm(2)</div><div id='n_method'> N Method Name: L1_norm(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: losses/__init__.py</div><div id='n_file'> N File Name: losses/__init__.py</div><div id='m_start'> M Start Line: 17</div><div id='m_end'> M End Line: 24</div><div id='n_start'> N Start Line: 21</div><div id='n_end'> N End Line: 23</div><BR>