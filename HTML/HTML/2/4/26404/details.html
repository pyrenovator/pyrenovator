<html><h3>Pattern ID :26404
</h3><img src='79237881.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            device = int(self._device[-1])
        if os.path.isdir(outdir) == False:
            dataframes = []
            for target in <a id="change">self._module_dict.keys()</a>:
                dataloader = make_dataloader(db = database, pulsemaps = pulsemap, features = self._features, truth = self._truth, batch_size = self._batch_size, shuffle = False, selection = None, num_workers = self.n_workers, persistent_workers= False)
                trainer = Trainer(gpus = [device])
                model = torch.load(self._module_dict[target][&quotpath&quot], map_location = &quotcpu&quot, pickle_module = dill)</code></pre><h3>After Change</h3><pre><code class='java'>
            dataloaders, event_batches = self._setup_dataloaders(chunk_size = chunk_size, db = database, pulsemap = pulsemap, selection = None, persistent_workers= False)
            i = 0
            for dataloader in dataloaders:
                print(&quotCHUNK %s / %s&quot%(i<a id="change">, len(dataloaders)</a>))
                df = self._inference(device, dataloader)
                truth = self._get_truth(database, event_batches[i].tolist())
                retro = self._get_retro(database, <a id="change">event_batches[i].tolist()</a>)
                self._append_to_pipeline(outdir, truth,retro, df, i)
                i +=1
        else:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/icecube/graphnet/commit/168ec8b73fbc8ab36f97a9d1cdb750a69b0fd137#diff-89219ce9fa0dd731421a631d8ff08d468fdd8321f88f54b1fd109ede8ed0cca3L44' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 79237881</div><div id='project'> Project Name: icecube/graphnet</div><div id='commit'> Commit Name: 168ec8b73fbc8ab36f97a9d1cdb750a69b0fd137</div><div id='time'> Time: 2022-04-04</div><div id='author'> Author: rahn@outlook.dk</div><div id='file'> File Name: src/graphnet/data/pipeline.py</div><div id='m_class'> M Class Name: InSQLitePipeline</div><div id='n_method'> N Class Name: InSQLitePipeline</div><div id='m_method'> M Method Name: __call__(4)</div><div id='n_method'> N Method Name: __call__(3)</div><div id='m_parent_class'> M Parent Class: ABC</div><div id='n_parent_class'> N Parent Class: ABC</div><div id='m_file'> M File Name: src/graphnet/data/pipeline.py</div><div id='n_file'> N File Name: src/graphnet/data/pipeline.py</div><div id='m_start'> M Start Line: 50</div><div id='m_end'> M End Line: 64</div><div id='n_start'> N Start Line: 44</div><div id='n_end'> N End Line: 64</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            device = int(self._device[-1])
        if os.path.isdir(outdir) == False:
            dataframes = []
            for target in <a id="change">self._module_dict.keys()</a>:
                dataloader = make_dataloader(db = database, pulsemaps = pulsemap, features = self._features, truth = self._truth, batch_size = self._batch_size, shuffle = False, selection = None, num_workers = self.n_workers, persistent_workers= False)
                trainer = Trainer(gpus = [device])
                model = torch.load(self._module_dict[target][&quotpath&quot], map_location = &quotcpu&quot, pickle_module = dill)</code></pre><h3>After Change</h3><pre><code class='java'>
        if os.path.isdir(outdir) == False:
            dataloaders, event_batches = self._setup_dataloaders(chunk_size = chunk_size, db = database, pulsemap = pulsemap, selection = None, persistent_workers= False)
            i = 0
            for <a id="change">dataloader</a> in dataloaders:
                print(&quotCHUNK %s / %s&quot%(i<a id="change">, len(dataloaders)</a>))
                df = self._inference(device, dataloader)
                truth = self._get_truth(database, event_batches[i].tolist())
                retro = self._get_retro(database, <a id="change">event_batches[i].tolist()</a>)
                self._append_to_pipeline(outdir, truth,retro, df, i)
                i +=1
        else:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/graphnet-team/graphnet/commit/168ec8b73fbc8ab36f97a9d1cdb750a69b0fd137#diff-89219ce9fa0dd731421a631d8ff08d468fdd8321f88f54b1fd109ede8ed0cca3L43' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 79237883</div><div id='project'> Project Name: graphnet-team/graphnet</div><div id='commit'> Commit Name: 168ec8b73fbc8ab36f97a9d1cdb750a69b0fd137</div><div id='time'> Time: 2022-04-04</div><div id='author'> Author: rahn@outlook.dk</div><div id='file'> File Name: src/graphnet/data/pipeline.py</div><div id='m_class'> M Class Name: InSQLitePipeline</div><div id='n_method'> N Class Name: InSQLitePipeline</div><div id='m_method'> M Method Name: __call__(4)</div><div id='n_method'> N Method Name: __call__(3)</div><div id='m_parent_class'> M Parent Class: ABC</div><div id='n_parent_class'> N Parent Class: ABC</div><div id='m_file'> M File Name: src/graphnet/data/pipeline.py</div><div id='n_file'> N File Name: src/graphnet/data/pipeline.py</div><div id='m_start'> M Start Line: 50</div><div id='m_end'> M End Line: 64</div><div id='n_start'> N Start Line: 44</div><div id='n_end'> N End Line: 64</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if relation_to_id is None:
            if create_inverse_triples:
                relation_to_id = create_relation_mapping(
                    set(<a id="change">relation_to_inverse.keys()</a>).union(set(relation_to_inverse.values())),
                )
            else:
                relation_to_id = create_relation_mapping(unique_relations)</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 Check if the triples are inverted already
        &#47&#47 We re-create them pure index based to ensure that _all_ inverse triples are present and that they are
        &#47&#47 contained if and only if create_inverse_triples is True.
        if <a id="change">filter_out_candidate_inverse_relations</a>:
            unique_relations<a id="change">, inverse</a> = np.unique(triples[:, 1], return_inverse=True)
            suspected_to_be_inverse_relations = {r for r in unique_relations if r.endswith(INVERSE_SUFFIX)}
            if len(suspected_to_be_inverse_relations) &gt; 0:
                logger.warning(
                    f&quotSome triples already have the inverse relation suffix {INVERSE_SUFFIX}. &quot
                    f&quotRe-creating inverse triples to ensure consistency. You may disable this behaviour by passing &quot
                    f&quotfilter_out_candidate_inverse_relations=False&quot,
                )
                relation_ids_to_remove = [
                    i
                    for i, r in enumerate(<a id="change">unique_relations.tolist()</a>)
                    if r in suspected_to_be_inverse_relations
                ]
                mask = np.isin(element=inverse, test_elements=relation_ids_to_remove, invert=True)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/pykeen/pykeen/commit/a007a273ff146107fd1b0c099d561c7b7279965a#diff-2dce01c3c0b4127bdab5850a84b545299b150d156c01aad24589fa76762c6c72L144' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 79237885</div><div id='project'> Project Name: pykeen/pykeen</div><div id='commit'> Commit Name: a007a273ff146107fd1b0c099d561c7b7279965a</div><div id='time'> Time: 2020-12-10</div><div id='author'> Author: berrendorf@dbs.ifi.lmu.de</div><div id='file'> File Name: src/pykeen/triples/triples_factory.py</div><div id='m_class'> M Class Name: TriplesFactory</div><div id='n_method'> N Class Name: TriplesFactory</div><div id='m_method'> M Method Name: from_labeled_triples(7)</div><div id='n_method'> N Method Name: from_labeled_triples(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/pykeen/triples/triples_factory.py</div><div id='n_file'> N File Name: src/pykeen/triples/triples_factory.py</div><div id='m_start'> M Start Line: 169</div><div id='m_end'> M End Line: 222</div><div id='n_start'> N Start Line: 269</div><div id='n_end'> N End Line: 319</div><BR>