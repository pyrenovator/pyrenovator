<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    train_dir = os.path.join(data_dir, &quottrain&quot)
    val_dir = os.path.join(data_dir, &quotval&quot)
    test_dir = os.path.join(data_dir, &quottest&quot)
    train_data<a id="change"> = </a>SynpickVideoDataset(data_dir=train_dir, num_frames=cfg.vid_total_length, step=cfg.vid_step,
                                     allow_overlap=cfg.vid_allow_overlap, num_classes=num_classes,
                                     include_gripper=cfg.include_gripper)
    val_data = SynpickVideoDataset(data_dir=val_dir, num_frames=cfg.vid_total_length, step=cfg.vid_step,
                                   allow_overlap=cfg.vid_allow_overlap, num_classes=num_classes,
                                   include_gripper=cfg.include_gripper)
    train_loader<a id="change"> = </a><a id="change">DataLoader(</a>train_data<a id="change">, batch_size=cfg.batch_size, shuffle=True, num_workers=cfg.batch_size,
                              drop_last=True)</a>
    valid_loader = DataLoader(val_data, batch_size=1, shuffle=False, num_workers=4, drop_last=True)
    cfg.action_size = train_data.action_size
    cfg.img_shape = train_data.img_shape
</code></pre><h3>After Change</h3><pre><code class='java'>
    torch.manual_seed(cfg.seed)

    &#47&#47 DATA
    (train_data<a id="change">, val_data, test_data</a>), (train_loader, val_loader, test_loader) = create_dataset(cfg)

    &#47&#47 Optuna
    if cfg.use_optuna:</code></pre>