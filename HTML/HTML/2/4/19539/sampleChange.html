<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    KL_COST = 2e-3
    ACTION_TYPE_KL_COST = 1e-1
    &#47&#47 TODO: change to use the teacher logits
    loss_he<a id="change"> = </a>human_policy_kl_loss(target_logits.action_type, <a id="change">target_logits.action_type.clone()</a>.detach(), ACTION_TYPE_KL_COST)

    &#47&#47 Entropy Loss:
    &#47&#47 There is an entropy loss with weight 1e-4 on all action arguments, </code></pre><h3>After Change</h3><pre><code class='java'>
    KL_COST = 2e-3
    ACTION_TYPE_KL_COST = 1e-1
    &#47&#47 We change to use the teacher logits
    <a id="change">print("trajectories.teacher_logits"</a>, trajectories.teacher_logits<a id="change">)</a> if debug else None
    teacher_logits_action_type = filter_by_for_lists("action_type", trajectories.teacher_logits)

    print("target_logits.action_type.shape", target_logits.action_type.shape) if debug else None</code></pre>