<html><h3>Pattern ID :34648
</h3><img src='99543910.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            q, diff, _ = self.rvq(z)
            return q, diff.mean()
        else:
            return z<a id="change">, torch.zeros_like(z).mean()</a>

    def set_warmed_up(self, state: bool):
        state = torch.tensor(int(state), device=self.warmed_up.device)
        self.warmed_up = state</code></pre><h3>After Change</h3><pre><code class='java'>
        else:
            diff = torch.zeros_like(z).mean()

        if <a id="change">self.noise_augmentation</a>:
            z<a id="change"> = </a>torch.cat([z, <a id="change">torch.randn_like(</a>z<a id="change">)</a>], 1)

        return z, diff
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/caillonantoine/rave/commit/89dad00587fd1c93af554abf13a265417a9d8982#diff-2ec9f36787f2fbc81526d9241c09a293c2ba31639b497d73cc3f1046d0f278c5L635' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 99543910</div><div id='project'> Project Name: caillonantoine/rave</div><div id='commit'> Commit Name: 89dad00587fd1c93af554abf13a265417a9d8982</div><div id='time'> Time: 2023-02-18</div><div id='author'> Author: caillonantoine@gmail.com</div><div id='file'> File Name: rave/blocks.py</div><div id='m_class'> M Class Name: DiscreteEncoder</div><div id='n_method'> N Class Name: DiscreteEncoder</div><div id='m_method'> M Method Name: reparametrize(2)</div><div id='n_method'> N Method Name: reparametrize(2)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: rave/blocks.py</div><div id='n_file'> N File Name: rave/blocks.py</div><div id='m_start'> M Start Line: 635</div><div id='m_end'> M End Line: 638</div><div id='n_start'> N Start Line: 648</div><div id='n_end'> N End Line: 655</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47        x: [B, C_in_out, T]
        &#47&#47        nonpadding: [B, 1, T]
        &#47&#47        cond: [B, C_g, T]
        zs<a id="change">, _</a> = self.decoder(x=encoded_texts.transpose(1, 2), nonpadding=text_lens, cond=utterance_embedding, infer=False, noise_scale=1.0)  &#47&#47 (B, Lmax, adim)
        before_outs = self.feat_out(zs).view(zs.size(0), -1, self.odim)  &#47&#47 (B, Lmax, odim)

        &#47&#47 postnet -&gt; (B, Lmax//r * r, odim)</code></pre><h3>After Change</h3><pre><code class='java'>

        &#47&#47 forward VAE decoder
        target_non_padding_mask = make_non_pad_mask(xs=speech_lens)
        if <a id="change">is_inference</a>:
            z = self.decoder(cond=encoded_texts.transpose(1, 2),
                             infer=is_inference)  &#47&#47 (B, Lmax, adim)
        else:
            z, kl_loss, z_p, m_q, logs_q = self.decoder(x=gold_speech,
                                                        nonpadding=target_non_padding_mask,
                                                        cond=encoded_texts.transpose(1, 2),
                                                        infer=is_inference)  &#47&#47 (B, Lmax, adim)
            if not use_posterior:
                z<a id="change"> = </a><a id="change">torch.randn_like(</a>z<a id="change">)</a>

        before_outs = self.decoder.decoder(z, nonpadding=speech_lens, cond=encoded_texts).transpose(1, 2)

        &#47&#47 forward flow post-net</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/digitalphonetics/ims-toucan/commit/1f6ef3294b6593510f03bf07885afb4754888c42#diff-12643f5b2c8b9a82605c22c3f362317aa32afc7f0c07d080244ac4cefb2f5794L244' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 99543908</div><div id='project'> Project Name: digitalphonetics/ims-toucan</div><div id='commit'> Commit Name: 1f6ef3294b6593510f03bf07885afb4754888c42</div><div id='time'> Time: 2022-11-29</div><div id='author'> Author: florian.lux@ims.uni-stuttgart.de</div><div id='file'> File Name: TrainingInterfaces/Text_to_Spectrogram/PortaSpeech/PortaSpeech.py</div><div id='m_class'> M Class Name: PortaSpeech</div><div id='n_method'> N Class Name: PortaSpeech</div><div id='m_method'> M Method Name: _forward(14)</div><div id='n_method'> N Method Name: _forward(12)</div><div id='m_parent_class'> M Parent Class: torch.nn.Module,ABC</div><div id='n_parent_class'> N Parent Class: torch.nn.Module,ABC</div><div id='m_file'> M File Name: TrainingInterfaces/Text_to_Spectrogram/PortaSpeech/PortaSpeech.py</div><div id='n_file'> N File Name: TrainingInterfaces/Text_to_Spectrogram/PortaSpeech/PortaSpeech.py</div><div id='m_start'> M Start Line: 303</div><div id='m_end'> M End Line: 309</div><div id='n_start'> N Start Line: 258</div><div id='n_end'> N End Line: 330</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    beta_t = self.beta_0 + t * (self.beta_1 - self.beta_0)
    drift = -0.5 * beta_t * x
    diffusion = torch.sqrt(beta_t)
    return drift<a id="change">, diffusion</a>
  
  def prior_sampling(self, shape):
    return torch.randn(*shape)
</code></pre><h3>After Change</h3><pre><code class='java'>
    t = batch[&quott&quot]
    beta_t = self.beta_0 + t * (self.beta_1 - self.beta_0)
    diffusion = torch.sqrt(beta_t)
    for <a id="change">key</a> in self.irreps.keys():
      x = batch[key]
      drift = -0.5 * beta_t * x
      x_mean = x + drift * dt
      z<a id="change"> = </a><a id="change">torch.randn_like(</a>x<a id="change">)</a>
      x = x_mean + diffusion * np.sqrt(abs(dt)) * z
      batch[key] = x
    return batch.to(batch.device)
  </code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/20171130/equivariant-nn-zoo/commit/ea9c879fc74829feacf3002ec119608020920c8d#diff-501e41fef4f8d363382785a620f69db97a59d6f05223f844cf6ba48147781ed4L60' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 99543906</div><div id='project'> Project Name: 20171130/equivariant-nn-zoo</div><div id='commit'> Commit Name: ea9c879fc74829feacf3002ec119608020920c8d</div><div id='time'> Time: 2022-08-04</div><div id='author'> Author: hangruibi@outlook.com</div><div id='file'> File Name: e3_layers/run/sde_utils.py</div><div id='m_class'> M Class Name: VPSDE</div><div id='n_method'> N Class Name: VPSDE</div><div id='m_method'> M Method Name: sde(3)</div><div id='n_method'> N Method Name: sde(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: SDE</div><div id='m_file'> M File Name: e3_layers/run/sde_utils.py</div><div id='n_file'> N File Name: e3_layers/run/sde_utils.py</div><div id='m_start'> M Start Line: 62</div><div id='m_end'> M End Line: 64</div><div id='n_start'> N Start Line: 69</div><div id='n_end'> N End Line: 81</div><BR>