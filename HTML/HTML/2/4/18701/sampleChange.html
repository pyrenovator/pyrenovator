<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    &#47&#47save parameters
    params = model.state_dict()
    for key, val in params.items():
        params[key]<a id="change"> = </a><a id="change">val.cpu().numpy()</a>
    torch.save(params, "pytorch_params_glue.file") 

    start_model = &quotrandom&quot
</code></pre><h3>After Change</h3><pre><code class='java'>

def finetune(args):
    cuda_condition = torch.cuda.is_available()
    device = torch.device("cuda:%d"%args.gpu_id<a id="change"> if </a>cuda_condition<a id="change"> else </a>"cpu")
    task_name = args.task_name
    if task_name in [&quotsst-2&quot,&quotcola&quot, &quotmrpc&quot]:
        num_labels = 2</code></pre>