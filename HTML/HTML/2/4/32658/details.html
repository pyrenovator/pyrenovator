<html><h3>Pattern ID :32658
</h3><img src='95036938.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
	y = df[&quotT&quot].T[targets2index[target]]
	
	drugs = df[&quotX&quot]
	drugs_idx = np.array(<a id="change">[&quotDrug &quot + str(i) for i in list(range(drugs.shape[0]))]</a>)

	return drugs, y, drugs_idx
</code></pre><h3>After Change</h3><pre><code class='java'>

	targets = ["E_PBE0", "E_max_EINDO", "I_max_ZINDO", "HOMO_ZINDO", "LUMO_ZINDO", "E_1st_ZINDO", "IP_ZINDO", "EA_ZINDO", "HOMO_PBE0", "LUMO_PBE0", "HOMO_GW", "LUMO_GW", "alpha_PBE0", "alpha_SCS"]
	import pandas as pd
	df<a id="change"> = </a><a id="change">pd.DataFrame()</a>
	df[&quotX&quot] = pd.Series([i for i in inx[&quotX&quot]])
	df = pd.concat([df, pd.DataFrame(inx[&quotT&quot], columns = targets)], axis = 1)
	df[&quotID&quot] = [&quotDrug &quot + str(i+1) for i in range(len(df))]
	df.to_pickle(&quot/Users/kexinhuang/Desktop/qm7b.pkl&quot)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/mims-harvard/tdc/commit/77a6e4386efd75bd5d14443ee59d04cdfb98e3cc#diff-579c6125b5c3fca2c843ab9b6d8fc34263fbfcabbd55e6d404fcbadbcb699b63L13' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 95036938</div><div id='project'> Project Name: mims-harvard/tdc</div><div id='commit'> Commit Name: 77a6e4386efd75bd5d14443ee59d04cdfb98e3cc</div><div id='time'> Time: 2020-11-06</div><div id='author'> Author: kexinhuang@hsph.harvard.edu</div><div id='file'> File Name: data_process/QM_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: QM7_process(3)</div><div id='n_method'> N Method Name: QM7_process(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: data_process/QM_utils.py</div><div id='n_file'> N File Name: data_process/QM_utils.py</div><div id='m_start'> M Start Line: 13</div><div id='m_end'> M End Line: 27</div><div id='n_start'> N Start Line: 17</div><div id='n_end'> N End Line: 25</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        topk_different_prefixes = self._prefix_pool.topk_with_different_start_token(k=N_p, min_occurrences=num_min_occurrences)
        top_prefixes = topk_prefixes + topk_different_prefixes
        top_prefix_types = ((["topk_all"] * len(topk_prefixes)) + (["topk_with_different_start_token"] * len(topk_different_prefixes)))
        top_prefixes_str = <a id="change">[self.tokenizer.decode(p) for p in top_prefixes]</a>
        top_prefix_accs = [self._prefix_pool._avg_accuracy[p] for p in top_prefixes]
        top_prefix_losses = [self._prefix_pool._avg_loss[p] for p in top_prefixes]
        top_prefix_n_queries = [len(self._prefix_pool._all_losses[p]) for p in top_prefixes]
        return {</code></pre><h3>After Change</h3><pre><code class='java'>
        all_losses, all_accuracies = self._test_prefixes(
            prefixes=all_prefixes, eval_dataloader=eval_dataloader, possible_answer_mask=possible_answer_mask
        )
        df<a id="change"> = </a><a id="change">pd.DataFrame(
            </a>zip(*[all_prefixes, all_losses, all_accuracies])<a id="change">,
            columns=[&quotprefix&quot, &quotloss&quot, &quotaccuracy&quot]
        )</a>
        df = df.sort_values(by=[&quotaccuracy&quot, &quotloss&quot], ascending=[False, True]).reset_index()
        &#47&#47 df = df.sort_values(by=&quotloss&quot, ascending=True).reset_index()
        df[&quotprefix_str&quot] = df[&quotprefix&quot].map(self.tokenizer.decode)
        df[&quotn_queries&quot] = df[&quotprefix&quot].map(lambda p_ids: len(self._prefix_pool._all_losses[p_ids]))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/csinva/imodelsx/commit/147ad2802c855f3a4067cf9e46a5b9b675ca62c0#diff-07fae3a6b4b2063fc088f03411d4dbb2edb1afad047512f4e930977a1ead2a63L43' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 95036922</div><div id='project'> Project Name: csinva/imodelsx</div><div id='commit'> Commit Name: 147ad2802c855f3a4067cf9e46a5b9b675ca62c0</div><div id='time'> Time: 2022-10-12</div><div id='author'> Author: chandan_singh@berkeley.edu</div><div id='file'> File Name: imodelsx/iprompt/autoprompt.py</div><div id='m_class'> M Class Name: AutoPrompt</div><div id='n_method'> N Class Name: AutoPrompt</div><div id='m_method'> M Method Name: serialize(3)</div><div id='n_method'> N Method Name: serialize(1)</div><div id='m_parent_class'> M Parent Class: HotFlip</div><div id='n_parent_class'> N Parent Class: HotFlip</div><div id='m_file'> M File Name: imodelsx/iprompt/autoprompt.py</div><div id='n_file'> N File Name: imodelsx/iprompt/autoprompt.py</div><div id='m_start'> M Start Line: 43</div><div id='m_end'> M End Line: 73</div><div id='n_start'> N Start Line: 80</div><div id='n_end'> N End Line: 111</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        l = len(data)
        n_of_nulls = [data[c].isna().sum() for c in data.columns]
        percent_of_nulls = <a id="change">[it / l for it in n_of_nulls]</a>

        display = (
            [px.bar(x=data.columns, y=percent_of_nulls, title=&quotPercent Of Nulls&quot, range_y=(0, 1))]
            if sum(n_of_nulls) &gt; 0 and context.with_display is True</code></pre><h3>After Change</h3><pre><code class='java'>
            else pd.Series(index=list(data.columns), dtype=object)

        result_data = [[col, data[col].isna().sum(), feature_importance[col]] for col in data.columns]
        result_data = <a id="change">pd.DataFrame(data=result_data,
                                   columns=[&quotColumn&quot,
                                            &quotPercent of nulls in sample&quot,
                                            &quotFeature importance&quot])</a>.set_index([&quotColumn&quot])
        result_data[&quotPercent of nulls in sample&quot]<a id="change"> = </a>result_data[&quotPercent of nulls in sample&quot] / dataset.n_samples
        result_data.sort_values(by=&quotPercent of nulls in sample&quot)
        if all(feature_importance.isna()):
            result_data.drop(&quotFeature importance&quot, axis=1, inplace=True)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/deepchecks/deepchecks/commit/0f96dcc7ceafdb87c80e0f325d570993874e1ff3#diff-24d3d780fdcf40631ca2a89ba2de94e40f43ea0cf13d362bc1c7cd7bb05143d8L52' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 95036927</div><div id='project'> Project Name: deepchecks/deepchecks</div><div id='commit'> Commit Name: 0f96dcc7ceafdb87c80e0f325d570993874e1ff3</div><div id='time'> Time: 2022-08-30</div><div id='author'> Author: 67195469+Nadav-Barak@users.noreply.github.com</div><div id='file'> File Name: deepchecks/tabular/checks/data_integrity/percent_of_nulls.py</div><div id='m_class'> M Class Name: PercentOfNulls</div><div id='n_method'> N Class Name: PercentOfNulls</div><div id='m_method'> M Method Name: run_logic(3)</div><div id='n_method'> N Method Name: run_logic(3)</div><div id='m_parent_class'> M Parent Class: SingleDatasetCheck,ReduceFeatureMixin</div><div id='n_parent_class'> N Parent Class: SingleDatasetCheck,ReduceMixin</div><div id='m_file'> M File Name: deepchecks/tabular/checks/data_integrity/percent_of_nulls.py</div><div id='n_file'> N File Name: deepchecks/tabular/checks/data_integrity/percent_of_nulls.py</div><div id='m_start'> M Start Line: 56</div><div id='m_end'> M End Line: 66</div><div id='n_start'> N Start Line: 75</div><div id='n_end'> N End Line: 98</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    doc = model_entities(text)
    ents = list(doc.ents)
    sents = list(doc.sents)
    etypes = <a id="change">[e.label_ for e in ents]</a>
    etype_symbols = {&quotPERSON&quot: (&quot&lt;&lt; &quot, &quot &gt;&gt;&quot),
                     &quotORG&quot: (&quot[[ &quot, &quot ]]&quot),
                     &quotGPE&quot: (&quot{{ &quot, &quot }}&quot)
                     }</code></pre><h3>After Change</h3><pre><code class='java'>
            &quotstart_char&quot: e.start_char,
            &quotend_char&quot: e.end_char
        })
    df_entities = <a id="change">pd.DataFrame(</a>lines<a id="change">, columns=[&quotentity&quot, &quotentity_type&quot, &quotstart_char&quot, &quotend_char&quot])</a>
    sents = list(doc.sents)
    etypes<a id="change"> = </a>df_entities.entity_type
    etype_symbols = {&quotPERSON&quot: (&quot&lt;&lt; &quot, &quot &gt;&gt;&quot),
                     &quotORG&quot: (&quot[[ &quot, &quot ]]&quot),
                     &quotGPE&quot: (&quot{{ &quot, &quot }}&quot)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/bluebrain/search/commit/f4189ead6e06c51fbcc4406b6662f1716a3ae8ac#diff-44410a9ae1a5944ed6b828e01b9f27b008da17270adafbc89c659cd099863604L9' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 95036935</div><div id='project'> Project Name: bluebrain/search</div><div id='commit'> Commit Name: f4189ead6e06c51fbcc4406b6662f1716a3ae8ac</div><div id='time'> Time: 2020-05-14</div><div id='author'> Author: francesco.casalegno@gmail.com</div><div id='file'> File Name: tests/test_mining/test_relation.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_annotate(1)</div><div id='n_method'> N Method Name: test_annotate(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_mining/test_relation.py</div><div id='n_file'> N File Name: tests/test_mining/test_relation.py</div><div id='m_start'> M Start Line: 14</div><div id='m_end'> M End Line: 47</div><div id='n_start'> N Start Line: 15</div><div id='n_end'> N End Line: 55</div><BR>