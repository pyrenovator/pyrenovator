<html><h3>Pattern ID :1696
</h3><img src='8140604.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                observation, deterministic, return_log_prob=True
            )[-1]
            logits_pi = logits_pi.detach().cpu().numpy().flatten()
            logits_adv = <a id="change">logits_adv.detach().cpu().numpy()</a>.flatten()
            return action, log_pi, adv_log_pi, logits_pi, logits_adv
        return action, log_pi, adv_log_pi
</code></pre><h3>After Change</h3><pre><code class='java'>
            scale = actor_distrib.scale.detach().cpu().numpy().flatten()
            params_pi = np.concatenate([mean, scale], -1)
            mean = adversary_distrib.mean.detach().cpu().numpy().flatten()
            scale = <a id="change">adversary_distrib.scale.detach().cpu().numpy().flatten()</a>
            params_adv = np.concatenate([mean, scale], -1)
        return action, log_pi, adv_log_pi, params_pi, params_adv

    def compute_values(self, observations: Observation) -&gt; np.ndarray:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/yfletberliac/adversarially-guided-actor-critic/commit/4958ecb8ca6e7e344852f7aa9fc8668cd8cd074b#diff-513f475959da3d0565e9ebe8fc9a9ab196187c5415b4d26445a650fd2fae785cL115' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 8140604</div><div id='project'> Project Name: yfletberliac/adversarially-guided-actor-critic</div><div id='commit'> Commit Name: 4958ecb8ca6e7e344852f7aa9fc8668cd8cd074b</div><div id='time'> Time: 2021-07-07</div><div id='author'> Author: cibeah.cb@gmail.com</div><div id='file'> File Name: agac_torch/agac/agac_ppo.py</div><div id='m_class'> M Class Name: PPO</div><div id='n_method'> N Class Name: PPO</div><div id='m_method'> M Method Name: select_action(3)</div><div id='n_method'> N Method Name: select_action(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: agac_torch/agac/agac_ppo.py</div><div id='n_file'> N File Name: agac_torch/agac/agac_ppo.py</div><div id='m_start'> M Start Line: 115</div><div id='m_end'> M End Line: 138</div><div id='n_start'> N Start Line: 121</div><div id='n_end'> N End Line: 146</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                &#47&#47 TODO: clip grad norm?
                &#47&#47 nn.utils.clip_grad_norm_(self.policy.parameters(), self.max_grad_norm)
                self.policy.optimizer.step()
        print(explained_variance(return_batch.numpy()[:, 0], <a id="change">values[:, 0].detach().cpu().numpy()</a>))

    def learn(self, total_timesteps, callback=None, log_interval=100,
              eval_freq=-1, n_eval_episodes=5, tb_log_name="PPO", reset_num_timesteps=True):</code></pre><h3>After Change</h3><pre><code class='java'>
                policy_loss_2 = advantage * th.clamp(ratio, 1 - self.clip_range, 1 + self.clip_range)
                policy_loss = -th.min(policy_loss_1, policy_loss_2).mean()
                &#47&#47 value_loss = th.mean((return_batch - value)**2)
                value_loss = F.mse_loss(return_batch, <a id="change">values.flatten()</a>)
                entropy_loss = th.mean(entropy)
                loss = policy_loss + self.ent_coef * entropy_loss + self.vf_coef * value_loss
                &#47&#47 loss = policy_loss</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/dlr-rm/stable-baselines3/commit/fe8b415cbf2025ee1e9c36b89b2f6e36c83ae5d8#diff-f8bbda9f9732c12b0ea5e52bd22588b6acc3977b6fa5bfa6fd8ef3a8a3021f97L107' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 8140623</div><div id='project'> Project Name: dlr-rm/stable-baselines3</div><div id='commit'> Commit Name: fe8b415cbf2025ee1e9c36b89b2f6e36c83ae5d8</div><div id='time'> Time: 2019-09-19</div><div id='author'> Author: antonin.raffin@ensta.org</div><div id='file'> File Name: torchy_baselines/ppo/ppo.py</div><div id='m_class'> M Class Name: PPO</div><div id='n_method'> N Class Name: PPO</div><div id='m_method'> M Method Name: train(3)</div><div id='n_method'> N Method Name: train(3)</div><div id='m_parent_class'> M Parent Class: BaseRLModel</div><div id='n_parent_class'> N Parent Class: BaseRLModel</div><div id='m_file'> M File Name: torchy_baselines/ppo/ppo.py</div><div id='n_file'> N File Name: torchy_baselines/ppo/ppo.py</div><div id='m_start'> M Start Line: 128</div><div id='m_end'> M End Line: 141</div><div id='n_start'> N Start Line: 128</div><div id='n_end'> N End Line: 128</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        pred = torch.ones_like(scores)
        pred[scores &lt;= .5] = 0
        y_pred = pred.cpu().numpy().flatten()
        auc_scores = <a id="change">scores.detach().cpu().numpy()</a>.flatten()

        res = {
            "accuracy": accuracy_score(y_true, y_pred),</code></pre><h3>After Change</h3><pre><code class='java'>
        if y.dim() == 1:
            y_true = y.cpu().numpy().flatten()
        else:
            y_true = <a id="change">torch.argmax(y, dim=-1).cpu().numpy().flatten()</a>

        pred = torch.argmax(scores, dim=-1)
        y_pred = pred.cpu().numpy().flatten()
        </code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/makgyver/gossipy/commit/31a93a404f8bfba3869c5eb733962a438f4806f0#diff-36e45624fe64c0d02688d4de471bd229b4bba0d9212ce90bec22a3949a0f2f10L90' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 8140599</div><div id='project'> Project Name: makgyver/gossipy</div><div id='commit'> Commit Name: 31a93a404f8bfba3869c5eb733962a438f4806f0</div><div id='time'> Time: 2021-08-29</div><div id='author'> Author: mak1788@gmail.com</div><div id='file'> File Name: gossipy/model/handler.py</div><div id='m_class'> M Class Name: TorchModelHandler</div><div id='n_method'> N Class Name: TorchModelHandler</div><div id='m_method'> M Method Name: evaluate(2)</div><div id='n_method'> N Method Name: evaluate(2)</div><div id='m_parent_class'> M Parent Class: ModelHandler</div><div id='n_parent_class'> N Parent Class: ModelHandler</div><div id='m_file'> M File Name: gossipy/model/handler.py</div><div id='n_file'> N File Name: gossipy/model/handler.py</div><div id='m_start'> M Start Line: 93</div><div id='m_end'> M End Line: 103</div><div id='n_start'> N Start Line: 99</div><div id='n_end'> N End Line: 123</div><BR>