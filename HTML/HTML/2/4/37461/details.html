<html><h3>Pattern ID :37461
</h3><img src='107974088.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    &#47&#47     %y : torch.Tensor [&#47&#47users=1] = placeholder[target=y]
    &#47&#47     %where : [&#47&#47users=1] = call_function[target=torch.where](args = (%condition, %x, %y), kwargs = {})
    &#47&#47     return where
    graph = <a id="change">tracer.trace(</a>model<a id="change">,
                         meta_args={
                             "condition": torch.rand(4, 4, 64, 64).to(&quotmeta&quot),
                             "x": torch.rand(4, 1, 64, 64).to(&quotmeta&quot),
                             "y": torch.rand(1, 4, 64, 64).to(&quotmeta&quot)
                         })</a>
    gm = ColoGraphModule(model, graph)
    physical_mesh_id = torch.arange(0, 4)

    mesh_shape = (2, 2)</code></pre><h3>After Change</h3><pre><code class='java'>
        &quotx&quot: torch.rand(4, 1, 64, 64).to(&quotmeta&quot),
        &quoty&quot: torch.rand(1, 4, 64, 64).to(&quotmeta&quot)
    }
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>
    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>
    physical_mesh_id = torch.arange(0, 4)

    mesh_shape = (2, 2)
    device_mesh = DeviceMesh(physical_mesh_id, mesh_shape)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 21</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-46e332e894ceb447644d33d3a2c33194bd2d2ec3251869acfb254d516d8846b4L23' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974088</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_where_handler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_where_handler(0)</div><div id='n_method'> N Method Name: test_where_handler(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_where_handler.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_where_handler.py</div><div id='m_start'> M Start Line: 23</div><div id='m_end'> M End Line: 36</div><div id='n_start'> N Start Line: 25</div><div id='n_end'> N End Line: 40</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    &#47&#47     %input_1 : torch.Tensor [&#47&#47users=1] = placeholder[target=input]
    &#47&#47     %_0 : [&#47&#47users=1] = call_module[target=0](args = (%input_1,), kwargs = {})
    &#47&#47     return _0
    graph = <a id="change">tracer.trace(</a>model<a id="change">, meta_args={"input": torch.rand(4, 16).to(&quotmeta&quot)})</a>
    gm = ColoGraphModule(model, graph)

    ln_mod_node = list(graph.nodes)[1]
    strategies_vector = StrategiesVector(ln_mod_node)</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47     %_0 : [&#47&#47users=1] = call_module[target=0](args = (%input_1,), kwargs = {})
    &#47&#47     return _0
    meta_args = {"input": torch.rand(4, 16).to(&quotmeta&quot)}
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>
    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>

    ln_mod_node = list(graph.nodes)[1]
    strategies_vector = StrategiesVector(ln_mod_node)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-203f69b7ac902df9a8588d53c0959ed98e7a50cccacd1eb806e2bd5d2cb79ceeL21' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974087</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_layer_norm_handler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: check_ln_module_handler(3)</div><div id='n_method'> N Method Name: check_ln_module_handler(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_layer_norm_handler.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_layer_norm_handler.py</div><div id='m_start'> M Start Line: 24</div><div id='m_end'> M End Line: 48</div><div id='n_start'> N Start Line: 26</div><div id='n_end'> N End Line: 53</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    &#47&#47     %input_1 : torch.Tensor [&#47&#47users=0] = placeholder[target=input]
    &#47&#47     %conv_weight : [&#47&#47users=1] = get_attr[target=conv.weight]
    &#47&#47     return conv_weight
    graph = <a id="change">tracer.trace(</a>model<a id="change">, meta_args={&quotinput&quot: torch.rand(4, 4, 64, 64).to(&quotmeta&quot)})</a>
    gm = ColoGraphModule(model, graph)
    physical_mesh_id = torch.arange(0, 4)
    mesh_shape = (2, 2)
    device_mesh = DeviceMesh(physical_mesh_id, mesh_shape)</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47     %conv_weight : [&#47&#47users=1] = get_attr[target=conv.weight]
    &#47&#47     return conv_weight
    meta_args = {&quotinput&quot: torch.rand(4, 4, 64, 64).to(&quotmeta&quot)}
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>
    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>
    physical_mesh_id = torch.arange(0, 4)
    mesh_shape = (2, 2)
    device_mesh = DeviceMesh(physical_mesh_id, mesh_shape)
    getattr_node = list(graph.nodes)[1]</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-87d5f6d037613dd7beeb4aa9297bc97859c7d3ba97da3ac272fdc5c30c39339fL21' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974086</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_getattr_handler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_getattr_handler(0)</div><div id='n_method'> N Method Name: test_getattr_handler(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_getattr_handler.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_getattr_handler.py</div><div id='m_start'> M Start Line: 22</div><div id='m_end'> M End Line: 28</div><div id='n_start'> N Start Line: 26</div><div id='n_end'> N End Line: 35</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    &#47&#47     %input_1 : torch.Tensor [&#47&#47users=1] = placeholder[target=input]
    &#47&#47     %_0 : [&#47&#47users=1] = call_module[target=0](args = (%input_1,), kwargs = {})
    &#47&#47     return _0
    graph = <a id="change">tracer.trace(</a>model<a id="change">, meta_args={"input": torch.rand(4, 4, 64, 64).to(&quotmeta&quot)})</a>

    gm = ColoGraphModule(model, graph)
    physical_mesh_id = torch.arange(0, 4)
</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47     %_0 : [&#47&#47users=1] = call_module[target=0](args = (%input_1,), kwargs = {})
    &#47&#47     return _0
    meta_args = {"input": torch.rand(4, 4, 64, 64).to(&quotmeta&quot)}
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>

    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>
    physical_mesh_id = torch.arange(0, 4)

    mesh_shape = (2, 2)
    device_mesh = DeviceMesh(physical_mesh_id, mesh_shape)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-840c332bbda1065f999dbd2514a4e5ab2fedad68b4aa353086d958eabd01109bL14' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974085</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_norm_pooling_handler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_norm_pool_handler(0)</div><div id='n_method'> N Method Name: test_norm_pool_handler(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_norm_pooling_handler.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_norm_pooling_handler.py</div><div id='m_start'> M Start Line: 15</div><div id='m_end'> M End Line: 21</div><div id='n_start'> N Start Line: 17</div><div id='n_end'> N End Line: 27</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                                     input_args=input_args,
                                     meta_arg_names=meta_arg_names)
    tracer = ColoTracer()
    graph = <a id="change">tracer.trace(</a>model<a id="change">,
                         meta_args={
                             "x1": torch.rand(4, 8, 16).to(&quotmeta&quot),
                             &quotx2&quot: torch.rand(4, 16, 8).to(&quotmeta&quot)
                         })</a>
    gm = ColoGraphModule(model, graph)
    linear_mod_node = list(graph.nodes)[2]
    strategies_vector = StrategiesVector(linear_mod_node)
</code></pre><h3>After Change</h3><pre><code class='java'>
                                     meta_arg_names=meta_arg_names)
    tracer = ColoTracer(bias_addition_split=True)
    meta_args = {&quotx1&quot: torch.rand(4, 8, 16).to(&quotmeta&quot), &quotx2&quot: torch.rand(4, 16, 8).to(&quotmeta&quot)}
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>
    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>
    linear_mod_node = list(graph.nodes)[2]
    strategies_vector = StrategiesVector(linear_mod_node)

    &#47&#47 build handler</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-88540bfc608d9234427964bca6adfb872c39af8330dfeb1884ff6a3cddded56fL127' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974084</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_bmm_handler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: check_1d_device_mesh(4)</div><div id='n_method'> N Method Name: check_1d_device_mesh(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_bmm_handler.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_bmm_handler.py</div><div id='m_start'> M Start Line: 130</div><div id='m_end'> M End Line: 155</div><div id='n_start'> N Start Line: 130</div><div id='n_end'> N End Line: 154</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                                     node_type=&quotbias_module&quot)

    tracer = ColoTracer()
    graph = <a id="change">tracer.trace(</a>model<a id="change">, meta_args={"x": torch.rand(4, 4, 4, 16).to(&quotmeta&quot)})</a>
    gm = ColoGraphModule(model, graph)

    linear_mod_node = list(graph.nodes)[3]
    strategies_vector = StrategiesVector(linear_mod_node)</code></pre><h3>After Change</h3><pre><code class='java'>

    tracer = ColoTracer(bias_addition_split=True)
    meta_args = {"x": torch.rand(4, 4, 4, 16).to(&quotmeta&quot)}
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>
    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>

    linear_mod_node = list(graph.nodes)[3]
    strategies_vector = StrategiesVector(linear_mod_node)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-f6328d42a40a98c9cc8d7705b4b2e05b4d84d3820eaa4298d9e6726d7ffd01adL40' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974083</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_bias_linear_module_node.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: check_linear_module_handler(4)</div><div id='n_method'> N Method Name: check_linear_module_handler(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_bias_linear_module_node.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_bias_linear_module_node.py</div><div id='m_start'> M Start Line: 43</div><div id='m_end'> M End Line: 66</div><div id='n_start'> N Start Line: 41</div><div id='n_end'> N End Line: 67</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    model = MatMulModule()

    tracer = ColoTracer()
    graph = <a id="change">tracer.trace(</a>model<a id="change">, meta_args={"x1": x1.to(&quotmeta&quot), &quotx2&quot: x2.to(&quotmeta&quot)})</a>
    gm = ColoGraphModule(model, graph)
    physical_mesh_id = torch.arange(0, 4)

    print(graph)</code></pre><h3>After Change</h3><pre><code class='java'>

    tracer = ColoTracer(bias_addition_split=True)
    meta_args = {"x1": x1.to(&quotmeta&quot), &quotx2&quot: x2.to(&quotmeta&quot)}
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>
    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>
    physical_mesh_id = torch.arange(0, 4)

    print(graph)
    mesh_shape = (2, 2)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-108b1a3ad9c06aa60a50bbf5a0bb966e0beef4f25ea6d61485967bf3cdc9337cL47' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974082</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_matmul_handler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_matmul_node_handler(1)</div><div id='n_method'> N Method Name: test_matmul_node_handler(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_matmul_handler.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_matmul_handler.py</div><div id='m_start'> M Start Line: 58</div><div id='m_end'> M End Line: 162</div><div id='n_start'> N Start Line: 60</div><div id='n_end'> N End Line: 169</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    device_mesh = DeviceMesh(physical_mesh_id, mesh_shape)

    tracer = ColoTracer()
    graph = <a id="change">tracer.trace(</a>model<a id="change">,
                         meta_args={
                             "input": torch.rand(4, 4, 4, 16).to(&quotmeta&quot),
                             &quotothers&quot: torch.rand(32, 16).to(&quotmeta&quot)
                         })</a>
    gm = ColoGraphModule(model, graph)
    linear_func_node = list(graph.nodes)[2]
    strategies_vector = StrategiesVector(linear_func_node)
</code></pre><h3>After Change</h3><pre><code class='java'>

    tracer = ColoTracer(bias_addition_split=True)
    meta_args = {&quotinput&quot: torch.rand(4, 4, 4, 16).to(&quotmeta&quot), &quotothers&quot: torch.rand(32, 16).to(&quotmeta&quot)}
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>
    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>
    linear_func_node = list(graph.nodes)[2]
    strategies_vector = StrategiesVector(linear_func_node)

    &#47&#47 build handler</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-844a13f9980cc706d886a938079cbaa0499fbbdafa307cc1a49e0c6df29b8987L27' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974081</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_shard_option.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: check_shard_option(1)</div><div id='n_method'> N Method Name: check_shard_option(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_shard_option.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_shard_option.py</div><div id='m_start'> M Start Line: 28</div><div id='m_end'> M End Line: 38</div><div id='n_start'> N Start Line: 26</div><div id='n_end'> N End Line: 35</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    &#47&#47 graph():
    &#47&#47     %input_1 : torch.Tensor [&#47&#47users=1] = placeholder[target=input]
    &#47&#47     return input_1
    graph = <a id="change">tracer.trace(</a>model<a id="change">, meta_args={
        "input": torch.rand(4, 4, 64, 64).to(&quotmeta&quot),
    })</a>
    gm = ColoGraphModule(model, graph)
    physical_mesh_id = torch.arange(0, 4)

    mesh_shape = (2, 2)</code></pre><h3>After Change</h3><pre><code class='java'>
    meta_args = {
        "input": torch.rand(4, 4, 64, 64).to(&quotmeta&quot),
    }
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>
    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>
    physical_mesh_id = torch.arange(0, 4)

    mesh_shape = (2, 2)
    device_mesh = DeviceMesh(physical_mesh_id, mesh_shape)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-a9076c1d21b68b9850a6fad24081255cb6863f028c3dc889be7de5545285105eL22' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974080</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_placeholder_handler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_placeholder_handler(1)</div><div id='n_method'> N Method Name: test_placeholder_handler(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_placeholder_handler.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_placeholder_handler.py</div><div id='m_start'> M Start Line: 23</div><div id='m_end'> M End Line: 30</div><div id='n_start'> N Start Line: 27</div><div id='n_end'> N End Line: 37</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                                     meta_arg_names=meta_arg_names)

    tracer = ColoTracer()
    graph = <a id="change">tracer.trace(</a>model<a id="change">,
                         meta_args={
                             "input": torch.rand(input_shape).to(&quotmeta&quot),
                             &quotothers&quot: torch.rand(32, 16).to(&quotmeta&quot)
                         })</a>
    gm = ColoGraphModule(model, graph)
    if bias:
        linear_func_node = list(graph.nodes)[3]
    else:</code></pre><h3>After Change</h3><pre><code class='java'>

    tracer = ColoTracer(bias_addition_split=True)
    meta_args = {&quotinput&quot: torch.rand(input_shape).to(&quotmeta&quot), &quotothers&quot: torch.rand(32, 16).to(&quotmeta&quot)}
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>
    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>

    if bias:
        linear_func_node = list(graph.nodes)[3]
    else:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-051da2db76fd058a3d682c5ef59f2c2451a8e5f2a2dffdd2a668978c12cd517cL171' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974079</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_linear_handler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: check_linear_function_handler(5)</div><div id='n_method'> N Method Name: check_linear_function_handler(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_linear_handler.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_linear_handler.py</div><div id='m_start'> M Start Line: 174</div><div id='m_end'> M End Line: 204</div><div id='n_start'> N Start Line: 178</div><div id='n_end'> N End Line: 207</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    &#47&#47     %linear : [&#47&#47users=1] = call_function[target=torch._C._nn.linear](args = (%input_1, %other), kwargs = {bias: None})
    &#47&#47     %softmax : [&#47&#47users=1] = call_method[target=split](args = (%linear,), kwargs = {})
    &#47&#47     return split
    graph = <a id="change">tracer.trace(</a>model<a id="change">,
                         meta_args={
                             "input": torch.rand(8, 16, 64, 32).to(&quotmeta&quot),
                             "other": torch.rand(64, 32).to(&quotmeta&quot),
                         })</a>

    gm = ColoGraphModule(model, graph)

    previous_mod_node = list(graph.nodes)[2]</code></pre><h3>After Change</h3><pre><code class='java'>
        &quotinput&quot: torch.rand(8, 16, 64, 32).to(&quotmeta&quot),
        &quotother&quot: torch.rand(64, 32).to(&quotmeta&quot),
    }
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>

    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>

    previous_mod_node = list(graph.nodes)[2]
    split_node = list(graph.nodes)[3]
    split_strategies_vector = StrategiesVector(split_node)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-53dd480025e00a02063da51e603de0d05f986b04c184722bc26ae660b84d28b4L34' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974078</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_softmax_handler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: check_split_handler(5)</div><div id='n_method'> N Method Name: check_split_handler(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_softmax_handler.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_softmax_handler.py</div><div id='m_start'> M Start Line: 37</div><div id='m_end'> M End Line: 69</div><div id='n_start'> N Start Line: 39</div><div id='n_end'> N End Line: 74</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    tracer = ColoTracer()

    graph = <a id="change">tracer.trace(</a>model<a id="change">,
                         meta_args={
                             "input": torch.rand(8, 16, 64, 32).to(&quotmeta&quot),
                             "other": torch.rand(64, 32).to(&quotmeta&quot),
                         })</a>

    gm = ColoGraphModule(model, graph)
    linear_mod_node = list(graph.nodes)[2]
    getitem_mod_node = list(graph.nodes)[3]</code></pre><h3>After Change</h3><pre><code class='java'>
        "input": torch.rand(8, 16, 64, 32).to(&quotmeta&quot),
        "other": torch.rand(64, 32).to(&quotmeta&quot),
    }
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>

    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">list(meta_args.values()))</a>
    linear_mod_node = list(graph.nodes)[2]
    getitem_mod_node = list(graph.nodes)[3]
    getitem_strategies_vector = StrategiesVector(getitem_mod_node)
    linear_strategies_vector = StrategiesVector(linear_mod_node)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-71193df4b142a82174f9d51ff954ec0e25cade58a3dbe281a75b24d13f0ac0bfL36' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974077</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_getitem_handler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: check_getitem_from_tensor_handler(4)</div><div id='n_method'> N Method Name: check_getitem_from_tensor_handler(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_getitem_handler.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_getitem_handler.py</div><div id='m_start'> M Start Line: 40</div><div id='m_end'> M End Line: 67</div><div id='n_start'> N Start Line: 42</div><div id='n_end'> N End Line: 71</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    &#47&#47     %linear : [&#47&#47users=1] = call_function[target=torch._C._nn.linear](args = (%input_1, %other), kwargs = {bias: None})
    &#47&#47     %sum_1 : [&#47&#47users=1] = call_function[target=torch.sum](args = (%linear,), kwargs = {})
    &#47&#47     return sum_1
    graph = <a id="change">tracer.trace(</a>model<a id="change">,
                         meta_args={
                             "input": torch.rand(8, 16, 64, 32).to(&quotmeta&quot),
                             "other": torch.rand(64, 32).to(&quotmeta&quot),
                         })</a>
    gm = ColoGraphModule(model, graph)

    previous_mod_node = list(graph.nodes)[2]
    sum_node = list(graph.nodes)[3]</code></pre><h3>After Change</h3><pre><code class='java'>
        "input": torch.rand(8, 16, 64, 32).to(&quotmeta&quot),
        "other": torch.rand(64, 32).to(&quotmeta&quot),
    }
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>
    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>

    previous_mod_node = list(graph.nodes)[2]
    sum_node = list(graph.nodes)[3]
    sum_strategies_vector = StrategiesVector(sum_node)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-f35eb084f9db5b781f1398909392113013e139a919464a1c04757db83551bbd7L38' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974076</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_sum_handler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: check_sum_handler(5)</div><div id='n_method'> N Method Name: check_sum_handler(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_sum_handler.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_sum_handler.py</div><div id='m_start'> M Start Line: 41</div><div id='m_end'> M End Line: 219</div><div id='n_start'> N Start Line: 42</div><div id='n_end'> N End Line: 221</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    &#47&#47     %linear : [&#47&#47users=1] = call_function[target=torch._C._nn.linear](args = (%x, %weight), kwargs = {})
    &#47&#47     %add : [&#47&#47users=1] = call_function[target=operator.add](args = (%linear, %bias), kwargs = {})
    &#47&#47     return add
    graph = <a id="change">tracer.trace(</a>model<a id="change">, meta_args={"x": torch.rand(4, 4, 4, 16).to(&quotmeta&quot)})</a>
    gm = ColoGraphModule(model, graph)

    linear_mod_node = list(graph.nodes)[3]
    strategies_vector = StrategiesVector(linear_mod_node)</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47     %add : [&#47&#47users=1] = call_function[target=operator.add](args = (%linear, %bias), kwargs = {})
    &#47&#47     return add
    meta_args = {"x": torch.rand(4, 4, 4, 16).to(&quotmeta&quot)}
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>
    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>

    linear_mod_node = list(graph.nodes)[3]
    strategies_vector = StrategiesVector(linear_mod_node)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-7da3c71c3c5a8d111ae8609711617dcb60016b1db1ab90ab9282346926b11179L44' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974075</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_bias_linear_function_node.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: check_linear_module_handler(3)</div><div id='n_method'> N Method Name: check_linear_module_handler(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_bias_linear_function_node.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_bias_linear_function_node.py</div><div id='m_start'> M Start Line: 47</div><div id='m_end'> M End Line: 77</div><div id='n_start'> N Start Line: 45</div><div id='n_end'> N End Line: 78</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    &#47&#47     %arange : [&#47&#47users=1] = call_function[target=torch.arange](args = (%getitem,), kwargs = {})
    &#47&#47     %add : [&#47&#47users=1] = call_function[target=operator.add](args = (%x, %arange), kwargs = {})
    &#47&#47     return add
    graph = <a id="change">tracer.trace(</a>model<a id="change">, meta_args={
        "x": torch.rand(10).to(&quotmeta&quot),
    })</a>
    gm = ColoGraphModule(model, graph)
    physical_mesh_id = torch.arange(0, 4)

    mesh_shape = (2, 2)</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47     %add : [&#47&#47users=1] = call_function[target=operator.add](args = (%x, %arange), kwargs = {})
    &#47&#47     return add
    meta_args = {&quotx&quot: torch.rand(10).to(&quotmeta&quot)}
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>
    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>
    physical_mesh_id = torch.arange(0, 4)

    mesh_shape = (2, 2)
    device_mesh = DeviceMesh(physical_mesh_id, mesh_shape)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-789e9e30e28f5bb859448d36d63301a45249f4814f0bd94a687bb20add83d233L23' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974074</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_tensor_constructor.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_where_handler(0)</div><div id='n_method'> N Method Name: test_where_handler(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_tensor_constructor.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_tensor_constructor.py</div><div id='m_start'> M Start Line: 24</div><div id='m_end'> M End Line: 35</div><div id='n_start'> N Start Line: 26</div><div id='n_end'> N End Line: 38</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    &#47&#47     %x : torch.Tensor [&#47&#47users=2] = placeholder[target=x]
    &#47&#47     %mul : [&#47&#47users=1] = call_function[target=operator.mul](args = (%x, 2), kwargs = {})
    &#47&#47     return (x, mul)
    graph = <a id="change">tracer.trace(</a>model<a id="change">, meta_args={
        "x": torch.rand(4, 4, 64, 64).to(&quotmeta&quot),
    })</a>
    gm = ColoGraphModule(model, graph)
    physical_mesh_id = torch.arange(0, 4)

    mesh_shape = (2, 2)</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47     %mul : [&#47&#47users=1] = call_function[target=operator.mul](args = (%x, 2), kwargs = {})
    &#47&#47     return (x, mul)
    meta_args = {&quotx&quot: torch.rand(4, 4, 64, 64).to(&quotmeta&quot)}
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>
    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>
    physical_mesh_id = torch.arange(0, 4)

    mesh_shape = (2, 2)
    device_mesh = DeviceMesh(physical_mesh_id, mesh_shape)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-1591a3662d1e376e1201811aa41361317986644d80c0cc6fdc29eb4980b98360L23' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974073</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_output_handler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_output_handler(1)</div><div id='n_method'> N Method Name: test_output_handler(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_output_handler.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_output_handler.py</div><div id='m_start'> M Start Line: 24</div><div id='m_end'> M End Line: 32</div><div id='n_start'> N Start Line: 28</div><div id='n_end'> N End Line: 37</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    &#47&#47     %input_1 : torch.Tensor [&#47&#47users=1] = placeholder[target=input]
    &#47&#47     %_0 : [&#47&#47users=1] = call_module[target=0](args = (%input_1,), kwargs = {})
    &#47&#47     return _0
    graph = <a id="change">tracer.trace(</a>model<a id="change">, meta_args={"input": torch.rand(4, 16, 64, 64).to(&quotmeta&quot)})</a>
    gm = ColoGraphModule(model, graph)
    bn_mod_node = list(graph.nodes)[1]
    strategies_vector = StrategiesVector(bn_mod_node)
</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47     %_0 : [&#47&#47users=1] = call_module[target=0](args = (%input_1,), kwargs = {})
    &#47&#47     return _0
    meta_args = {"input": torch.rand(4, 16, 64, 64).to(&quotmeta&quot)}
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>
    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>
    bn_mod_node = list(graph.nodes)[1]
    strategies_vector = StrategiesVector(bn_mod_node)

    &#47&#47 build handler</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-a730fc2a85d73c3f5b991ec6d372bf405550ce0fcfe5e30c2267f713d7048544L20' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974072</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_batch_norm_handler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: check_bn_module_handler(3)</div><div id='n_method'> N Method Name: check_bn_module_handler(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_batch_norm_handler.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_batch_norm_handler.py</div><div id='m_start'> M Start Line: 23</div><div id='m_end'> M End Line: 46</div><div id='n_start'> N Start Line: 25</div><div id='n_end'> N End Line: 51</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                                     meta_arg_names=meta_arg_names)

    tracer = ColoTracer()
    graph = <a id="change">tracer.trace(</a>model<a id="change">, meta_args={"input": torch.rand(input_shape).to(&quotmeta&quot)})</a>
    gm = ColoGraphModule(model, graph)

    linear_mod_node = list(graph.nodes)[1]
    strategies_vector = StrategiesVector(linear_mod_node)</code></pre><h3>After Change</h3><pre><code class='java'>

    tracer = ColoTracer(bias_addition_split=True)
    meta_args = {"input": torch.rand(input_shape).cuda()}
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>
    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>

    linear_mod_node = list(graph.nodes)[1]
    strategies_vector = StrategiesVector(linear_mod_node)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-051da2db76fd058a3d682c5ef59f2c2451a8e5f2a2dffdd2a668978c12cd517cL26' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974071</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_linear_handler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: check_linear_module_handler(5)</div><div id='n_method'> N Method Name: check_linear_module_handler(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_linear_handler.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_linear_handler.py</div><div id='m_start'> M Start Line: 29</div><div id='m_end'> M End Line: 53</div><div id='n_start'> N Start Line: 31</div><div id='n_end'> N End Line: 58</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    &#47&#47     %split : [&#47&#47users=1] = call_function[target=torch.functional.split](args = (%conv2d, 2), kwargs = {dim: 0})
    &#47&#47     %getitem : [&#47&#47users=1] = call_function[target=operator.getitem](args = (%split, 1), kwargs = {})
    &#47&#47     return getitem
    graph = <a id="change">tracer.trace(</a>model<a id="change">, meta_args={
        "input": torch.rand(4, 4, 64, 64).to(&quotmeta&quot),
    })</a>
    gm = ColoGraphModule(model, graph)
    physical_mesh_id = torch.arange(0, 4)

    mesh_shape = (2, 2)</code></pre><h3>After Change</h3><pre><code class='java'>
    meta_args = {
        "input": torch.rand(4, 4, 64, 64).to(&quotmeta&quot),
    }
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>
    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>
    physical_mesh_id = torch.arange(0, 4)

    mesh_shape = (2, 2)
    device_mesh = DeviceMesh(physical_mesh_id, mesh_shape)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-71193df4b142a82174f9d51ff954ec0e25cade58a3dbe281a75b24d13f0ac0bfL124' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974070</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_getitem_handler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_getitem_from_tuple_handler(0)</div><div id='n_method'> N Method Name: test_getitem_from_tuple_handler(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_getitem_handler.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_getitem_handler.py</div><div id='m_start'> M Start Line: 125</div><div id='m_end'> M End Line: 134</div><div id='n_start'> N Start Line: 127</div><div id='n_end'> N End Line: 139</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                                     input_args=[input],
                                     meta_arg_names=[&quotinput&quot])
    tracer = ColoTracer()
    graph = <a id="change">tracer.trace(</a>model<a id="change">, meta_args={"input": torch.rand(4, 4, 64, 64).to(&quotmeta&quot)})</a>
    gm = ColoGraphModule(model, graph)
    conv_mod_node = list(graph.nodes)[1]
    strategies_vector = StrategiesVector(conv_mod_node)
</code></pre><h3>After Change</h3><pre><code class='java'>
                                     meta_arg_names=[&quotinput&quot])
    tracer = ColoTracer(bias_addition_split=True)
    meta_args = {&quotinput&quot: torch.rand(4, 4, 64, 64).to(&quotmeta&quot)}
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>
    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>
    conv_mod_node = list(graph.nodes)[1]
    strategies_vector = StrategiesVector(conv_mod_node)

    &#47&#47 build handler</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-9278e1bcaf2db8516af19dc9d0fc8986e2d54d6c5718b931696db85818668c2cL20' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974069</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_conv_handler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: check_conv_module_handler(4)</div><div id='n_method'> N Method Name: check_conv_module_handler(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_conv_handler.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_conv_handler.py</div><div id='m_start'> M Start Line: 23</div><div id='m_end'> M End Line: 45</div><div id='n_start'> N Start Line: 25</div><div id='n_end'> N End Line: 50</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                                     input_args=input_args,
                                     meta_arg_names=meta_arg_names)
    tracer = ColoTracer()
    graph = <a id="change">tracer.trace(</a>model<a id="change">,
                         meta_args={
                             "x1": torch.rand(4, 8, 16).to(&quotmeta&quot),
                             &quotx2&quot: torch.rand(4, 16, 8).to(&quotmeta&quot)
                         })</a>
    gm = ColoGraphModule(model, graph)

    linear_mod_node = list(graph.nodes)[2]
    strategies_vector = StrategiesVector(linear_mod_node)</code></pre><h3>After Change</h3><pre><code class='java'>
                                     meta_arg_names=meta_arg_names)
    tracer = ColoTracer(bias_addition_split=True)
    meta_args = {&quotx1&quot: torch.rand(4, 8, 16).to(&quotmeta&quot), &quotx2&quot: torch.rand(4, 16, 8).to(&quotmeta&quot)}
    graph<a id="change"> = </a><a id="change">tracer.trace(</a>model<a id="change">, meta_args=meta_args)</a>
    gm = ColoGraphModule(model, graph)
    <a id="change">shape_prop_pass(</a>gm, *<a id="change">meta_args.values())</a>

    linear_mod_node = list(graph.nodes)[2]
    strategies_vector = StrategiesVector(linear_mod_node)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/fee2af861078181e18a059800ba09a4edfb311f0#diff-88540bfc608d9234427964bca6adfb872c39af8330dfeb1884ff6a3cddded56fL32' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107974068</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: fee2af861078181e18a059800ba09a4edfb311f0</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_bmm_handler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: check_2d_device_mesh(4)</div><div id='n_method'> N Method Name: check_2d_device_mesh(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_bmm_handler.py</div><div id='n_file'> N File Name: tests/test_auto_parallel/test_tensor_shard/test_node_handler/test_bmm_handler.py</div><div id='m_start'> M Start Line: 35</div><div id='m_end'> M End Line: 60</div><div id='n_start'> N Start Line: 37</div><div id='n_end'> N End Line: 61</div><BR>