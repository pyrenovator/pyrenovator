<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            gi, gj = gij.T  &#47&#47 grid xy indices

            &#47&#47 Append
            a<a id="change"> = </a><a id="change">t[:, 6].long()</a>  &#47&#47 anchor indices
            indices.append((b, a, gj.clamp_(0, gain[3] - 1), gi.clamp_(0, gain[2] - 1)))  &#47&#47 image, anchor, grid indices
            tbox.append(torch.cat((gxy - gij, gwh), 1))  &#47&#47 box
            anch.append(anchors[a])  &#47&#47 anchors</code></pre><h3>After Change</h3><pre><code class='java'>
                offsets = 0

            &#47&#47 Define
            <a id="change">bc</a><a id="change">, gxy, gwh, a</a> = t.unsafe_chunk(4, dim=1)  &#47&#47 (image, class), grid xy, grid wh, anchors
            <a id="change">a</a><a id="change">, (b, c)</a> = <a id="change">a.long().view(-1</a><a id="change">)</a><a id="change">, bc.long().T</a>  &#47&#47 anchors, image, class
            gij = (gxy - offsets).long()
            gi, gj = gij.T  &#47&#47 grid indices
</code></pre>