<html><h3>Pattern ID :33602
</h3><img src='96596225.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        if concat_groups and len(cat_col_group) &gt; 1:
            &#47&#47 Concatenate columns and replace cat_col_group
            &#47&#47 with the single name
            df_gb = <a id="change">cudf.DataFrame()</a>
            ignore_index = True
            df_gb[cat_col_group_str] = _concat([gdf[col] for col in cat_col_group], ignore_index)
            cat_col_group = [cat_col_group_str]
        else:</code></pre><h3>After Change</h3><pre><code class='java'>
        if concat_groups and len(cat_col_group) &gt; 1:
            &#47&#47 Concatenate columns and replace cat_col_group
            &#47&#47 with the single name
            df_gb = <a id="change">type(df)()</a>
            ignore_index = True
            df_gb[cat_col_group_str] = _concat([df[col] for col in cat_col_group], ignore_index)
            cat_col_group = [cat_col_group_str]
        else:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 6</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/nvidia/nvtabular/commit/1e1e49983892576fa07417c15a824be7b30fa019#diff-1ca374b0454b2a9fd152a1a4d3ba35e323000565d3fed5567253473d505aa8efL446' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 96596225</div><div id='project'> Project Name: nvidia/nvtabular</div><div id='commit'> Commit Name: 1e1e49983892576fa07417c15a824be7b30fa019</div><div id='time'> Time: 2021-02-11</div><div id='author'> Author: rzamora217@gmail.com</div><div id='file'> File Name: nvtabular/ops/categorify.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _top_level_groupby(8)</div><div id='n_method'> N Method Name: _top_level_groupby(8)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: nvtabular/ops/categorify.py</div><div id='n_file'> N File Name: nvtabular/ops/categorify.py</div><div id='m_start'> M Start Line: 446</div><div id='m_end'> M End Line: 499</div><div id='n_start'> N Start Line: 478</div><div id='n_end'> N End Line: 533</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    def transform(self, columns, gdf: cudf.DataFrame):
        &#47&#47 TODO: should we clip values if they are out of bounds (below 0 or 1)
        &#47&#47 (could happen in validation dataset if datapoint)
        new_gdf = <a id="change">cudf.DataFrame()</a>
        for name in columns:
            dif = self.maxs[name] - self.mins[name]
            if dif &gt; 0:
                new_gdf[name] = (gdf[name] - self.mins[name]) / dif</code></pre><h3>After Change</h3><pre><code class='java'>
    def transform(self, columns, gdf: DataFrameType):
        &#47&#47 TODO: should we clip values if they are out of bounds (below 0 or 1)
        &#47&#47 (could happen in validation dataset if datapoint)
        new_gdf = <a id="change">type(gdf)()</a>
        for name in columns:
            dif = self.maxs[name] - self.mins[name]
            if dif &gt; 0:
                new_gdf[name] = (gdf[name] - self.mins[name]) / dif</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/nvidia/nvtabular/commit/2e510709ea99b6e1f74fb09bd3c87936568c3e3d#diff-f1aff1e9b975dd708db5ab89fa3bef1bc3a5633cca77e7951cfbfbf4ebf74534L92' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 96596227</div><div id='project'> Project Name: nvidia/nvtabular</div><div id='commit'> Commit Name: 2e510709ea99b6e1f74fb09bd3c87936568c3e3d</div><div id='time'> Time: 2021-02-09</div><div id='author'> Author: rzamora217@gmail.com</div><div id='file'> File Name: nvtabular/ops/normalize.py</div><div id='m_class'> M Class Name: NormalizeMinMax</div><div id='n_method'> N Class Name: NormalizeMinMax</div><div id='m_method'> M Method Name: transform(3)</div><div id='n_method'> N Method Name: transform(3)</div><div id='m_parent_class'> M Parent Class: StatOperator</div><div id='n_parent_class'> N Parent Class: StatOperator</div><div id='m_file'> M File Name: nvtabular/ops/normalize.py</div><div id='n_file'> N File Name: nvtabular/ops/normalize.py</div><div id='m_start'> M Start Line: 95</div><div id='m_end'> M End Line: 95</div><div id='n_start'> N Start Line: 96</div><div id='n_end'> N End Line: 96</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            value.reset_index(drop=False, inplace=True)

    if value is None:
        value = <a id="change">cudf.DataFrame()</a>
        for c in selection_r:
            typ = gdf[selection_l[0]].dtype if len(selection_l) == 1 else gdf[c].dtype
            value[c] = cudf.Series([None], dtype=typ)
        value.index.name = "labels"</code></pre><h3>After Change</h3><pre><code class='java'>
            value.reset_index(drop=False, inplace=True)

    if value is None:
        value = <a id="change">type(df)()</a>
        for c in selection_r:
            typ = df[selection_l[0]].dtype if len(selection_l) == 1 else df[c].dtype
            value[c] = df._constructor_sliced([None], dtype=typ)
        value.index.name = "labels"</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/nvidia/nvtabular/commit/1e1e49983892576fa07417c15a824be7b30fa019#diff-1ca374b0454b2a9fd152a1a4d3ba35e323000565d3fed5567253473d505aa8efL839' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 96596226</div><div id='project'> Project Name: nvidia/nvtabular</div><div id='commit'> Commit Name: 1e1e49983892576fa07417c15a824be7b30fa019</div><div id='time'> Time: 2021-02-11</div><div id='author'> Author: rzamora217@gmail.com</div><div id='file'> File Name: nvtabular/ops/categorify.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _encode(11)</div><div id='n_method'> N Method Name: _encode(11)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: nvtabular/ops/categorify.py</div><div id='n_file'> N File Name: nvtabular/ops/categorify.py</div><div id='m_start'> M Start Line: 856</div><div id='m_end'> M End Line: 887</div><div id='n_start'> N Start Line: 899</div><div id='n_end'> N End Line: 932</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    @annotate("DFLambda_op", color="darkgreen", domain="nvt_python")
    def transform(self, columns: ColumnNames, gdf: cudf.DataFrame) -&gt; cudf.DataFrame:
        new_gdf = <a id="change">cudf.DataFrame()</a>
        for col in columns:
            if self._param_count == 2:
                new_gdf[col] = self.f(gdf[col], gdf)
            elif self._param_count == 1:</code></pre><h3>After Change</h3><pre><code class='java'>

    @annotate("DFLambda_op", color="darkgreen", domain="nvt_python")
    def transform(self, columns: ColumnNames, df: DataFrameType) -&gt; DataFrameType:
        new_df = <a id="change">type(df)()</a>
        for col in columns:
            if self._param_count == 2:
                new_df[col] = self.f(df[col], df)
            elif self._param_count == 1:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/nvidia/nvtabular/commit/1e1e49983892576fa07417c15a824be7b30fa019#diff-f223b18145d6e73f3bd7a35d02c3b0b944372e53cfe58e09e665eaa7251073d5L69' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 96596229</div><div id='project'> Project Name: nvidia/nvtabular</div><div id='commit'> Commit Name: 1e1e49983892576fa07417c15a824be7b30fa019</div><div id='time'> Time: 2021-02-11</div><div id='author'> Author: rzamora217@gmail.com</div><div id='file'> File Name: nvtabular/ops/lambdaop.py</div><div id='m_class'> M Class Name: LambdaOp</div><div id='n_method'> N Class Name: LambdaOp</div><div id='m_method'> M Method Name: transform(3)</div><div id='n_method'> N Method Name: transform(3)</div><div id='m_parent_class'> M Parent Class: Operator</div><div id='n_parent_class'> N Parent Class: Operator</div><div id='m_file'> M File Name: nvtabular/ops/lambdaop.py</div><div id='n_file'> N File Name: nvtabular/ops/lambdaop.py</div><div id='m_start'> M Start Line: 70</div><div id='m_end'> M End Line: 70</div><div id='n_start'> N Start Line: 70</div><div id='n_end'> N End Line: 70</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    @annotate("Normalize_op", color="darkgreen", domain="nvt_python")
    def transform(self, columns: ColumnNames, gdf: cudf.DataFrame) -&gt; cudf.DataFrame:
        new_gdf = <a id="change">cudf.DataFrame()</a>
        for name in columns:
            if self.stds[name] &gt; 0:
                new_gdf[name] = (gdf[name] - self.means[name]) / (self.stds[name])
                new_gdf[name] = new_gdf[name].astype("float32")</code></pre><h3>After Change</h3><pre><code class='java'>

    @annotate("Normalize_op", color="darkgreen", domain="nvt_python")
    def transform(self, columns: ColumnNames, gdf: DataFrameType) -&gt; DataFrameType:
        new_gdf = <a id="change">type(gdf)()</a>
        for name in columns:
            if self.stds[name] &gt; 0:
                new_gdf[name] = (gdf[name] - self.means[name]) / (self.stds[name])
                new_gdf[name] = new_gdf[name].astype("float32")</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/nvidia/nvtabular/commit/2e510709ea99b6e1f74fb09bd3c87936568c3e3d#diff-f1aff1e9b975dd708db5ab89fa3bef1bc3a5633cca77e7951cfbfbf4ebf74534L60' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 96596228</div><div id='project'> Project Name: nvidia/nvtabular</div><div id='commit'> Commit Name: 2e510709ea99b6e1f74fb09bd3c87936568c3e3d</div><div id='time'> Time: 2021-02-09</div><div id='author'> Author: rzamora217@gmail.com</div><div id='file'> File Name: nvtabular/ops/normalize.py</div><div id='m_class'> M Class Name: Normalize</div><div id='n_method'> N Class Name: Normalize</div><div id='m_method'> M Method Name: transform(3)</div><div id='n_method'> N Method Name: transform(3)</div><div id='m_parent_class'> M Parent Class: StatOperator</div><div id='n_parent_class'> N Parent Class: StatOperator</div><div id='m_file'> M File Name: nvtabular/ops/normalize.py</div><div id='n_file'> N File Name: nvtabular/ops/normalize.py</div><div id='m_start'> M Start Line: 61</div><div id='m_end'> M End Line: 61</div><div id='n_start'> N Start Line: 62</div><div id='n_end'> N End Line: 62</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def _chunkwise_moments(df):
    df2 = <a id="change">cudf.DataFrame()</a>
    for col in df.columns:
        df2[col] = df[col].astype("float64").pow(2)
    vals = {
        "df-count": df.count().to_frame().transpose(),</code></pre><h3>After Change</h3><pre><code class='java'>


def _chunkwise_moments(df):
    df2 = <a id="change">type(df)()</a>
    for col in df.columns:
        df2[col] = df[col].astype("float64").pow(2)
    vals = {
        "df-count": df.count().to_frame().transpose(),</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/nvidia/nvtabular/commit/2e510709ea99b6e1f74fb09bd3c87936568c3e3d#diff-d500a4c13a2f7a8a25d0bc0e2c09c6d803081624b0476563df1ad0d609ff0a45L65' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 96596230</div><div id='project'> Project Name: nvidia/nvtabular</div><div id='commit'> Commit Name: 2e510709ea99b6e1f74fb09bd3c87936568c3e3d</div><div id='time'> Time: 2021-02-09</div><div id='author'> Author: rzamora217@gmail.com</div><div id='file'> File Name: nvtabular/ops/moments.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _chunkwise_moments(1)</div><div id='n_method'> N Method Name: _chunkwise_moments(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: nvtabular/ops/moments.py</div><div id='n_file'> N File Name: nvtabular/ops/moments.py</div><div id='m_start'> M Start Line: 66</div><div id='m_end'> M End Line: 66</div><div id='n_start'> N Start Line: 65</div><div id='n_end'> N End Line: 65</div><BR>