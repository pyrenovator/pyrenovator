<html><h3>Pattern ID :1860
</h3><img src='8356330.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    cluster_sums = X.groupby("cluster")[&quotweight&quot].sum()
    print("cluster_sums", cluster_sums)
    &#47&#47 Pandas object. (id-&gt;Index)
    clusters = [list(<a id="change">X.groupby(</a>"cluster"<a id="change">)</a>.get_group(c).sort_values("id").itertuples()) for c in range(C)]
    clusters_lengths<a id="change"> = </a>{i: len(clusters[i]) for i in range(len(clusters))}
    print("cluster_lengths", clusters_lengths)
    bins = first_fit_cluster(K, clusters, id_to_node=id_to_node)
    &#47&#47 sort</code></pre><h3>After Change</h3><pre><code class='java'>
    id_to_node = {node.id: node for node in nodes}
    C = n_clusters

    clusters<a id="change">, to_unify</a> = make_clusters(work_graph, nodes, node_weight_function, C=C)
    bins = first_fit_cluster(K, clusters, id_to_node=id_to_node, to_unify=to_unify, C=C)
    &#47&#47 sort
    for v in bins.values():</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/saareliad/ftpipe/commit/bf1903e2f8a06b723ec2807e3315f4f8349d0aa3#diff-953ae8ba7f43ec5c4002c07e1a7b5162ec9c3bb94a76ae077cdbc9a9b706224bL213' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 8356330</div><div id='project'> Project Name: saareliad/ftpipe</div><div id='commit'> Commit Name: bf1903e2f8a06b723ec2807e3315f4f8349d0aa3</div><div id='time'> Time: 2020-09-07</div><div id='author'> Author: saareliad@campus.technion.ac.il</div><div id='file'> File Name: pytorch_Gpipe/model_partitioning/bin_packing/partition_2dbinpack.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: partition_2dbin_pack(5)</div><div id='n_method'> N Method Name: partition_2dbin_pack(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: pytorch_Gpipe/model_partitioning/bin_packing/partition_2dbinpack.py</div><div id='n_file'> N File Name: pytorch_Gpipe/model_partitioning/bin_packing/partition_2dbinpack.py</div><div id='m_start'> M Start Line: 213</div><div id='m_end'> M End Line: 232</div><div id='n_start'> N Start Line: 288</div><div id='n_end'> N End Line: 288</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    last_df.sort_values(by=[&quotunique_id&quot, &quotds&quot], inplace=True, ascending=False)
    last_df.reset_index(drop=True, inplace=True)

    last_df = <a id="change">last_df.groupby(</a>&quotunique_id&quot<a id="change">)</a>.head(ds_in_test)
    last_df[&quotsample_mask&quot] = 0

    last_df = last_df[[&quotunique_id&quot, &quotds&quot, &quotsample_mask&quot]]

    mask_df = Y_df.merge(last_df, on=[&quotunique_id&quot, &quotds&quot], how=&quotleft&quot)
    mask_df[&quotsample_mask&quot] = mask_df[&quotsample_mask&quot].fillna(1)

    mask_df<a id="change"> = </a>mask_df[[&quotunique_id&quot, &quotds&quot, &quotsample_mask&quot]]
    mask_df.sort_values(by=[&quotunique_id&quot, &quotds&quot], inplace=True)
    mask_df[&quotavailable_mask&quot] = 1
</code></pre><h3>After Change</h3><pre><code class='java'>

    mask_df_s = mask_df.sort_values(by=[&quotunique_id&quot, &quotds&quot])
    zero_idx = mask_df_s.groupby(&quotunique_id&quot).tail(ds_in_test).index
    mask_df.loc[zero_idx<a id="change">, &quotsample_mask&quot</a>] = 0

    assert len(mask_df)==len(Y_df), \
        f&quotThe mask_df length {len(mask_df)} is not equal to Y_df length {len(Y_df)}&quot</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/nixtla/neuralforecast/commit/cafcc1cb5944664ede8648900ffbf755cf344b09#diff-b6f244e4e9c53c9e9686b904e2becb0d34c3e810c6d9610bc9fca985aae7aa23L365' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 8356328</div><div id='project'> Project Name: nixtla/neuralforecast</div><div id='commit'> Commit Name: cafcc1cb5944664ede8648900ffbf755cf344b09</div><div id='time'> Time: 2021-04-29</div><div id='author'> Author: fede.garza.ramirez@gmail.com</div><div id='file'> File Name: nixtla/data/tsdataset.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: get_default_mask_df(3)</div><div id='n_method'> N Method Name: get_default_mask_df(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: nixtla/data/tsdataset.py</div><div id='n_file'> N File Name: nixtla/data/tsdataset.py</div><div id='m_start'> M Start Line: 384</div><div id='m_end'> M End Line: 398</div><div id='n_start'> N Start Line: 384</div><div id='n_end'> N End Line: 390</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        df_b = pd.read_pickle(latest_filename_b)

        &#47&#47 df will have every trial, so group by which prop/part was used
        grouped_b<a id="change"> = </a><a id="change">df_b.groupby(</a>groupby<a id="change">)</a>

        return grouped, latest_filename, grouped_b

    def plot(self):</code></pre><h3>After Change</h3><pre><code class='java'>
        grouped = df.groupby(groupby)


        return grouped<a id="change">, latest_filename</a>

    &#47&#47 def plot(self):
    &#47&#47     grouped, filename = self.grab_latest_groups()
    &#47&#47     &#47&#47 Setup table columns</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/mit-acl/nn_robustness_analysis/commit/3d2cd1f1bff1e6e54e76b61e120625ef91604889#diff-380ec8b19ce82a99f9291f165d8cb945571b2f757ea9131bed672ad40f383a18L934' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 8356323</div><div id='project'> Project Name: mit-acl/nn_robustness_analysis</div><div id='commit'> Commit Name: 3d2cd1f1bff1e6e54e76b61e120625ef91604889</div><div id='time'> Time: 2023-01-31</div><div id='author'> Author: nrober1122@gmail.com</div><div id='file'> File Name: nn_closed_loop/backward_experiments.py</div><div id='m_class'> M Class Name: NNScalability</div><div id='n_method'> N Class Name: NNScalability</div><div id='m_method'> M Method Name: grab_latest_groups(1)</div><div id='n_method'> N Method Name: grab_latest_groups(1)</div><div id='m_parent_class'> M Parent Class: Experiment</div><div id='n_parent_class'> N Parent Class: Experiment</div><div id='m_file'> M File Name: nn_closed_loop/backward_experiments.py</div><div id='n_file'> N File Name: nn_closed_loop/backward_experiments.py</div><div id='m_start'> M Start Line: 937</div><div id='m_end'> M End Line: 952</div><div id='n_start'> N Start Line: 906</div><div id='n_end'> N End Line: 914</div><BR>