<html><h3>Pattern ID :20799
</h3><img src='67000604.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

    def test_f1_score(self):
        self.metrics.f1_score(average="micro")
        <a id="change">return</a>


&#47&#47 class TestMulticlassOneHotEncoded(unittest.TestCase):
</code></pre><h3>After Change</h3><pre><code class='java'>

    def test_f1_score(self):
        f1_micro = self.metrics.f1_score(average="micro")
        f1_micro1<a id="change"> = </a><a id="change">f1_score(</a>self.true, self.pred<a id="change">, average="micro")</a>
        self.assertAlmostEqual(f1_micro, f1_micro1)
        return

</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/atrcheema/ai4water/commit/8f6de3e34053298a051ed9582072e6cb24e8fc95#diff-c3742cd9e7be5093ee76c654f2cb52770df96fa61c62f8406355479c12e55e93L63' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 67000604</div><div id='project'> Project Name: atrcheema/ai4water</div><div id='commit'> Commit Name: 8f6de3e34053298a051ed9582072e6cb24e8fc95</div><div id='time'> Time: 2022-02-09</div><div id='author'> Author: ather_abbas786@yahoo.com</div><div id='file'> File Name: tests/test_postprocessing/test_SeqMetrics/test_classification.py</div><div id='m_class'> M Class Name: TestMulticlass1D</div><div id='n_method'> N Class Name: TestMulticlass1D</div><div id='m_method'> M Method Name: test_f1_score(1)</div><div id='n_method'> N Method Name: test_f1_score(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: tests/test_postprocessing/test_SeqMetrics/test_classification.py</div><div id='n_file'> N File Name: tests/test_postprocessing/test_SeqMetrics/test_classification.py</div><div id='m_start'> M Start Line: 63</div><div id='m_end'> M End Line: 64</div><div id='n_start'> N Start Line: 67</div><div id='n_end'> N End Line: 70</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    assert len(decoded_preds) == len(decoded_labels)

    if "return_decoded_preds" in kwargs and kwargs["return_decoded_preds"]:
        <a id="change">return </a>decoded_preds
    
    correct, total = 0, 0
    for i in range(len(decoded_preds)):</code></pre><h3>After Change</h3><pre><code class='java'>
                                                                training_args.pred_types)
    pos_labels = list(training_args.id2role.values())
    pos_labels.remove(training_args.id2role[0])
    micro_f1<a id="change"> = </a><a id="change">f1_score(</a>final_labels, final_preds<a id="change">, labels=pos_labels, average="micro")</a> * 100.0
    return {"micro_f1": micro_f1}

    &#47&#47 if "return_decoded_preds" in kwargs and kwargs["return_decoded_preds"]:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/thu-keg/omnievent/commit/16615dd3b3b08bc6a7d3a7e658469e9c3ef58003#diff-c401add59b28a47361b10eb1ffae4bd238b671225cf9a1b8e754124048d8353cL24' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 67000602</div><div id='project'> Project Name: thu-keg/omnievent</div><div id='commit'> Commit Name: 16615dd3b3b08bc6a7d3a7e658469e9c3ef58003</div><div id='time'> Time: 2022-06-06</div><div id='author'> Author: penghao20170136@163.com</div><div id='file'> File Name: src/OpenEE/evaluation/metric.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: compute_seq_F1(2)</div><div id='n_method'> N Method Name: compute_seq_F1(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/OpenEE/evaluation/metric.py</div><div id='n_file'> N File Name: src/OpenEE/evaluation/metric.py</div><div id='m_start'> M Start Line: 25</div><div id='m_end'> M End Line: 55</div><div id='n_start'> N Start Line: 26</div><div id='n_end'> N End Line: 47</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 print("hello4")
        self.optimizer.step()
        
        <a id="change">return </a>loss_ner, loss_rel, pred_ner, pred_rel
    
    def evaluate(self):
        print(&quotSTARTING EVALUATION...&quot)</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 print("haha5")
        loss_ner, loss_rel, pred_ner, pred_rel = self.model(data_item)
        pred_token_type = self.resotre_ner((pred_ner))
        f1_ner<a id="change"> = </a><a id="change">f1_score(</a>data_item[&quottoken_type_origin&quot], pred_token_type<a id="change">)</a>
        loss = (loss_ner + loss_rel*100)
        &#47&#47 print("hello3")
        loss.backward()
        &#47&#47 print("hello4")</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/mangonihao/multiheadjointentityrelationextraction_simple/commit/03f812f27211890c17e5f3a602594753cb2cf61d#diff-075d5e201e6fa33310a0829d04f69714642c915794e8b2dfaacd31c8d32e0a3fL101' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 67000600</div><div id='project'> Project Name: mangonihao/multiheadjointentityrelationextraction_simple</div><div id='commit'> Commit Name: 03f812f27211890c17e5f3a602594753cb2cf61d</div><div id='time'> Time: 2021-03-07</div><div id='author'> Author: 2075419247@qq.com</div><div id='file'> File Name: mains/trainer.py</div><div id='m_class'> M Class Name: Trainer</div><div id='n_method'> N Class Name: Trainer</div><div id='m_method'> M Method Name: train_batch(2)</div><div id='n_method'> N Method Name: train_batch(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: mains/trainer.py</div><div id='n_file'> N File Name: mains/trainer.py</div><div id='m_start'> M Start Line: 117</div><div id='m_end'> M End Line: 117</div><div id='n_start'> N Start Line: 118</div><div id='n_end'> N End Line: 126</div><BR>