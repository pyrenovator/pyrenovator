<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        tag_len = stitch_tags.shape[-1]
        gt_stitches = gt_stitches.long()

        <a id="change">for </a>pattern_idx in <a id="change">range(</a>stitch_tags.shape[0]<a id="change">):
            </a>pattern_tags = stitch_tags[pattern_idx].view(-1, stitch_tags.shape[-1])  &#47&#47 flat view
            left_sides = pattern_tags[gt_stitches[pattern_idx][0]]
            right_sides = pattern_tags[gt_stitches[pattern_idx][1]]
            total_tags = torch.cat([left_sides, right_sides])</code></pre><h3>After Change</h3><pre><code class='java'>
               
        &#47&#47 final sum
        fin_stitch_losses = similarity_loss + non_zero_loss + total_neg_loss + free_edges_loss
        stitch_loss_dict = <a id="change">dict(
            stitch_similarity_loss=similarity_loss,
            stitch_non_zero_loss=non_zero_loss, 
            stitch_neg_loss=total_neg_loss, 
            free_edges_loss=free_edges_loss
        )</a>

        return fin_stitch_losses, stitch_loss_dict

    def free_edges(self, stitch_tags, gt_free_mask):</code></pre>