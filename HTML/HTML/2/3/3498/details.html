<html><h3>Pattern ID :3498
</h3><img src='13393005.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        if self.ap is None:
            self.ap = AudioPreprocessor(input_sr=sr, output_sr=16000, melspec_buckets=80, hop_length=256, n_fft=1024)
        text = self.tf.string_to_tensor(transcript).long()
        text_len = torch.LongTensor(<a id="change">text.shape(</a>0<a id="change">)</a>)
        speech = torch.transpose(self.ap.audio_to_mel_spec_tensor(wave), 0, 1)
        speech_len = torch.LongTensor(speech.shape(1))
        if self.spemb:</code></pre><h3>After Change</h3><pre><code class='java'>
        if self.ap is None:
            self.ap = AudioPreprocessor(input_sr=sr, output_sr=16000, melspec_buckets=80, hop_length=256, n_fft=1024)
        text = self.tf.string_to_tensor(transcript).long()
        text_len = torch.LongTensor(<a id="change">text.shape[0]</a>)
        speech = torch.transpose(self.ap.audio_to_mel_spec_tensor(wave), 0, 1)
        speech_len = torch.LongTensor(speech.shape[1])
        if self.spemb:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 7</div><BR><div id='size'>Non-data size: 2</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/digitalphonetics/ims-toucan/commit/d9bc0a5423b5454d68e127cd7a51927f952324aa#diff-0965ad6e3a8f04afe3a358a7558e203eaa1f244ad6e8e6fbfe73f8a2052b8cb1L37' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 13393005</div><div id='project'> Project Name: digitalphonetics/ims-toucan</div><div id='commit'> Commit Name: d9bc0a5423b5454d68e127cd7a51927f952324aa</div><div id='time'> Time: 2021-02-22</div><div id='author'> Author: florian.lux@ims.uni-stuttgart.de</div><div id='file'> File Name: TransformerTTS/TransformerTTSDataset.py</div><div id='m_class'> M Class Name: TransformerTTSDataset</div><div id='n_method'> N Class Name: TransformerTTSDataset</div><div id='m_method'> M Method Name: __getitem__(2)</div><div id='n_method'> N Method Name: __getitem__(2)</div><div id='m_parent_class'> M Parent Class: Dataset</div><div id='n_parent_class'> N Parent Class: Dataset</div><div id='m_file'> M File Name: TransformerTTS/TransformerTTSDataset.py</div><div id='n_file'> N File Name: TransformerTTS/TransformerTTSDataset.py</div><div id='m_start'> M Start Line: 37</div><div id='m_end'> M End Line: 40</div><div id='n_start'> N Start Line: 37</div><div id='n_end'> N End Line: 45</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    on_device,
):
    dtype, x, axis = dtype_values_axis
    if len(<a id="change">np.shape(</a>x<a id="change">)</a>) == 1:
        axis = None
    helpers.test_frontend_function(
        input_dtypes=dtype,</code></pre><h3>After Change</h3><pre><code class='java'>
):
    dtype, x, axis, ord, check_stable = norm_values
    if check_stable:
        assume(matrix_is_stable(<a id="change">x[0]</a>, cond_limit=10))
    helpers.test_frontend_function(
        input_dtypes=dtype,
        frontend=frontend,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ivy-dl/ivy/commit/d946a935562c4291dcd74df785c1a32bb4b940c5#diff-be890a30e55caabf667ffc1412239c60e9ad4433021e92b8206d080f9c98f646L31' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 13393006</div><div id='project'> Project Name: ivy-dl/ivy</div><div id='commit'> Commit Name: d946a935562c4291dcd74df785c1a32bb4b940c5</div><div id='time'> Time: 2023-03-17</div><div id='author'> Author: hirwanshutiflx@gmail.com</div><div id='file'> File Name: ivy_tests/test_ivy/test_frontends/test_numpy/test_linear_algebra/test_norms_and_other_numbers.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_numpy_norm(6)</div><div id='n_method'> N Method Name: test_numpy_norm(7)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: ivy_tests/test_ivy/test_frontends/test_numpy/test_linear_algebra/test_norms_and_other_numbers.py</div><div id='n_file'> N File Name: ivy_tests/test_ivy/test_frontends/test_numpy/test_linear_algebra/test_norms_and_other_numbers.py</div><div id='m_start'> M Start Line: 34</div><div id='m_end'> M End Line: 42</div><div id='n_start'> N Start Line: 81</div><div id='n_end'> N End Line: 83</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    Returns:
        torch.Tensor: The calculated loss
    
    if len(pred.shape) &gt; 1 and <a id="change">pred.shape(</a>1<a id="change">)</a> == 1:
        &#47&#47 For binary class segmentation, the shape of pred is
        &#47&#47 [N, 1, H, W] and that of label is [N, H, W].
        &#47&#47 As the ignore_index often set as 255, so the</code></pre><h3>After Change</h3><pre><code class='java'>
    Returns:
        torch.Tensor: The calculated loss
    
    if len(pred.shape) &gt; 1 and <a id="change">pred.shape[1]</a> == 1:
        &#47&#47 For binary class segmentation, the shape of pred is
        &#47&#47 [N, 1, H, W] and that of label is [N, H, W].
        &#47&#47 As the ignore_index often set as 255, so the</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/alibaba/easycv/commit/0cb91de0cb80845f2a09f6de7c3697f28b51629e#diff-7e161c8ef8b60cfdbe05fc0e74bfd0c739c921deaf087a3eb71393cb50b3ea8eL110' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 13393000</div><div id='project'> Project Name: alibaba/easycv</div><div id='commit'> Commit Name: 0cb91de0cb80845f2a09f6de7c3697f28b51629e</div><div id='time'> Time: 2022-09-14</div><div id='author'> Author: 55594658+zzoneee@users.noreply.github.com</div><div id='file'> File Name: easycv/models/loss/cross_entropy_loss.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: binary_cross_entropy(9)</div><div id='n_method'> N Method Name: binary_cross_entropy(8)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: easycv/models/loss/cross_entropy_loss.py</div><div id='n_file'> N File Name: easycv/models/loss/cross_entropy_loss.py</div><div id='m_start'> M Start Line: 139</div><div id='m_end'> M End Line: 139</div><div id='n_start'> N Start Line: 118</div><div id='n_end'> N End Line: 172</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def rand_translation(x, ratio=(1, 8)):
    B, H, W = tf.shape(x)[0], <a id="change">tf.shape(</a>x<a id="change">)</a>[1], tf.shape(x)[2]
    translation_x = tf.random.uniform([B, 1], -(W * ratio[0] // ratio[1]), (W * ratio[0] // ratio[1]) + 1, dtype=tf.int32)
    translation_y = tf.random.uniform([B, 1], -(H * ratio[0] // ratio[1]), (H * ratio[0] // ratio[1]) + 1, dtype=tf.int32)
    grid_x = tf.clip_by_value(tf.expand_dims(tf.range(W, dtype=tf.int32), 0) + translation_x + 1, 0, W + 1)</code></pre><h3>After Change</h3><pre><code class='java'>
    translation_x = tf.random.uniform([batch_size, 1], -shift[0], shift[0] + 1, dtype=tf.int32)
    translation_y = tf.random.uniform([batch_size, 1], -shift[1], shift[1] + 1, dtype=tf.int32)
    grid_x = tf.clip_by_value(tf.expand_dims(tf.range(image_size[0], dtype=tf.int32), 0) + translation_x + 1, 0, image_size[0] + 1)
    grid_y = tf.clip_by_value(tf.expand_dims(tf.range(image_size[1], dtype=tf.int32), 0) + translation_y + 1, 0, <a id="change">image_size[1]</a> + 1)
    x = tf.gather_nd(tf.pad(x, [[0, 0], [1, 1], [0, 0], [0, 0]]), tf.expand_dims(grid_x, -1), batch_dims=1)
    x = tf.transpose(tf.gather_nd(tf.pad(tf.transpose(x, [0, 2, 1, 3]), [[0, 0], [1, 1], [0, 0], [0, 0]]), tf.expand_dims(grid_y, -1), batch_dims=1), [0, 2, 1, 3])
    return x</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/mit-han-lab/data-efficient-gans/commit/96d6d871bf47d8dd3d280b77a5c3a01c674a7acd#diff-9b2f8ed36eb5d0b4386adda30a7118adc7bb2b244e6714cd6b9507f7761b04abL40' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 13392996</div><div id='project'> Project Name: mit-han-lab/data-efficient-gans</div><div id='commit'> Commit Name: 96d6d871bf47d8dd3d280b77a5c3a01c674a7acd</div><div id='time'> Time: 2020-07-01</div><div id='author'> Author: zsyzzsoft@gmail.com</div><div id='file'> File Name: DiffAugment-stylegan2/DiffAugment_tf.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: rand_translation(2)</div><div id='n_method'> N Method Name: rand_translation(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: DiffAugment-stylegan2/DiffAugment_tf.py</div><div id='n_file'> N File Name: DiffAugment-stylegan2/DiffAugment_tf.py</div><div id='m_start'> M Start Line: 41</div><div id='m_end'> M End Line: 47</div><div id='n_start'> N Start Line: 41</div><div id='n_end'> N End Line: 49</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        &#47&#47 TODO, use registered buffer
        causal_mask = paddle.tensor.triu(
            paddle.ones((paddle.shape(input_ids)[-1], <a id="change">paddle.shape(</a>input_ids<a id="change">)</a>[-1])) * -1e4, diagonal=1
        )
        if past_key_values_length &gt; 0:
            causal_mask = paddle.concat(</code></pre><h3>After Change</h3><pre><code class='java'>

        if position_ids is None:
            position_ids = paddle.arange(
                past_key_values_length, <a id="change">input_shape[-1]</a> + past_key_values_length, dtype="int64"
            )
            position_ids = position_ids.unsqueeze(0)
            position_ids = paddle.expand(position_ids, input_shape)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/paddlepaddle/paddlenlp/commit/64f4c107a9b225af009e63f95372e4371ce59337#diff-6f18e3f4e6ac6957480cc4c50be585e08bc1e7724d6900d54c2e337f0525d473L285' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 13392998</div><div id='project'> Project Name: paddlepaddle/paddlenlp</div><div id='commit'> Commit Name: 64f4c107a9b225af009e63f95372e4371ce59337</div><div id='time'> Time: 2023-03-15</div><div id='author'> Author: 35913314+1649759610@users.noreply.github.com</div><div id='file'> File Name: paddlenlp/transformers/opt/modeling.py</div><div id='m_class'> M Class Name: OPTModel</div><div id='n_method'> N Class Name: OPTModel</div><div id='m_method'> M Method Name: forward(10)</div><div id='n_method'> N Method Name: forward(9)</div><div id='m_parent_class'> M Parent Class: OPTPretrainedModel</div><div id='n_parent_class'> N Parent Class: OPTPretrainedModel</div><div id='m_file'> M File Name: paddlenlp/transformers/opt/modeling.py</div><div id='n_file'> N File Name: paddlenlp/transformers/opt/modeling.py</div><div id='m_start'> M Start Line: 366</div><div id='m_end'> M End Line: 379</div><div id='n_start'> N Start Line: 294</div><div id='n_end'> N End Line: 399</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def rand_translation(x, ratio=(1, 8)):
    B, H, W = tf.shape(x)[0], <a id="change">tf.shape(</a>x<a id="change">)</a>[1], tf.shape(x)[2]
    translation_x = tf.random.uniform([B, 1], -(W * ratio[0] // ratio[1]), (W * ratio[0] // ratio[1]) + 1, dtype=tf.int32)
    translation_y = tf.random.uniform([B, 1], -(H * ratio[0] // ratio[1]), (H * ratio[0] // ratio[1]) + 1, dtype=tf.int32)
    grid_x = tf.clip_by_value(tf.expand_dims(tf.range(W, dtype=tf.int32), 0) + translation_x + 1, 0, W + 1)</code></pre><h3>After Change</h3><pre><code class='java'>
    shift = tf.cast(tf.cast(image_size, tf.float32) * ratio + 0.5, tf.int32)
    translation_x = tf.random.uniform([batch_size, 1], -shift[0], shift[0] + 1, dtype=tf.int32)
    translation_y = tf.random.uniform([batch_size, 1], -shift[1], shift[1] + 1, dtype=tf.int32)
    grid_x = tf.clip_by_value(tf.expand_dims(tf.range(image_size[0], dtype=tf.int32), 0) + translation_x + 1, 0, <a id="change">image_size[0]</a> + 1)
    grid_y = tf.clip_by_value(tf.expand_dims(tf.range(image_size[1], dtype=tf.int32), 0) + translation_y + 1, 0, image_size[1] + 1)
    x = tf.gather_nd(tf.pad(x, [[0, 0], [1, 1], [0, 0], [0, 0]]), tf.expand_dims(grid_x, -1), batch_dims=1)
    x = tf.transpose(tf.gather_nd(tf.pad(tf.transpose(x, [0, 2, 1, 3]), [[0, 0], [1, 1], [0, 0], [0, 0]]), tf.expand_dims(grid_y, -1), batch_dims=1), [0, 2, 1, 3])</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/mit-han-lab/data-efficient-gans/commit/96d6d871bf47d8dd3d280b77a5c3a01c674a7acd#diff-28ebcd161082c78a65acc309e5faccee2521dd684f1f97794d78a3fb29f2c891L40' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 13392992</div><div id='project'> Project Name: mit-han-lab/data-efficient-gans</div><div id='commit'> Commit Name: 96d6d871bf47d8dd3d280b77a5c3a01c674a7acd</div><div id='time'> Time: 2020-07-01</div><div id='author'> Author: zsyzzsoft@gmail.com</div><div id='file'> File Name: DiffAugment_tf.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: rand_translation(2)</div><div id='n_method'> N Method Name: rand_translation(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: DiffAugment_tf.py</div><div id='n_file'> N File Name: DiffAugment_tf.py</div><div id='m_start'> M Start Line: 41</div><div id='m_end'> M End Line: 47</div><div id='n_start'> N Start Line: 41</div><div id='n_end'> N End Line: 49</div><BR>