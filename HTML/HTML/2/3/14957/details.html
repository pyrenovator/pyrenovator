<html><h3>Pattern ID :14957
</h3><img src='49815705.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
      for s,st in zip(self.views[-1].shape, self.views[-1].strides):
        if st == 0 or s == 1:
          new_strides.append(0)
          <a id="change">continue</a>
        this_dim = self.views[-2].expr_node(Variable(&quotidx&quot, 0, s-1)*st)
        if isinstance(this_dim, Variable):
          new_strides.append(1)
        elif isinstance(this_dim, MulNode) and isinstance(this_dim.a, Variable):</code></pre><h3>After Change</h3><pre><code class='java'>
      new_strides = []
      for s,st in zip(self.views[-1].shape, self.views[-1].strides):
        this_dim = self.views[-2].expr_node(Variable(&quotidx&quot, 0, s-1)*st)
        <a id="change">if </a><a id="change">isinstance(</a>this_dim, NumNode<a id="change">)</a> and this_dim.b == 0:
          new_strides.append(0)
        elif isinstance(this_dim, Variable):
          new_strides.append(1)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 6</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/geohot/tinygrad/commit/cfa5a12f13b78c9bfaa287002d4b247c83ed88e5#diff-cc5e15efb221798e710a795ffab858ea5e70befb4dbc1d46d472b1cdc7192019L112' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 49815705</div><div id='project'> Project Name: geohot/tinygrad</div><div id='commit'> Commit Name: cfa5a12f13b78c9bfaa287002d4b247c83ed88e5</div><div id='time'> Time: 2023-02-28</div><div id='author'> Author: geohot@gmail.com</div><div id='file'> File Name: tinygrad/shape/__init__.py</div><div id='m_class'> M Class Name: ShapeTracker</div><div id='n_method'> N Class Name: ShapeTracker</div><div id='m_method'> M Method Name: simplify(1)</div><div id='n_method'> N Method Name: simplify(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tinygrad/shape/__init__.py</div><div id='n_file'> N File Name: tinygrad/shape/__init__.py</div><div id='m_start'> M Start Line: 112</div><div id='m_end'> M End Line: 124</div><div id='n_start'> N Start Line: 113</div><div id='n_end'> N End Line: 123</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        X = {}
        for tensor, names in zip([cats, conts], [self.cat_names, self.cont_names]):
            if len(names) == 0:
                <a id="change">continue</a>
            elif len(names) &gt; 1:
                tensors = tf.split(tensor, len(names), axis=1)
            else:
                tensors = [tensor]</code></pre><h3>After Change</h3><pre><code class='java'>
        X = {}
        for tensor, names in zip([cats, conts], [self.cat_names, self.cont_names]):
            lists = {}
            <a id="change">if </a><a id="change">isinstance(</a>tensor, tuple<a id="change">)</a>:
                tensor, lists = tensor
            names = [i for i in names if i not in lists]
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/nvidia/nvtabular/commit/6b668bbd884073cbaf03837cbce5df0810d18a00#diff-5370fdee81817626cc493a473693f5aab4cf69e6b4b1fdbc6fe743789c28a0d1L293' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 49815707</div><div id='project'> Project Name: nvidia/nvtabular</div><div id='commit'> Commit Name: 6b668bbd884073cbaf03837cbce5df0810d18a00</div><div id='time'> Time: 2020-11-03</div><div id='author'> Author: amacgunny@gmail.com</div><div id='file'> File Name: nvtabular/loader/tensorflow.py</div><div id='m_class'> M Class Name: KerasSequenceLoader</div><div id='n_method'> N Class Name: KerasSequenceLoader</div><div id='m_method'> M Method Name: _handle_tensors(4)</div><div id='n_method'> N Method Name: _handle_tensors(4)</div><div id='m_parent_class'> M Parent Class: tf.keras.utils.Sequence,DataLoader</div><div id='n_parent_class'> N Parent Class: tf.keras.utils.Sequence,DataLoader</div><div id='m_file'> M File Name: nvtabular/loader/tensorflow.py</div><div id='n_file'> N File Name: nvtabular/loader/tensorflow.py</div><div id='m_start'> M Start Line: 294</div><div id='m_end'> M End Line: 302</div><div id='n_start'> N Start Line: 315</div><div id='n_end'> N End Line: 336</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

            if isinstance(module, RatNormal):
                truncated_normal_(module.stds, std=0.1)
                <a id="change">continue</a>

    def mpe(
        self,
        evidence: torch.Tensor = None,</code></pre><h3>After Change</h3><pre><code class='java'>
        for module in self.modules():
            if hasattr(module, "_init_weights") and module != self:
                module._init_weights()
            elif <a id="change">isinstance(</a>module, EinsumMixingLayer<a id="change">)</a>:
                truncated_normal_(module.weights, std=0.5)
            elif isinstance(module, EinsumLayer):
                truncated_normal_(module.weights, std=0.5)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/braun-steven/simple-einet/commit/33db6cd59b1042f3edb63005725b06c88ec6bc59#diff-b07179cedca4d239e2586e9cb6fff9e541bc16eec55c28d6d2537cfebff90289L249' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 49815708</div><div id='project'> Project Name: braun-steven/simple-einet</div><div id='commit'> Commit Name: 33db6cd59b1042f3edb63005725b06c88ec6bc59</div><div id='time'> Time: 2022-01-20</div><div id='author'> Author: steven.lang.mz@gmail.com</div><div id='file'> File Name: simple_einet/einet.py</div><div id='m_class'> M Class Name: Einet</div><div id='n_method'> N Class Name: Einet</div><div id='m_method'> M Method Name: _init_weights(1)</div><div id='n_method'> N Method Name: _init_weights(1)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: simple_einet/einet.py</div><div id='n_file'> N File Name: simple_einet/einet.py</div><div id='m_start'> M Start Line: 254</div><div id='m_end'> M End Line: 264</div><div id='n_start'> N Start Line: 251</div><div id='n_end'> N End Line: 260</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                float_list = [result]
            else:
                self._logger.warning(f"Failed when working out score of metric {metric}.")
                <a id="change">continue</a>
            if len(float_list) != 0:
                if score is None:
                    score = 0.
                score += sum(float_list) / len(float_list)</code></pre><h3>After Change</h3><pre><code class='java'>
        float_list = []
        for metric, result in self._valid_metrics_results.items():
            if isinstance(result, dict):
                float_list = [v for k, v in result.items() if <a id="change">k in keys and isinstance(v, float)</a>]
            elif metric in keys:
                if isinstance(result, Collection):
                    float_list = list(filter(lambda x: isinstance(x, float), result))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/rucaibox/textbox/commit/a823ff8def5622cdd534036d366f1875188610de#diff-5b3f9c4be34034ec39b0dfd25f8b3f9f911b0bbff67729d62ca882be803bc4c8L209' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 49815692</div><div id='project'> Project Name: rucaibox/textbox</div><div id='commit'> Commit Name: a823ff8def5622cdd534036d366f1875188610de</div><div id='time'> Time: 2022-07-12</div><div id='author'> Author: 1020030101@qq.com</div><div id='file'> File Name: textbox/utils/dashboard.py</div><div id='m_class'> M Class Name: EpochTracker</div><div id='n_method'> N Class Name: EpochTracker</div><div id='m_method'> M Method Name: calc_score(2)</div><div id='n_method'> N Method Name: calc_score(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: textbox/utils/dashboard.py</div><div id='n_file'> N File Name: textbox/utils/dashboard.py</div><div id='m_start'> M Start Line: 214</div><div id='m_end'> M End Line: 233</div><div id='n_start'> N Start Line: 220</div><div id='n_end'> N End Line: 238</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                inputs[col] = torch.Tensor(features[col]).type(torch.long).unsqueeze(0).to(self.device) 
            except:
                inputs[col] = features[col]
                <a id="change">continue</a>
            
        return inputs
    
    def predict_one_sample(</code></pre><h3>After Change</h3><pre><code class='java'>
    ):
        inputs = {}
        for col in features:
            <a id="change">if </a><a id="change">isinstance(</a>features[col], np.ndarray<a id="change">)</a>:
                inputs[col] = torch.Tensor(features[col]).type(torch.long).unsqueeze(0).to(self.device) 
            else:
                inputs[col] = features[col]</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/xiangking/ark-nlp/commit/547150f5ba8c3cf3e1bb22bb1c651145f1258622#diff-396f47fe258eabd9514cea84f780380aab1a47aad360f6dc1a8e67a402de89cdL69' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 49815695</div><div id='project'> Project Name: xiangking/ark-nlp</div><div id='commit'> Commit Name: 547150f5ba8c3cf3e1bb22bb1c651145f1258622</div><div id='time'> Time: 2021-05-10</div><div id='author'> Author: wx15857152367@163.com</div><div id='file'> File Name: ark_nlp/factory/predictor/casrel_relation_extraction.py</div><div id='m_class'> M Class Name: CasrelREPredictor</div><div id='n_method'> N Class Name: CasrelREPredictor</div><div id='m_method'> M Method Name: _get_module_one_sample_inputs(2)</div><div id='n_method'> N Method Name: _get_module_one_sample_inputs(2)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: ark_nlp/factory/predictor/casrel_relation_extraction.py</div><div id='n_file'> N File Name: ark_nlp/factory/predictor/casrel_relation_extraction.py</div><div id='m_start'> M Start Line: 75</div><div id='m_end'> M End Line: 81</div><div id='n_start'> N Start Line: 76</div><div id='n_end'> N End Line: 82</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        for name, module in model.named_modules():
            if not isinstance(module, (BasicBlock, Bottleneck)):
                <a id="change">continue</a>

            block_last = (f&quot{name}.conv2&quot, module.conv2)
            if isinstance(module, Bottleneck):
                block_last = (f&quot{name}.conv3&quot, module.conv3)</code></pre><h3>After Change</h3><pre><code class='java'>
            if module.downsample is not None:
                pinned_out[f&quot{name}.downsample.0&quot] = all_modules

            <a id="change">if </a><a id="change">isinstance(</a>module, BasicBlock<a id="change">)</a>:
                pinned_out[f&quot{name}.conv2&quot] = all_modules
            else:
                pinned_out[f&quot{name}.conv3&quot] = all_modules   </code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/eidoslab/simplify/commit/222d496fef53d6b5468aa2001b5f6907d4b787f2#diff-09d0cbaf891d623ac245ccf84485a687b554217349ca55557c60b33234b969aeL18' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 49815697</div><div id='project'> Project Name: eidoslab/simplify</div><div id='commit'> Commit Name: 222d496fef53d6b5468aa2001b5f6907d4b787f2</div><div id='time'> Time: 2021-05-28</div><div id='author'> Author: carlo.alberto.barbano@outlook.com</div><div id='file'> File Name: utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: get_pinned_out(1)</div><div id='n_method'> N Method Name: get_pinned_out(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: utils.py</div><div id='n_file'> N File Name: utils.py</div><div id='m_start'> M Start Line: 22</div><div id='m_end'> M End Line: 44</div><div id='n_start'> N Start Line: 22</div><div id='n_end'> N End Line: 51</div><BR>