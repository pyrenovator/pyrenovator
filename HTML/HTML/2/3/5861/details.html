<html><h3>Pattern ID :5861
</h3><img src='20720308.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    idx = mb.values().view(len(mb.keys()), -1).transpose(0, 1)
    logger.info(f"{idx}", ranks=[0])

    <a id="change">with </a><a id="change">ColoInitContext(device=get_current_device()):
        </a>model = EmbeddingBag([6, 4], 3)
    spec = TensorSpec(
        distspec.shard(gpc.get_group(ParallelMode.PARALLEL_1D), [0], [gpc.get_world_size(ParallelMode.PARALLEL_1D)]),
        ParallelAction(ComputePattern.TP1D))</code></pre><h3>After Change</h3><pre><code class='java'>


def main():
    config = <a id="change">dict()</a>
    colossalai.launch_from_torch(config=config, verbose=False)

    colossalai.logging.disable_existing_loggers()
    logger = colossalai.logging.get_dist_logger()</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/hpcaitech/freqcacheembedding/commit/a61a1ad5740991f47e8056702337b6f2915faddc#diff-e8a3112bbf9ad7ddb4d08b6efb743006585e650381233493a30d98a1ce7f9951L40' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 20720308</div><div id='project'> Project Name: hpcaitech/freqcacheembedding</div><div id='commit'> Commit Name: a61a1ad5740991f47e8056702337b6f2915faddc</div><div id='time'> Time: 2022-06-01</div><div id='author'> Author: zhangg1998@outlook.com</div><div id='file'> File Name: modules/colossal_embedding.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: modules/colossal_embedding.py</div><div id='n_file'> N File Name: modules/colossal_embedding.py</div><div id='m_start'> M Start Line: 40</div><div id='m_end'> M End Line: 63</div><div id='n_start'> N Start Line: 50</div><div id='n_end'> N End Line: 69</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def run_test(flow, endpoint, port_expose):
    <a id="change">with </a><a id="change">flow:
        </a>resp = flow.post(
            endpoint,
            [Document() for _ in range(10)],
            return_results=True,</code></pre><h3>After Change</h3><pre><code class='java'>
    with portforward.forward(
        namespace, gateway_pod_name, flow.port_expose, flow.port_expose, config_path
    ):
        client_kwargs = <a id="change">dict(
            host=&quotlocalhost&quot,
            port=flow.port_expose,
            asyncio=True,
        )</a>
        client_kwargs.update(flow._common_kwargs)

        client = Client(**client_kwargs)
        client.show_progress = True</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/6e9e7ef32f61cab04c6efc7a9f21659d26b50fdb#diff-e3067955c9efade1423c6e293462d207495c677d07e360b0040731f7f39b7c2dL10' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 20720305</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: 6e9e7ef32f61cab04c6efc7a9f21659d26b50fdb</div><div id='time'> Time: 2022-01-10</div><div id='author'> Author: joan.martinez@jina.ai</div><div id='file'> File Name: tests/k8s/test_k8s.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: run_test(4)</div><div id='n_method'> N Method Name: run_test(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/k8s/test_k8s.py</div><div id='n_file'> N File Name: tests/k8s/test_k8s.py</div><div id='m_start'> M Start Line: 10</div><div id='m_end'> M End Line: 18</div><div id='n_start'> N Start Line: 78</div><div id='n_end'> N End Line: 110</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    obj._uninformed_proposal = MagicMock()
    obj._flow_proposal = MagicMock()
    obj.likelihood_evaluations = [2, 3]
    with patch("pickle.load", return_value=obj) as mock_pickle, <a id="change">patch(
        "builtins.open"
    ):
        </a>out = NestedSampler.resume("test.pkl", model)

    mock_pickle.assert_called_once()
</code></pre><h3>After Change</h3><pre><code class='java'>
    obj._flow_proposal.resume = MagicMock()

    weights_file = "weight.pt"
    flow_config = <a id="change">dict(a=1)</a>

    with patch(
        "nessai.samplers.base.BaseNestedSampler.resume", return_value=obj
    ) as mock:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/mj-will/nessai/commit/7a5a304ee2d7b313deb71bc709f3e1b2543dd3a7#diff-2dd10422526896d8c1ad0a4424a7b4272983b300588191e712145a1c32af9b03L86' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 20720307</div><div id='project'> Project Name: mj-will/nessai</div><div id='commit'> Commit Name: 7a5a304ee2d7b313deb71bc709f3e1b2543dd3a7</div><div id='time'> Time: 2022-08-29</div><div id='author'> Author: m.williams.4@research.gla.ac.uk</div><div id='file'> File Name: tests/test_samplers/test_nested_sampler/test_resume.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_resume(1)</div><div id='n_method'> N Method Name: test_resume(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_samplers/test_nested_sampler/test_resume.py</div><div id='n_file'> N File Name: tests/test_samplers/test_nested_sampler/test_resume.py</div><div id='m_start'> M Start Line: 88</div><div id='m_end'> M End Line: 103</div><div id='n_start'> N Start Line: 55</div><div id='n_end'> N End Line: 83</div><BR>