<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    dataset = self.env.get_dataset()
    N = dataset[&quotrewards&quot].shape[0]
    obs = dataset[&quotobservations&quot]
    next_obs<a id="change"> = </a><a id="change">np.roll(</a>obs, -1<a id="change">, axis=0)</a>
    dataset_out = {&quotstates&quot: torch.as_tensor(obs[:-1], dtype=torch.float32),
                   &quotactions&quot: torch.as_tensor(dataset[&quotactions&quot][:-1], dtype=torch.float32),
                   &quotrewards&quot: torch.as_tensor(dataset[&quotrewards&quot][:-1], dtype=torch.float32),</code></pre><h3>After Change</h3><pre><code class='java'>
    dataset_out = {&quotstates&quot: torch.as_tensor(dataset[&quotobservations&quot][:-1], dtype=torch.float32),
                   &quotactions&quot: torch.as_tensor(dataset[&quotactions&quot][:-1], dtype=torch.float32),
                   &quotrewards&quot: torch.as_tensor(dataset[&quotrewards&quot][:-1], dtype=torch.float32),
                   &quotnext_states&quot: torch.as_tensor(<a id="change">dataset[&quotobservations&quot]</a>[1:], dtype=torch.float32), 
                   &quotterminals&quot: torch.as_tensor(dataset[&quotterminals&quot][:-1], dtype=torch.float32)}
    &#47&#47 Postprocess
    if size &gt; 0 and size &lt; N:</code></pre>