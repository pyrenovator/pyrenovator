<html><h3>Pattern ID :27598
</h3><img src='81936090.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        fm = QFontMetrics(block.charFormat().font())
        fm_w = fm.width(&quot字&quot)
        space_w = <a id="change">fm.width(</a>&quot &quot<a id="change">)</a>
        line_width = fm_w
        tbr = fm.tightBoundingRect(&quot字fg&quot)
        TBRH = tbr.height()
</code></pre><h3>After Change</h3><pre><code class='java'>
                char_yoffset_lst.append(line_y_offset + tbr_h)
                for _ in range(num_rspaces):
                    char_yoffset_lst.append(min(char_yoffset_lst[-1] + space_w, self.available_height))
                line_bottom = <a id="change">char_yoffset_lst[-1]</a>
            else:
                char_yoffset_lst.append(char_bottom)
                for _ in range(num_rspaces):
                    char_yoffset_lst.append(min(char_yoffset_lst[-1] + space_w, self.available_height))</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 2</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/dmmaze/ballonstranslator/commit/d7adb3112abfc081ab49b3bc14aa6f5948a86856#diff-aa30432cc2fa48fb565134b7016dce79dfcd72b25d12617536123aa7380a8965L270' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 81936090</div><div id='project'> Project Name: dmmaze/ballonstranslator</div><div id='commit'> Commit Name: d7adb3112abfc081ab49b3bc14aa6f5948a86856</div><div id='time'> Time: 2022-08-26</div><div id='author'> Author: beneathlimbo@gmail.com</div><div id='file'> File Name: ballontranslator/ui/textlayout.py</div><div id='m_class'> M Class Name: VerticalTextDocumentLayout</div><div id='n_method'> N Class Name: VerticalTextDocumentLayout</div><div id='m_method'> M Method Name: layoutBlock(2)</div><div id='n_method'> N Method Name: layoutBlock(2)</div><div id='m_parent_class'> M Parent Class: QAbstractTextDocumentLayout</div><div id='n_parent_class'> N Parent Class: QAbstractTextDocumentLayout</div><div id='m_file'> M File Name: ballontranslator/ui/textlayout.py</div><div id='n_file'> N File Name: ballontranslator/ui/textlayout.py</div><div id='m_start'> M Start Line: 270</div><div id='m_end'> M End Line: 353</div><div id='n_start'> N Start Line: 292</div><div id='n_end'> N End Line: 379</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                    else:
                        yoff = -pun_tbr.top() - fm.ascent() - pun_tbr.height() / 2 - cfmt.br.width() / 2
                    if char in PUNSET_NONBRACKET:
                        yoff = -cfmt.tbr.width() - pun_br.height() + <a id="change">cfmt.br.width()</a>
                        &#47&#47 line.draw(painter, QPointF(hight_comp,  yoff - pun_tbr.height()), o)
                    line.draw(painter, QPointF(hight_comp,  yoff), o)
                    painter.setTransform(inv_transform, True)
                elif char in PUNSET_PAUSEORSTOP:</code></pre><h3>After Change</h3><pre><code class='java'>
                        yoff = -cfmt.tbr.top() - fm.ascent() - cfmt.tbr.width()
                        hight_comp = 0
                    elif char in PUNSET_NONBRACKET:
                        yoff =  -<a id="change">non_bracket_br[1]</a> - non_bracket_br[3]
                        if self.punc_align_center:
                            yoff = yoff - cfmt.tbr.width() / 2 + non_bracket_br[3] / 3
                        else:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/dmmaze/ballonstranslator/commit/4a49735da4dd45753a39aeb5b450778d346b1eae#diff-aa30432cc2fa48fb565134b7016dce79dfcd72b25d12617536123aa7380a8965L142' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 81936091</div><div id='project'> Project Name: dmmaze/ballonstranslator</div><div id='commit'> Commit Name: 4a49735da4dd45753a39aeb5b450778d346b1eae</div><div id='time'> Time: 2022-08-28</div><div id='author'> Author: beneathlimbo@gmail.com</div><div id='file'> File Name: ballontranslator/ui/textlayout.py</div><div id='m_class'> M Class Name: VerticalTextDocumentLayout</div><div id='n_method'> N Class Name: VerticalTextDocumentLayout</div><div id='m_method'> M Method Name: draw(3)</div><div id='n_method'> N Method Name: draw(3)</div><div id='m_parent_class'> M Parent Class: QAbstractTextDocumentLayout</div><div id='n_parent_class'> N Parent Class: QAbstractTextDocumentLayout</div><div id='m_file'> M File Name: ballontranslator/ui/textlayout.py</div><div id='n_file'> N File Name: ballontranslator/ui/textlayout.py</div><div id='m_start'> M Start Line: 175</div><div id='m_end'> M End Line: 219</div><div id='n_start'> N Start Line: 197</div><div id='n_end'> N End Line: 244</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                cfmt = CharFontFormat(fcmt)
                if cfmt.size &gt; self._max_font_size:
                    self._max_font_size = cfmt.size
                if ideal_width &lt; <a id="change">cfmt.br.width()</a>:
                    ideal_width = cfmt.br.width()
                charfmt_lst.append(cfmt)
                text_len = fragment.length()</code></pre><h3>After Change</h3><pre><code class='java'>
                        ideal_width = w_

                if self.need_ideal_height:
                    h_ = <a id="change">cfmt.punc_rect(&quotfg&quot)[0]</a>.height()
                    if ideal_height &lt; h_:
                        ideal_height = h_
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/dmmaze/ballonstranslator/commit/d0b47afc065a72c97d7faa688aed5ec93542e9ac#diff-2280c33c620559afa2066016e28328873ed99c20b268e5a461f2eb9fdc1fb67cL188' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 81936088</div><div id='project'> Project Name: dmmaze/ballonstranslator</div><div id='commit'> Commit Name: d0b47afc065a72c97d7faa688aed5ec93542e9ac</div><div id='time'> Time: 2022-09-07</div><div id='author'> Author: beneathlimbo@gmail.com</div><div id='file'> File Name: ballontranslator/ui/scene_textlayout.py</div><div id='m_class'> M Class Name: SceneTextLayout</div><div id='n_method'> N Class Name: SceneTextLayout</div><div id='m_method'> M Method Name: documentChanged(4)</div><div id='n_method'> N Method Name: documentChanged(4)</div><div id='m_parent_class'> M Parent Class: QAbstractTextDocumentLayout</div><div id='n_parent_class'> N Parent Class: QAbstractTextDocumentLayout</div><div id='m_file'> M File Name: ballontranslator/ui/scene_textlayout.py</div><div id='n_file'> N File Name: ballontranslator/ui/scene_textlayout.py</div><div id='m_start'> M Start Line: 204</div><div id='m_end'> M End Line: 209</div><div id='n_start'> N Start Line: 198</div><div id='n_end'> N End Line: 232</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                        xoff += cfmt.br.width() - pun_tbr.width()
                    line.draw(painter, QPointF(xoff, yoff), o)
                else:
                    yoff = line.naturalTextWidth() - <a id="change">cfmt.br.width()</a>
                    line.draw(painter, QPointF(-yoff, -cfmt.tbr.top() - fm.ascent() + yoff), o)
                        
            block = block.next()
        </code></pre><h3>After Change</h3><pre><code class='java'>
                    act_rect = cfmt.punc_actual_rect(line, char, cache=True)
                    &#47&#47 yoff = 0
                    &#47&#47 yoff = pun_br.top() - pun_tbr.top()
                    yoff = -<a id="change">act_rect[1]</a>
                    xoff = -pun_tbr.left()
                    yoff += self.draw_shifted
                    &#47&#47 xoff -= self.draw_shifted
                    if num_lspaces &gt; 0:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/dmmaze/ballonstranslator/commit/eab989632c95aef750234d6d12c634e58acccd8b#diff-2280c33c620559afa2066016e28328873ed99c20b268e5a461f2eb9fdc1fb67cL198' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 81936089</div><div id='project'> Project Name: dmmaze/ballonstranslator</div><div id='commit'> Commit Name: eab989632c95aef750234d6d12c634e58acccd8b</div><div id='time'> Time: 2022-08-29</div><div id='author'> Author: beneathlimbo@gmail.com</div><div id='file'> File Name: ballontranslator/ui/scene_textlayout.py</div><div id='m_class'> M Class Name: VerticalTextDocumentLayout</div><div id='n_method'> N Class Name: VerticalTextDocumentLayout</div><div id='m_method'> M Method Name: draw(3)</div><div id='n_method'> N Method Name: draw(3)</div><div id='m_parent_class'> M Parent Class: SceneTextLayout</div><div id='n_parent_class'> N Parent Class: SceneTextLayout</div><div id='m_file'> M File Name: ballontranslator/ui/scene_textlayout.py</div><div id='n_file'> N File Name: ballontranslator/ui/scene_textlayout.py</div><div id='m_start'> M Start Line: 221</div><div id='m_end'> M End Line: 288</div><div id='n_start'> N Start Line: 276</div><div id='n_end'> N End Line: 352</div><BR>