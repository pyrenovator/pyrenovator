<html><h3>Pattern ID :4390
</h3><img src='16172966.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    data_path = os.path.join(os.path.dirname(__file__), os.environ.get(&quotJINA_DATA_FILE&quot, None))
    &#47&#47import glob
    with f, open(data_path) as fp:
        <a id="change">print(f&quottype: {type(fp)}&quot</a><a id="change">)</a>
        print(f&quotlines: {type(np.array(fp.readlines()))}&quot)
        d = Document.from_ndarray(np.array(fp.readlines()))
        num_docs = min(num_docs, len(fp.readlines()))
        with TimeContext(f&quotQPS: indexing {num_docs}&quot, logger=f.logger):</code></pre><h3>After Change</h3><pre><code class='java'>
            print(f&quotdddddd {dd}&quot)
        with TimeContext(f&quotQPS: indexing {num_docs}&quot, logger=f.logger):
            &#47&#47f.post(on=&quot/index&quot, request_size=16, docs=d, parameters={&quotsource_path&quot: &quot./data&quot}, inputs=d)
            <a id="change">f.index(</a>d<a id="change">)</a>
            &#47&#47f.search()
            &quot&quot&quot
            
            metas = {&quotworkspace&quot: &quot./workspace&quot}, parameters = {&quotsource_path&quot: &quot./workspace&quot,</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 2</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/jina-ai/examples/commit/5a64b61e836d0126f174b465dbe6ce30c0dbba61#diff-def4447edc2667e78227e0f5fee5b0c63664208309581a18e50eb887dee324b7L37' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16172966</div><div id='project'> Project Name: jina-ai/examples</div><div id='commit'> Commit Name: 5a64b61e836d0126f174b465dbe6ce30c0dbba61</div><div id='time'> Time: 2021-05-21</div><div id='author'> Author: zhuoran2@andrew.cmu.edu</div><div id='file'> File Name: wikipedia-sentences/app.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: index(1)</div><div id='n_method'> N Method Name: index(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: wikipedia-sentences/app.py</div><div id='n_file'> N File Name: wikipedia-sentences/app.py</div><div id='m_start'> M Start Line: 37</div><div id='m_end'> M End Line: 55</div><div id='n_start'> N Start Line: 40</div><div id='n_end'> N End Line: 75</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        src_ids = X[:, 0, 0].squeeze().tolist()  &#47&#47 (1, 2, 2, L) -&gt; (1, L) -&gt; (L) -&gt; list
        pred_ids = transformer.predict(X).squeeze().tolist()  &#47&#47 (1, L) -&gt; (L) -&gt; list
        print([tokenizer.id_to_token(src_id) for src_id in src_ids])
        <a id="change">print("-&gt;"</a><a id="change">)</a>
        print([tokenizer.id_to_token(pred_id) for pred_id in pred_ids])


if __name__ == &quot__main__&quot:</code></pre><h3>After Change</h3><pre><code class='java'>
        X = InferInputsBuilder(tokenizer, config[&quotmax_length&quot])(srcs=[config[&quotkor&quot]])
        src_ids = X[0, 0, 0].tolist()  &#47&#47 (1, 2, 2, L) -&gt; (L) -&gt; list
        pred_ids = transformer.predict(X).squeeze().tolist()  &#47&#47 (1, L) -&gt; (L) -&gt; list
        pred_ids = pred_ids[: <a id="change">pred_ids.index(</a>tokenizer.eos_token_id<a id="change">)</a>]  &#47&#47 noqa
        print(tokenizer.decode(ids=src_ids), "-&gt;", tokenizer.decode(ids=pred_ids))

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/eubinecto/the-clean-transformer/commit/fec218b75568e8fe876d9015cb2cd186661303ef#diff-f5ca89baf936662ded1038bd077b9fdbd9e3d91f08158fc90300fa289f534c45L7' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16172964</div><div id='project'> Project Name: eubinecto/the-clean-transformer</div><div id='commit'> Commit Name: fec218b75568e8fe876d9015cb2cd186661303ef</div><div id='time'> Time: 2021-12-11</div><div id='author'> Author: eubinecto</div><div id='file'> File Name: main_infer.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: main_infer.py</div><div id='n_file'> N File Name: main_infer.py</div><div id='m_start'> M Start Line: 13</div><div id='m_end'> M End Line: 26</div><div id='n_start'> N Start Line: 17</div><div id='n_end'> N End Line: 24</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    results = plot_util.load_results(dirs, names=qualities + [xlabel],
                                     enable_monitor=False, x_bound=[xlabel, x_bound], use_buf=use_buf)
    <a id="change">print("---- load dataset --- "</a><a id="change">)</a>
    &#47&#47 y_names = [&quotacc/adjusted_r2&quot, &quotacc/accurancy_trans&quot]
    &#47&#47 eval_policy/coupon_avg_rate
    &#47&#47 postfixs = [&quotcoupon_avg_rate&quot, &quotcoupon_predict_rate&quot, &quotroi_avg&quot, &quotroi_predict&quot, &quotsum_avg_gmv&quot, &quotsum_fos&quot,
    &#47&#47             &quotsum_predict_gmv&quot, &quotsum_spend&quot]</code></pre><h3>After Change</h3><pre><code class='java'>
        misc_scale_index = []
    for i in range(len(qualities)):
        if i in misc_scale_index:
            scale_dict[qualities[i]] = misc_scale[<a id="change">misc_scale_index.index(</a>i<a id="change">)</a>]
        else:
            scale_dict[qualities[i]] = 1
    _, _, lgd, texts = plot_util.plot_results(results, xy_fn= lambda r, y_names: csv_to_xy(r, DEFAULT_X_NAME, y_names,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/xionghuichen/rlassistant/commit/c960619032588e7490bfcecc6c8aa20a04a0bddf#diff-a8c3aff055596448cd598dd02c9f760327d2126ed0fb81a01e0173d529481ddbL91' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16172963</div><div id='project'> Project Name: xionghuichen/rlassistant</div><div id='commit'> Commit Name: c960619032588e7490bfcecc6c8aa20a04a0bddf</div><div id='time'> Time: 2020-12-21</div><div id='author'> Author: zpcxh95@outlook.com</div><div id='file'> File Name: RLA/easy_plot/plot_func.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: plot_res_func(17)</div><div id='n_method'> N Method Name: plot_res_func(19)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: RLA/easy_plot/plot_func.py</div><div id='n_file'> N File Name: RLA/easy_plot/plot_func.py</div><div id='m_start'> M Start Line: 91</div><div id='m_end'> M End Line: 173</div><div id='n_start'> N Start Line: 95</div><div id='n_end'> N End Line: 150</div><BR>