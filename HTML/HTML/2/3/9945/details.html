<html><h3>Pattern ID :9945
</h3><img src='35592525.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 pipeline i.e. self._counter: Dict[str, int]
        self._counter = {}

        <a id="change">super().__init__()</a>

    def __str__(self):
        return (
            f"{self.__class__.__name__}(port={self.port}, text_log_save_dir="</code></pre><h3>After Change</h3><pre><code class='java'>

        self.port = port
        self.text_log_save_frequency = text_log_save_frequency
        self.text_log_file_path = <a id="change">os.path.join(
            </a>text_log_save_dir, text_log_file_name or "prometheus_logs.prom"<a id="change">
        )</a>
        self._prometheus_metrics = defaultdict(str)

        self._setup_client()
        self._counter = 0</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/neuralmagic/deepsparse/commit/52ee5009542ebd63798ae25be3e82ed79d90a216#diff-ccc557acf5d3cbbc788c496ce9869d54794f087debe65beb6deb4cb12a2fcffdL49' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 35592525</div><div id='project'> Project Name: neuralmagic/deepsparse</div><div id='commit'> Commit Name: 52ee5009542ebd63798ae25be3e82ed79d90a216</div><div id='time'> Time: 2022-11-16</div><div id='author'> Author: 97082108+dbogunowicz@users.noreply.github.com</div><div id='file'> File Name: src/deepsparse/loggers/prometheus_logger.py</div><div id='m_class'> M Class Name: PrometheusLogger</div><div id='n_method'> N Class Name: PrometheusLogger</div><div id='m_method'> M Method Name: __init__(5)</div><div id='n_method'> N Method Name: __init__(5)</div><div id='m_parent_class'> M Parent Class: BaseLogger</div><div id='n_parent_class'> N Parent Class: BaseLogger</div><div id='m_file'> M File Name: src/deepsparse/loggers/prometheus_logger.py</div><div id='n_file'> N File Name: src/deepsparse/loggers/prometheus_logger.py</div><div id='m_start'> M Start Line: 49</div><div id='m_end'> M End Line: 65</div><div id='n_start'> N Start Line: 67</div><div id='n_end'> N End Line: 81</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

class MyDataset(BaseDataset):
    def __init__(self, data_paths: dict, mode=&quottrain&quot):
        <a id="change">super().__init__(</a>ImageDataset, data_paths, mode<a id="change">)</a>

class MyDataLoader(BaseDataLoader):
    pass
</code></pre><h3>After Change</h3><pre><code class='java'>
class MyDataset(Dataset):
    def __init__(self, data_dir=&quot./data&quot, label_path=None, mode=&quottrain&quot):
        &#47&#47 read filenames
        img_files = <a id="change">os.path.join(</a>data_dir, &quot*.png&quot<a id="change">)</a>
        self.filenames = glob.glob(img_files)

        self.label_path = label_path
        if label_path is not None:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/deeperlearner/pytorch-template/commit/662aa3e639fc5ff861fc47d269afc1fcd379973d#diff-1cf7685b2b46fb7a7a88faf2dd447faf9b0f85db6b220538b59c19599ab0b51bL55' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 35592524</div><div id='project'> Project Name: deeperlearner/pytorch-template</div><div id='commit'> Commit Name: 662aa3e639fc5ff861fc47d269afc1fcd379973d</div><div id='time'> Time: 2021-01-31</div><div id='author'> Author: b04202035@g.ntu.edu.tw</div><div id='file'> File Name: data_loader/data_loader.py</div><div id='m_class'> M Class Name: MyDataset</div><div id='n_method'> N Class Name: MyDataset</div><div id='m_method'> M Method Name: __init__(4)</div><div id='n_method'> N Method Name: __init__(3)</div><div id='m_parent_class'> M Parent Class: Dataset</div><div id='n_parent_class'> N Parent Class: BaseDataset</div><div id='m_file'> M File Name: data_loader/data_loader.py</div><div id='n_file'> N File Name: data_loader/data_loader.py</div><div id='m_start'> M Start Line: 55</div><div id='m_end'> M End Line: 56</div><div id='n_start'> N Start Line: 13</div><div id='n_end'> N End Line: 33</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        return self.model(img.to(self.device))

    def postprocess(self, inference_output):
        <a id="change">super().__init__(</a>inference_output<a id="change">)</a>


_service = DBTextDetectionHandler()
</code></pre><h3>After Change</h3><pre><code class='java'>
            prob_mask = (pred[0] * 255).astype(np.uint8)
            thresh_mask = (pred[1] * 255).astype(np.uint8)
            imageio.imwrite(os.path.join(self.tmp_dir, "foo1.jpg"), prob_mask)
            imageio.imwrite(<a id="change">os.path.join(</a>self.tmp_dir, "foo2.jpg"<a id="change">)</a>,
                            thresh_mask)
            prob_mask = prob_mask.tolist()
            thresh_mask = thresh_mask.tolist()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huyhoang17/db_text_minimal/commit/f4f4a579c2735d4894dbd7a518d7edd3a380158c#diff-23e40717902653b44405c831cc5ac56fe774efaa8f789e81c8899bc3a325fd3bL71' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 35592523</div><div id='project'> Project Name: huyhoang17/db_text_minimal</div><div id='commit'> Commit Name: f4f4a579c2735d4894dbd7a518d7edd3a380158c</div><div id='time'> Time: 2020-06-17</div><div id='author'> Author: hoangphan0710@gmail.com</div><div id='file'> File Name: src/db_handler.py</div><div id='m_class'> M Class Name: DBTextDetectionHandler</div><div id='n_method'> N Class Name: DBTextDetectionHandler</div><div id='m_method'> M Method Name: postprocess(2)</div><div id='n_method'> N Method Name: postprocess(2)</div><div id='m_parent_class'> M Parent Class: BaseHandler</div><div id='n_parent_class'> N Parent Class: BaseHandler</div><div id='m_file'> M File Name: src/db_handler.py</div><div id='n_file'> N File Name: src/db_handler.py</div><div id='m_start'> M Start Line: 72</div><div id='m_end'> M End Line: 72</div><div id='n_start'> N Start Line: 95</div><div id='n_end'> N End Line: 107</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

class EasyTraining(_BaseEasyTraining):
    def __init__(self, cfg, nn: NNInterface):
        <a id="change">super(EasyTraining, self).__init__(</a>cfg, nn<a id="change">)</a>
        &#47&#47 resume
        if os.path.isdir(self.ckpt_save_dir):
            self._load_model_resume()
        else:</code></pre><h3>After Change</h3><pre><code class='java'>
        self.start_epoch = 0

        self.model_name = cfg.MODEL.NAME
        self.ckpt_save_dir = <a id="change">os.path.join(</a>cfg.TRAIN.CKPT_SAVE_DIR, config_md5(cfg)<a id="change">)</a>
        self.over_write_ckpt = cfg.TRAIN.OVERWRITE_CKPT

        self.nn = nn
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/cnstark/easytorch/commit/fd8e183939cf02b2361cddb4bb318a457da0534a#diff-3734d9a10d4a21d1a70b5559593b2ee4a83d7e08aac0331004ca4ba1067e8af6L171' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 35592521</div><div id='project'> Project Name: cnstark/easytorch</div><div id='commit'> Commit Name: fd8e183939cf02b2361cddb4bb318a457da0534a</div><div id='time'> Time: 2021-04-14</div><div id='author'> Author: 45590791+cnstark@users.noreply.github.com</div><div id='file'> File Name: easytraining.py</div><div id='m_class'> M Class Name: EasyTraining</div><div id='n_method'> N Class Name: EasyTraining</div><div id='m_method'> M Method Name: __init__(3)</div><div id='n_method'> N Method Name: __init__(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: _BaseEasyTraining</div><div id='m_file'> M File Name: easytraining.py</div><div id='n_file'> N File Name: easytraining.py</div><div id='m_start'> M Start Line: 172</div><div id='m_end'> M End Line: 201</div><div id='n_start'> N Start Line: 20</div><div id='n_end'> N End Line: 76</div><BR>