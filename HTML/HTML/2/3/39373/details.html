<html><h3>Pattern ID :39373
</h3><img src='111795273.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            spm = pd.read_feather(spm_fname)

        wl.index = pd.to_datetime(wl.pop(&quotindex&quot))
        spm.index = pd.to_datetime(<a id="change">spm.pop(</a>&quotindex&quot<a id="change">)</a>)

        return wl[st:en], spm[st:en]
</code></pre><h3>After Change</h3><pre><code class='java'>
        spm_fname = os.path.join(self.ds_dir, &quothydro&quot, &quotspm.nc&quot)
        if not os.path.exists(wl_fname):
            print("reading data from xlsx files and saving them in netcdf format.")
            <a id="change">print("This will happen only once but will save io time."</a><a id="change">)</a>
            files = glob.glob(f"{os.path.join(self.ds_dir, &quothydro&quot)}/*.xlsx")
            wl = pd.DataFrame()
            spm = pd.DataFrame()
            for f in files:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 6</div><BR><div id='size'>Non-data size: 2</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/atrcheema/dl4seq/commit/010fbe51c1ccf4305e1811558e8e0e2123274ac4#diff-8245caa308efbee7a234224040dca29c35af38103f9931c96f66a8e435e88e08L1017' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111795273</div><div id='project'> Project Name: atrcheema/dl4seq</div><div id='commit'> Commit Name: 010fbe51c1ccf4305e1811558e8e0e2123274ac4</div><div id='time'> Time: 2021-08-30</div><div id='author'> Author: ather_abbas786@yahoo.com</div><div id='file'> File Name: ai4water/utils/datasets/datasets.py</div><div id='m_class'> M Class Name: MtropicsLaos</div><div id='n_method'> N Class Name: MtropicsLaos</div><div id='m_method'> M Method Name: fetch_hydro(3)</div><div id='n_method'> N Method Name: fetch_hydro(3)</div><div id='m_parent_class'> M Parent Class: Datasets</div><div id='n_parent_class'> N Parent Class: Datasets</div><div id='m_file'> M File Name: ai4water/utils/datasets/datasets.py</div><div id='n_file'> N File Name: ai4water/utils/datasets/datasets.py</div><div id='m_start'> M Start Line: 1017</div><div id='m_end'> M End Line: 1052</div><div id='n_start'> N Start Line: 1036</div><div id='n_end'> N End Line: 1070</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        ic(len(keys_train), len(keys_valid), len(keys_test))
        for k in keys_valid:
            ic(k)
            grp_valid.copy(<a id="change">grp_train.pop(</a>k<a id="change">)</a>, dest=k)
        for k in keys_test:
            ic(k)
            grp_test.copy(grp_train.pop(k), dest=k)</code></pre><h3>After Change</h3><pre><code class='java'>
        keys_train, keys_valid, keys_test = np.split(np.random.permutation(keys), sections)
        ic(len(keys_train), len(keys_valid), len(keys_test))
        for k in keys_train:
            <a id="change">print("train"</a>, k<a id="change">)</a>
            grp_train_new.copy(grp_train[k], dest=k)
        for k in keys_valid:
            print("valid", k)
            grp_valid.copy(grp_train[k], dest=k)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/rikorose/deepfilternet/commit/a9cbd9e8b6acc875d98195000cc5da7629dbebe3#diff-e989f34a58ed3796de4ca633898df05a3d6a74d753902e6d951b544873063339L15' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111795256</div><div id='project'> Project Name: rikorose/deepfilternet</div><div id='commit'> Commit Name: a9cbd9e8b6acc875d98195000cc5da7629dbebe3</div><div id='time'> Time: 2022-04-12</div><div id='author'> Author: h.schroeter@pm.me</div><div id='file'> File Name: DeepFilterNet/df/scripts/split_hdf5.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(2)</div><div id='n_method'> N Method Name: main(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: DeepFilterNet/df/scripts/split_hdf5.py</div><div id='n_file'> N File Name: DeepFilterNet/df/scripts/split_hdf5.py</div><div id='m_start'> M Start Line: 33</div><div id='m_end'> M End Line: 48</div><div id='n_start'> N Start Line: 22</div><div id='n_end'> N End Line: 56</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        for i in range(len(client_features) - 1, -1, -1):
            if i in self.lazy_worker_list:
                <a id="change">raw_client_grad_list.pop(</a>i<a id="change">)</a>
            elif i not in self.potentially_poisoned_worker_list:
                self.client_cache[i] = client_features[i]
        return raw_client_grad_list
</code></pre><h3>After Change</h3><pre><code class='java'>
            client_features, global_model_feature
        )
        print(f"client_wise_scores = {client_wise_scores}")
        <a id="change">print(f"global_wise_scores = {global_wise_scores}"</a><a id="change">)</a>

        for i in range(len(client_wise_scores)):
            if (
                    client_wise_scores[i] &lt; self.lowerbound</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/fedml-ai/fedml/commit/6e38f5c840378693e9643065a302ba9b6bffb2ff#diff-f2d67f9b9cfccb2f0cf84e165d29c3eb6c43fe99d598355920567ac52e30aa9dL37' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111795274</div><div id='project'> Project Name: fedml-ai/fedml</div><div id='commit'> Commit Name: 6e38f5c840378693e9643065a302ba9b6bffb2ff</div><div id='time'> Time: 2022-11-07</div><div id='author'> Author: sshan0731@hotmail.com</div><div id='file'> File Name: python/fedml/core/security/defense/cross_round_defense.py</div><div id='m_class'> M Class Name: CrossRoundDefense</div><div id='n_method'> N Class Name: CrossRoundDefense</div><div id='m_method'> M Method Name: defend_before_aggregation(3)</div><div id='n_method'> N Method Name: defend_before_aggregation(3)</div><div id='m_parent_class'> M Parent Class: BaseDefenseMethod</div><div id='n_parent_class'> N Parent Class: BaseDefenseMethod</div><div id='m_file'> M File Name: python/fedml/core/security/defense/cross_round_defense.py</div><div id='n_file'> N File Name: python/fedml/core/security/defense/cross_round_defense.py</div><div id='m_start'> M Start Line: 42</div><div id='m_end'> M End Line: 72</div><div id='n_start'> N Start Line: 44</div><div id='n_end'> N End Line: 82</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        sequence_input = torch.cat([sequence_input, pos_enc], -1)
        if not sequence_input.requires_grad:
            return (None,) * 11
        out0, out1 = <a id="change">ctx.output_list.pop(</a>0<a id="change">)</a>.chunk(2, 1)
        with torch.no_grad():
            inp0 = out0 - ReversibleRNNFunction._calc(out1, sequence_input, bn_weight1, bn_bias1, linear_param1)
            inp1 = out1 - ReversibleRNNFunction._calc(inp0, sequence_input, bn_weight0, bn_bias0, linear_param0)</code></pre><h3>After Change</h3><pre><code class='java'>
        fn_input.requires_grad_(True)
        if not ctx.top:
            ctx.output_list.append(fn_input)
        <a id="change">print("OUT"</a><a id="change">)</a>
        return tuple(grad_out) + (None, None)


class RevRNN(torch.nn.Module):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/homebrewnlp/homebrewnlp/commit/4e76dd34dd5e959cd50e4e7384d9a877686ee5c3#diff-c98bba8dbdd18eb4e9fa8ae11c28e350c08ee816fce50f9fb86d61cbcd345276L49' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111795279</div><div id='project'> Project Name: homebrewnlp/homebrewnlp</div><div id='commit'> Commit Name: 4e76dd34dd5e959cd50e4e7384d9a877686ee5c3</div><div id='time'> Time: 2020-07-15</div><div id='author'> Author: 39779310+ClashLuke@users.noreply.github.com</div><div id='file'> File Name: module.py</div><div id='m_class'> M Class Name: ReversibleRNNFunction</div><div id='n_method'> N Class Name: ReversibleRNNFunction</div><div id='m_method'> M Method Name: backward(2)</div><div id='n_method'> N Method Name: backward(2)</div><div id='m_parent_class'> M Parent Class: torch.autograd.Function</div><div id='n_parent_class'> N Parent Class: torch.autograd.Function</div><div id='m_file'> M File Name: module.py</div><div id='n_file'> N File Name: module.py</div><div id='m_start'> M Start Line: 51</div><div id='m_end'> M End Line: 70</div><div id='n_start'> N Start Line: 62</div><div id='n_end'> N End Line: 89</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                not self.to_keep_higher_scores and client_scores[i] &gt; self.upper_bound
            ) or (self.to_keep_higher_scores and client_scores[i] &lt; self.lower_bound):
                &#47&#47 we do not remove the score in self.score_list to avoid mis-deleting due to severe non-iid among clients
                <a id="change">raw_client_grad_list.pop(</a>i<a id="change">)</a>
                print(f"pop -- i = {i}")
        return raw_client_grad_list

    def compute_gaussian_distribution(self):</code></pre><h3>After Change</h3><pre><code class='java'>
        print(f"client scores = {client_scores}")
        mu, sigma = compute_gaussian_distribution(client_scores)
        self.upper_bound = mu + self.bound_param * sigma
        <a id="change">print(f"mu = {mu}, sigma = {sigma}, upperbound = {self.upper_bound}"</a><a id="change">)</a>
        new_client_models, _ = self.kick_out_poisoned_local_models(client_scores, raw_client_grad_list)
        importance_feature_list = self._get_importance_feature(new_client_models)
        alphas = [1 / len(importance_feature_list)] * len(importance_feature_list)
        self.median = compute_middle_point(alphas, importance_feature_list)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/fedml-ai/fedml/commit/0c00424b8658cf7b1d36fdf61146a5bee2465478#diff-70cf382fe695f6a8a80eeceb699773854944cd2ed6df4f50fde94cb85acba11fL52' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111795280</div><div id='project'> Project Name: fedml-ai/fedml</div><div id='commit'> Commit Name: 0c00424b8658cf7b1d36fdf61146a5bee2465478</div><div id='time'> Time: 2022-10-22</div><div id='author'> Author: sshan0731@hotmail.com</div><div id='file'> File Name: python/fedml/core/security/defense/three_sigma_krum_defense.py</div><div id='m_class'> M Class Name: ThreeSigmaKrumDefense</div><div id='n_method'> N Class Name: ThreeSigmaKrumDefense</div><div id='m_method'> M Method Name: defend_before_aggregation(3)</div><div id='n_method'> N Method Name: defend_before_aggregation(3)</div><div id='m_parent_class'> M Parent Class: BaseDefenseMethod</div><div id='n_parent_class'> N Parent Class: BaseDefenseMethod</div><div id='m_file'> M File Name: python/fedml/core/security/defense/three_sigma_krum_defense.py</div><div id='n_file'> N File Name: python/fedml/core/security/defense/three_sigma_krum_defense.py</div><div id='m_start'> M Start Line: 57</div><div id='m_end'> M End Line: 77</div><div id='n_start'> N Start Line: 55</div><div id='n_end'> N End Line: 65</div><BR>