<html><h3>Pattern ID :23043
</h3><img src='73041518.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        cli_logger.print("Successfully created subnet: cloudtik-{}-subnet ...".format(config["workspace_name"]))
    except Exception as e:
        cli_logger.verbose_error("{}", str(e))
        <a id="change">cli_logger.abort(
            "Failed to create subnet. Please check whether the CIDR has conflict with other subnets."</a><a id="change">)</a>
    return subnet


def _create_and_configure_subnets(config, vpc):</code></pre><h3>After Change</h3><pre><code class='java'>
        cli_logger.print("Successfully created subnet: cloudtik-{}-subnet ...".format(config["workspace_name"]))
    except Exception as e:
        cli_logger.error("Failed to create subnet. {}", str(e))
        <a id="change">raise </a>e
    return subnet

</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 6</div><BR><div id='size'>Non-data size: 2</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/oap-project/cloudtik/commit/eacde9fb2ba1f6990059d618ec3af513a05199de#diff-6bc435e611884584db2ccdc83cfbee08f96ec899c0349bc431aa30cffa476ef2L793' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 73041518</div><div id='project'> Project Name: oap-project/cloudtik</div><div id='commit'> Commit Name: eacde9fb2ba1f6990059d618ec3af513a05199de</div><div id='time'> Time: 2022-03-28</div><div id='author'> Author: haifeng.chen@intel.com</div><div id='file'> File Name: python/cloudtik/providers/_private/aws/config.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _create_subnet(3)</div><div id='n_method'> N Method Name: _create_subnet(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: python/cloudtik/providers/_private/aws/config.py</div><div id='n_file'> N File Name: python/cloudtik/providers/_private/aws/config.py</div><div id='m_start'> M Start Line: 793</div><div id='m_end'> M End Line: 794</div><div id='n_start'> N Start Line: 798</div><div id='n_end'> N End Line: 798</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    except Exception as e:
        cli_logger.verbose_error("{}", str(e))
        <a id="change">cli_logger.abort(
            "Failed to create workspace. Please check the error."</a><a id="change">)</a>

    cli_logger.print(
        "Successfully created workspace: {}.",
        cf.bold(workspace_name))</code></pre><h3>After Change</h3><pre><code class='java'>

    except Exception as e:
        cli_logger.error("Failed to create workspace. {}", str(e))
        <a id="change">raise </a>e

    cli_logger.print(
        "Successfully created workspace: {}.",</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/oap-project/cloudtik/commit/eacde9fb2ba1f6990059d618ec3af513a05199de#diff-6bc435e611884584db2ccdc83cfbee08f96ec899c0349bc431aa30cffa476ef2L923' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 73041519</div><div id='project'> Project Name: oap-project/cloudtik</div><div id='commit'> Commit Name: eacde9fb2ba1f6990059d618ec3af513a05199de</div><div id='time'> Time: 2022-03-28</div><div id='author'> Author: haifeng.chen@intel.com</div><div id='file'> File Name: python/cloudtik/providers/_private/aws/config.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _configure_vpc(1)</div><div id='n_method'> N Method Name: _configure_vpc(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: python/cloudtik/providers/_private/aws/config.py</div><div id='n_file'> N File Name: python/cloudtik/providers/_private/aws/config.py</div><div id='m_start'> M Start Line: 972</div><div id='m_end'> M End Line: 973</div><div id='n_start'> N Start Line: 971</div><div id='n_end'> N End Line: 971</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    except Exception as e:
        &#47&#47 todo: add better exception info
        cli_logger.verbose_error("{}", str(e))
        <a id="change">cli_logger.abort(
            "Failed to create workspace VPC. Please check weather you have reach the maximum number of VPCs."</a><a id="change">)</a>
    return vpc


def _create_subnet(config, cidr,  vpc):</code></pre><h3>After Change</h3><pre><code class='java'>
        cli_logger.print("Successfully created workspace VPC: cloudtik-{}-vpc ...".format(config["workspace_name"]))
    except Exception as e:
        cli_logger.error("Failed to create workspace VPC. {}", str(e))
        <a id="change">raise </a>e

    return vpc
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/oap-project/cloudtik/commit/eacde9fb2ba1f6990059d618ec3af513a05199de#diff-6bc435e611884584db2ccdc83cfbee08f96ec899c0349bc431aa30cffa476ef2L769' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 73041522</div><div id='project'> Project Name: oap-project/cloudtik</div><div id='commit'> Commit Name: eacde9fb2ba1f6990059d618ec3af513a05199de</div><div id='time'> Time: 2022-03-28</div><div id='author'> Author: haifeng.chen@intel.com</div><div id='file'> File Name: python/cloudtik/providers/_private/aws/config.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _create_vpc(2)</div><div id='n_method'> N Method Name: _create_vpc(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: python/cloudtik/providers/_private/aws/config.py</div><div id='n_file'> N File Name: python/cloudtik/providers/_private/aws/config.py</div><div id='m_start'> M Start Line: 781</div><div id='m_end'> M End Line: 782</div><div id='n_start'> N Start Line: 786</div><div id='n_end'> N End Line: 786</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                "Found an existing NAT Gateway. Will use this one")
        except Exception as e:
            cli_logger.verbose_error("{}", str(e))
            <a id="change">cli_logger.abort(
                "Failed to create NAT Gateway. "
                "Please check weather you have reach the maximum number of NAT Gateways."</a><a id="change">)</a>
    return nat_gw


def _update_route_table_for_public_subnet(config, ec2, ec2_client, vpc, subnet, igw):</code></pre><h3>After Change</h3><pre><code class='java'>
            cli_logger.print(
                "Found an existing NAT Gateway. Will use this one")
        except Exception:
            <a id="change">raise </a>e

    return nat_gw
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/oap-project/cloudtik/commit/eacde9fb2ba1f6990059d618ec3af513a05199de#diff-6bc435e611884584db2ccdc83cfbee08f96ec899c0349bc431aa30cffa476ef2L859' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 73041523</div><div id='project'> Project Name: oap-project/cloudtik</div><div id='commit'> Commit Name: eacde9fb2ba1f6990059d618ec3af513a05199de</div><div id='time'> Time: 2022-03-28</div><div id='author'> Author: haifeng.chen@intel.com</div><div id='file'> File Name: python/cloudtik/providers/_private/aws/config.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _create_nat_gateway(4)</div><div id='n_method'> N Method Name: _create_nat_gateway(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: python/cloudtik/providers/_private/aws/config.py</div><div id='n_file'> N File Name: python/cloudtik/providers/_private/aws/config.py</div><div id='m_start'> M Start Line: 873</div><div id='m_end'> M End Line: 884</div><div id='n_start'> N Start Line: 874</div><div id='n_end'> N End Line: 882</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            cli_logger.print("Existing internet gateway found. Will use this one.")
        except Exception as e:
            cli_logger.verbose_error("{}", str(e))
            <a id="change">cli_logger.abort(
                "Failed to create Internet Gateway. "
                "Please check whether you have reach the maximum number of Internet Gateway."</a><a id="change">)</a>
    return igw


def _create_elastic_ip(ec2_client):</code></pre><h3>After Change</h3><pre><code class='java'>
            igw = igws[0]
            cli_logger.print("Existing internet gateway found. Will use this one.")
        except Exception:
            <a id="change">raise </a>e
    return igw

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/oap-project/cloudtik/commit/eacde9fb2ba1f6990059d618ec3af513a05199de#diff-6bc435e611884584db2ccdc83cfbee08f96ec899c0349bc431aa30cffa476ef2L818' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 73041520</div><div id='project'> Project Name: oap-project/cloudtik</div><div id='commit'> Commit Name: eacde9fb2ba1f6990059d618ec3af513a05199de</div><div id='time'> Time: 2022-03-28</div><div id='author'> Author: haifeng.chen@intel.com</div><div id='file'> File Name: python/cloudtik/providers/_private/aws/config.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _create_internet_gateway(3)</div><div id='n_method'> N Method Name: _create_internet_gateway(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: python/cloudtik/providers/_private/aws/config.py</div><div id='n_file'> N File Name: python/cloudtik/providers/_private/aws/config.py</div><div id='m_start'> M Start Line: 826</div><div id='m_end'> M End Line: 836</div><div id='n_start'> N Start Line: 830</div><div id='n_end'> N End Line: 837</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        vpc_resource.delete()
    except Exception as e:
        cli_logger.verbose_error("{}", str(e))
        <a id="change">cli_logger.abort(
            "Please remove its dependencies and delete the VPC manually."</a><a id="change">)</a>
    return


def _create_vpc(config,  ec2):</code></pre><h3>After Change</h3><pre><code class='java'>
        vpc_resource.delete()
    except Exception as e:
        cli_logger.error("Failed to delete VPC. {}", str(e))
        <a id="change">raise </a>e
    return

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/oap-project/cloudtik/commit/eacde9fb2ba1f6990059d618ec3af513a05199de#diff-6bc435e611884584db2ccdc83cfbee08f96ec899c0349bc431aa30cffa476ef2L751' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 73041521</div><div id='project'> Project Name: oap-project/cloudtik</div><div id='commit'> Commit Name: eacde9fb2ba1f6990059d618ec3af513a05199de</div><div id='time'> Time: 2022-03-28</div><div id='author'> Author: haifeng.chen@intel.com</div><div id='file'> File Name: python/cloudtik/providers/_private/aws/config.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _delete_vpc(3)</div><div id='n_method'> N Method Name: _delete_vpc(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: python/cloudtik/providers/_private/aws/config.py</div><div id='n_file'> N File Name: python/cloudtik/providers/_private/aws/config.py</div><div id='m_start'> M Start Line: 764</div><div id='m_end'> M End Line: 765</div><div id='n_start'> N Start Line: 771</div><div id='n_end'> N End Line: 771</div><BR>