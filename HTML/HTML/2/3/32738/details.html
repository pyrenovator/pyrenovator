<html><h3>Pattern ID :32738
</h3><img src='95117385.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        sentence_with_prompt = IE_PATTERN.format(sentence)
        pre_history.append((
            f&quot{sentence_with_prompt}&quot,
            <a id="change">json.dumps(</a>example[&quotanswers&quot]<a id="change">, ensure_ascii=False)</a>
        ))

    return {&quotpre_history&quot: pre_history}
</code></pre><h3>After Change</h3><pre><code class='java'>
    for _type, exmpale in class_examples.items():
        cls_pre_history.append((f&quot“{exmpale}”是 {class_list} 里的什么类别？&quot, _type))

    ie_pre_history<a id="change"> = </a><a id="change">[
        </a>(
            "现在你需要帮助我完成信息抽取任务，当我给你一个句子时，你需要帮我抽取出句子中三元组，并按照JSON的格式输出，上述句子中没有的信息用[&quot原文中未提及&quot]来表示，多个值之间用&quot,&quot分隔。",
            &quot好的，请输入您的句子。&quot
        )<a id="change"></a>
    ]

    for _type, example_list in ie_examples.items():
        for example in example_list:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/harderthenharder/transformers_tasks/commit/72b407dd37f1ff96df7e778cd810437cafe138e9#diff-551c73d2e393c7b27999a12ff0e0f90679681ff1f5de29ad8c22539d1aa815d6L81' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 95117385</div><div id='project'> Project Name: harderthenharder/transformers_tasks</div><div id='commit'> Commit Name: 72b407dd37f1ff96df7e778cd810437cafe138e9</div><div id='time'> Time: 2023-03-19</div><div id='author'> Author: 1414463123@qq.com</div><div id='file'> File Name: LLM/llm_information_extraction.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: init_prompts(0)</div><div id='n_method'> N Method Name: init_prompts(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: LLM/llm_information_extraction.py</div><div id='n_file'> N File Name: LLM/llm_information_extraction.py</div><div id='m_start'> M Start Line: 81</div><div id='m_end'> M End Line: 96</div><div id='n_start'> N Start Line: 86</div><div id='n_end'> N End Line: 115</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        collected (list[data]): a list of data gathered from each rank
    
    world_size = get_world_size()
    total_size = len(bytearray(<a id="change">nncore.dumps(</a>data<a id="change">)</a>)) * world_size

    pynvml.nvmlInit()
    matched = False</code></pre><h3>After Change</h3><pre><code class='java'>
    size_list, tensor = _pad_tensors(tensor, group)
    max_size = max(size_list)

    tensor_list<a id="change"> = </a>[tensor.new_empty(<a id="change">[</a>max_size<a id="change"></a>]) for _ in size_list]
    dist.all_gather(tensor_list, tensor, group=group)

    gathered = []</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/yeliudev/nncore/commit/c60692996f4316b5befe701efbc18a9ad7cc7ac1#diff-fdf562e6b578fc92f4c74e59141f61b874fc8722e8eb5d843ef38c4c81d99321L47' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 95117390</div><div id='project'> Project Name: yeliudev/nncore</div><div id='commit'> Commit Name: c60692996f4316b5befe701efbc18a9ad7cc7ac1</div><div id='time'> Time: 2020-03-11</div><div id='author'> Author: goolhanrry@gmail.com</div><div id='file'> File Name: nncore/engine/comm.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: all_gather(2)</div><div id='n_method'> N Method Name: all_gather(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: nncore/engine/comm.py</div><div id='n_file'> N File Name: nncore/engine/comm.py</div><div id='m_start'> M Start Line: 47</div><div id='m_end'> M End Line: 78</div><div id='n_start'> N Start Line: 86</div><div id='n_end'> N End Line: 112</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        settings.MONAI_LABEL_APP_DIR,
        settings.MONAI_LABEL_STUDIES,
        method,
        <a id="change">json.dumps(</a>request<a id="change">)</a>,
    ]

    logger.info(f"COMMAND:: {&quot &quot.join(cmd)}")</code></pre><h3>After Change</h3><pre><code class='java'>
        my_env["MASTER_ADDR"] = "127.0.0.1"
        my_env["MASTER_PORT"] = "1234"

    cmd<a id="change"> = </a><a id="change">[
        </a>sys.executable,
        "-m",
        "monailabel.interfaces.utils.app",
        "-m",
        method,
        "-r",
        json.dumps(request, separators=(",", ":"))<a id="change"></a>,
    ]

    logger.info(f"COMMAND:: {&quot &quot.join(cmd)}")</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/project-monai/monailabel/commit/62c4207eaf8efe94cd8123b6470f672206f8ece3#diff-64b8e175a1b972125eda543982f707a6d9f3b5d5d2f2bab08b2c5b2c85c8be27L35' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 95117388</div><div id='project'> Project Name: project-monai/monailabel</div><div id='commit'> Commit Name: 62c4207eaf8efe94cd8123b6470f672206f8ece3</div><div id='time'> Time: 2021-10-17</div><div id='author'> Author: sachidanand.alle@gmail.com</div><div id='file'> File Name: monailabel/utils/async_tasks/utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _task_func(3)</div><div id='n_method'> N Method Name: _task_func(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: monailabel/utils/async_tasks/utils.py</div><div id='n_file'> N File Name: monailabel/utils/async_tasks/utils.py</div><div id='m_start'> M Start Line: 36</div><div id='m_end'> M End Line: 48</div><div id='n_start'> N Start Line: 33</div><div id='n_end'> N End Line: 55</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            data.append({ &quotuserId&quot: &quotno_user&quot, &quotrecs&quot: json.dumps([&quottest_rec_{}&quot.format(_) for _ in range(3)])})
            &#47&#47 loop over predictions and store them
            for idx in range(len(self.best_predictions)):
                data.append({ &quotuserId&quot: f&quotuser_{idx}&quot, &quotrecs&quot: <a id="change">json.dumps(</a>self.best_predictions[idx].tolist()<a id="change">)</a> })
            with table.batch_writer() as writer:
                for item in data:
                    writer.put_item(Item=item)</code></pre><h3>After Change</h3><pre><code class='java'>
            dynamodb = boto3.resource(&quotdynamodb&quot)
            table = dynamodb.Table(self.DYNAMO_TABLE)
            &#47&#47 upload some static items as a test
            data<a id="change"> = </a>[ <a id="change">{ </a>&quotuserId&quot: user, &quotrecs&quot: json.dumps(recs)<a id="change"> }</a> for user, recs in self.best_predictions.items()] 
            &#47&#47 finally add test user
            data.append({ &quotuserId&quot: &quotno_user&quot, &quotrecs&quot: json.dumps([&quottest_rec_{}&quot.format(_) for _ in range(self.TOP_K)])})
            &#47&#47 loop over predictions and store them in the table</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jacopotagliabue/recs-at-resonable-scale/commit/ddac0d119c488dae26df6f96470cea4fe366b927#diff-9b8fa700f21964aef76747038004e0ed38e07299e7c0adc81db033595dde7677L353' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 95117395</div><div id='project'> Project Name: jacopotagliabue/recs-at-resonable-scale</div><div id='commit'> Commit Name: ddac0d119c488dae26df6f96470cea4fe366b927</div><div id='time'> Time: 2022-07-19</div><div id='author'> Author: tagliabue.jacopo@gmail.com</div><div id='file'> File Name: src/my_merlin_flow.py</div><div id='m_class'> M Class Name: merlinFlow</div><div id='n_method'> N Class Name: merlinFlow</div><div id='m_method'> M Method Name: cache_predictions(1)</div><div id='n_method'> N Method Name: cache_predictions(1)</div><div id='m_parent_class'> M Parent Class: FlowSpec</div><div id='n_parent_class'> N Parent Class: FlowSpec</div><div id='m_file'> M File Name: src/my_merlin_flow.py</div><div id='n_file'> N File Name: src/my_merlin_flow.py</div><div id='m_start'> M Start Line: 371</div><div id='m_end'> M End Line: 377</div><div id='n_start'> N Start Line: 381</div><div id='n_end'> N End Line: 383</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                prefix = d.get(&quotadd_prefix_space&quot, &quot&quot)
                if &quotadd_prefix_space&quot in d:
                    d.pop(&quotadd_prefix_space&quot)
                output.append(prefix + <a id="change">json.dumps(</a>d<a id="change">)</a>)
        return &quot&quot.join(output)

</code></pre><h3>After Change</h3><pre><code class='java'>
                    output.append({"text": t, "add_prefix_space": d.get("add_prefix_space", "")})
                i = j + 1
            elif &quotmeta&quot in d and d[&quotmeta&quot] == &quotlabelword&quot:
                d_new<a id="change"> = </a><a id="change">{}</a>
                d_new["mask"] = None
                d_new["add_prefix_space"] = d["add_prefix_space"]
                output.append(d_new)
            else:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/thunlp/openprompt/commit/81705392bda249548dcd4ecf0086c6fae63b6d59#diff-0060b001b7bcb59bcad42e574d4b6d2e4b7a1b8fdea8d3082342eeb80c703efdL124' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 95117393</div><div id='project'> Project Name: thunlp/openprompt</div><div id='commit'> Commit Name: 81705392bda249548dcd4ecf0086c6fae63b6d59</div><div id='time'> Time: 2023-02-05</div><div id='author'> Author: yl-chen21@mails.tsinghua.edu.cn</div><div id='file'> File Name: openprompt/prompts/prompt_generator.py</div><div id='m_class'> M Class Name: TemplateGenerator</div><div id='n_method'> N Class Name: TemplateGenerator</div><div id='m_method'> M Method Name: convert_template(3)</div><div id='n_method'> N Method Name: convert_template(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: openprompt/prompts/prompt_generator.py</div><div id='n_file'> N File Name: openprompt/prompts/prompt_generator.py</div><div id='m_start'> M Start Line: 139</div><div id='m_end'> M End Line: 157</div><div id='n_start'> N Start Line: 139</div><div id='n_end'> N End Line: 159</div><BR>