<html><h3>Pattern ID :22602
</h3><img src='71385057.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        last_name = &quotgateway&quot
        for k, v in data._pod_nodes.items():
            <a id="change">if </a>k == &quotgateway&quot:
                <a id="change">continue</a>
            kwargs = {}
            &#47&#47 only add "needs" when the value is not the last pod name
            if list(v.needs) != [last_name]:
                kwargs = {&quotneeds&quot: list(v.needs)}</code></pre><h3>After Change</h3><pre><code class='java'>
                    kwargs.pop(t)
            if k == &quotgateway&quot:
                if &quotJINA_FULL_CLI&quot in os.environ:
                    <a id="change">r[&quotwith&quot].update(</a>kwargs<a id="change">)</a>
                else:
                    continue
            else:
                last_name = kwargs[&quotname&quot]</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/ca7375aa518f6a85627bf269da5d81bdfc9dc528#diff-3651932819469c65134c2d3c7e8c8e6d0808acfb70263070542a14eca3cdf9b9L82' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 71385057</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: ca7375aa518f6a85627bf269da5d81bdfc9dc528</div><div id='time'> Time: 2021-08-30</div><div id='author'> Author: deepankar.mahapatro@jina.ai</div><div id='file'> File Name: jina/jaml/parsers/flow/v1.py</div><div id='m_class'> M Class Name: V1Parser</div><div id='n_method'> N Class Name: V1Parser</div><div id='m_method'> M Method Name: dump(2)</div><div id='n_method'> N Method Name: dump(2)</div><div id='m_parent_class'> M Parent Class: VersionedYAMLParser</div><div id='n_parent_class'> N Parent Class: VersionedYAMLParser</div><div id='m_file'> M File Name: jina/jaml/parsers/flow/v1.py</div><div id='n_file'> N File Name: jina/jaml/parsers/flow/v1.py</div><div id='m_start'> M Start Line: 82</div><div id='m_end'> M End Line: 117</div><div id='n_start'> N Start Line: 89</div><div id='n_end'> N End Line: 127</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            for artifact in artifacts:
                source = os.path.join(self.artifact_root, artifact[0])
                target = artifact[1]
                <a id="change">if </a>not isinstance(target, str):
                    <a id="change">continue</a>
                tar.add(source, arcname=target)

    def remove(self):
        </code></pre><h3>After Change</h3><pre><code class='java'>
        Parameters:
            artifacts: array of (source, destination) tuples
        
        <a id="change">self.artifacts.update(</a>artifacts<a id="change">)</a>

        &#47&#47 TODO: Use glob to expand
        &#47&#47 TODO: Add logic to untar and retar
        with tarfile.open(self.context_path, "w:gz") as tar:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/aws/deep-learning-containers/commit/ac91417c7e292b6c12286e7e6c2dc7aa77e37fff#diff-3c594bc7b8e7e27f5de8b755d041e053d6192502744f8a44b07cbd20396659bbL55' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 71385056</div><div id='project'> Project Name: aws/deep-learning-containers</div><div id='commit'> Commit Name: ac91417c7e292b6c12286e7e6c2dc7aa77e37fff</div><div id='time'> Time: 2020-02-14</div><div id='author'> Author: shanmugamsakthivadivel.1@osu.edu</div><div id='file'> File Name: src/context.py</div><div id='m_class'> M Class Name: Context</div><div id='n_method'> N Class Name: Context</div><div id='m_method'> M Method Name: add(2)</div><div id='n_method'> N Method Name: add(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/context.py</div><div id='n_file'> N File Name: src/context.py</div><div id='m_start'> M Start Line: 62</div><div id='m_end'> M End Line: 72</div><div id='n_start'> N Start Line: 61</div><div id='n_end'> N End Line: 71</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                offset += numel
        else:
            for p, p32 in zip(self.fp16_params, self.fp32_params):
                <a id="change">if </a>not p.requires_grad:
                    <a id="change">continue</a>
                p.data.copy_(p32.data)

    def zero_grad(self):
        Clears the gradients of all optimized parameters.</code></pre><h3>After Change</h3><pre><code class='java'>
        self.fp32_optimizer.step(closure)

        if self.scaler is not None:
            <a id="change">self.scaler.update()</a>

        self._sync_fp32_grads_to_fp16()

    def zero_grad(self):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/kssteven418/i-bert/commit/84e32315af7b4a479450a1e65b9e277226d75576#diff-f260a34a203191343e5e59e58bddb5841c3874b348958606795911fbf2d77638L183' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 71385061</div><div id='project'> Project Name: kssteven418/i-bert</div><div id='commit'> Commit Name: 84e32315af7b4a479450a1e65b9e277226d75576</div><div id='time'> Time: 2020-07-23</div><div id='author'> Author: andersonic@fb.com</div><div id='file'> File Name: fairseq/optim/fp16_optimizer.py</div><div id='m_class'> M Class Name: _FP16OptimizerMixin</div><div id='n_method'> N Class Name: _FP16OptimizerMixin</div><div id='m_method'> M Method Name: step(2)</div><div id='n_method'> N Method Name: step(2)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: fairseq/optim/fp16_optimizer.py</div><div id='n_file'> N File Name: fairseq/optim/fp16_optimizer.py</div><div id='m_start'> M Start Line: 189</div><div id='m_end'> M End Line: 203</div><div id='n_start'> N Start Line: 149</div><div id='n_end'> N End Line: 152</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    def _handle_tensors(self, cats, conts, labels):
        X = {}
        for tensor, names in zip([cats, conts], [self.cat_names, self.cont_names]):
            <a id="change">if </a>len(names) == 0:
                <a id="change">continue</a>
            elif len(names) &gt; 1:
                tensors = tf.split(tensor, len(names), axis=1)
            else:
                tensors = [tensor]</code></pre><h3>After Change</h3><pre><code class='java'>
                lists.update({name: x for name, x in zip(names, tensors)})
            elif len(names) == 1:
                lists[names[0]] = tensor
            <a id="change">X.update(</a>lists<a id="change">)</a>

        &#47&#47 TODO: use dict for labels as well?
        &#47&#47 would require output layers to match naming
        if len(self.label_names) &gt; 1:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/nvidia/nvtabular/commit/6b668bbd884073cbaf03837cbce5df0810d18a00#diff-5370fdee81817626cc493a473693f5aab4cf69e6b4b1fdbc6fe743789c28a0d1L293' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 71385054</div><div id='project'> Project Name: nvidia/nvtabular</div><div id='commit'> Commit Name: 6b668bbd884073cbaf03837cbce5df0810d18a00</div><div id='time'> Time: 2020-11-03</div><div id='author'> Author: amacgunny@gmail.com</div><div id='file'> File Name: nvtabular/loader/tensorflow.py</div><div id='m_class'> M Class Name: KerasSequenceLoader</div><div id='n_method'> N Class Name: KerasSequenceLoader</div><div id='m_method'> M Method Name: _handle_tensors(4)</div><div id='n_method'> N Method Name: _handle_tensors(4)</div><div id='m_parent_class'> M Parent Class: tf.keras.utils.Sequence,DataLoader</div><div id='n_parent_class'> N Parent Class: tf.keras.utils.Sequence,DataLoader</div><div id='m_file'> M File Name: nvtabular/loader/tensorflow.py</div><div id='n_file'> N File Name: nvtabular/loader/tensorflow.py</div><div id='m_start'> M Start Line: 294</div><div id='m_end'> M End Line: 302</div><div id='n_start'> N Start Line: 315</div><div id='n_end'> N End Line: 336</div><BR>