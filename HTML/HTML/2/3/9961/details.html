<html><h3>Pattern ID :9961
</h3><img src='35602031.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            vb = self.vertical_bars[idx].single()
            pnm_ = vb.pnm_with_max_pitch(method=&quotmidi&quot)
            assert bar.number == idx
            <a id="change">if </a>idx == 6:
                bar.show(fmt=&quotmusicxml.png&quot)
                vb[pnm_].show(fmt=&quotmusicxml.png&quot)
            if pnm_ != pnm:</code></pre><h3>After Change</h3><pre><code class='java'>
                part.replace(bar, vb[pnm_])

        part.partName = f&quot{PROJ_NM}, CH &#47&#471&quot
        <a id="change">ic(list(</a>part.measure(0)<a id="change">)</a><a id="change">)</a>
        &#47&#47 for bar in part[m21.stream.Measure]:
        &#47&#47     tempos = bar[m21.tempo.MetronomeMark]
        &#47&#47     if tempos:
        &#47&#47         &#47&#47 ic(list(tempos))</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/stefanheng/symbolic-music-generation/commit/4a5a5847113d13d252e65668534ef6ab096ff24c#diff-9bddc1ec410935c3b7e65a0e53b587a68e1dda58d8f63e4abcaf788573ad9f27L302' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 35602031</div><div id='project'> Project Name: stefanheng/symbolic-music-generation</div><div id='commit'> Commit Name: 4a5a5847113d13d252e65668534ef6ab096ff24c</div><div id='time'> Time: 2021-11-25</div><div id='author'> Author: 43276957+SpongeBobBang@users.noreply.github.com</div><div id='file'> File Name: melody_extractor.py</div><div id='m_class'> M Class Name: MxlMelodyExtractor</div><div id='n_method'> N Class Name: MxlMelodyExtractor</div><div id='m_method'> M Method Name: bar_with_max_pitch(2)</div><div id='n_method'> N Method Name: bar_with_max_pitch(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: melody_extractor.py</div><div id='n_file'> N File Name: melody_extractor.py</div><div id='m_start'> M Start Line: 302</div><div id='m_end'> M End Line: 347</div><div id='n_start'> N Start Line: 346</div><div id='n_end'> N End Line: 379</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            dir_nm = config(f&quot{DIR_DSET}.MXL_EG.dir_nm&quot)
            dir_nm = f&quot{dir_nm}_out&quot
            scr.write(fmt=&quotmxl&quot, fp=os.path.join(PATH_BASE, DIR_DSET, dir_nm, f&quot{title}.mxl&quot))
        elif <a id="change"></a>exp == &quotsymbol&quot:
            &#47&#47 Per `music21`, duration is represented in terms of quarter notes
            slot_dur = int(2**-2 / 2**-self.prec)  &#47&#47 Duration of a time slot
            ic(slot_dur)</code></pre><h3>After Change</h3><pre><code class='java'>
            &#47&#47 exit(1)

            &#47&#47 Get signature for each bar
            bars = iter(<a id="change">list(</a>part[m21.stream.Measure]<a id="change">)</a>)
            bar0 = next(bars)
            ts = next(bar0[m21.meter.TimeSignature])
            lst_bar_n_ts = [(bar0, ts)]
            ic(list(bar0))
            &#47&#47 ic(list(bars))
            for bar in bars:
            &#47&#47 while bars:
            &#47&#47     bar = next(bars)
            &#47&#47     ic(list(bar))
                ts_: m21.stream.iterator.RecursiveIterator
                ts_ = bar[m21.meter.TimeSignature]
                if ts_:
                    &#47&#47 ic(list(ts_))
                    &#47&#47 ic(ts_, bar.number)
                    ts = next(iter(ts_))
                lst_bar_n_ts.append((bar, ts))
                &#47&#47 ic(list(bar))
                &#47&#47 ic(list(bar[m21.note.Rest or m21.tempo.MetronomeMark]))
                &#47&#47 exit(1)
                &#47&#47 ic(bar)
            <a id="change">ic(</a>lst_bar_n_ts<a id="change">)</a>
            exit(1)
        else:
            return scr
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/stefanheng/symbolic-music-generation/commit/602db438aa5b4cb140b74186c6ec72d099a9b425#diff-9bddc1ec410935c3b7e65a0e53b587a68e1dda58d8f63e4abcaf788573ad9f27L323' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 35602030</div><div id='project'> Project Name: stefanheng/symbolic-music-generation</div><div id='commit'> Commit Name: 602db438aa5b4cb140b74186c6ec72d099a9b425</div><div id='time'> Time: 2021-12-18</div><div id='author'> Author: 43276957+SpongeBobBang@users.noreply.github.com</div><div id='file'> File Name: melody_extractor.py</div><div id='m_class'> M Class Name: MxlMelodyExtractor</div><div id='n_method'> N Class Name: MxlMelodyExtractor</div><div id='m_method'> M Method Name: bar_with_max_pitch(2)</div><div id='n_method'> N Method Name: bar_with_max_pitch(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: melody_extractor.py</div><div id='n_file'> N File Name: melody_extractor.py</div><div id='m_start'> M Start Line: 372</div><div id='m_end'> M End Line: 377</div><div id='n_start'> N Start Line: 366</div><div id='n_end'> N End Line: 438</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                &#47&#47 ic(idxs)

                id_ = self.tokenizer(e)
                <a id="change">if </a>bar.number == 6:
                    &#47&#47 bar.show()
                    ic(e, vars(e), strt, dur)
                    &#47&#47 ic(self.enc, len(self.enc))</code></pre><h3>After Change</h3><pre><code class='java'>
                strt, dur = e.offset, e.duration.quarterLength
                num = n_slots_per_beat*dur + 1
                if bar.number == 73:
                    <a id="change">ic(list(</a>bar<a id="change">)</a><a id="change">)</a>
                assert num.is_integer()
                idxs_ = (np.linspace(strt, strt+dur, num=int(num)) * n_slots_per_beat)[:-1]
                idxs = idxs_.astype(int)
                assert np.all(idxs_-idxs == 0)  &#47&#47 Should be integers</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/stefanheng/symbolic-music-generation/commit/8d126cbf838b183b5e5d3de6015f90ece225b964#diff-9bddc1ec410935c3b7e65a0e53b587a68e1dda58d8f63e4abcaf788573ad9f27L419' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 35602029</div><div id='project'> Project Name: stefanheng/symbolic-music-generation</div><div id='commit'> Commit Name: 8d126cbf838b183b5e5d3de6015f90ece225b964</div><div id='time'> Time: 2021-12-19</div><div id='author'> Author: 43276957+SpongeBobBang@users.noreply.github.com</div><div id='file'> File Name: melody_extractor.py</div><div id='m_class'> M Class Name: BarEnc</div><div id='n_method'> N Class Name: BarEnc</div><div id='m_method'> M Method Name: __init__(4)</div><div id='n_method'> N Method Name: __init__(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: melody_extractor.py</div><div id='n_file'> N File Name: melody_extractor.py</div><div id='m_start'> M Start Line: 422</div><div id='m_end'> M End Line: 447</div><div id='n_start'> N Start Line: 424</div><div id='n_end'> N End Line: 439</div><BR>