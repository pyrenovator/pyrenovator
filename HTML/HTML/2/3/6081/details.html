<html><h3>Pattern ID :6081
</h3><img src='21076231.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 print(f&quotTrain set: Average loss: {train_loss/ len(data):.4f}, &quot
        &#47&#47       f&quotAccuracy: {correct}/{len(data)} ({correct/len(data):.2f}%)&quot)

    return train_loss / <a id="change">len(</a>data<a id="change">)</a>, correct / len(data)  &#47&#47 返回平均损失和平均准确率</code></pre><h3>After Change</h3><pre><code class='java'>

        &#47&#47训练集测试损失值和准确率
        train_output=model(data.to(torch.float32))
        train_loss<a id="change">=</a><a id="change">criterion(</a>train_output,target<a id="change">)</a>.item()
        prediction = train_output.argmax(dim=1, keepdim=True)  &#47&#47 将one-hot输出转为单个标量
        correct = prediction.eq(target.view_as(prediction)).sum().item()  &#47&#47 比较得到准确率
        train_acc=100. * correct/len(data)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/jefffffu/awesome-differential-privacy-and-meachine-learning/commit/2ebbe536f3de4fe260e92dfa2a45dd3bab30a414#diff-aecaebc49c1330d797ceb7c3e3b703c3d28e5366804cbea249ee3aca40cfbd58L10' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 21076231</div><div id='project'> Project Name: jefffffu/awesome-differential-privacy-and-meachine-learning</div><div id='commit'> Commit Name: 2ebbe536f3de4fe260e92dfa2a45dd3bab30a414</div><div id='time'> Time: 2022-12-06</div><div id='author'> Author: 1193147851@qq.com</div><div id='file'> File Name: train_and_validation/train_with_dp.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train_dynamic_add_noise(4)</div><div id='n_method'> N Method Name: train_dynamic_add_noise(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: train_and_validation/train_with_dp.py</div><div id='n_file'> N File Name: train_and_validation/train_with_dp.py</div><div id='m_start'> M Start Line: 10</div><div id='m_end'> M End Line: 40</div><div id='n_start'> N Start Line: 13</div><div id='n_end'> N End Line: 45</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    if args.model != &quotTransformer&quot:
        hidden = model.init_hidden(args.batch_size)
    length = <a id="change">len(</a>range(0, train_data.size(0) - 1, args.bptt)<a id="change">)</a>

    with tqdm(total=length, 
              desc=&quotEpoch {:2d}/{:2d}&quot.format(epoch + 1, args.epochs),
              disable=not args.verbose) as t:</code></pre><h3>After Change</h3><pre><code class='java'>
            else:
                hidden = repackage_hidden(hidden)
                output, hidden = model(data, hidden)
            loss<a id="change"> = </a><a id="change">criterion(</a>output, target<a id="change">)</a>

            loss.backward()
            train_loss.update(loss)
            &#47&#47total_loss += loss.item()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/gpauloski/kfac_pytorch/commit/22a07a821dbaeffdcc00bb4614c8967b44803eeb#diff-bdffb13cddd47e5bff2b5c74cc5a6b24986275164f7b0399c894841d3699ad66L261' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 21076232</div><div id='project'> Project Name: gpauloski/kfac_pytorch</div><div id='commit'> Commit Name: 22a07a821dbaeffdcc00bb4614c8967b44803eeb</div><div id='time'> Time: 2020-04-09</div><div id='author'> Author: gpauloski@yahoo.com</div><div id='file'> File Name: examples/pytorch_wikitext_rnn.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(10)</div><div id='n_method'> N Method Name: train(9)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: examples/pytorch_wikitext_rnn.py</div><div id='n_file'> N File Name: examples/pytorch_wikitext_rnn.py</div><div id='m_start'> M Start Line: 264</div><div id='m_end'> M End Line: 309</div><div id='n_start'> N Start Line: 246</div><div id='n_end'> N End Line: 279</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    if args.model != &quotTransformer&quot:
        hidden = model.init_hidden(args.batch_size)
    length = <a id="change">len(</a>range(0, data_source.size(0) - 1, args.bptt)<a id="change">)</a>
    verbose = args.verbose if epoch is not None else False

    with tqdm(total=length,
              bar_format=&quot{l_bar}{bar}|{postfix}&quot,</code></pre><h3>After Change</h3><pre><code class='java'>
                else:
                    output, hidden = model(data, hidden)
                    hidden = repackage_hidden(hidden)
                loss<a id="change"> = </a><a id="change">criterion(</a>output, target<a id="change">)</a>
                val_loss.update(loss)
                t.update(1) 

            t.set_postfix_str("\b\b val_loss: {:4.2f}, val_ppl: {:6.2f}".format(</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/gpauloski/kfac_pytorch/commit/22a07a821dbaeffdcc00bb4614c8967b44803eeb#diff-bdffb13cddd47e5bff2b5c74cc5a6b24986275164f7b0399c894841d3699ad66L224' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 21076235</div><div id='project'> Project Name: gpauloski/kfac_pytorch</div><div id='commit'> Commit Name: 22a07a821dbaeffdcc00bb4614c8967b44803eeb</div><div id='time'> Time: 2020-04-09</div><div id='author'> Author: gpauloski@yahoo.com</div><div id='file'> File Name: examples/pytorch_wikitext_rnn.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: evaluate(5)</div><div id='n_method'> N Method Name: evaluate(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: examples/pytorch_wikitext_rnn.py</div><div id='n_file'> N File Name: examples/pytorch_wikitext_rnn.py</div><div id='m_start'> M Start Line: 226</div><div id='m_end'> M End Line: 258</div><div id='n_start'> N Start Line: 209</div><div id='n_end'> N End Line: 242</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                ynt_featmap = self.model.get_fm_before_outlayer(ynt_img)
                l2_loss += criterion(ynt_featmap, yt_avg_featmap)
            
            l2_loss = torch.div(l2_loss, <a id="change">len(</a>self.ynt_sub_inds<a id="change">)</a>)
            print("Epoch {} | MSE Loss {}".format(epoch, l2_loss))
            l2_loss.backward(retain_graph=True)
            optimizer.step()</code></pre><h3>After Change</h3><pre><code class='java'>
            ynt_img = self.ynt_imgs[self.ynt_sub_inds].cuda()
            ynt_img = ynt_img * (1-self.mask) + self.mask * torch.sigmoid(self.mark)
            ynt_featmap = self.model.get_fm_before_outlayer(ynt_img)
            l2_loss<a id="change"> = </a><a id="change">criterion(</a>ynt_featmap, yt_avg_featmap.clone().detach()<a id="change">)</a>
            
            print("Epoch {} | MSE Loss {}".format(epoch, l2_loss))
            l2_loss.backward()
            optimizer.step()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ain-soph/trojanzoo/commit/ab9477e1b0e41c6abe9e11d7345b20233d61b9d9#diff-1e9f08cdcf107dac703ba6ade89c7699ee84615bf2b5cdd4e776168a691df4dfL150' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 21076236</div><div id='project'> Project Name: ain-soph/trojanzoo</div><div id='commit'> Commit Name: ab9477e1b0e41c6abe9e11d7345b20233d61b9d9</div><div id='time'> Time: 2020-07-01</div><div id='author'> Author: zxx5113@lrs-twang01.ist.psu.edu</div><div id='file'> File Name: trojanzoo/attack/backdoor/latent_backdoor.py</div><div id='m_class'> M Class Name: Latent_Backdoor</div><div id='n_method'> N Class Name: Latent_Backdoor</div><div id='m_method'> M Method Name: generate_trigger(1)</div><div id='n_method'> N Method Name: generate_trigger(1)</div><div id='m_parent_class'> M Parent Class: BadNet</div><div id='n_parent_class'> N Parent Class: BadNet</div><div id='m_file'> M File Name: trojanzoo/attack/backdoor/latent_backdoor.py</div><div id='n_file'> N File Name: trojanzoo/attack/backdoor/latent_backdoor.py</div><div id='m_start'> M Start Line: 183</div><div id='m_end'> M End Line: 256</div><div id='n_start'> N Start Line: 138</div><div id='n_end'> N End Line: 204</div><BR>