<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        dense_features = torch.rand((B, D))

        embeddings = <a id="change">KeyedTensor(
            keys=keys,
            length_per_key=[D] * F,
            values=torch.rand((B, D * F)),
        )</a>
        concat_dense = inter_arch(dense_features, embeddings)
        &#47&#47  B X (D + F + F choose 2)
        self.assertEqual(concat_dense.size(), (B, D + F + choose(F, 2)))
</code></pre><h3>After Change</h3><pre><code class='java'>

        dense_features = torch.rand((B, D))

        sparse_features = <a id="change">torch.rand(</a>(B<a id="change">, F, D</a>)<a id="change">)</a>
        concat_dense = inter_arch(dense_features, sparse_features)
        &#47&#47  B X (D + F + F choose 2)
        self.assertEqual(concat_dense.size(), (B, D + F + choose(F, 2)))
</code></pre>