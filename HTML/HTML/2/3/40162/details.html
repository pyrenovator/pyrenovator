<html><h3>Pattern ID :40162
</h3><img src='114109885.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
      assert not math.isnan(val)
      const = Token(f"({val}f)", Types.FLOAT)

    can_merge = (not self.bufs[buf_index].st.needs_valid() and len(self.bufs[buf_index].st.views) == 1) or "Image" in <a id="change">str(</a>type(self.bufs[buf_index]._buf)<a id="change">)</a>
    should_upcast = not CLANG and const is None and can_merge and self.buftokens[buf_index].can_float4()

    tokens = []
    for o in self.buftokens[buf_index].offsets():</code></pre><h3>After Change</h3><pre><code class='java'>
          can_merge = True
          for j in range(1,4):
            idxy_test, valid_test = self.sts[buf_index].expr_idxs(o+j)
            can_merge = can_merge and valid.render() == <a id="change">valid_test.render()</a>
            can_merge<a id="change"> = </a>can_merge and (idxy+j).render() == idxy_test.render()
        if const is not None:
          ldr = const
        elif isinstance(self.bufs[buf_index]._buf, CLImage):</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/geohot/tinygrad/commit/1702a5779f62c66a46f90aa85dea69221b406cc9#diff-305e94e84668440e8f8a2a4e17d5796e43233474510c7af082ab29c9aa824eeeL91' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 114109885</div><div id='project'> Project Name: geohot/tinygrad</div><div id='commit'> Commit Name: 1702a5779f62c66a46f90aa85dea69221b406cc9</div><div id='time'> Time: 2023-02-28</div><div id='author'> Author: george@comma.ai</div><div id='file'> File Name: tinygrad/llops/ops_gpu.py</div><div id='m_class'> M Class Name: CLASTKernel</div><div id='n_method'> N Class Name: CLASTKernel</div><div id='m_method'> M Method Name: load(2)</div><div id='n_method'> N Method Name: load(2)</div><div id='m_parent_class'> M Parent Class: ASTKernel</div><div id='n_parent_class'> N Parent Class: ASTKernel</div><div id='m_file'> M File Name: tinygrad/llops/ops_gpu.py</div><div id='n_file'> N File Name: tinygrad/llops/ops_gpu.py</div><div id='m_start'> M Start Line: 92</div><div id='m_end'> M End Line: 114</div><div id='n_start'> N Start Line: 91</div><div id='n_end'> N End Line: 117</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    card = ModelCard.from_template(ModelCardData())
    if not overwrite:
        existing_card = ModelCard.load(MODEL_CARD_REPO_ID)
        if str(existing_card) == <a id="change">str(</a>card<a id="change">)</a>:
            print("Model Card not pushed: did not change.")
            return
    print(f"Pushing empty Model Card to Hub: {MODEL_CARD_REPO_ID}")</code></pre><h3>After Change</h3><pre><code class='java'>
    
    &#47&#47 Not using ModelCard directly to preserve comments in metadata part
    template = jinja2.Template(ModelCard.default_template_path.read_text())
    content<a id="change"> = </a><a id="change">template.render(
        card_data="{}",
        model_summary=(
            "This modelcard aims to be a base template for new models. "
            "It has been generated using [this raw template]"
            "(https://github.com/huggingface/huggingface_hub/blob/main/src/huggingface_hub/templates/modelcard_template.md?plain=1)."
        ),
    )</a>
    if not overwrite:
        existing_content = Path(
            hf_hub_download(MODEL_CARD_REPO_ID, REPOCARD_NAME, repo_type="model")
        ).read_text()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/huggingface_hub/commit/8ff9aa5fc078693f6de39ddc18d91f80e5260014#diff-896d0f3f528c4c8156b09461d5ab832bd58aae8521e4557cd7a3ceab99ed841eL47' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 114109886</div><div id='project'> Project Name: huggingface/huggingface_hub</div><div id='commit'> Commit Name: 8ff9aa5fc078693f6de39ddc18d91f80e5260014</div><div id='time'> Time: 2023-01-16</div><div id='author'> Author: julien@huggingface.co</div><div id='file'> File Name: utils/push_repocard_examples.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: push_model_card_example(1)</div><div id='n_method'> N Method Name: push_model_card_example(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: utils/push_repocard_examples.py</div><div id='n_file'> N File Name: utils/push_repocard_examples.py</div><div id='m_start'> M Start Line: 54</div><div id='m_end'> M End Line: 61</div><div id='n_start'> N Start Line: 51</div><div id='n_end'> N End Line: 73</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    card = DatasetCard.from_template(DatasetCardData())
    if not overwrite:
        existing_card = DatasetCard.load(DATASET_CARD_REPO_ID)
        if str(existing_card) == <a id="change">str(</a>card<a id="change">)</a>:
            print("Dataset Card not pushed: did not change.")
            return
    print(f"Pushing empty Dataset Card to Hub: {DATASET_CARD_REPO_ID}")</code></pre><h3>After Change</h3><pre><code class='java'>
    
    &#47&#47 Not using DatasetCard directly to preserve comments in metadata part
    template = jinja2.Template(DatasetCard.default_template_path.read_text())
    content<a id="change"> = </a><a id="change">template.render(
        card_data="{}",
        dataset_summary=(
            "This dataset card aims to be a base template for new datasets. "
            "It has been generated using [this raw template]"
            "(https://github.com/huggingface/huggingface_hub/blob/main/src/huggingface_hub/templates/datasetcard_template.md?plain=1)."
        ),
    )</a>
    if not overwrite:
        existing_content = Path(
            hf_hub_download(DATASET_CARD_REPO_ID, REPOCARD_NAME, repo_type="dataset")
        ).read_text()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/huggingface_hub/commit/8ff9aa5fc078693f6de39ddc18d91f80e5260014#diff-896d0f3f528c4c8156b09461d5ab832bd58aae8521e4557cd7a3ceab99ed841eL64' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 114109881</div><div id='project'> Project Name: huggingface/huggingface_hub</div><div id='commit'> Commit Name: 8ff9aa5fc078693f6de39ddc18d91f80e5260014</div><div id='time'> Time: 2023-01-16</div><div id='author'> Author: julien@huggingface.co</div><div id='file'> File Name: utils/push_repocard_examples.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: push_dataset_card_example(1)</div><div id='n_method'> N Method Name: push_dataset_card_example(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: utils/push_repocard_examples.py</div><div id='n_file'> N File Name: utils/push_repocard_examples.py</div><div id='m_start'> M Start Line: 70</div><div id='m_end'> M End Line: 77</div><div id='n_start'> N Start Line: 83</div><div id='n_end'> N End Line: 105</div><BR>