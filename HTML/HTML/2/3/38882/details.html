<html><h3>Pattern ID :38882
</h3><img src='110945668.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                    wandb.log(
                        {"return": mean_return, "Accepted Exp Pct": accepted_exp_pct}
                    )
        if <a id="change">step % save_interval == 0 and save_to_disk</a>:
            agent.save(save_dir)

    if save_to_disk:</code></pre><h3>After Change</h3><pre><code class='java'>
                        best_eval = mean_return
                        agent.save(save_dir)
                else:
                    <a id="change">agent.save(</a>save_dir<a id="change">)</a>


    if save_to_disk:
        agent.save(save_dir)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/jakegrigsby/super_sac/commit/82f3ab05d90aa6d100d2772e4b2ec7f098a8f83f#diff-a5e8c65ce6bb50d36d213947814f21c5218b17421b32ea86dfcf65fab78a0cd7L108' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 110945668</div><div id='project'> Project Name: jakegrigsby/super_sac</div><div id='commit'> Commit Name: 82f3ab05d90aa6d100d2772e4b2ec7f098a8f83f</div><div id='time'> Time: 2021-12-26</div><div id='author'> Author: jcg6dn@virginia.edu</div><div id='file'> File Name: super_sac/main.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: super_sac(65)</div><div id='n_method'> N Method Name: super_sac(65)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: super_sac/main.py</div><div id='n_file'> N File Name: super_sac/main.py</div><div id='m_start'> M Start Line: 264</div><div id='m_end'> M End Line: 557</div><div id='n_start'> N Start Line: 108</div><div id='n_end'> N End Line: 564</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    if len(_tensor.shape) == 4:
        assert _tensor.shape[0] == 1
        _tensor = _tensor[0]
    if <a id="change">len(_tensor.shape) == 3 and _tensor.shape[0] == 1</a>:
        _tensor = _tensor[0]
    if isinstance(_tensor, torch.Tensor):
        _tensor = float2byte(_tensor)</code></pre><h3>After Change</h3><pre><code class='java'>
    if not os.path.exists(dir):
        os.makedirs(dir)
    img = tensor_to_img(_tensor)
    <a id="change">img.save(</a>path<a id="change">)</a>


def save_numpy_as_img(path: str, arr: np.ndarray):
    save_tensor_as_img(path, torch.as_tensor(arr))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ain-soph/trojanzoo/commit/80e74988c8d77c00322fd1144f83d6ff4e5ee2cb#diff-59110220d7b2e9e917330943a1e1f68a8553b17e10ecd1de679b4ca60cdeb606L133' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 110945669</div><div id='project'> Project Name: ain-soph/trojanzoo</div><div id='commit'> Commit Name: 80e74988c8d77c00322fd1144f83d6ff4e5ee2cb</div><div id='time'> Time: 2020-12-31</div><div id='author'> Author: ain-soph@live.com</div><div id='file'> File Name: trojanzoo/utils/tensor.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: save_tensor_as_img(2)</div><div id='n_method'> N Method Name: save_tensor_as_img(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: trojanzoo/utils/tensor.py</div><div id='n_file'> N File Name: trojanzoo/utils/tensor.py</div><div id='m_start'> M Start Line: 133</div><div id='m_end'> M End Line: 147</div><div id='n_start'> N Start Line: 145</div><div id='n_end'> N End Line: 150</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        split = path / "lang_annotations/auto_lang_ann.npy"
        data = np.load(split, allow_pickle=True).reshape(-1)[0]
        task_ann = cfg.val_instructions if "val" in i else cfg.train_instructions
        if <a id="change">cfg.reannotate and "train" in i</a>:
            print("Re-annotating sequences...")
            data["language"]["ann"] = [
                task_ann[task][np.random.randint(len(task_ann[task]))] for task in data["language"]["task"]</code></pre><h3>After Change</h3><pre><code class='java'>
            language_embedding = model(list(ann))
            embeddings[task]["emb"] = language_embedding.cpu().numpy()
            embeddings[task]["ann"] = ann
        <a id="change">np.save(</a>save_path / "embeddings", embeddings<a id="change">)</a>  &#47&#47 type:ignore
        print("Done saving val language embeddings for Rollouts !")

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/mees/calvin/commit/e5b712f12f5a2c5bf461a633771f1f7be42666a2#diff-a8af52d2b408a2118467e90ca6cc196f882296e11f9a1a15d03163a462e8aacbL19' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 110945667</div><div id='project'> Project Name: mees/calvin</div><div id='commit'> Commit Name: e5b712f12f5a2c5bf461a633771f1f7be42666a2</div><div id='time'> Time: 2022-04-14</div><div id='author'> Author: oier.mees@gmail.com</div><div id='file'> File Name: calvin_models/calvin_agent/utils/relabel_with_new_lang_model.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(1)</div><div id='n_method'> N Method Name: main(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: calvin_models/calvin_agent/utils/relabel_with_new_lang_model.py</div><div id='n_file'> N File Name: calvin_models/calvin_agent/utils/relabel_with_new_lang_model.py</div><div id='m_start'> M Start Line: 21</div><div id='m_end'> M End Line: 41</div><div id='n_start'> N Start Line: 23</div><div id='n_end'> N End Line: 55</div><BR>