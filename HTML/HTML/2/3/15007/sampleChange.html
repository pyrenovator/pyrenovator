<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        img = torch.randn(shape, device=device)

        for i in tqdm(reversed(range(0, self.num_timesteps)), desc=&quotsampling loop time step&quot, total=self.num_timesteps):
            img = self.p_sample(img, <a id="change">torch.full(</a>(b<a id="change"></a>,), i<a id="change">, device=device, dtype=torch.long)</a>)

        img = unnormalize_to_zero_to_one(img)
        return img</code></pre><h3>After Change</h3><pre><code class='java'>

    @torch.no_grad()
    def p_sample_loop(self, shape):
        batch<a id="change">, device</a> = shape[0], self.betas.device

        img = torch.randn(shape, device=device)
</code></pre>