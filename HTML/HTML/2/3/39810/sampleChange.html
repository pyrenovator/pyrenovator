<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

    dot_product_desc = F.relu(dot_product_desc)

    dot_product_desc = <a id="change">torch.reshape(</a>torch.reshape(dot_product_desc, [batch_size, Hc, Wc, Hc * Wc]),
                                                 [batch_size, Hc, Wc, Hc, Wc]<a id="change">)</a>
    dot_product_desc = torch.reshape(torch.reshape(dot_product_desc, [batch_size, Hc * Wc, Hc, Wc]),
                                                 [batch_size, Hc, Wc, Hc, Wc])

</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47negative_dist = torch.sum(((valid_mask*(1-s)*negative_dist)[(valid_mask*(1-s)*negative_dist)&gt;0]).mean())
    positive_dist = torch.sum(valid_mask * lambda_d * s * positive_dist) / normalization
    negative_dist = torch.sum(valid_mask * (1 - s) * negative_dist) / normalization
    print(<a id="change">&quotDebug (loss.py) positive_dist:{:.3f}, negtive_dist:{:.3f}&quot.format(</a>positive_dist, negative_dist<a id="change">)</a>)

    loss = torch.sum(valid_mask * loss) / normalization
    return loss</code></pre>