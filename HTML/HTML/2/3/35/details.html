<html><h3>Pattern ID :35
</h3><img src='263031.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            return getattr(torch.optim, optimizer)
        if optimizer in globals() and \
                issubclass(globals()[optimizer], torch.optim.Optimizer):
            return <a id="change">globals()</a>[optimizer]
    else:
        raise ValueError("Invalid optimizer: {}, it needs to be an optimizer "
                         "class, or a string name of a valid optimizer class "</code></pre><h3>After Change</h3><pre><code class='java'>


def assert_and_get_valid_optimizer(optimizer):
    global_vars<a id="change"> = </a><a id="change">get_globals_from_stack()</a>
    if inspect.isclass(optimizer) and \
            issubclass(optimizer, torch.optim.Optimizer):
        return optimizer
    if isinstance(optimizer, str):</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/iffix/machin/commit/2b23a8131a239c3b0cf6ac2108725c6d6c1bdcda#diff-b036df81b74c6a4de7949286dbfd2b4b83e52d6ed94dfb8c6e9fbfd2ec944ce0L201' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 263031</div><div id='project'> Project Name: iffix/machin</div><div id='commit'> Commit Name: 2b23a8131a239c3b0cf6ac2108725c6d6c1bdcda</div><div id='time'> Time: 2021-03-27</div><div id='author'> Author: hanhanmumuqq@163.com</div><div id='file'> File Name: machin/frame/algorithms/utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: assert_and_get_valid_optimizer(1)</div><div id='n_method'> N Method Name: assert_and_get_valid_optimizer(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: machin/frame/algorithms/utils.py</div><div id='n_file'> N File Name: machin/frame/algorithms/utils.py</div><div id='m_start'> M Start Line: 201</div><div id='m_end'> M End Line: 208</div><div id='n_start'> N Start Line: 204</div><div id='n_end'> N End Line: 213</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if issubclass(model, nn.Module):
            m.append(model)
        if isinstance(model, str) and model in globals() \
                and issubclass(<a id="change">globals()</a>[model], nn.Module):
            m.append(globals()[model])
        else:
            raise ValueError("Invalid model: {}, it needs to be an nn.Module "</code></pre><h3>After Change</h3><pre><code class='java'>

def assert_and_get_valid_models(models):
    m = []
    global_vars<a id="change"> = </a><a id="change">get_globals_from_stack()</a>
    for model in models:
        if inspect.isclass(model) and issubclass(model, nn.Module):
            m.append(model)
        if isinstance(model, str) and model in global_vars \</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/iffix/machin/commit/2b23a8131a239c3b0cf6ac2108725c6d6c1bdcda#diff-b036df81b74c6a4de7949286dbfd2b4b83e52d6ed94dfb8c6e9fbfd2ec944ce0L184' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 263040</div><div id='project'> Project Name: iffix/machin</div><div id='commit'> Commit Name: 2b23a8131a239c3b0cf6ac2108725c6d6c1bdcda</div><div id='time'> Time: 2021-03-27</div><div id='author'> Author: hanhanmumuqq@163.com</div><div id='file'> File Name: machin/frame/algorithms/utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: assert_and_get_valid_models(1)</div><div id='n_method'> N Method Name: assert_and_get_valid_models(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: machin/frame/algorithms/utils.py</div><div id='n_file'> N File Name: machin/frame/algorithms/utils.py</div><div id='m_start'> M Start Line: 186</div><div id='m_end'> M End Line: 191</div><div id='n_start'> N Start Line: 188</div><div id='n_end'> N End Line: 194</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if hasattr(torch.optim.lr_scheduler, lr_scheduler):
            return getattr(torch.optim.lr_scheduler, lr_scheduler)
        if lr_scheduler in globals() and \
                issubclass(<a id="change">globals()</a>[lr_scheduler],
                           torch.optim.lr_scheduler._LRScheduler):
            return globals()[lr_scheduler]
    else:</code></pre><h3>After Change</h3><pre><code class='java'>


def assert_and_get_valid_lr_scheduler(lr_scheduler):
    global_vars<a id="change"> = </a><a id="change">get_globals_from_stack()</a>
    if inspect.isclass(lr_scheduler) and \
            issubclass(lr_scheduler, torch.optim.lr_scheduler._LRScheduler):
        return lr_scheduler
    if isinstance(lr_scheduler, str):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/iffix/machin/commit/2b23a8131a239c3b0cf6ac2108725c6d6c1bdcda#diff-b036df81b74c6a4de7949286dbfd2b4b83e52d6ed94dfb8c6e9fbfd2ec944ce0L217' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 263041</div><div id='project'> Project Name: iffix/machin</div><div id='commit'> Commit Name: 2b23a8131a239c3b0cf6ac2108725c6d6c1bdcda</div><div id='time'> Time: 2021-03-27</div><div id='author'> Author: hanhanmumuqq@163.com</div><div id='file'> File Name: machin/frame/algorithms/utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: assert_and_get_valid_lr_scheduler(1)</div><div id='n_method'> N Method Name: assert_and_get_valid_lr_scheduler(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: machin/frame/algorithms/utils.py</div><div id='n_file'> N File Name: machin/frame/algorithms/utils.py</div><div id='m_start'> M Start Line: 218</div><div id='m_end'> M End Line: 226</div><div id='n_start'> N Start Line: 223</div><div id='n_end'> N End Line: 233</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    if isinstance(criterion, str):
        if hasattr(torch.nn.modules.loss, criterion):
            return getattr(torch.nn.modules.loss, criterion)
        if criterion in <a id="change">globals()</a> and callable(globals()[criterion]):
            return globals()[criterion]
    else:
        raise ValueError("Invalid optimizer: {}, it needs to be a loss "</code></pre><h3>After Change</h3><pre><code class='java'>


def assert_and_get_valid_criterion(criterion):
    global_vars<a id="change"> = </a><a id="change">get_globals_from_stack()</a>
    if inspect.isclass(criterion) and issubclass(criterion, nn.Module):
        return criterion
    if callable(criterion):
        return criterion</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/iffix/machin/commit/2b23a8131a239c3b0cf6ac2108725c6d6c1bdcda#diff-b036df81b74c6a4de7949286dbfd2b4b83e52d6ed94dfb8c6e9fbfd2ec944ce0L235' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 263039</div><div id='project'> Project Name: iffix/machin</div><div id='commit'> Commit Name: 2b23a8131a239c3b0cf6ac2108725c6d6c1bdcda</div><div id='time'> Time: 2021-03-27</div><div id='author'> Author: hanhanmumuqq@163.com</div><div id='file'> File Name: machin/frame/algorithms/utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: assert_and_get_valid_criterion(1)</div><div id='n_method'> N Method Name: assert_and_get_valid_criterion(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: machin/frame/algorithms/utils.py</div><div id='n_file'> N File Name: machin/frame/algorithms/utils.py</div><div id='m_start'> M Start Line: 236</div><div id='m_end'> M End Line: 244</div><div id='n_start'> N Start Line: 244</div><div id='n_end'> N End Line: 253</div><BR>