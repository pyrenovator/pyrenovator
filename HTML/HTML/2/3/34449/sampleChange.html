<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    axis_not_channel = [i for i in range(len(tensor_data.shape))]
    axis_not_channel.remove(channel_axis)
    if per_channel:
        thresholds_per_channel<a id="change"> = </a>np.max(<a id="change">np.abs(</a>tensor_data<a id="change">)</a>, axis=tuple(axis_not_channel), keepdims=True)
    else:
        thresholds_per_channel = np.max(np.abs(tensor_data), keepdims=True)
    thresholds_per_channel = np.power(2.0, np.ceil(np.log2(thresholds_per_channel)))</code></pre><h3>After Change</h3><pre><code class='java'>
        n_clusters = 2 ** n_bits
    kmeans = KMeans(n_clusters=n_clusters)

    threshold_selection_tensor = symmetric_selection_tensor<a id="change"> if </a>is_symmetric<a id="change"> else </a>power_of_two_selection_tensor
    thresholds_per_channel = threshold_selection_tensor(tensor_data, p, n_bits, per_channel,
                                                        channel_axis, n_iter, min_threshold,
                                                        qc.QuantizationErrorMethod.NOCLIPPING)[THRESHOLD]</code></pre>