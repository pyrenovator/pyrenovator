<html><h3>Pattern ID :2195
</h3><img src='9320264.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        s = self.size[index][1].to(&quotcuda&quot)
        &#47&#47 m = self.size[index][2].to(&quotcuda&quot)

        <a id="change">return </a>x, y, d, s

    def __len__(self):
        return self.len</code></pre><h3>After Change</h3><pre><code class='java'>
        x = self.x_data[index][0].to(&quotcuda&quot)
        dx = torch.diff(x, dim=0)[89:269]
        &#47&#47 torch.cat((torch.diff(x), torch.zeros(1).to(&quotcuda:0&quot)))
        ddx<a id="change"> = </a><a id="change">torch.diff(</a>torch.diff(x, dim=0)<a id="change">, dim=0)</a>[88:268]
        &#47&#47 x = (self.x_data[index] - torch.mean(self.x_data[index])) / torch.std(self.x_data[index]).to(&quotcuda&quot)
        &#47&#47 x_size = torch.mean(self.x_data[index]).to(&quotcuda&quot)
        &#47&#47 if x_size &lt; 0.5:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/tvs-ai/pytorch_rppgs/commit/04d8750f56400d00caea5b1bdd2a69ac3769c18f#diff-a4860f3ef856a8707dafb300bd408a5d43e536dc148f3942473ebf1fafc11e29L17' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 9320264</div><div id='project'> Project Name: tvs-ai/pytorch_rppgs</div><div id='commit'> Commit Name: 04d8750f56400d00caea5b1bdd2a69ac3769c18f</div><div id='time'> Time: 2023-01-12</div><div id='author'> Author: forownsake@gmail.com</div><div id='file'> File Name: vid2bp/BPNetDataset.py</div><div id='m_class'> M Class Name: BPNetDataset</div><div id='n_method'> N Class Name: BPNetDataset</div><div id='m_method'> M Method Name: __getitem__(2)</div><div id='n_method'> N Method Name: __getitem__(2)</div><div id='m_parent_class'> M Parent Class: Dataset</div><div id='n_parent_class'> N Parent Class: Dataset</div><div id='m_file'> M File Name: vid2bp/BPNetDataset.py</div><div id='n_file'> N File Name: vid2bp/BPNetDataset.py</div><div id='m_start'> M Start Line: 17</div><div id='m_end'> M End Line: 41</div><div id='n_start'> N Start Line: 18</div><div id='n_end'> N End Line: 45</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    mask_ppg = np.take(f_ppg, fmask_ppg)
    mask_pxx = np.take(pxx_ppg, fmask_ppg)
    fft_hr = np.take(mask_ppg, np.argmax(mask_pxx, 0))[0] * 60
    <a id="change">return </a>fft_hr</code></pre><h3>After Change</h3><pre><code class='java'>
        hr = np.take(mask_ppg, np.argmax(mask_pxx, 0))[0] * 60
    else:
        ppg_peaks, _ = scipy.signal.find_peaks(ppg_signal)
        hr<a id="change"> = </a>60 / (np.mean(<a id="change">np.diff(</a>ppg_peaks<a id="change">)</a>) / fs)
    return hr

def mag2db(magnitude):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tvs-ai/pytorch_rppgs/commit/479a4ce2d1dbdf85953c0b93c68388394ef89a83#diff-1d4078b5da302e2e2a11d90ef59ac6ce441432ac9f36c30b18514b62752c6491L63' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 9320253</div><div id='project'> Project Name: tvs-ai/pytorch_rppgs</div><div id='commit'> Commit Name: 479a4ce2d1dbdf85953c0b93c68388394ef89a83</div><div id='time'> Time: 2023-05-03</div><div id='author'> Author: spicyyeol@gmail.com</div><div id='file'> File Name: rppg/utils/funcs.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: calculate_hr(5)</div><div id='n_method'> N Method Name: calculate_hr(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: rppg/utils/funcs.py</div><div id='n_file'> N File Name: rppg/utils/funcs.py</div><div id='m_start'> M Start Line: 65</div><div id='m_end'> M End Line: 72</div><div id='n_start'> N Start Line: 61</div><div id='n_end'> N End Line: 74</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        s = self.size[index][1].to(&quotcuda&quot)
        m = self.size[index][2].to(&quotcuda&quot)

        <a id="change">return </a>x, y, d, s, size_class

    def __len__(self):
        return self.len</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47     size_class = 5
        y = self.y_data[index].to(&quotcuda&quot)
        y_first_derivative = torch.diff(y, dim=0)
        y_second_derivative<a id="change"> = </a><a id="change">torch.diff(</a>y_first_derivative<a id="change">, dim=0)</a>
        &quot&quot&quot
        size[index][0] = np.min(diastolic list) 
        size[index][1] = np.max(systolic list) 
        &quot&quot&quot</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tvs-ai/pytorch_rppgs/commit/c1b2bd1f750e2da30823147e4d7c70501000b2c7#diff-a4860f3ef856a8707dafb300bd408a5d43e536dc148f3942473ebf1fafc11e29L16' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 9320250</div><div id='project'> Project Name: tvs-ai/pytorch_rppgs</div><div id='commit'> Commit Name: c1b2bd1f750e2da30823147e4d7c70501000b2c7</div><div id='time'> Time: 2023-01-09</div><div id='author'> Author: forownsake@gmail.com</div><div id='file'> File Name: vid2bp/BPNetDataset.py</div><div id='m_class'> M Class Name: BPNetDataset</div><div id='n_method'> N Class Name: BPNetDataset</div><div id='m_method'> M Method Name: __getitem__(2)</div><div id='n_method'> N Method Name: __getitem__(2)</div><div id='m_parent_class'> M Parent Class: Dataset</div><div id='n_parent_class'> N Parent Class: Dataset</div><div id='m_file'> M File Name: vid2bp/BPNetDataset.py</div><div id='n_file'> N File Name: vid2bp/BPNetDataset.py</div><div id='m_start'> M Start Line: 17</div><div id='m_end'> M End Line: 39</div><div id='n_start'> N Start Line: 17</div><div id='n_end'> N End Line: 41</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        scores on the entire prediction results regardless the users.

    
    <a id="change">return </a>roc_auc_score(trues, preds)


&#47&#47 Loss based Metrics &#47&#47</code></pre><h3>After Change</h3><pre><code class='java'>
    M is the number of positive samples.N is the number of negative samples.${rank_i}$ is the rank of the ith positive sample.
    
    fps, tps = _binary_clf_curve(trues, preds)
    optimal_idxs<a id="change"> = </a>np.where(np.r_[True, np.logical_or(<a id="change">np.diff(</a>fps, 2<a id="change">)</a>, np.diff(tps, 2)), True])[0]
    fps = np.r_[0, fps[optimal_idxs]]
    tps = np.r_[0, tps[optimal_idxs]]
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/rucaibox/recbole/commit/12ee51207a252a3ebdc06d9a5897e6668c152ee8#diff-d263fac968632c495d236324d3f734dff265d48a180976f16a74b4bfe8bba475L105' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 9320262</div><div id='project'> Project Name: rucaibox/recbole</div><div id='commit'> Commit Name: 12ee51207a252a3ebdc06d9a5897e6668c152ee8</div><div id='time'> Time: 2020-08-09</div><div id='author'> Author: 970955517@qq.com</div><div id='file'> File Name: evaluator/metrics.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: auc(2)</div><div id='n_method'> N Method Name: auc(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: evaluator/metrics.py</div><div id='n_file'> N File Name: evaluator/metrics.py</div><div id='m_start'> M Start Line: 117</div><div id='m_end'> M End Line: 117</div><div id='n_start'> N Start Line: 162</div><div id='n_end'> N End Line: 169</div><BR>