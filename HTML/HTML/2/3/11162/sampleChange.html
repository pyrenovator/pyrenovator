<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        self.metric_val = RDMetric()
        self.metric_test = RDMetric()
        &#47&#47 --- load the model to device --- &#47&#47
        <a id="change">self.to(</a>device<a id="change">)</a>  &#47&#47 always make sure to do this.

    def forward(self, X: torch.Tensor) -&gt; torch.Tensor:
        </code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 -- the only neural network we need -- &#47&#47
        self.bert_mlm = bert_mlm
        &#47&#47 -- to be used to compute S_wisdom -- &#47&#47
        <a id="change">self.register_buffer("wisdom2subwords"</a>, wisdom2subwords<a id="change">)</a>  &#47&#47 (|W|, K)
        &#47&#47 --- to be used for getting H_k --- &#47&#47
        self.wisdom_mask: Optional[torch.Tensor] = None  &#47&#47 (N, L)
        &#47&#47 --- to be used for getting H_desc --- &#47&#47</code></pre>