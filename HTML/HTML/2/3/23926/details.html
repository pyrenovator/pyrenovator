<html><h3>Pattern ID :23926
</h3><img src='74424239.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                &#47&#47generate sample without image
                sample_text = text[:1]
                token_list = sample_text.masked_select(sample_text != 0).tolist()
                decoded_text<a id="change"> = </a><a id="change">self.tokenizer.decode(</a>token_list<a id="change">)</a>

                x_gen = pl_module.generate_images(text[:1], filter_thres=0.9)  &#47&#47 topk sampling at 0.9

                pl_module.train()  </code></pre><h3>After Change</h3><pre><code class='java'>
            sample_text = text[:1]
            token_list = sample_text.masked_select(sample_text != 0).tolist()
            decoded_text = self.tokenizer.decode(token_list)   
            <a id="change">print(</a>decoded_text<a id="change">)</a>         
            text = text.to(pl_module.device)
            x = x.to(pl_module.device)       
            with torch.no_grad():</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/tgisaturday/dalle-lightning/commit/f8d6717d2acfd3b34ebff35c9c67973e0b7c5f59#diff-a83484d4c7b7ebe0b0e0ade59c8557937a9e940ae331d28b6debb50cefd16ffcL208' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 74424239</div><div id='project'> Project Name: tgisaturday/dalle-lightning</div><div id='commit'> Commit Name: f8d6717d2acfd3b34ebff35c9c67973e0b7c5f59</div><div id='time'> Time: 2021-07-26</div><div id='author'> Author: jamesk1228@gmail.com</div><div id='file'> File Name: pl_dalle/callbacks.py</div><div id='m_class'> M Class Name: DalleImageSampler</div><div id='n_method'> N Class Name: DalleImageSampler</div><div id='m_method'> M Method Name: on_train_batch_end(7)</div><div id='n_method'> N Method Name: on_train_batch_end(7)</div><div id='m_parent_class'> M Parent Class: Callback</div><div id='n_parent_class'> N Parent Class: Callback</div><div id='m_file'> M File Name: pl_dalle/callbacks.py</div><div id='n_file'> N File Name: pl_dalle/callbacks.py</div><div id='m_start'> M Start Line: 209</div><div id='m_end'> M End Line: 219</div><div id='n_start'> N Start Line: 208</div><div id='n_end'> N End Line: 209</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            with torch.no_grad():
                train_z = model.encode(batch.x, batch.edge_train)
                if val:
                    link_logits<a id="change"> = </a><a id="change">model.decode(</a>train_z, batch.edge_val<a id="change">)</a>
                else:
                    link_logits = model.decode(train_z, batch.edge_test)

                if val:</code></pre><h3>After Change</h3><pre><code class='java'>
                pred = (out &gt; threshold).float() * 1
            
            cum_score += average_precision_score(np.ones(pred.numel()), pred.cpu())
            <a id="change">print(</a>cum_score<a id="change">)</a>
            ngraphs += batch.num_graphs

        return cum_score / ngraphs, model
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/fedml-ai/fedml/commit/0bed2c22b8b40421e77d045b17d8c3e54aff3d3f#diff-c776a3deeaf43a5fd8f6b180bb4965c1755d5dd349dd8fdd95dad74f14814a9bL25' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 74424249</div><div id='project'> Project Name: fedml-ai/fedml</div><div id='commit'> Commit Name: 0bed2c22b8b40421e77d045b17d8c3e54aff3d3f</div><div id='time'> Time: 2022-07-29</div><div id='author'> Author: emirceyani@gmail.com</div><div id='file'> File Name: python/app/fedgraphnn/ego_networks_link_pred/trainer/federated_lp_aggregator.py</div><div id='m_class'> M Class Name: FedLPAggregator</div><div id='n_method'> N Class Name: FedLPAggregator</div><div id='m_method'> M Method Name: _test(5)</div><div id='n_method'> N Method Name: _test(5)</div><div id='m_parent_class'> M Parent Class: ServerAggregator</div><div id='n_parent_class'> N Parent Class: ServerAggregator</div><div id='m_file'> M File Name: python/app/fedgraphnn/ego_networks_link_pred/trainer/federated_lp_aggregator.py</div><div id='n_file'> N File Name: python/app/fedgraphnn/ego_networks_link_pred/trainer/federated_lp_aggregator.py</div><div id='m_start'> M Start Line: 26</div><div id='m_end'> M End Line: 49</div><div id='n_start'> N Start Line: 27</div><div id='n_end'> N End Line: 52</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            text, x = batch
            sample_text = text[:1]
            token_list = sample_text.masked_select(sample_text != 0).tolist()
            decoded_text<a id="change"> = </a><a id="change">self.tokenizer.decode(</a>token_list<a id="change">)</a>       
            text = text.to(pl_module.device)
            x = x.to(pl_module.device)       
            with torch.no_grad():</code></pre><h3>After Change</h3><pre><code class='java'>
            x = x.to(pl_module.device)       
            with torch.no_grad():
                pl_module.eval()
                <a id="change">print(</a>&quotfuck&quot<a id="change">)</a>
                &#47&#47generate sample with image provided
                x_rec = pl_module.generate_images(text=text, img = x, filter_thres=0.9)  &#47&#47 topk sampling at 0.9
                print(&quotfuck&quot)
                &#47&#47generate sample without image</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tgisaturday/dalle-lightning/commit/42e20bec303cdd55c251ee6a6a452cd8a5ef4e3e#diff-a83484d4c7b7ebe0b0e0ade59c8557937a9e940ae331d28b6debb50cefd16ffcL190' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 74424246</div><div id='project'> Project Name: tgisaturday/dalle-lightning</div><div id='commit'> Commit Name: 42e20bec303cdd55c251ee6a6a452cd8a5ef4e3e</div><div id='time'> Time: 2021-07-26</div><div id='author'> Author: jamesk1228@gmail.com</div><div id='file'> File Name: pl_dalle/callbacks.py</div><div id='m_class'> M Class Name: DalleImageSampler</div><div id='n_method'> N Class Name: DalleImageSampler</div><div id='m_method'> M Method Name: on_train_batch_end(7)</div><div id='n_method'> N Method Name: on_train_batch_end(7)</div><div id='m_parent_class'> M Parent Class: Callback</div><div id='n_parent_class'> N Parent Class: Callback</div><div id='m_file'> M File Name: pl_dalle/callbacks.py</div><div id='n_file'> N File Name: pl_dalle/callbacks.py</div><div id='m_start'> M Start Line: 202</div><div id='m_end'> M End Line: 246</div><div id='n_start'> N Start Line: 206</div><div id='n_end'> N End Line: 209</div><BR>