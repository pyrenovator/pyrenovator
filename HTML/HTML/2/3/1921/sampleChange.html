<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
def test_parallel():
    input = torch.normal(mean=torch.zeros(7 * 5 * 5)).reshape((1, 1, 7, 5, 5))

    c5 = co.Conv3d(1, 1, (5<a id="change">, 5, 5</a>), padding=(2, 2, 2))
    c3 = co.Conv3d(1, 1, (3, 3, 3), padding=(1, 1, 1))
    c1 = co.Conv3d(1, 1, (1, 1, 1), padding=(0, 0, 0))
    par = co.Parallel(c5, c3, c1)</code></pre><h3>After Change</h3><pre><code class='java'>
    )

    &#47&#47 forward_step
    out_steps = [<a id="change">par.forward_step(</a>input[:, :, i]<a id="change">)</a> for i in range(input.shape[2])]
    assert all(isinstance(o, TensorPlaceholder) for o in out_steps[: par.delay])

    out_steps<a id="change"> = </a>torch.stack(out_steps[par.delay :], dim=2)
    assert torch.allclose(out_steps, out_all[:, :, : -par.delay])

    &#47&#47 forward_steps</code></pre>