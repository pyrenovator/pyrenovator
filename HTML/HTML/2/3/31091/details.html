<html><h3>Pattern ID :31091
</h3><img src='91310019.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                    None
                )

            <a id="change">if </a>interrupted:
                <a id="change">sys.exit(</a>0<a id="change">)</a>

            if is_final_step:
                break
</code></pre><h3>After Change</h3><pre><code class='java'>
                throughput = n_labels_tokens / elapsed_time
                throughput = distributed_utils.all_reduce_item(throughput, op="sum")
                
                train_loss<a id="change">, log_step, n_labels_tokens</a> = 0.0, 0, 0

                logger.info(
                    f"Epoch: {epoch} | Step: {step} | "</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/microsoft/archai/commit/0ccde545283f441a006b42d39971eab7c6533b40#diff-b9b9ba6172925a61872b8db6c549fe9c048b74122bcc38156f33b17727764c5eL240' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 91310019</div><div id='project'> Project Name: microsoft/archai</div><div id='commit'> Commit Name: 0ccde545283f441a006b42d39971eab7c6533b40</div><div id='time'> Time: 2022-12-16</div><div id='author'> Author: gth.rosa@uol.com.br</div><div id='file'> File Name: archai/nlp/trainers/nvidia/trainer.py</div><div id='m_class'> M Class Name: NvidiaTrainer</div><div id='n_method'> N Class Name: NvidiaTrainer</div><div id='m_method'> M Method Name: training_step(7)</div><div id='n_method'> N Method Name: training_step(7)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: archai/nlp/trainers/nvidia/trainer.py</div><div id='n_file'> N File Name: archai/nlp/trainers/nvidia/trainer.py</div><div id='m_start'> M Start Line: 240</div><div id='m_end'> M End Line: 380</div><div id='n_start'> N Start Line: 291</div><div id='n_end'> N End Line: 425</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 Join the agent first so we can exit if the agent fails to connect to
        &#47&#47 the master.
        agent.join()
        <a id="change">if </a>agent.exitcode != 0:
            master.terminate()
            <a id="change">sys.exit(</a>agent.exitcode<a id="change">)</a>

        master.join()
    except (KeyboardInterrupt, SystemExit):
        pass</code></pre><h3>After Change</h3><pre><code class='java'>


def main():
    db<a id="change">, master, agent, db_logs</a> = False, None, None, None
    try:
        master = run_master()
        agent = run_agent()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/determined-ai/determined/commit/f6b8847d9b545d7d975de52b7919fd600bc91a7e#diff-21fa56f5d70c52d427c1e68ed30346fad67a9681aa99c15e3c5fe1e0443161beL62' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 91310021</div><div id='project'> Project Name: determined-ai/determined</div><div id='commit'> Commit Name: f6b8847d9b545d7d975de52b7919fd600bc91a7e</div><div id='time'> Time: 2020-05-11</div><div id='author'> Author: yoni@determined.ai</div><div id='file'> File Name: tools/run-server.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tools/run-server.py</div><div id='n_file'> N File Name: tools/run-server.py</div><div id='m_start'> M Start Line: 63</div><div id='m_end'> M End Line: 81</div><div id='n_start'> N Start Line: 83</div><div id='n_end'> N End Line: 116</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

def print_scores(gt_json, pred_json, output_fname):
    &#47&#47 Read test data ground truth
    <a id="change">if </a>not os.path.isfile(gt_json):
        <a id="change">sys.exit(</a>&quotERROR:&quot, gt_json, &quotNot Found&quot<a id="change">)</a>
    with open(gt_json, encoding=&quotutf8&quot) as f:
        gt_data = json.load(f)
    
    &#47&#47 Read input data (predictions)</code></pre><h3>After Change</h3><pre><code class='java'>
        sys.exit(&quotERROR: Unrecognized predictions file format:&quot, file_type)

def print_scores(args):
    gt_data<a id="change">, pred_data</a> = read_data(args.ground_truth_json, args.prediction_ftype, args)

    acc, f, f_best_match, mrr, map_ref = evaluate(pred_data, gt_data)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ai4bharat/indiannlp-transliteration/commit/2c49f671de6531c3bd422504ce1cf9ac5655af03#diff-c1349ad39b7813d932f2c7a58edcb5ec9eb8dc6c51be555eb6183a20a65eee81L144' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 91310025</div><div id='project'> Project Name: ai4bharat/indiannlp-transliteration</div><div id='commit'> Commit Name: 2c49f671de6531c3bd422504ce1cf9ac5655af03</div><div id='time'> Time: 2020-01-19</div><div id='author'> Author: gokulnc@ymail.com</div><div id='file'> File Name: tasks/calculate_scores.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: print_scores(1)</div><div id='n_method'> N Method Name: print_scores(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tasks/calculate_scores.py</div><div id='n_file'> N File Name: tasks/calculate_scores.py</div><div id='m_start'> M Start Line: 144</div><div id='m_end'> M End Line: 162</div><div id='n_start'> N Start Line: 202</div><div id='n_end'> N End Line: 208</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    &#47&#47 load a checkpoint
    if not args.pretrained:
        <a id="change">if </a>not load_checkpoint(model, args.checkpoint):
            <a id="change">exit(</a>1<a id="change">)</a>

    if args.num_gpu &gt; 1:
        model = torch.nn.DataParallel(model, device_ids=list(range(args.num_gpu))).cuda()
    else:</code></pre><h3>After Change</h3><pre><code class='java'>
          (args.model, sum([m.numel() for m in model.parameters()])))

    data_mean, data_std = get_mean_and_std(model, args)
    model<a id="change">, test_time_pool</a> = apply_test_time_pool(model, args)

    if args.num_gpu &gt; 1:
        model = torch.nn.DataParallel(model, device_ids=list(range(args.num_gpu))).cuda()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/feng-lab/pytorch-image-models/commit/9c3859fb9c5bebd224c2f275b16fe0307300623c#diff-6bb87854f62182076b9d47e5a3fa17d5fb46826b979e3292b7ae7bef07022cf4L44' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 91310027</div><div id='project'> Project Name: feng-lab/pytorch-image-models</div><div id='commit'> Commit Name: 9c3859fb9c5bebd224c2f275b16fe0307300623c</div><div id='time'> Time: 2019-04-11</div><div id='author'> Author: rwightman@gmail.com</div><div id='file'> File Name: inference.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: inference.py</div><div id='n_file'> N File Name: inference.py</div><div id='m_start'> M Start Line: 45</div><div id='m_end'> M End Line: 67</div><div id='n_start'> N Start Line: 48</div><div id='n_end'> N End Line: 62</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                start_batch = checkpoint["batch"]
                step = checkpoint["step"]

                <a id="change">if </a>step &gt;= self.args.max_steps:
                    <a id="change">sys.exit(</a>1<a id="change">)</a>

            except FileNotFoundError:
                pass
</code></pre><h3>After Change</h3><pre><code class='java'>
        self.create_scheduler()

        if checkpoint_path:
            iterator<a id="change">, start_epoch, start_batch, step</a> = self.load_checkpoint(checkpoint_path)
        else:
            iterator, start_epoch, start_batch, step = 0, 0, 0, 0
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/archai/commit/e54b79e6468d1aa496ea60e08975dc54495fcd44#diff-b9b9ba6172925a61872b8db6c549fe9c048b74122bcc38156f33b17727764c5eL425' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 91310029</div><div id='project'> Project Name: microsoft/archai</div><div id='commit'> Commit Name: e54b79e6468d1aa496ea60e08975dc54495fcd44</div><div id='time'> Time: 2022-12-16</div><div id='author'> Author: gth.rosa@uol.com.br</div><div id='file'> File Name: archai/nlp/trainers/nvidia/trainer.py</div><div id='m_class'> M Class Name: NvidiaTrainer</div><div id='n_method'> N Class Name: NvidiaTrainer</div><div id='m_method'> M Method Name: train(2)</div><div id='n_method'> N Method Name: train(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: archai/nlp/trainers/nvidia/trainer.py</div><div id='n_file'> N File Name: archai/nlp/trainers/nvidia/trainer.py</div><div id='m_start'> M Start Line: 446</div><div id='m_end'> M End Line: 467</div><div id='n_start'> N Start Line: 474</div><div id='n_end'> N End Line: 480</div><BR>