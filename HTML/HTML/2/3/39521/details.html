<html><h3>Pattern ID :39521
</h3><img src='112504500.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                rank=self.local_rank,
            )

        <a id="change">if </a>self.world_size &gt; 1 and self.valid_sampler is None:
            self.valid_sampler = DistributedSampler(
                self.valid_dataset,
                num_replicas=self.world_size,</code></pre><h3>After Change</h3><pre><code class='java'>
                self.model, self.optimizer, self.train_loader, self.valid_loader
            )
        else:
            self<a id="change">.model, self.optimizer, self.train_loader = </a><a id="change">self._accel.prepare(
                </a>self.model, self.optimizer, self.train_loader<a id="change">
            )</a>

        &#47&#47 if self.config.fp16:
        &#47&#47     self.scaler = torch.cuda.amp.GradScaler()
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/abhi1thakur/tez/commit/449f278846aad8bec4023d72b38576dc199131ea#diff-f660d461854c66d0499111062c0db2ec9def34eb74858385556acf394ec6032cL48' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 112504500</div><div id='project'> Project Name: abhi1thakur/tez</div><div id='commit'> Commit Name: 449f278846aad8bec4023d72b38576dc199131ea</div><div id='time'> Time: 2022-07-06</div><div id='author'> Author: abhishek4@gmail.com</div><div id='file'> File Name: tez/model/tez.py</div><div id='m_class'> M Class Name: Tez</div><div id='n_method'> N Class Name: Tez</div><div id='m_method'> M Method Name: _init_trainer(4)</div><div id='n_method'> N Method Name: _init_trainer(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tez/model/tez.py</div><div id='n_file'> N File Name: tez/model/tez.py</div><div id='m_start'> M Start Line: 81</div><div id='m_end'> M End Line: 193</div><div id='n_start'> N Start Line: 48</div><div id='n_end'> N End Line: 146</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        if w_train is None:
            w_train = pd.DataFrame(np.ones_like(y_train.values), index=y_train.index)
        <a id="change">if </a>w_valid is None:
            w_valid = pd.DataFrame(np.ones_like(y_valid.values), index=y_valid.index)

        save_path = create_save_path(save_path)</code></pre><h3>After Change</h3><pre><code class='java'>
        save_path=None,
    ):

        df_train<a id="change">, df_valid = </a><a id="change">dataset.prepare(
            </a>["train", "valid"]<a id="change">, col_set=["feature", "label"], data_key=DataHandlerLP.DK_L
        )</a>
        x_train, y_train = df_train["feature"], df_train["label"]
        x_valid, y_valid = df_valid["feature"], df_valid["label"]

        try:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/853410c16eb79708371b87a4af37de18840e03f2#diff-262692c578e458decfd85fcba44547340ec8f0f95ae83157e691e4f10f496179L145' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 112504503</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: 853410c16eb79708371b87a4af37de18840e03f2</div><div id='time'> Time: 2020-11-09</div><div id='author'> Author: dw1920@nyu.edu</div><div id='file'> File Name: qlib/contrib/model/pytorch_nn.py</div><div id='m_class'> M Class Name: DNNModelPytorch</div><div id='n_method'> N Class Name: DNNModelPytorch</div><div id='m_method'> M Method Name: fit(5)</div><div id='n_method'> N Method Name: fit(10)</div><div id='m_parent_class'> M Parent Class: Model</div><div id='n_parent_class'> N Parent Class: Model</div><div id='m_file'> M File Name: qlib/contrib/model/pytorch_nn.py</div><div id='n_file'> N File Name: qlib/contrib/model/pytorch_nn.py</div><div id='m_start'> M Start Line: 147</div><div id='m_end'> M End Line: 163</div><div id='n_start'> N Start Line: 149</div><div id='n_end'> N End Line: 206</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            pin_memory=pin_memory,
        )

        <a id="change">if </a>self.model.training:
            self.model.eval()

        for data in data_loader:</code></pre><h3>After Change</h3><pre><code class='java'>
            drop_last=False,
        )

        self<a id="change">.model, data_loader = </a><a id="change">self._accel.prepare(</a>self.model, data_loader<a id="change">)</a>

        self.model.eval()

        for data in data_loader:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/abhi1thakur/tez/commit/90933936418c38774062d73dce874a996b50c158#diff-f660d461854c66d0499111062c0db2ec9def34eb74858385556acf394ec6032cL433' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 112504519</div><div id='project'> Project Name: abhi1thakur/tez</div><div id='commit'> Commit Name: 90933936418c38774062d73dce874a996b50c158</div><div id='time'> Time: 2022-07-07</div><div id='author'> Author: abhishek4@gmail.com</div><div id='file'> File Name: tez/model/tez.py</div><div id='m_class'> M Class Name: Tez</div><div id='n_method'> N Class Name: Tez</div><div id='m_method'> M Method Name: predict(2)</div><div id='n_method'> N Method Name: predict(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tez/model/tez.py</div><div id='n_file'> N File Name: tez/model/tez.py</div><div id='m_start'> M Start Line: 479</div><div id='m_end'> M End Line: 482</div><div id='n_start'> N Start Line: 439</div><div id='n_end'> N End Line: 491</div><BR>