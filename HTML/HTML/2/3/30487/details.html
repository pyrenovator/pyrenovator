<html><h3>Pattern ID :30487
</h3><img src='90238560.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

    &#47&#47 add noise
    wavaug = WavAug(sample_rate=out_sample_rate, mode="test")
    for wav_file in <a id="change">tqdm(</a>wav_files<a id="change">)</a>:
        output_path = wav_file.replace(str(data_dir), str(save_dir))
        Path(output_path).parent.mkdir(parents=True, exist_ok=True)
</code></pre><h3>After Change</h3><pre><code class='java'>
    assert data_dir != save_dir, f"data_dir and save_dir should not be the same!"
    assert data_dir.exists(), f"{data_dir} does not exist!"
    print(f"[INFO] data_dir : {data_dir}")
    <a id="change">print(f"[INFO] save_dir : {save_dir}"</a><a id="change">)</a>
    save_dir.mkdir(parents=True, exist_ok=True)

    &#47&#47 find wav files
    wav_files = librosa.util.find_files(data_dir)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 8</div><BR><div id='size'>Non-data size: 2</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/ga642381/robustvc/commit/b126baaf7f3ce43577adb438842d1c6c4904b722#diff-5b54711dd6b5dcab5729c760588f01daaa854df533804b325965013633add281L22' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 90238560</div><div id='project'> Project Name: ga642381/robustvc</div><div id='commit'> Commit Name: b126baaf7f3ce43577adb438842d1c6c4904b722</div><div id='time'> Time: 2021-08-28</div><div id='author'> Author: ga642381@gmail.com</div><div id='file'> File Name: assets/script/dataset_noise.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(3)</div><div id='n_method'> N Method Name: main(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: assets/script/dataset_noise.py</div><div id='n_file'> N File Name: assets/script/dataset_noise.py</div><div id='m_start'> M Start Line: 22</div><div id='m_end'> M End Line: 46</div><div id='n_start'> N Start Line: 37</div><div id='n_end'> N End Line: 64</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            test_cnt = 0
            for (dirpath, _, filenames) in os.walk(test_path):
                print(f&quotcopying {dirpath} -&gt; {processed_test_path}&quot)
                for filename in <a id="change">tqdm(</a>filenames<a id="change">)</a>:
                    if filename.endswith(&quot.jpg&quot):
                        relsourcepath = os.path.relpath(dirpath, test_path)
                        destpath = os.path.join(processed_test_path, relsourcepath)</code></pre><h3>After Change</h3><pre><code class='java'>
        print("Unzip the downloaded file and find \&quottest\&quot and \&quottrain\&quot folders "
              "and copy them into \&quotdata/cats_vs_dogs\&quot. ")
        print("Make sure that images are in the following directory structure:")
        <a id="change">print("  \&quotdata/cats_vs_dogs/train/cats\&quot"</a><a id="change">)</a>
        print("  \&quotdata/cats_vs_dogs/train/dogs\&quot")
        print("  \&quotdata/cats_vs_dogs/test/cats\&quot")
        print("  \&quotdata/cats_vs_dogs/test/dogs\&quot")
        print("Re-run the script. The script will create an \&quotaugmented\&quot folder ")</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/maximintegratedai/ai8x-training/commit/b7e48bb0c9f807e182c0568c533abeedbda7906e#diff-0746092ad24c69c3410de6010c914928737b3226e13f5ec148f341d8f4b05514L57' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 90238561</div><div id='project'> Project Name: maximintegratedai/ai8x-training</div><div id='commit'> Commit Name: b7e48bb0c9f807e182c0568c533abeedbda7906e</div><div id='time'> Time: 2022-05-10</div><div id='author'> Author: 48036488+aniktash@users.noreply.github.com</div><div id='file'> File Name: datasets/cats_vs_dogs.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: catsdogs_get_datasets(4)</div><div id='n_method'> N Method Name: catsdogs_get_datasets(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: datasets/cats_vs_dogs.py</div><div id='n_file'> N File Name: datasets/cats_vs_dogs.py</div><div id='m_start'> M Start Line: 118</div><div id='m_end'> M End Line: 133</div><div id='n_start'> N Start Line: 73</div><div id='n_end'> N End Line: 134</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    best_score = float(&quot-inf&quot)
    best_model = None

    for iteration in <a id="change">tqdm(</a>range(max_iterations)<a id="change">)</a>:

        totloss = 0
        c = 0</code></pre><h3>After Change</h3><pre><code class='java'>
    

    correct ,tot = eval(best_model, test, device)
    <a id="change">print(f&quot\nTest accuracy: {correct / tot}&quot</a><a id="change">)</a>
        

        
def eval(model, test, device):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tiagomantunes/karen/commit/53298391d3359a8d3c02b9fe84ccf36d2ec00950#diff-81b53beb0622f06b4d0bc961e5bb5bed36c5cb3828666638fe241d38d4ef5b00L8' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 90238532</div><div id='project'> Project Name: tiagomantunes/karen</div><div id='commit'> Commit Name: 53298391d3359a8d3c02b9fe84ccf36d2ec00950</div><div id='time'> Time: 2021-05-28</div><div id='author'> Author: tiago.melo.antunes@gmail.com</div><div id='file'> File Name: framework/training.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(9)</div><div id='n_method'> N Method Name: train(9)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: framework/training.py</div><div id='n_file'> N File Name: framework/training.py</div><div id='m_start'> M Start Line: 35</div><div id='m_end'> M End Line: 84</div><div id='n_start'> N Start Line: 35</div><div id='n_end'> N End Line: 89</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            best_vloss = torch.inf if &quotval_loss&quot not in self.losses else min(self.losses[&quotval_loss&quot])
            count_lr_no_improve = 0
            count_early_stop = 0
            for _ in <a id="change">tqdm(</a>range(self.current_epoch, self.train_args[&quotmax_epochs&quot])<a id="change">)</a>:

                &#47&#47 Train the model
                self.model.train(True)</code></pre><h3>After Change</h3><pre><code class='java'>

                &#47&#47 Check for early stopping
                if count_early_stop &gt;= self.train_args[&quotearlystop_patience&quot]:
                    <a id="change">print(&quotEarly stopping.&quot</a><a id="change">)</a>
                    break

            torch.save(self.best_model, join(self.savepath_dict[&quothomepath&quot], f&quotmodel_{self.current_epoch + 1}.pt&quot))
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/royerlab/cytoself/commit/b3b16f803da5f046ba94cf78bea05fa7bb23f7bc#diff-523a645fa31e54102ea3d8c4549d9c4caee9ee4e75e32ac26e816f9dccd684fdL346' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 90238535</div><div id='project'> Project Name: royerlab/cytoself</div><div id='commit'> Commit Name: b3b16f803da5f046ba94cf78bea05fa7bb23f7bc</div><div id='time'> Time: 2022-07-12</div><div id='author'> Author: liamiiliil@gmail.com</div><div id='file'> File Name: cytoself/trainer/basetrainer.py</div><div id='m_class'> M Class Name: BaseTrainer</div><div id='n_method'> N Class Name: BaseTrainer</div><div id='m_method'> M Method Name: fit(4)</div><div id='n_method'> N Method Name: fit(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: cytoself/trainer/basetrainer.py</div><div id='n_file'> N File Name: cytoself/trainer/basetrainer.py</div><div id='m_start'> M Start Line: 373</div><div id='m_end'> M End Line: 377</div><div id='n_start'> N Start Line: 373</div><div id='n_end'> N End Line: 407</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        patch_size = self.cfg.patch_size

        &#47&#47 Compute anomaly map of anomaly images
        for i, (img, mask) in <a id="change">tqdm(</a>enumerate(self.test_anomaly_dataloader)<a id="change">)</a>:
            
            img.to(self.cfg.device)
            h, w, c = img.shape</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 Compute anomaly map of normal images
        for i, (img, arr, mask) in enumerate(self.test_normal_dataloader):

            <a id="change">print(f&quot{i+1}/{len(self.test_anomaly_dataloader)}&quot</a><a id="change">)</a>
            
            b, c, h, w = img.shape
            anomaly_map = np.zeros((h, w))
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/taikiinoue/stad/commit/fa86afcb446f6f9853f81d36632e9b83d767e1f9#diff-b29b28f1ad780fa199366aab98611397f2d066c70a058eb15b54f8cf0455871dL133' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 90238537</div><div id='project'> Project Name: taikiinoue/stad</div><div id='commit'> Commit Name: fa86afcb446f6f9853f81d36632e9b83d767e1f9</div><div id='time'> Time: 2020-07-07</div><div id='author'> Author: taikiinoue45@gmail.com</div><div id='file'> File Name: stad/trainer/trainer.py</div><div id='m_class'> M Class Name: Trainer</div><div id='n_method'> N Class Name: Trainer</div><div id='m_method'> M Method Name: run_inference(1)</div><div id='n_method'> N Method Name: run_inference(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: stad/trainer/trainer.py</div><div id='n_file'> N File Name: stad/trainer/trainer.py</div><div id='m_start'> M Start Line: 141</div><div id='m_end'> M End Line: 179</div><div id='n_start'> N Start Line: 140</div><div id='n_end'> N End Line: 184</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    kmeans = MiniBatchKMeans(n_clusters=k, batch_size=batch_size)
    vectors = None
    print("starting kmeans")
    for i in <a id="change">tqdm(</a>range(epochs)<a id="change">)</a>:
        for path in paths:
            if vectors is None:
                vectors = np.load(path)</code></pre><h3>After Change</h3><pre><code class='java'>
    vectors = None
    print("starting kmeans")
    for i in range(epochs):
        <a id="change">print("epoch:"</a>, i<a id="change">)</a>
        for path in tqdm(paths):
            if vectors is None:
                vectors = np.load(path)
            else:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ammesatyajit/videobert/commit/2a6e108d236273c9fc41578df05971824e958cf7#diff-3a927794d8a0e757a857aef47fbf5181598cbc3c500fa0fa2778a70aa7a1f10aL8' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 90238540</div><div id='project'> Project Name: ammesatyajit/videobert</div><div id='commit'> Commit Name: 2a6e108d236273c9fc41578df05971824e958cf7</div><div id='time'> Time: 2021-01-01</div><div id='author'> Author: ammesatyajit@gmail.com</div><div id='file'> File Name: VideoBERT/I3D/minibatch_hkmeans.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: minibatch_kmeans(5)</div><div id='n_method'> N Method Name: minibatch_kmeans(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: VideoBERT/I3D/minibatch_hkmeans.py</div><div id='n_file'> N File Name: VideoBERT/I3D/minibatch_hkmeans.py</div><div id='m_start'> M Start Line: 15</div><div id='m_end'> M End Line: 25</div><div id='n_start'> N Start Line: 15</div><div id='n_end'> N End Line: 26</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        best_acc = -1
        &#47&#47 scheduler = self.schedule_lr(self.optimizer)
        for epoch in range(self.n_epochs):
            for idx, (image, y_train) in <a id="change">tqdm(</a>enumerate(self.train_loader)<a id="change">)</a>:
                image = image.to(self.device)
                y_train=y_train.to(self.device)
                y_pred = self.model(image)</code></pre><h3>After Change</h3><pre><code class='java'>
        best_acc = -1
        &#47&#47 scheduler = self.schedule_lr(self.optimizer)
        for epoch in range(self.n_epochs):
            <a id="change">print("Training..."</a><a id="change">)</a>
            for idx, (image, y_train) in enumerate(self.train_loader):
                image = image.to(self.device)
                y_train=y_train.to(self.device)
                y_pred = self.model(image)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tungedng2710/improved-arcface/commit/8809199be93a91cedd1355df431d7bbc46458991#diff-9f1d8e92cd6ea2024cda543185e6c91bbc5cd7377d0eb7d5b071abee5e466410L38' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 90238542</div><div id='project'> Project Name: tungedng2710/improved-arcface</div><div id='commit'> Commit Name: 8809199be93a91cedd1355df431d7bbc46458991</div><div id='time'> Time: 2021-12-15</div><div id='author'> Author: tungnguyen99.tn@gmail.com</div><div id='file'> File Name: trainer.py</div><div id='m_class'> M Class Name: Trainer</div><div id='n_method'> N Class Name: Trainer</div><div id='m_method'> M Method Name: train(3)</div><div id='n_method'> N Method Name: train(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: trainer.py</div><div id='n_file'> N File Name: trainer.py</div><div id='m_start'> M Start Line: 43</div><div id='m_end'> M End Line: 64</div><div id='n_start'> N Start Line: 43</div><div id='n_end'> N End Line: 57</div><BR>