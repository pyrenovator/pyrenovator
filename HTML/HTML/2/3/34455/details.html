<html><h3>Pattern ID :34455
</h3><img src='98806195.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    model = classification.__dict__[arch_name](pretrained=True).eval()
    &#47&#47 Forward
    with torch.no_grad():
        out<a id="change"> = </a><a id="change">model(</a>torch.rand((batch_size, *input_shape), dtype=torch.float32)<a id="change">)</a>
    &#47&#47 Output checks
    assert isinstance(out, torch.Tensor)
    assert out.dtype == torch.float32
    assert out.numpy().shape == (batch_size, *output_size)</code></pre><h3>After Change</h3><pre><code class='java'>
    model = classification.__dict__[arch_name](pretrained=True).eval()
    _test_classification(model, input_shape, output_size)
    &#47&#47 test pretrained model with different num_classes
    model = <a id="change">classification.__dict__[arch_name](pretrained=True, num_classes=108).eval()</a>
    _test_classification(model, input_shape, output_size=(108,))


@pytest.mark.parametrize(</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/mindee/doctr/commit/6e806ca3f8ae19e67a2e8c95ee04bf3da1381602#diff-dca7150679f3a079fb82bbbf4432b5c10f37cefeb5dd0fe82960b80ea88b3b8dL26' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 98806195</div><div id='project'> Project Name: mindee/doctr</div><div id='commit'> Commit Name: 6e806ca3f8ae19e67a2e8c95ee04bf3da1381602</div><div id='time'> Time: 2022-04-05</div><div id='author'> Author: felixdittrich92@gmail.com</div><div id='file'> File Name: tests/pytorch/test_models_classification_pt.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_classification_architectures(3)</div><div id='n_method'> N Method Name: test_classification_architectures(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/pytorch/test_models_classification_pt.py</div><div id='n_file'> N File Name: tests/pytorch/test_models_classification_pt.py</div><div id='m_start'> M Start Line: 26</div><div id='m_end'> M End Line: 42</div><div id='n_start'> N Start Line: 42</div><div id='n_end'> N End Line: 46</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        dummy_input = self.dummy_input

        image<a id="change"> = </a><a id="change">model(</a>*<a id="change">dummy_input)</a>
        new_image = new_model(*dummy_input)

        assert (image - new_image).abs().sum() &lt; 1e-5, "Models don&quott give the same forward pass"
</code></pre><h3>After Change</h3><pre><code class='java'>

        model = self.model_class(**init_dict)
        model.to(torch_device)
        <a id="change">model.eval()</a>

        with tempfile.TemporaryDirectory() as tmpdirname:
            model.save_pretrained(tmpdirname)
            new_model = UNetModel.from_pretrained(tmpdirname)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/diffusers/commit/7dc71897b34a8130e3450dfc0a6498dc6b582b80#diff-4477682aa2d35ffa1e5b6d67f459bd4254c1ce4fda4ecdebbbb9f323a04bacfaL97' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 98806199</div><div id='project'> Project Name: huggingface/diffusers</div><div id='commit'> Commit Name: 7dc71897b34a8130e3450dfc0a6498dc6b582b80</div><div id='time'> Time: 2022-06-17</div><div id='author'> Author: surajp815@gmail.com</div><div id='file'> File Name: tests/test_modeling_utils.py</div><div id='m_class'> M Class Name: ModelTesterMixin</div><div id='n_method'> N Class Name: ModelTesterMixin</div><div id='m_method'> M Method Name: test_from_pretrained_save_pretrained(1)</div><div id='n_method'> N Method Name: test_from_pretrained_save_pretrained(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: tests/test_modeling_utils.py</div><div id='n_file'> N File Name: tests/test_modeling_utils.py</div><div id='m_start'> M Start Line: 98</div><div id='m_end'> M End Line: 109</div><div id='n_start'> N Start Line: 87</div><div id='n_end'> N End Line: 102</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        for i, (inputs, labels) in enumerate(tqdm(train_loader, leave=False), start=1):
            inputs = inputs.to(device)
            labels = labels.to(device)
            outputs = <a id="change">model(</a>inputs<a id="change">)</a>
            loss = criterion(outputs, labels)
            optimizer.zero_grad()
            loss.backward()
            optimizer.step()
            loss_avg<a id="change"> += </a>loss.item()
            if verbose and i % 100 == 0:
                tqdm.write(
                    f"Epoch [{epoch}/{num_epochs}], "</code></pre><h3>After Change</h3><pre><code class='java'>
        model.train()
        train_loss = run_epoch(model, train_loader, device, criterion, optimizer)
        train_loss_history.append(train_loss)
        <a id="change">model.eval()</a>
        with torch.no_grad():
            val_loss = run_epoch(model, val_loader, device, criterion)
        val_loss_history.append(val_loss)
        if verbose:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jaketae/deep-malware-detection/commit/745a3e07407c7a3bac0f9828d6c42101d998c3c6#diff-ed183d67207df065a11e1289f19d34cc2abbc5448dea952683cfe9728c342b95L10' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 98806191</div><div id='project'> Project Name: jaketae/deep-malware-detection</div><div id='commit'> Commit Name: 745a3e07407c7a3bac0f9828d6c42101d998c3c6</div><div id='time'> Time: 2020-11-23</div><div id='author'> Author: jaesungtae@gmail.com</div><div id='file'> File Name: train.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(9)</div><div id='n_method'> N Method Name: train(8)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: train.py</div><div id='n_file'> N File Name: train.py</div><div id='m_start'> M Start Line: 20</div><div id='m_end'> M End Line: 53</div><div id='n_start'> N Start Line: 16</div><div id='n_end'> N End Line: 46</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                x = melspec_fn(x)

                &#47&#47 compute loss
                y<a id="change"> = </a><a id="change">model(</a>x<a id="change">)</a>
                loss = F.mse_loss(y, x)

                val_losses[&quotloss_val&quot] += loss.item()
                val_n += 1</code></pre><h3>After Change</h3><pre><code class='java'>
            model_eval = model_ema
        else:
            model_eval = model
        <a id="change">model_eval.eval()</a>
        val_losses = defaultdict(float)
        val_n = 0
        with torch.no_grad():
            for x in loader_val:  &#47&#47 XXX: add e.g. tqdm for big validation sets</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/wuaalb/pytorch_template_audio/commit/c4139268ca0f749f4ec4c0a299d889225b89b003#diff-ed183d67207df065a11e1289f19d34cc2abbc5448dea952683cfe9728c342b95L26' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 98806189</div><div id='project'> Project Name: wuaalb/pytorch_template_audio</div><div id='commit'> Commit Name: c4139268ca0f749f4ec4c0a299d889225b89b003</div><div id='time'> Time: 2020-11-23</div><div id='author'> Author: mblaauw@gmail.com</div><div id='file'> File Name: train.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(1)</div><div id='n_method'> N Method Name: train(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: train.py</div><div id='n_file'> N File Name: train.py</div><div id='m_start'> M Start Line: 66</div><div id='m_end'> M End Line: 192</div><div id='n_start'> N Start Line: 66</div><div id='n_end'> N End Line: 199</div><BR>