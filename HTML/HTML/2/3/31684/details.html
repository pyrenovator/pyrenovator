<html><h3>Pattern ID :31684
</h3><img src='92393569.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    w = generator.linear0.weight
    eigen_vectors = torch.svd(w).V.to(z.device)[:, :num_semantic_axis]

    zs_start = z.repeat(num_semantic_axis).view(-1, 1, <a id="change">len(</a>z<a id="change">)</a>)
    zs_end = (z.unsqueeze(1) + maximum_variations*eigen_vectors).T.view(-1, 1, len(z))
    zs_canvas = misc.interpolate(x0=zs_start, x1=zs_end, num_midpoints=num_cols-2).view(-1, len(z))
    images_canvas = generator(zs_canvas, fake_label.repeat(len(zs_canvas)), eval=True)</code></pre><h3>After Change</h3><pre><code class='java'>
    zs_start = z.repeat(num_semantic_axis).view(-1, 1, z_dim)
    zs_end = (z.unsqueeze(1) + maximum_variations*eigen_vectors).T.view(-1, 1, z_dim)
    if backbone == "big_resnet":
        zs_shard = <a id="change">zs[z_dim:].expand(</a>[1, 1, -1]<a id="change">)</a>.repeat(num_semantic_axis, 1, 1)
        zs_start = torch.cat([zs_start, zs_shard], axis=2)
        zs_end<a id="change"> = </a>torch.cat([zs_end, zs_shard], axis=2)
    zs_canvas = misc.interpolate(x0=zs_start, x1=zs_end, num_midpoints=num_cols-2).view(-1, zs_start.shape[-1])
    images_canvas = generator(zs_canvas, fake_label.repeat(len(zs_canvas)), eval=True)
    return images_canvas</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/postech-cvlab/pytorch-studiogan/commit/b4e68975c4ce99a3a230f49229c1164ef4b6b84a#diff-2a2508841b4d823c367229f2635073c52a1ee5b0db2dbc5ffdcc406284e3eabaL12' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 92393569</div><div id='project'> Project Name: postech-cvlab/pytorch-studiogan</div><div id='commit'> Commit Name: b4e68975c4ce99a3a230f49229c1164ef4b6b84a</div><div id='time'> Time: 2021-09-16</div><div id='author'> Author: first287@naver.com</div><div id='file'> File Name: src/utils/sefa.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: apply_sefa(7)</div><div id='n_method'> N Method Name: apply_sefa(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/utils/sefa.py</div><div id='n_file'> N File Name: src/utils/sefa.py</div><div id='m_start'> M Start Line: 17</div><div id='m_end'> M End Line: 19</div><div id='n_start'> N Start Line: 12</div><div id='n_end'> N End Line: 27</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            &#47&#47print(labels[i])
            for j in range(len(labels[i])):
                if labels[i, j] == 1:
                    if j != <a id="change">len(</a>labels[i]<a id="change">)</a>-1:
                        cur_query_matrix.extend(self.memory_matrix[j*self.num_prototype:(j+1)*self.num_prototype, :])
                    else:
                        cur_query_matrix.extend(self.memory_matrix[j * self.num_prototype:, :])</code></pre><h3>After Change</h3><pre><code class='java'>

        &#47&#47 Memory querying and responding for visual features

        dummy_memory_matrix<a id="change"> = </a><a id="change">self.memory_matrix.unsqueeze(0).expand(</a>att_feats.size(0), self.memory_matrix.size(0), self.memory_matrix.size(1)<a id="change">)</a>
        responses = self.cmn(att_feats, dummy_memory_matrix, dummy_memory_matrix)

        max_num_protype = max((labels[:,-1]*3 + labels[:,:-1].sum(-1))) * self.num_prototype
        query_matrix = self.memory_matrix.new_zeros(att_feats.size(0), max_num_protype, self.memory_matrix.shape[-1])</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/markin-wang/xpronet/commit/4ce89afc1120d8d6dd836304f6537d139f0505f1#diff-b630bb1eacf9d665efc0c82b70d348b40f19422267ac86cbe6329800b8b3d4d3L388' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 92393563</div><div id='project'> Project Name: markin-wang/xpronet</div><div id='commit'> Commit Name: 4ce89afc1120d8d6dd836304f6537d139f0505f1</div><div id='time'> Time: 2021-11-23</div><div id='author'> Author: cserwj@gmail.com</div><div id='file'> File Name: modules/base_cmn.py</div><div id='m_class'> M Class Name: BaseCMN</div><div id='n_method'> N Class Name: BaseCMN</div><div id='m_method'> M Method Name: _prepare_feature_forward(5)</div><div id='n_method'> N Method Name: _prepare_feature_forward(5)</div><div id='m_parent_class'> M Parent Class: AttModel</div><div id='n_parent_class'> N Parent Class: AttModel</div><div id='m_file'> M File Name: modules/base_cmn.py</div><div id='n_file'> N File Name: modules/base_cmn.py</div><div id='m_start'> M Start Line: 400</div><div id='m_end'> M End Line: 417</div><div id='n_start'> N Start Line: 400</div><div id='n_end'> N End Line: 401</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        
        with torch.no_grad():
            all_updated = []
            for pattern_idx in range(<a id="change">len(</a>pattern_features<a id="change">)</a>):
                &#47&#47 permutation is unique for every pattern hence cannot perform vector operations
                &#47&#47 Padding is mixed up in the permutation, no need for additional processing
                updated_feature = torch.stack([pattern_features[pattern_idx][i] for i in permutation[pattern_idx]])</code></pre><h3>After Change</h3><pre><code class='java'>
                for _ in range(len(pattern_features.shape) - len(permutation.shape)):
                    extended_permutation = extended_permutation.unsqueeze(-1)
                &#47&#47 expand just creates a new view without extra copies
                extended_permutation<a id="change"> = </a><a id="change">extended_permutation.expand(</a>pattern_features.shape<a id="change">)</a>

            &#47&#47 collect features with correct permutation in pattern dimention
            indexed_features = torch.gather(pattern_features, dim=1, index=extended_permutation)
        </code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/maria-korosteleva/garment-pattern-estimation/commit/66c717b0d59467277210e38e07f0d574af577038#diff-66aae7ec57f079963bb4847ebb79bfda4004ba832ee23e11911a14908193967cL898' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 92393562</div><div id='project'> Project Name: maria-korosteleva/garment-pattern-estimation</div><div id='commit'> Commit Name: 66c717b0d59467277210e38e07f0d574af577038</div><div id='time'> Time: 2021-06-14</div><div id='author'> Author: mariako@kaist.ac.kr</div><div id='file'> File Name: nn/metrics.py</div><div id='m_class'> M Class Name: ComposedPatternLoss</div><div id='n_method'> N Class Name: ComposedPatternLoss</div><div id='m_method'> M Method Name: _feature_permute(2)</div><div id='n_method'> N Method Name: _feature_permute(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: nn/metrics.py</div><div id='n_file'> N File Name: nn/metrics.py</div><div id='m_start'> M Start Line: 903</div><div id='m_end'> M End Line: 910</div><div id='n_start'> N Start Line: 903</div><div id='n_end'> N End Line: 914</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    &#47&#47 https://huggingface.co/transformers/internal/tokenization_utils.html&#47&#47transformers.tokenization_utils_base.SpecialTokensMixin.add_tokens
    tokenizer.add_tokens(wisdoms)
    &#47&#47 https://huggingface.co/transformers/main_classes/model.html&#47&#47transformers.PreTrainedModel.resize_token_embeddings
    model.resize_token_embeddings(<a id="change">len(</a>tokenizer<a id="change">)</a>)
    &#47&#47 https://huggingface.co/transformers/_modules/transformers/modeling_bert.html
    word_embeddings: torch.nn.Embedding = model.bert.embeddings.word_embeddings
    wiskeys = WisKeysBuilder(tokenizer, device)(wisdoms)  &#47&#47 (|W|,)</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47 30000이 무엇을 의미하는가? - 어휘의 크기/
    inputs = word_embeddings(encoded[&quotinput_ids&quot])  &#47&#47 (N, L) -&gt; (N, L, E=H)
    token_types = token_type_embeddings(encoded[&quottoken_type_ids&quot])  &#47&#47 (N, L) -&gt; (N, L, E=H)
    positions<a id="change"> = </a>position_embeddings(<a id="change">torch.arange(L).expand(</a>N, L<a id="change">)</a>)
    fused = inputs + token_types + positions
    print(fused)  &#47&#47 이것이 bert의 입력으로 들어간다.
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/eubinecto/wisdomify/commit/5a03b27e6f81452ba455ffd3a19daabc799e91f9#diff-d0b0f2e910a08437939a98f9c38292bfe2c8a710de76c8d8032660c9a4563b8aL7' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 92393565</div><div id='project'> Project Name: eubinecto/wisdomify</div><div id='commit'> Commit Name: 5a03b27e6f81452ba455ffd3a19daabc799e91f9</div><div id='time'> Time: 2021-10-12</div><div id='author'> Author: eubinecto</div><div id='file'> File Name: wisdomify/examples/explore_bert_embeddings.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: wisdomify/examples/explore_bert_embeddings.py</div><div id='n_file'> N File Name: wisdomify/examples/explore_bert_embeddings.py</div><div id='m_start'> M Start Line: 8</div><div id='m_end'> M End Line: 26</div><div id='n_start'> N Start Line: 17</div><div id='n_end'> N End Line: 55</div><BR>