<html><h3>Pattern ID :32423
</h3><img src='94597795.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        
        Should return: the evaluation result (float)
        
        <a id="change">return </a><a id="change">accuracy_score(</a>label, np.argmax(predict, axis=1)<a id="change">)</a>


@register_evaluate("mrr")
class Mrr(Evaluation):</code></pre><h3>After Change</h3><pre><code class='java'>
            predict = np.argmax(predict, axis=1)
        else:
            predict = [1 if p &gt; 0.5 else 0 for p in predict]
        return <a id="change">accuracy_score(</a>label, predict<a id="change">)</a>


@register_evaluate("mrr")
class Mrr(Evaluation):</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/thumnlab/autogl/commit/4878a0abe50e14aa04c220d601208935cf04069e#diff-11e5a389e7c284145e32ed5d4084773fad10e468c1c00d93337cd95e761d2e44L145' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 94597795</div><div id='project'> Project Name: thumnlab/autogl</div><div id='commit'> Commit Name: 4878a0abe50e14aa04c220d601208935cf04069e</div><div id='time'> Time: 2021-05-30</div><div id='author'> Author: frozenmad2015@outlook.com</div><div id='file'> File Name: autogl/module/train/evaluation.py</div><div id='m_class'> M Class Name: Acc</div><div id='n_method'> N Class Name: Acc</div><div id='m_method'> M Method Name: evaluate(2)</div><div id='n_method'> N Method Name: evaluate(2)</div><div id='m_parent_class'> M Parent Class: Evaluation</div><div id='n_parent_class'> N Parent Class: Evaluation</div><div id='m_file'> M File Name: autogl/module/train/evaluation.py</div><div id='n_file'> N File Name: autogl/module/train/evaluation.py</div><div id='m_start'> M Start Line: 145</div><div id='m_end'> M End Line: 145</div><div id='n_start'> N Start Line: 146</div><div id='n_end'> N End Line: 150</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 training metrics
        preds = torch.argmax(logits, dim=1)
        preds, y = preds.cpu(), y.cpu()
        acc = <a id="change">accuracy_score(</a>preds, y<a id="change">)</a>
        self.log(&quottrain_loss&quot, loss, on_step=False, on_epoch=True, logger=True, prog_bar=True)
        self.log(&quottrain_acc&quot, acc, on_step=False, on_epoch=True, logger=True, prog_bar=True)

        return loss</code></pre><h3>After Change</h3><pre><code class='java'>

        &#47&#47 training metrics
        preds = torch.argmax(logits, dim=1)
        acc = <a id="change">accuracy_score(</a>preds.cpu(), y.cpu()<a id="change">)</a>
        self.log(&quottrain_loss&quot, loss, on_step=False, on_epoch=True, logger=True, prog_bar=True)
        self.log(&quottrain_acc&quot, acc, on_step=False, on_epoch=True, logger=True, prog_bar=True)

        &#47&#47 we can return here anything and then read it in some callback
        <a id="change">return </a>loss, acc, preds, y

    &#47&#47 logic for a single validation step
    def validation_step(self, batch, batch_idx):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ashleve/lightning-hydra-template/commit/0030c94b17bdd837b536a177ae3b0725d2c3e74d#diff-e03535cf9a37db01715946f6f12ec50ec7e66db034189f20317e30d3e2d8af02L36' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 94597799</div><div id='project'> Project Name: ashleve/lightning-hydra-template</div><div id='commit'> Commit Name: 0030c94b17bdd837b536a177ae3b0725d2c3e74d</div><div id='time'> Time: 2021-01-09</div><div id='author'> Author: zalewski.ukas@gmail.com</div><div id='file'> File Name: project/pytorch_modules/lightning_models/simple_mnist_classifier.py</div><div id='m_class'> M Class Name: LitModel</div><div id='n_method'> N Class Name: LitModel</div><div id='m_method'> M Method Name: training_step(3)</div><div id='n_method'> N Method Name: training_step(3)</div><div id='m_parent_class'> M Parent Class: pl.LightningModule</div><div id='n_parent_class'> N Parent Class: pl.LightningModule</div><div id='m_file'> M File Name: project/pytorch_modules/lightning_models/simple_mnist_classifier.py</div><div id='n_file'> N File Name: project/pytorch_modules/lightning_models/simple_mnist_classifier.py</div><div id='m_start'> M Start Line: 39</div><div id='m_end'> M End Line: 48</div><div id='n_start'> N Start Line: 39</div><div id='n_end'> N End Line: 48</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        
        Should return: the evaluation result (float)
        
        return <a id="change">accuracy_score(</a>label, np.argmax(predict, axis=1)<a id="change">)</a>


@register_evaluate("mrr")
class Mrr(Evaluation):</code></pre><h3>After Change</h3><pre><code class='java'>
            predict = np.argmax(predict, axis=1)
        else:
            predict = [1 if p &gt; 0.5 else 0 for p in predict]
        <a id="change">return </a><a id="change">accuracy_score(</a>label, predict<a id="change">)</a>


@register_evaluate("mrr")
class Mrr(Evaluation):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/thumnlab/autogl/commit/136bddfdc1dcfa2f07648dd722570e0c06b90e0b#diff-11e5a389e7c284145e32ed5d4084773fad10e468c1c00d93337cd95e761d2e44L198' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 94597798</div><div id='project'> Project Name: thumnlab/autogl</div><div id='commit'> Commit Name: 136bddfdc1dcfa2f07648dd722570e0c06b90e0b</div><div id='time'> Time: 2021-06-22</div><div id='author'> Author: null</div><div id='file'> File Name: autogl/module/train/evaluation.py</div><div id='m_class'> M Class Name: Acc</div><div id='n_method'> N Class Name: Acc</div><div id='m_method'> M Method Name: evaluate(2)</div><div id='n_method'> N Method Name: evaluate(2)</div><div id='m_parent_class'> M Parent Class: Evaluation</div><div id='n_parent_class'> N Parent Class: Evaluation</div><div id='m_file'> M File Name: autogl/module/train/evaluation.py</div><div id='n_file'> N File Name: autogl/module/train/evaluation.py</div><div id='m_start'> M Start Line: 202</div><div id='m_end'> M End Line: 202</div><div id='n_start'> N Start Line: 216</div><div id='n_end'> N End Line: 220</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 validation metrics
        preds = torch.argmax(logits, dim=1)
        preds, y = preds.cpu(), y.cpu()
        acc = <a id="change">accuracy_score(</a>preds, y<a id="change">)</a>
        self.log(&quotval_loss&quot, loss, on_step=False, on_epoch=True, logger=True, prog_bar=True)
        self.log(&quotval_acc&quot, acc, on_step=False, on_epoch=True, logger=True, prog_bar=True)

        &#47&#47 we can return here anything and then read it in some callback</code></pre><h3>After Change</h3><pre><code class='java'>

        &#47&#47 validation metrics
        preds = torch.argmax(logits, dim=1)
        acc = <a id="change">accuracy_score(</a>preds.cpu(), y.cpu()<a id="change">)</a>
        self.log(&quotval_loss&quot, loss, on_step=False, on_epoch=True, logger=True, prog_bar=True)
        self.log(&quotval_acc&quot, acc, on_step=False, on_epoch=True, logger=True, prog_bar=True)

        <a id="change">return </a>loss, acc, preds, y

    &#47&#47 logic for a single testing step
    def test_step(self, batch, batch_idx):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ashleve/lightning-hydra-template/commit/0030c94b17bdd837b536a177ae3b0725d2c3e74d#diff-e03535cf9a37db01715946f6f12ec50ec7e66db034189f20317e30d3e2d8af02L51' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 94597800</div><div id='project'> Project Name: ashleve/lightning-hydra-template</div><div id='commit'> Commit Name: 0030c94b17bdd837b536a177ae3b0725d2c3e74d</div><div id='time'> Time: 2021-01-09</div><div id='author'> Author: zalewski.ukas@gmail.com</div><div id='file'> File Name: project/pytorch_modules/lightning_models/simple_mnist_classifier.py</div><div id='m_class'> M Class Name: LitModel</div><div id='n_method'> N Class Name: LitModel</div><div id='m_method'> M Method Name: validation_step(3)</div><div id='n_method'> N Method Name: validation_step(3)</div><div id='m_parent_class'> M Parent Class: pl.LightningModule</div><div id='n_parent_class'> N Parent Class: pl.LightningModule</div><div id='m_file'> M File Name: project/pytorch_modules/lightning_models/simple_mnist_classifier.py</div><div id='n_file'> N File Name: project/pytorch_modules/lightning_models/simple_mnist_classifier.py</div><div id='m_start'> M Start Line: 57</div><div id='m_end'> M End Line: 64</div><div id='n_start'> N Start Line: 54</div><div id='n_end'> N End Line: 62</div><BR>