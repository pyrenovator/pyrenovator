<html><h3>Pattern ID :15342
</h3><img src='52038504.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                iid = iids[i]
                if uid not in uid2itemlist:
                    uid2itemlist[uid] = []
                <a id="change">uid2itemlist[uid].append(</a>iid<a id="change">)</a>
            for uid in uid2itemlist:
                pos_num = len(uid2itemlist[uid])
                if pos_num &gt;= self.neg_sample_to:
                    uid2itemlist[uid] = uid2itemlist[uid][:self.neg_sample_to-1]</code></pre><h3>After Change</h3><pre><code class='java'>
            uid2itemlist = {}
            grouped_uid_iid = self.dataset.inter_feat.groupby(uid_field)[iid_field]
            for uid, iids in grouped_uid_iid:
                uid2itemlist[uid]<a id="change"> = </a><a id="change">iids.to_list()</a>
            for uid in uid2itemlist:
                pos_num = len(uid2itemlist[uid])
                neg_num = self.neg_sample_to - pos_num
                if pos_num &gt;= self.neg_sample_to:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/rucaibox/recbole/commit/b4a648dbd96a2c402fa0522a276adcfdd3393639#diff-f41d5d93e76efa5638a691f8947c424c58ec3f51b884fc0d235ddd324dd574f2L76' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 52038504</div><div id='project'> Project Name: rucaibox/recbole</div><div id='commit'> Commit Name: b4a648dbd96a2c402fa0522a276adcfdd3393639</div><div id='time'> Time: 2020-07-17</div><div id='author'> Author: houyupeng@ruc.edu.cn</div><div id='file'> File Name: data/dataloader.py</div><div id='m_class'> M Class Name: GeneralDataLoader</div><div id='n_method'> N Class Name: GeneralDataLoader</div><div id='m_method'> M Method Name: _pre_neg_sampling(1)</div><div id='n_method'> N Method Name: _pre_neg_sampling(1)</div><div id='m_parent_class'> M Parent Class: AbstractDataLoader</div><div id='n_parent_class'> N Parent Class: AbstractDataLoader</div><div id='m_file'> M File Name: data/dataloader.py</div><div id='n_file'> N File Name: data/dataloader.py</div><div id='m_start'> M Start Line: 76</div><div id='m_end'> M End Line: 153</div><div id='n_start'> N Start Line: 81</div><div id='n_end'> N End Line: 148</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            num_errors += 1
            continue

        <a id="change">all_ids.append(</a>sentence_id<a id="change">)</a>
        all_embeddings.append(embedding)

        if index % 1000 == 0:
            print(f&quotEmbedded {index} with {num_errors} errors&quot)</code></pre><h3>After Change</h3><pre><code class='java'>
            continue

        sentences_text = sentences.iloc[start_ix: end_ix][&quottext&quot].to_list()
        sentences_id<a id="change"> = </a><a id="change">sentences.iloc[start_ix: end_ix][&quotsentence_id&quot].to_list()</a>

        try:
            preprocessed_sentences = model.preprocess_many(sentences_text)
            embeddings = model.embed_many(preprocessed_sentences)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/bluebrain/search/commit/6eb30c8b3e77791ee4e407dd19d7a5e08fe5e132#diff-6a370a606e89902d9cea7c7edf876b91c643d1c115291d5912b04e3bd88cf446L263' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 52038521</div><div id='project'> Project Name: bluebrain/search</div><div id='commit'> Commit Name: 6eb30c8b3e77791ee4e407dd19d7a5e08fe5e132</div><div id='time'> Time: 2020-09-04</div><div id='author'> Author: jankrepl@yahoo.com</div><div id='file'> File Name: src/bbsearch/embedding_models.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: compute_database_embeddings(4)</div><div id='n_method'> N Method Name: compute_database_embeddings(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/bbsearch/embedding_models.py</div><div id='n_file'> N File Name: src/bbsearch/embedding_models.py</div><div id='m_start'> M Start Line: 287</div><div id='m_end'> M End Line: 309</div><div id='n_start'> N Start Line: 433</div><div id='n_end'> N End Line: 494</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            
            article_id = pd.read_sql(sql_query, self.connection).iloc[0][&quotarticle_id&quot]

            <a id="change">article_ids.append(</a>article_id<a id="change">)</a>
            paragraph_ids.append(paragraph_id)

        return article_ids, paragraph_ids
</code></pre><h3>After Change</h3><pre><code class='java'>
        sentences = retrieve_sentences_from_sentence_ids(sentence_ids=sentence_ids,
                                                         engine=self.connection)
        article_ids = sentences[&quotarticle_id&quot].to_list()
        paragraph_ids<a id="change"> = </a><a id="change">sentences[&quotparagraph_pos_in_article&quot].to_list()</a>

        return article_ids, paragraph_ids

    def set_page(self, new_page, force=False):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/bluebrain/search/commit/6dbc2fe8f01adb39650da97fb8473111884cd0c1#diff-85be189895326858a3f7ca6923dff3de9eea38ea5442b7ccf9a3055107f2ea70L486' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 52038513</div><div id='project'> Project Name: bluebrain/search</div><div id='commit'> Commit Name: 6dbc2fe8f01adb39650da97fb8473111884cd0c1</div><div id='time'> Time: 2020-08-04</div><div id='author'> Author: francesco.casalegno@gmail.com</div><div id='file'> File Name: src/bbsearch/widgets/search_widget.py</div><div id='m_class'> M Class Name: SearchWidget</div><div id='n_method'> N Class Name: SearchWidget</div><div id='m_method'> M Method Name: resolve_ids(2)</div><div id='n_method'> N Method Name: resolve_ids(2)</div><div id='m_parent_class'> M Parent Class: widgets.VBox</div><div id='n_parent_class'> N Parent Class: widgets.VBox</div><div id='m_file'> M File Name: src/bbsearch/widgets/search_widget.py</div><div id='n_file'> N File Name: src/bbsearch/widgets/search_widget.py</div><div id='m_start'> M Start Line: 501</div><div id='m_end'> M End Line: 524</div><div id='n_start'> N Start Line: 486</div><div id='n_end'> N End Line: 489</div><BR>