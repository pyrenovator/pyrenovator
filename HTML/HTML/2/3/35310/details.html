<html><h3>Pattern ID :35310
</h3><img src='100405645.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        pass

    def destroy_all(self):
        <a id="change">pass</a>
</code></pre><h3>After Change</h3><pre><code class='java'>
        Destroy all device meshes.
        
        for name in self.device_mesh_store:
            <a id="change">for </a>pgs in <a id="change">self.device_mesh_store[name].process_groups_dict.values():
                </a>for pg in pgs:
                    dist.destroy_process_group(pg)

        self.device_mesh_store.clear()</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/4d5d8f98a49dbbd842742bfd1010384aee70312b#diff-10c2c18a3f4b86210aff90beadee7600b4f561ff8a3b954d18e10cbc0b5c2493L36' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 100405645</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: 4d5d8f98a49dbbd842742bfd1010384aee70312b</div><div id='time'> Time: 2023-03-23</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: colossalai/cluster/device_mesh_manager.py</div><div id='m_class'> M Class Name: DeviceMeshManager</div><div id='n_method'> N Class Name: DeviceMeshManager</div><div id='m_method'> M Method Name: destroy_all(1)</div><div id='n_method'> N Method Name: destroy_all(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: colossalai/cluster/device_mesh_manager.py</div><div id='n_file'> N File Name: colossalai/cluster/device_mesh_manager.py</div><div id='m_start'> M Start Line: 36</div><div id='m_end'> M End Line: 36</div><div id='n_start'> N Start Line: 112</div><div id='n_end'> N End Line: 117</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    def _record_sizes_checksums(self):
        Store in file when recorded size/checksum of downloaded files.
        &#47&#47TODO implement
        <a id="change">pass</a>

    def download_checksums(self, checksums_url):
        Downloads checksum file from the given URL and adds it to registry.
        &#47&#47TODO implement</code></pre><h3>After Change</h3><pre><code class='java'>
            self._recorded_sizes_checksums[url] = get_sizes_checksum(path) 
        elif isinstance(url_or_urls, dict):
            url_or_urls = list(flatten_nest_dict(url_or_urls).values())
            downloaded_path_or_paths = list(<a id="change">flatten_nest_dict(downloaded_path_or_paths).values()</a>)
        assert isinstance(url_or_urls, (list, tuple))
        <a id="change">for </a>url, path in zip(url_or_urls, downloaded_path_or_paths)<a id="change">:
            </a>self._recorded_sizes_checksums[url] = get_sizes_checksum(path) 

    def download(self, url_or_urls):
        Download given url(s).</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/datasets/commit/b6107a894a48bf7363d6f76f71eb54a0fe4cf191#diff-7ddc0e9c0182c9dec48e09791508ccf0181d44b3d22dccdbc29bd2348a6f8519L130' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 100405640</div><div id='project'> Project Name: huggingface/datasets</div><div id='commit'> Commit Name: b6107a894a48bf7363d6f76f71eb54a0fe4cf191</div><div id='time'> Time: 2020-04-24</div><div id='author'> Author: lhoest.q@gmail.com</div><div id='file'> File Name: src/nlp/utils/download_manager.py</div><div id='m_class'> M Class Name: DownloadManager</div><div id='n_method'> N Class Name: DownloadManager</div><div id='m_method'> M Method Name: _record_sizes_checksums(3)</div><div id='n_method'> N Method Name: _record_sizes_checksums(1)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: src/nlp/utils/download_manager.py</div><div id='n_file'> N File Name: src/nlp/utils/download_manager.py</div><div id='m_start'> M Start Line: 130</div><div id='m_end'> M End Line: 133</div><div id='n_start'> N Start Line: 130</div><div id='n_end'> N End Line: 142</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        pass

    def destroy(self):
        <a id="change">pass</a>

    def destroy_all(self):
        pass
</code></pre><h3>After Change</h3><pre><code class='java'>
            name (str): name of the device mesh
        
        if name in self.device_mesh_store:
            for pgs in <a id="change">self.device_mesh_store[name].process_groups_dict.values()</a>:
                <a id="change">for </a>pg in pgs<a id="change">:
                    </a>dist.destroy_process_group(pg)
            del self.device_mesh_store[name]
        else:
            raise ValueError(f&quotDevice mesh {name} does not exist.&quot)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/colossalai/commit/4d5d8f98a49dbbd842742bfd1010384aee70312b#diff-10c2c18a3f4b86210aff90beadee7600b4f561ff8a3b954d18e10cbc0b5c2493L32' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 100405641</div><div id='project'> Project Name: hpcaitech/colossalai</div><div id='commit'> Commit Name: 4d5d8f98a49dbbd842742bfd1010384aee70312b</div><div id='time'> Time: 2023-03-23</div><div id='author'> Author: 72588413+YuliangLiu0306@users.noreply.github.com</div><div id='file'> File Name: colossalai/cluster/device_mesh_manager.py</div><div id='m_class'> M Class Name: DeviceMeshManager</div><div id='n_method'> N Class Name: DeviceMeshManager</div><div id='m_method'> M Method Name: destroy(2)</div><div id='n_method'> N Method Name: destroy(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: colossalai/cluster/device_mesh_manager.py</div><div id='n_file'> N File Name: colossalai/cluster/device_mesh_manager.py</div><div id='m_start'> M Start Line: 33</div><div id='m_end'> M End Line: 33</div><div id='n_start'> N Start Line: 93</div><div id='n_end'> N End Line: 108</div><BR>