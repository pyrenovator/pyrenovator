<html><h3>Pattern ID :42157
</h3><img src='118318541.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    write_json(config, path_to_run / &quotconfig.json&quot)

    &#47&#47 Build trainer and start training
    trainer = <a id="change">Trainer(
        </a>train_loader, val_loader, model, criterion, optim, scheduler, device, config, path_to_run<a id="change">
    )</a>
    trainer.run()
        

if __name__ == "__main__":</code></pre><h3>After Change</h3><pre><code class='java'>

        &#47&#47 Unpack and load content
        model.load_state_dict(checkpoint[&quotmodel_state_dict&quot])
        optim.load_state_dict(<a id="change">checkpoint[&quotoptimizer_state_dict&quot]</a>)
        scheduler.load_state_dict(checkpoint[&quotscheduler_state_dict&quot])
        epoch = checkpoint[&quotepoch&quot]
        metric_start_val = checkpoint[&quotmetric_max_val&quot]</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 2</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/bwittmann/transoar/commit/943b60f71cbfae5fcb65729b42c3b9464b433db2#diff-0e048206896ef3808bf29e00f4ca534eb723fe51e27a47b583a92e913c33bbcfL17' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 118318541</div><div id='project'> Project Name: bwittmann/transoar</div><div id='commit'> Commit Name: 943b60f71cbfae5fcb65729b42c3b9464b433db2</div><div id='time'> Time: 2021-11-29</div><div id='author'> Author: bastian.wittmann@tum.de</div><div id='file'> File Name: scripts/train.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(2)</div><div id='n_method'> N Method Name: train(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: scripts/train.py</div><div id='n_file'> N File Name: scripts/train.py</div><div id='m_start'> M Start Line: 17</div><div id='m_end'> M End Line: 51</div><div id='n_start'> N Start Line: 17</div><div id='n_end'> N End Line: 67</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        logger.pushd(f"regular_training_{arch.metadata[&quotarchid&quot]}")            
        data_loaders = self.get_data(self.conf_loader)
        trainer = <a id="change">Trainer(</a>self.conf_train, arch.arch, checkpoint<a id="change">)</a> 
        trainer_metrics = trainer.fit(data_loaders)
        train_time = trainer_metrics.total_training_time()
        logger.popd()</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 see if we have visited this arch before
        if arch_flat_rep in self.eval_cache:
            logger.info(f"Arch is in eval cache. Returning from cache.")
            return <a id="change">self.eval_cache[arch_flat_rep].metadata[&quottrain_top1&quot]</a>

        &#47&#47 &#47&#47 if not in cache actually evaluate it
        &#47&#47 &#47&#47 -------------------------------------
        &#47&#47 &#47&#47 NOTE: we don&quott pass checkpoint to the trainers</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/archai/commit/08575031e0f640245f3ada7e59d8bb2ac39a78d8#diff-44311b00ae722d4a9079055eccac882721559cbb611d3159d294da7d1a7b01bbL75' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 118318540</div><div id='project'> Project Name: microsoft/archai</div><div id='commit'> Commit Name: 08575031e0f640245f3ada7e59d8bb2ac39a78d8</div><div id='time'> Time: 2022-12-16</div><div id='author'> Author: dedey@microsoft.com</div><div id='file'> File Name: archai/algos/local_search_darts/local_search_darts_reg.py</div><div id='m_class'> M Class Name: LocalSearchDartsReg</div><div id='n_method'> N Class Name: LocalSearchDartsReg</div><div id='m_method'> M Method Name: _evaluate(2)</div><div id='n_method'> N Method Name: _evaluate(2)</div><div id='m_parent_class'> M Parent Class: LocalSearch</div><div id='n_parent_class'> N Parent Class: LocalSearch</div><div id='m_file'> M File Name: archai/algos/local_search_darts/local_search_darts_reg.py</div><div id='n_file'> N File Name: archai/algos/local_search_darts/local_search_darts_reg.py</div><div id='m_start'> M Start Line: 81</div><div id='m_end'> M End Line: 97</div><div id='n_start'> N Start Line: 82</div><div id='n_end'> N End Line: 102</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    scheduler = torch.optim.lr_scheduler.StepLR(optim, config[&quottraining&quot][&quotlr_drop&quot])

    &#47&#47 Build trainer and start training
    trainer = <a id="change">Trainer(
        </a>train_loader, val_loader, model, criterion, optim, scheduler, device, config<a id="change">
    )</a>
    trainer.run()
        

if __name__ == "__main__":</code></pre><h3>After Change</h3><pre><code class='java'>
    scheduler = torch.optim.lr_scheduler.StepLR(optim, config[&quottraining&quot][&quotlr_drop&quot])

    &#47&#47 Init logging
    path_to_run = Path(os.getcwd()) / &quotruns&quot / <a id="change">config[&quottraining&quot][&quotexperiment_name&quot]</a>
    path_to_run.mkdir(exist_ok=True)
    write_json(config, path_to_run / &quotconfig.json&quot)

    &#47&#47 Build trainer and start training</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/bwittmann/transoar/commit/37c7e4ab63c3a5f501e3bb151f9c52d204bbdcc0#diff-0e048206896ef3808bf29e00f4ca534eb723fe51e27a47b583a92e913c33bbcfL14' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 118318542</div><div id='project'> Project Name: bwittmann/transoar</div><div id='commit'> Commit Name: 37c7e4ab63c3a5f501e3bb151f9c52d204bbdcc0</div><div id='time'> Time: 2021-11-22</div><div id='author'> Author: bastian.wittmann@tum.de</div><div id='file'> File Name: scripts/train.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(1)</div><div id='n_method'> N Method Name: train(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: scripts/train.py</div><div id='n_file'> N File Name: scripts/train.py</div><div id='m_start'> M Start Line: 15</div><div id='m_end'> M End Line: 40</div><div id='n_start'> N Start Line: 17</div><div id='n_end'> N End Line: 47</div><BR>