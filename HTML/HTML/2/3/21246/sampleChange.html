<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
      outputs = torch.zeros(tuple(outputs_shape),device=device)
      for i in range(len(dataset)):
        outputs[i,:,:,:,:] = model(dataset[i][0].unsqueeze(0).to(device))
    out_dataset = <a id="change">TensorDataset(</a>outputs,labels<a id="change">)</a>
    dlambda = lambdas[1]-lambdas[0]
    model.set_lhat(lambdas[-1]+dlambda-1e-9)
    for lam in reversed(lambdas):
      losses = get_rcps_losses_from_outputs(model, out_dataset, rcps_loss_fn, lam-dlambda, device)</code></pre><h3>After Change</h3><pre><code class='java'>
      print("Computing outputs")
      for i in range(len(dataset)):
        outputs[i,:,:,:,:] = model(dataset[i][0].unsqueeze(0).to(device)).cpu()
    out_dataset<a id="change"> = </a><a id="change">TensorDataset(</a>outputs,labels.cpu()<a id="change">)</a>
    dlambda = lambdas[1]-lambdas[0]
    model.set_lhat(lambdas[-1]+dlambda-1e-9)
    print("Computing losses")
    for lam in reversed(lambdas):</code></pre>