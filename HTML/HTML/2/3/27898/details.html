<html><h3>Pattern ID :27898
</h3><img src='82838257.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        labelled_gt = gt[mask_miss]

        mask = torch.isinf(labelled_gt) == 0
        <a id="change">return </a><a id="change">fun(</a>labelled_pred[mask], labelled_gt[mask]<a id="change">)</a>

    @staticmethod
    def offset_laplace_loss(pred, gt, logb, mask_miss):
        </code></pre><h3>After Change</h3><pre><code class='java'>

    @staticmethod
    def offset_l1_loss(pred, gt, _, mask_miss):
        <a id="change">return </a>tensor_loss(pred, gt, mask_miss, l1)

    @staticmethod
    def offset_laplace_loss(pred, gt, logb, mask_miss):</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/hellojialee/offsetguided/commit/ed8f8bbd9d6c8fd755ab5313d84c8e395b7d5adc#diff-3d9a7f2cbfa513eb06797c8db6c0976d52456d5273cdcf12e719ae25ffc2933eL72' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 82838257</div><div id='project'> Project Name: hellojialee/offsetguided</div><div id='commit'> Commit Name: ed8f8bbd9d6c8fd755ab5313d84c8e395b7d5adc</div><div id='time'> Time: 2020-06-30</div><div id='author'> Author: ustclijia@gmail.com</div><div id='file'> File Name: models/losses.py</div><div id='m_class'> M Class Name: LossChoice</div><div id='n_method'> N Class Name: LossChoice</div><div id='m_method'> M Method Name: offset_l1_loss(4)</div><div id='n_method'> N Method Name: offset_l1_loss(5)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: models/losses.py</div><div id='n_file'> N File Name: models/losses.py</div><div id='m_start'> M Start Line: 73</div><div id='m_end'> M End Line: 80</div><div id='n_start'> N Start Line: 72</div><div id='n_end'> N End Line: 72</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    &#47&#47 convert to days since epoch
    t = np.array((dates - datetime(1970, 1, 1)).dt.total_seconds().astype(np.float)) / (3600 * 24.0)
    features = np.column_stack(
        [<a id="change">fun(</a>(2.0 * (i + 1) * np.pi * t / period)<a id="change">)</a> for i in range(series_order) for fun in (np.sin, np.cos)]
    )
    <a id="change">return </a>features


def make_country_specific_holidays_df(year_list, country):</code></pre><h3>After Change</h3><pre><code class='java'>
    
    &#47&#47 convert to days since epoch
    t = np.array((dates - datetime(1970, 1, 1)).dt.total_seconds().astype(np.float)) / (3600 * 24.0)
    <a id="change">return </a>fourier_series_t(t, period, series_order)


def fourier_series_t(t, period, series_order):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ourownstory/neural_prophet/commit/b5bca72421507020a7a6a37ef7a315559811af07#diff-19e8b8bb76c45be0b19f9651c6c08d9e4641f5f993cdbaa581338cc45aff7516L282' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 82838258</div><div id='project'> Project Name: ourownstory/neural_prophet</div><div id='commit'> Commit Name: b5bca72421507020a7a6a37ef7a315559811af07</div><div id='time'> Time: 2020-11-01</div><div id='author'> Author: ourownstory@users.noreply.github.com</div><div id='file'> File Name: neuralprophet/time_dataset.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: fourier_series(3)</div><div id='n_method'> N Method Name: fourier_series(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: neuralprophet/time_dataset.py</div><div id='n_file'> N File Name: neuralprophet/time_dataset.py</div><div id='m_start'> M Start Line: 296</div><div id='m_end'> M End Line: 300</div><div id='n_start'> N Start Line: 296</div><div id='n_end'> N End Line: 297</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    labelled_pred = pred[mask_miss]
    labelled_gt = gt[mask_miss]

    <a id="change">return </a><a id="change">fun(</a>labelled_pred, labelled_gt<a id="change">)</a>


class LossChoice(object):
    @staticmethod</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47 return true if tensor is not infinity or not Not a Number (nan etc,)
    mask = torch.isfinite(labelled_gt)

    <a id="change">return </a>fun(labelled_pred[mask], labelled_gt[mask])


class LossChoice(object):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hellojialee/offsetguided/commit/ed8f8bbd9d6c8fd755ab5313d84c8e395b7d5adc#diff-3d9a7f2cbfa513eb06797c8db6c0976d52456d5273cdcf12e719ae25ffc2933eL29' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 82838259</div><div id='project'> Project Name: hellojialee/offsetguided</div><div id='commit'> Commit Name: ed8f8bbd9d6c8fd755ab5313d84c8e395b7d5adc</div><div id='time'> Time: 2020-06-30</div><div id='author'> Author: ustclijia@gmail.com</div><div id='file'> File Name: models/losses.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: tensor_loss(4)</div><div id='n_method'> N Method Name: tensor_loss(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: models/losses.py</div><div id='n_file'> N File Name: models/losses.py</div><div id='m_start'> M Start Line: 40</div><div id='m_end'> M End Line: 43</div><div id='n_start'> N Start Line: 41</div><div id='n_end'> N End Line: 47</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        labelled_gt = gt[mask_miss]

        mask = torch.isnan(labelled_gt) == 0
        <a id="change">return </a><a id="change">fun(</a>labelled_pred[mask], labelled_gt[mask]<a id="change">)</a>

    @staticmethod
    def offset_l1_loss(pred, gt, _, mask_miss, fun=l1):
        mask_miss = mask_miss.expand_as(gt)</code></pre><h3>After Change</h3><pre><code class='java'>
            mask_miss: tensor of shape (N, 1, out_h, out_w) unlabelled areas denoted as 0,
            fun: function to compute the loss.
        
        <a id="change">return </a>tensor_loss(pred, gt, mask_miss, l1)

    @staticmethod
    def offset_l1_loss(pred, gt, _, mask_miss):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hellojialee/offsetguided/commit/ed8f8bbd9d6c8fd755ab5313d84c8e395b7d5adc#diff-3d9a7f2cbfa513eb06797c8db6c0976d52456d5273cdcf12e719ae25ffc2933eL56' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 82838260</div><div id='project'> Project Name: hellojialee/offsetguided</div><div id='commit'> Commit Name: ed8f8bbd9d6c8fd755ab5313d84c8e395b7d5adc</div><div id='time'> Time: 2020-06-30</div><div id='author'> Author: ustclijia@gmail.com</div><div id='file'> File Name: models/losses.py</div><div id='m_class'> M Class Name: LossChoice</div><div id='n_method'> N Class Name: LossChoice</div><div id='m_method'> M Method Name: scale_l1_loss(3)</div><div id='n_method'> N Method Name: scale_l1_loss(4)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: models/losses.py</div><div id='n_file'> N File Name: models/losses.py</div><div id='m_start'> M Start Line: 56</div><div id='m_end'> M End Line: 70</div><div id='n_start'> N Start Line: 68</div><div id='n_end'> N End Line: 68</div><BR>