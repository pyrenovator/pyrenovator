<html><h3>Pattern ID :17744
</h3><img src='58429083.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                self._resampler = T.Resample(sampling_rate, self.sampling_rate)
            array = self._resampler(array)
            sampling_rate = self.sampling_rate
        array = <a id="change">array.numpy()</a>
        if self.mono:
            array = array.mean(axis=0)
        return array, sampling_rate
</code></pre><h3>After Change</h3><pre><code class='java'>
                raise ImportError("To support decoding &quotmp3&quot audio files, please install &quotsox&quot.") from err
            array, sampling_rate = self._decode_mp3_torchaudio(path_or_file)
        else:
            <a id="change">try:  &#47&#47 try torchaudio anyway because sometimes it works (depending on the os and os packages installed)
                </a>array, sampling_rate = self._decode_mp3_torchaudio(path_or_file)
            <a id="change">except </a>RuntimeError:
                try:
                    &#47&#47 flake8: noqa
                    import librosa</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/huggingface/datasets/commit/142404f9ce8fe4e7a72e8c59be70a012b6f707cd#diff-a633089cfc19bde2aaf3ab69fe0b274597ce4b9ba9b8d081382f71ee9f767b0dL288' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 58429083</div><div id='project'> Project Name: huggingface/datasets</div><div id='commit'> Commit Name: 142404f9ce8fe4e7a72e8c59be70a012b6f707cd</div><div id='time'> Time: 2022-09-20</div><div id='author'> Author: polina@huggingface.co</div><div id='file'> File Name: src/datasets/features/audio.py</div><div id='m_class'> M Class Name: Audio</div><div id='n_method'> N Class Name: Audio</div><div id='m_method'> M Method Name: _decode_mp3(2)</div><div id='n_method'> N Method Name: _decode_mp3(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/datasets/features/audio.py</div><div id='n_file'> N File Name: src/datasets/features/audio.py</div><div id='m_start'> M Start Line: 290</div><div id='m_end'> M End Line: 308</div><div id='n_start'> N Start Line: 288</div><div id='n_end'> N End Line: 319</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        images = F.upsample(images, [640, 640], mode=&quotbilinear&quot)
        with torch.no_grad():
            _, pred = model(images)
        pred = <a id="change">interp(pred).cpu().data[0].numpy()</a>.transpose(1, 2, 0)
        pred = np.asarray(np.argmax(pred, axis=2), dtype=np.uint8)

        labels = np.asarray(labels.squeeze(0), dtype=np.uint8)</code></pre><h3>After Change</h3><pre><code class='java'>
    if model == "PSPNet":
        model = PSPNet(img_channel=3, num_classes=num_classes)

        <a id="change">try:
            </a>os.makedirs(save_path)
        <a id="change">except </a>FileExistsError:
            pass

    model.eval()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/smhassanerfani/atlantis/commit/7335f988ab8de5a81f643915a5ac09e646836528#diff-3665d65394f4f58a56a256ad6dd8621c68118d90fe56a19387e251c19cec2d2eL57' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 58429080</div><div id='project'> Project Name: smhassanerfani/atlantis</div><div id='commit'> Commit Name: 7335f988ab8de5a81f643915a5ac09e646836528</div><div id='time'> Time: 2022-03-17</div><div id='author'> Author: smhassanerfani@gmail.com</div><div id='file'> File Name: test.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(10)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: test.py</div><div id='n_file'> N File Name: test.py</div><div id='m_start'> M Start Line: 59</div><div id='m_end'> M End Line: 108</div><div id='n_start'> N Start Line: 16</div><div id='n_end'> N End Line: 84</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            "ijS",
            pbc.detach().cpu().numpy(),
            cell.detach().cpu().numpy(),
            <a id="change">pos.detach().cpu().numpy()</a>,
            cutoff,
        )
        edge_index = torch.tensor(np.stack([idx_i, idx_j], axis=0), device=pos.device)</code></pre><h3>After Change</h3><pre><code class='java'>
        if not bidirectional:
            raise NotImplementedError()

        <a id="change">try:
            </a>edge_index, S = calc_neighbor_by_pymatgen(pos, cell, pbc, cutoff)
        <a id="change">except </a>Exception:
            &#47&#47 This is slower.
            edge_index, S = calc_neighbor_by_ase(pos, cell, pbc, cutoff)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/pfnet-research/torch-dftd/commit/010c36b6d4aaceb3d614318121e910b9134663a4#diff-b7d2f2dd76c964ee21cc70cf4731c7a3ebb19e63b5388a67cb018d9e66e507f4L10' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 58429073</div><div id='project'> Project Name: pfnet-research/torch-dftd</div><div id='commit'> Commit Name: 010c36b6d4aaceb3d614318121e910b9134663a4</div><div id='time'> Time: 2021-07-04</div><div id='author'> Author: acc1ssnn9terias@gmail.com</div><div id='file'> File Name: torch_dftd/functions/edge_extraction.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: calc_edge_index(5)</div><div id='n_method'> N Method Name: calc_edge_index(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: torch_dftd/functions/edge_extraction.py</div><div id='n_file'> N File Name: torch_dftd/functions/edge_extraction.py</div><div id='m_start'> M Start Line: 49</div><div id='m_end'> M End Line: 58</div><div id='n_start'> N Start Line: 113</div><div id='n_end'> N End Line: 119</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                        imputation_collector.append(results[&quotimputed_data&quot])

                imputation_collector = torch.cat(imputation_collector)
                imputation_collector = <a id="change">imputation_collector.cpu().detach().numpy()</a>

                mean_val_loss = cal_mae(imputation_collector, val_X_intact, val_indicating_mask)
                self.logger[&quotvalidating_loss&quot].append(mean_val_loss)
                print(f&quotepoch {epoch}: training loss {mean_train_loss:.4f}, validating loss {mean_val_loss:.4f}&quot)</code></pre><h3>After Change</h3><pre><code class='java'>
        self.best_loss = float(&quotinf&quot)
        self.best_model_dict = None

        <a id="change">try:
            </a>for epoch in range(self.epochs):
                self.model.train()
                epoch_train_loss_collector = []
                for idx, data in enumerate(training_loader):
                    inputs = self.assemble_input_data(data)
                    self.optimizer.zero_grad()
                    results = self.model.forward(inputs)
                    results[&quotloss&quot].backward()
                    self.optimizer.step()
                    epoch_train_loss_collector.append(results[&quotloss&quot].item())

                mean_train_loss = np.mean(epoch_train_loss_collector)  &#47&#47 mean training loss of the current epoch
                self.logger[&quottraining_loss&quot].append(mean_train_loss)

                if val_loader is not None:
                    self.model.eval()
                    imputation_collector = []
                    with torch.no_grad():
                        for idx, data in enumerate(val_loader):
                            inputs = self.assemble_input_data(data)
                            results = self.model.forward(inputs)
                            imputation_collector.append(results[&quotimputed_data&quot])

                    imputation_collector = torch.cat(imputation_collector)
                    imputation_collector = imputation_collector

                    mean_val_loss = cal_mae(imputation_collector, val_X_intact, val_indicating_mask)
                    self.logger[&quotvalidating_loss&quot].append(mean_val_loss)
                    print(f&quotepoch {epoch}: training loss {mean_train_loss:.4f}, validating loss {mean_val_loss:.4f}&quot)
                    mean_loss = mean_val_loss
                else:
                    print(f&quotepoch {epoch}: training loss {mean_train_loss:.4f}&quot)
                    mean_loss = mean_train_loss

                if mean_loss &lt; self.best_loss:
                    self.best_loss = mean_loss
                    self.best_model_dict = self.model.state_dict()
                    self.patience = self.original_patience
                else:
                    self.patience -= 1
                    if self.patience == 0:
                        print(&quotExceeded the training patience. Terminating the training procedure...&quot)
                        break
        <a id="change">except </a>Exception as e:
            print(f&quotException: {e}&quot)
            if self.best_model_dict is None:
                raise RuntimeError(&quotTraining got interrupted. Model was not get trained. Please try fit() again.&quot)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/wenjiedu/pypots/commit/9f00193954f19b1cc14847a4ead3caa6461edf6b#diff-bf0bd54c8dbc0f298b087db3eba02f7494640a2ef2f9682acbfd5abd4e15fc88L67' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 58429076</div><div id='project'> Project Name: wenjiedu/pypots</div><div id='commit'> Commit Name: 9f00193954f19b1cc14847a4ead3caa6461edf6b</div><div id='time'> Time: 2022-05-03</div><div id='author'> Author: wenjay.du@gmail.com</div><div id='file'> File Name: pypots/imputation/base.py</div><div id='m_class'> M Class Name: BaseNNImputer</div><div id='n_method'> N Class Name: BaseNNImputer</div><div id='m_method'> M Method Name: _train_model(5)</div><div id='n_method'> N Method Name: _train_model(5)</div><div id='m_parent_class'> M Parent Class: BaseImputer,BaseNNModel</div><div id='n_parent_class'> N Parent Class: BaseImputer,BaseNNModel</div><div id='m_file'> M File Name: pypots/imputation/base.py</div><div id='n_file'> N File Name: pypots/imputation/base.py</div><div id='m_start'> M Start Line: 76</div><div id='m_end'> M End Line: 120</div><div id='n_start'> N Start Line: 76</div><div id='n_end'> N End Line: 129</div><BR>