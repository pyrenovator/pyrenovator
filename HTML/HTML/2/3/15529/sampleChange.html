<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

    for i, (s, p, o) in enumerate(test_spo):
        row = scores[i]  &#47&#47 corresponding predictions
        idx = o<a id="change"> if </a>direction == "o"<a id="change"> else </a>s
        true_score = row[idx]

        &#47&#47 remove current label from scores</code></pre><h3>After Change</h3><pre><code class='java'>
    true_scores = scores[arange, targets].view(-1, 1)

    &#47&#47 remove the true subjects/objects from the scores so they don&quott factor in rankings
    scores<a id="change"> = </a><a id="change">scores.clone()</a>
    scores[arange, targets] = float("-Inf")

    &#47&#47 follow LibKGE protocol by taking the mean rank among all entities with same score
    ranks = torch.sum(scores &gt; true_scores, dim=1, dtype=torch.double)</code></pre>