<html><h3>Pattern ID :27591
</h3><img src='81934871.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

def infer_shapes(onnx_path, out_path):
    try:
        <a id="change">SymbolicShapeInference.infer_shapes(</a>onnx_path, out_path<a id="change">)</a>
    except SystemExit:
        raise ShapeInferenceError("Unable to infer shapes for ONNX model.")
</code></pre><h3>After Change</h3><pre><code class='java'>
    verbose = 0

    onnx_opset = get_opset(onnx_model)
    <a id="change">if </a>not onnx_opset or <a id="change">onnx_opset &lt; 7</a>:
        raise ShapeInferenceError(
            "Only support models of onnx opset 7 and above.")
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/spcl/daceml/commit/91dec501f1642fce939e778ad114935f3bcd5fb8#diff-9dc6856e027b97f2d89af6c3c2f8ef2ca398e4062dbd6083bbbfaad19c01b7ccL8' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 81934871</div><div id='project'> Project Name: spcl/daceml</div><div id='commit'> Commit Name: 91dec501f1642fce939e778ad114935f3bcd5fb8</div><div id='time'> Time: 2020-09-08</div><div id='author'> Author: oliverrausch99@gmail.com</div><div id='file'> File Name: daceml/onnx/shape_inference/shape_inference.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: infer_shapes(1)</div><div id='n_method'> N Method Name: infer_shapes(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: daceml/onnx/shape_inference/shape_inference.py</div><div id='n_file'> N File Name: daceml/onnx/shape_inference/shape_inference.py</div><div id='m_start'> M Start Line: 8</div><div id='m_end'> M End Line: 12</div><div id='n_start'> N Start Line: 9</div><div id='n_end'> N End Line: 30</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def infer_shapes(onnx_model):
    return <a id="change">SymbolicShapeInference.infer_shapes(</a>onnx_model<a id="change">)</a>
</code></pre><h3>After Change</h3><pre><code class='java'>
    verbose = 0

    onnx_opset = get_opset(onnx_model)
    <a id="change">if </a>not onnx_opset or <a id="change">onnx_opset &lt; 7</a>:
        raise ShapeInferenceError(
            "Only support models of onnx opset 7 and above.")
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/spcl/daceml/commit/dad3f8aa31504fc116b1e29ad92d096140e151c7#diff-9dc6856e027b97f2d89af6c3c2f8ef2ca398e4062dbd6083bbbfaad19c01b7ccL4' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 81934868</div><div id='project'> Project Name: spcl/daceml</div><div id='commit'> Commit Name: dad3f8aa31504fc116b1e29ad92d096140e151c7</div><div id='time'> Time: 2021-03-01</div><div id='author'> Author: oliverrausch99@gmail.com</div><div id='file'> File Name: daceml/onnx/shape_inference/shape_inference.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: infer_shapes(1)</div><div id='n_method'> N Method Name: infer_shapes(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: daceml/onnx/shape_inference/shape_inference.py</div><div id='n_file'> N File Name: daceml/onnx/shape_inference/shape_inference.py</div><div id='m_start'> M Start Line: 5</div><div id='m_end'> M End Line: 5</div><div id='n_start'> N Start Line: 9</div><div id='n_end'> N End Line: 30</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        self.model = model
        input_names = [ "actual_input_1" ]
        torch.onnx.export(self.model, dummy_inputs, "model.onnx", verbose=True, input_names=input_names, opset_version=12)
        <a id="change">SymbolicShapeInference.infer_shapes(</a>"model.onnx", "shape_infer.onnx"<a id="change">)</a>

        onnx_model = onnx.load("./shape_infer.onnx")
        self.dace_model = ONNXModel("dace_model", onnx_model)
        self.sdfg = self.dace_model.sdfg</code></pre><h3>After Change</h3><pre><code class='java'>
        
        self.model = model
        self.sdfg = None
        <a id="change">if dummy_inputs is not None</a>:
            self.initialize_sdfg(dummy_inputs)

    def initialize_sdfg(self, dummy_inputs):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/spcl/daceml/commit/cb700ea4ccaba3a8bfcb6803a25a26a9e853393e#diff-841877dd14d732c6377ab0656e8c8fc413f96ba6bb7c35ecfe309557b5732fcfL12' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 81934869</div><div id='project'> Project Name: spcl/daceml</div><div id='commit'> Commit Name: cb700ea4ccaba3a8bfcb6803a25a26a9e853393e</div><div id='time'> Time: 2020-09-08</div><div id='author'> Author: shigang.li@inf.ethz.ch</div><div id='file'> File Name: daceml/pytorch/module.py</div><div id='m_class'> M Class Name: DACEModule</div><div id='n_method'> N Class Name: DACEModule</div><div id='m_method'> M Method Name: __init__(3)</div><div id='n_method'> N Method Name: __init__(2)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: daceml/pytorch/module.py</div><div id='n_file'> N File Name: daceml/pytorch/module.py</div><div id='m_start'> M Start Line: 15</div><div id='m_end'> M End Line: 24</div><div id='n_start'> N Start Line: 16</div><div id='n_end'> N End Line: 20</div><BR>