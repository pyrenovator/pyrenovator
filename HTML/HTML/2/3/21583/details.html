<html><h3>Pattern ID :21583
</h3><img src='68975832.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
	y = df[&quotT&quot].T[targets2index[target]]
	
	drugs = df[&quotX&quot]
	drugs_idx<a id="change"> = </a><a id="change">np.array(</a>[&quotDrug &quot + str(i) for i in list(range(drugs.shape[0]))]<a id="change">)</a>

	return drugs, y, drugs_idx
</code></pre><h3>After Change</h3><pre><code class='java'>
	df = pd.DataFrame()
	df[&quotX&quot] = pd.Series([i for i in inx[&quotX&quot]])
	df = pd.concat([df, pd.DataFrame(inx[&quotT&quot], columns = targets)], axis = 1)
	df[&quotID&quot] = [&quotDrug &quot + <a id="change">str(</a>i+1<a id="change">)</a> for i in range(len(df))]
	df.to_pickle(&quot/Users/kexinhuang/Desktop/qm7b.pkl&quot)

def QM8_9():</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/mims-harvard/tdc/commit/77a6e4386efd75bd5d14443ee59d04cdfb98e3cc#diff-579c6125b5c3fca2c843ab9b6d8fc34263fbfcabbd55e6d404fcbadbcb699b63L13' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 68975832</div><div id='project'> Project Name: mims-harvard/tdc</div><div id='commit'> Commit Name: 77a6e4386efd75bd5d14443ee59d04cdfb98e3cc</div><div id='time'> Time: 2020-11-06</div><div id='author'> Author: kexinhuang@hsph.harvard.edu</div><div id='file'> File Name: data_process/QM_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: QM7_process(3)</div><div id='n_method'> N Method Name: QM7_process(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: data_process/QM_utils.py</div><div id='n_file'> N File Name: data_process/QM_utils.py</div><div id='m_start'> M Start Line: 13</div><div id='m_end'> M End Line: 27</div><div id='n_start'> N Start Line: 17</div><div id='n_end'> N End Line: 25</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        elif aggregation_method == &quotweighted&quot:
            return {str(&quotWeighted &quot + score_name): np.sum(np.array(value_per_feature) * feature_importance)}
        elif aggregation_method == &quotl2_weighted&quot:
            sum_drift_fi<a id="change"> = </a><a id="change">np.array(</a>value_per_feature<a id="change">)</a> + feature_importance
            return {str(&quotL2 Weighted &quot + score_name): np.linalg.norm(sum_drift_fi) - np.linalg.norm(feature_importance)}
        else:
            raise DeepchecksValueError(f&quotUnknown aggregation method: {aggregation_method}&quot)</code></pre><h3>After Change</h3><pre><code class='java'>
        elif aggregation_method == &quotl2_weighted&quot:
            return {str(&quotL2 Weighted &quot + score_name): np.sum((value_per_feature ** 2) * feature_importance) ** (1. / 2)}
        elif aggregation_method == &quotl3_weighted&quot:
            return {<a id="change">str(</a>&quotL3 Weighted &quot + score_name<a id="change">)</a>: np.sum((value_per_feature ** 3) * feature_importance) ** (1. / 3)}


class ReducePropertyMixin(ReduceMixin):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/deepchecks/deepchecks/commit/04a0ba3160693220ff55fb3340c831fe80a3e4d1#diff-cd07db27723feff1cba89ec9e4040b27017fe393fb781ef1bdcf2de532b67364L100' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 68975828</div><div id='project'> Project Name: deepchecks/deepchecks</div><div id='commit'> Commit Name: 04a0ba3160693220ff55fb3340c831fe80a3e4d1</div><div id='time'> Time: 2023-02-28</div><div id='author'> Author: 67195469+Nadav-Barak@users.noreply.github.com</div><div id='file'> File Name: deepchecks/core/reduce_classes.py</div><div id='m_class'> M Class Name: ReduceFeatureMixin</div><div id='n_method'> N Class Name: ReduceFeatureMixin</div><div id='m_method'> M Method Name: feature_reduce(4)</div><div id='n_method'> N Method Name: feature_reduce(4)</div><div id='m_parent_class'> M Parent Class: ReduceMixin</div><div id='n_parent_class'> N Parent Class: ReduceMixin</div><div id='m_file'> M File Name: deepchecks/core/reduce_classes.py</div><div id='n_file'> N File Name: deepchecks/core/reduce_classes.py</div><div id='m_start'> M Start Line: 104</div><div id='m_end'> M End Line: 127</div><div id='n_start'> N Start Line: 104</div><div id='n_end'> N End Line: 129</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        ind, _ = hungray_aligment(y_true, y_pred)
        map_ = {i[0]:i[1] for i in ind}
        y_pred = <a id="change">np.array(</a>[map_[idx] for idx in y_pred]<a id="change">)</a>
        
        self.predictions<a id="change"> = </a>list([data.all_label_list[idx] for idx in y_pred])
        self.true_labels = list([data.all_label_list[idx] for idx in y_true])
        
        cm = confusion_matrix(y_true,y_pred) </code></pre><h3>After Change</h3><pre><code class='java'>
        
        self.logger.info
        self.logger.info("***** Test: Confusion Matrix *****")
        self.logger.info("%s", <a id="change">str(</a>cm<a id="change">)</a>)
        self.logger.info("***** Test results *****")
        
        for key in sorted(test_results.keys()):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/thuiar/textoir/commit/203370e17d2a3452b90670171b60c44cb1500bcd#diff-473639a4a577720e799b4a4695cd6fd7327cf5cf9528d09ba0ecbc00acd46b95L42' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 68975830</div><div id='project'> Project Name: thuiar/textoir</div><div id='commit'> Commit Name: 203370e17d2a3452b90670171b60c44cb1500bcd</div><div id='time'> Time: 2021-08-03</div><div id='author'> Author: zhang-hl20@mails.tsinghua.edu.cn</div><div id='file'> File Name: open_intent_discovery/methods/semi_supervised/MCL_BERT/manager.py</div><div id='m_class'> M Class Name: MCLManager</div><div id='n_method'> N Class Name: MCLManager</div><div id='m_method'> M Method Name: test(3)</div><div id='n_method'> N Method Name: test(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: open_intent_discovery/methods/semi_supervised/MCL_BERT/manager.py</div><div id='n_file'> N File Name: open_intent_discovery/methods/semi_supervised/MCL_BERT/manager.py</div><div id='m_start'> M Start Line: 42</div><div id='m_end'> M End Line: 63</div><div id='n_start'> N Start Line: 133</div><div id='n_end'> N End Line: 148</div><BR>