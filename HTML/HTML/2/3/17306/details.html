<html><h3>Pattern ID :17306
</h3><img src='57505261.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

                perturbed_result = iterate_solver(perturbed_As, perturbed_bs)
                numeric_der = (perturbed_result - result) / epsilon
                <a id="change">assert </a>numeric_der.isclose(analytic_der, rtol=1e-4, atol=1e-4).all()


@pytest.mark.cudaext</code></pre><h3>After Change</h3><pre><code class='java'>

def check_sparse_solver_multistep(batch_size: int, test_exception: bool):
    rng = torch.Generator()
    <a id="change">rng.manual_seed(37</a><a id="change">)</a>

    if not torch.cuda.is_available():
        return
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 7</div><BR><div id='size'>Non-data size: 2</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/facebookresearch/theseus/commit/00eee1a15c0f987f86c542d694ff6efc7b8fb1f9#diff-014672fddd42904f05996cc54f069475055044eb4e706177792d9c63c17eb890L76' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 57505261</div><div id='project'> Project Name: facebookresearch/theseus</div><div id='commit'> Commit Name: 00eee1a15c0f987f86c542d694ff6efc7b8fb1f9</div><div id='time'> Time: 2022-11-04</div><div id='author'> Author: luisen.p@gmail.com</div><div id='file'> File Name: theseus/optimizer/linear/tests/test_lu_cuda_sparse_solver.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: check_sparse_solver_multistep(2)</div><div id='n_method'> N Method Name: check_sparse_solver_multistep(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: theseus/optimizer/linear/tests/test_lu_cuda_sparse_solver.py</div><div id='n_file'> N File Name: theseus/optimizer/linear/tests/test_lu_cuda_sparse_solver.py</div><div id='m_start'> M Start Line: 84</div><div id='m_end'> M End Line: 159</div><div id='n_start'> N Start Line: 76</div><div id='n_end'> N End Line: 173</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        )

        assert np.abs(image_slice.flatten() - expected_slice).max() &lt; 1e-2
        <a id="change">assert </a>np.abs(image_from_tuple_slice.flatten() - expected_slice).max() &lt; 1e-2

    def test_alt_diffusion_pndm(self):
        device = "cpu"  &#47&#47 ensure determinism for the device-dependent torch.Generator</code></pre><h3>After Change</h3><pre><code class='java'>
        device = "cpu"  &#47&#47 ensure determinism for the device-dependent torch.Generator

        components = self.get_dummy_components()
        <a id="change">torch.manual_seed(0</a><a id="change">)</a>
        text_encoder_config = RobertaSeriesConfig(
            hidden_size=32,
            project_dim=32,
            intermediate_size=37,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/diffusers/commit/02d83c9ff1b93f2c6f9c94f9369b3e4bc1ba8ce7#diff-499696207abf6ce8e8607495873bf133251a2945a02c0963410b4f38fba319dbL126' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 57505260</div><div id='project'> Project Name: huggingface/diffusers</div><div id='commit'> Commit Name: 02d83c9ff1b93f2c6f9c94f9369b3e4bc1ba8ce7</div><div id='time'> Time: 2022-12-06</div><div id='author'> Author: anton@huggingface.co</div><div id='file'> File Name: tests/pipelines/altdiffusion/test_alt_diffusion.py</div><div id='m_class'> M Class Name: AltDiffusionPipelineFastTests</div><div id='n_method'> N Class Name: AltDiffusionPipelineFastTests</div><div id='m_method'> M Method Name: test_alt_diffusion_ddim(1)</div><div id='n_method'> N Method Name: test_alt_diffusion_ddim(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase,PipelineTesterMixin</div><div id='n_parent_class'> N Parent Class: unittest.TestCase,PipelineTesterMixin</div><div id='m_file'> M File Name: tests/pipelines/altdiffusion/test_alt_diffusion.py</div><div id='n_file'> N File Name: tests/pipelines/altdiffusion/test_alt_diffusion.py</div><div id='m_start'> M Start Line: 128</div><div id='m_end'> M End Line: 180</div><div id='n_start'> N Start Line: 126</div><div id='n_end'> N End Line: 149</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    state, action, logp_old, qval, adv = next(sample_gen)

    assert state.shape[0] == obs_dim
    <a id="change">assert </a>action
    assert logp_old
    assert qval
    assert adv</code></pre><h3>After Change</h3><pre><code class='java'>


def test_generate_trajectory_samples():
    <a id="change">torch.manual_seed(123</a><a id="change">)</a>
    model = PPO("CartPole-v0", batch_size=16)

    obs_dim = model.env.observation_space.shape[0]
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/pytorchlightning/pytorch-lightning-bolts/commit/58cb612459c04b48b70b0cad116d0d6b954e2a24#diff-2f9831150eaef4e86fd191492d6e60b1c824502f9d1656e76025877fbc3d7ebeL68' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 57505263</div><div id='project'> Project Name: pytorchlightning/pytorch-lightning-bolts</div><div id='commit'> Commit Name: 58cb612459c04b48b70b0cad116d0d6b954e2a24</div><div id='time'> Time: 2022-06-28</div><div id='author'> Author: sean@grid.ai</div><div id='file'> File Name: tests/models/rl/unit/test_ppo.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_generate_trajectory_samples(0)</div><div id='n_method'> N Method Name: test_generate_trajectory_samples(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/models/rl/unit/test_ppo.py</div><div id='n_file'> N File Name: tests/models/rl/unit/test_ppo.py</div><div id='m_start'> M Start Line: 77</div><div id='m_end'> M End Line: 77</div><div id='n_start'> N Start Line: 69</div><div id='n_end'> N End Line: 78</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        forward_pass_function(sim.session, None)

        for name, qc_op in sim.get_qc_quantize_op().items():
            <a id="change">assert </a>qc_op.tensor_quantizer.isEncodingValid is True


def forward_pass_function(session, args=None):</code></pre><h3>After Change</h3><pre><code class='java'>
    def test_quantize_resnet18(self):
         Test for E2E quantization 
        np.random.seed(0)
        <a id="change">torch.manual_seed(0</a><a id="change">)</a>

        if not os.path.exists(WORKING_DIR):
            os.makedirs(WORKING_DIR)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/5407489a33f6b1cd1f5826eda2e2a756d1bd7438#diff-399a3422b6263fcd378207253b1804985367f575917d6d3733a6275579e853cfL51' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 57505262</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: 5407489a33f6b1cd1f5826eda2e2a756d1bd7438</div><div id='time'> Time: 2022-11-17</div><div id='author'> Author: 63610745+quic-mangal@users.noreply.github.com</div><div id='file'> File Name: NightlyTests/onnx/test_quantsim.py</div><div id='m_class'> M Class Name: TestQuantizeAcceptance</div><div id='n_method'> N Class Name: TestQuantizeAcceptance</div><div id='m_method'> M Method Name: test_quantize_resnet18(1)</div><div id='n_method'> N Method Name: test_quantize_resnet18(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: NightlyTests/onnx/test_quantsim.py</div><div id='n_file'> N File Name: NightlyTests/onnx/test_quantsim.py</div><div id='m_start'> M Start Line: 58</div><div id='m_end'> M End Line: 73</div><div id='n_start'> N Start Line: 54</div><div id='n_end'> N End Line: 93</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            [0.51605093, 0.5707241, 0.47365507, 0.50578886, 0.5633877, 0.4642503, 0.5182081, 0.48763484, 0.49084237]
        )
        assert np.abs(image_slice.flatten() - expected_slice).max() &lt; 1e-2
        <a id="change">assert </a>np.abs(image_from_tuple_slice.flatten() - expected_slice).max() &lt; 1e-2

    @unittest.skipIf(torch_device != "cuda", "This test requires a GPU")
    def test_alt_diffusion_fp16(self):</code></pre><h3>After Change</h3><pre><code class='java'>

        components = self.get_dummy_components()
        components["scheduler"] = PNDMScheduler(skip_prk_steps=True)
        <a id="change">torch.manual_seed(0</a><a id="change">)</a>
        text_encoder_config = RobertaSeriesConfig(
            hidden_size=32,
            project_dim=32,
            intermediate_size=37,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/diffusers/commit/02d83c9ff1b93f2c6f9c94f9369b3e4bc1ba8ce7#diff-499696207abf6ce8e8607495873bf133251a2945a02c0963410b4f38fba319dbL182' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 57505257</div><div id='project'> Project Name: huggingface/diffusers</div><div id='commit'> Commit Name: 02d83c9ff1b93f2c6f9c94f9369b3e4bc1ba8ce7</div><div id='time'> Time: 2022-12-06</div><div id='author'> Author: anton@huggingface.co</div><div id='file'> File Name: tests/pipelines/altdiffusion/test_alt_diffusion.py</div><div id='m_class'> M Class Name: AltDiffusionPipelineFastTests</div><div id='n_method'> N Class Name: AltDiffusionPipelineFastTests</div><div id='m_method'> M Method Name: test_alt_diffusion_pndm(1)</div><div id='n_method'> N Method Name: test_alt_diffusion_pndm(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase,PipelineTesterMixin</div><div id='n_parent_class'> N Parent Class: unittest.TestCase,PipelineTesterMixin</div><div id='m_file'> M File Name: tests/pipelines/altdiffusion/test_alt_diffusion.py</div><div id='n_file'> N File Name: tests/pipelines/altdiffusion/test_alt_diffusion.py</div><div id='m_start'> M Start Line: 184</div><div id='m_end'> M End Line: 228</div><div id='n_start'> N Start Line: 161</div><div id='n_end'> N End Line: 183</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        atb_check = ata @ solved_x[i].cpu()

        max_offset = torch.norm(atb - atb_check, p=float("inf"))
        <a id="change">assert </a>max_offset &lt; 1e-4


def check_sparse_solver_multistep(test_exception: bool):</code></pre><h3>After Change</h3><pre><code class='java'>
@pytest.mark.parametrize("float_damping", [True, False])
def test_sparse_solver(batch_size: int, float_damping: bool):
    rng = torch.Generator()
    <a id="change">rng.manual_seed(0</a><a id="change">)</a>
    if not torch.cuda.is_available():
        return

    void_objective = th.Objective()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/facebookresearch/theseus/commit/00eee1a15c0f987f86c542d694ff6efc7b8fb1f9#diff-014672fddd42904f05996cc54f069475055044eb4e706177792d9c63c17eb890L26' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 57505258</div><div id='project'> Project Name: facebookresearch/theseus</div><div id='commit'> Commit Name: 00eee1a15c0f987f86c542d694ff6efc7b8fb1f9</div><div id='time'> Time: 2022-11-04</div><div id='author'> Author: luisen.p@gmail.com</div><div id='file'> File Name: theseus/optimizer/linear/tests/test_lu_cuda_sparse_solver.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_sparse_solver(2)</div><div id='n_method'> N Method Name: test_sparse_solver(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: theseus/optimizer/linear/tests/test_lu_cuda_sparse_solver.py</div><div id='n_file'> N File Name: theseus/optimizer/linear/tests/test_lu_cuda_sparse_solver.py</div><div id='m_start'> M Start Line: 33</div><div id='m_end'> M End Line: 64</div><div id='n_start'> N Start Line: 28</div><div id='n_end'> N End Line: 73</div><BR>