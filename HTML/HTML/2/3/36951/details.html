<html><h3>Pattern ID :36951
</h3><img src='105204581.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        if matrix.ndim != 3 or matrix.shape[1:] != (3, 3):
            raise ValueError("Hat matrices of SO(3) can only be 3x3 matrices")

        if <a id="change">_LieGroupCheckContext.get_context()</a>:
            warnings.warn(
                "Lie group checks are disabled, so the skew-symmetry of hat matrices is "
                "not checked for SO3.",</code></pre><h3>After Change</h3><pre><code class='java'>
        if matrix.ndim != 3 or matrix.shape[1:] != (3, 3):
            raise ValueError("Hat matrices of SO(3) can only be 3x3 matrices")

        checks_enabled<a id="change">, silent_unchecks = </a><a id="change">_LieGroupCheckContext.get_context()</a>
        if checks_enabled:
            if (
                matrix.transpose(1, 2) + matrix
            ).abs().max().item() &gt; theseus.constants._SO3_HAT_EPS[matrix.dtype]:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/facebookresearch/theseus/commit/b30b28cd4ff72a68f4e59e625954a129544d3c3d#diff-e280bf56ff67b77f7c002b2f7d530ca64133819c65e166cebb762368a675a724L181' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 105204581</div><div id='project'> Project Name: facebookresearch/theseus</div><div id='commit'> Commit Name: b30b28cd4ff72a68f4e59e625954a129544d3c3d</div><div id='time'> Time: 2022-11-04</div><div id='author'> Author: luisen.p@gmail.com</div><div id='file'> File Name: theseus/geometry/so3.py</div><div id='m_class'> M Class Name: SO3</div><div id='n_method'> N Class Name: SO3</div><div id='m_method'> M Method Name: _hat_matrix_check(1)</div><div id='n_method'> N Method Name: _hat_matrix_check(1)</div><div id='m_parent_class'> M Parent Class: LieGroup</div><div id='n_parent_class'> N Parent Class: LieGroup</div><div id='m_file'> M File Name: theseus/geometry/so3.py</div><div id='n_file'> N File Name: theseus/geometry/so3.py</div><div id='m_start'> M Start Line: 181</div><div id='m_end'> M End Line: 186</div><div id='n_start'> N Start Line: 182</div><div id='n_end'> N End Line: 193</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if quaternion.ndim != 2 or quaternion.shape[1] != 4:
            raise ValueError("Quaternions can only be 4-D vectors.")

        if <a id="change">_LieGroupCheckContext.get_context()</a>:
            QUANTERNION_EPS = theseus.constants._SO3_QUATERNION_EPS[quaternion.dtype]

            if quaternion.dtype != torch.float64:</code></pre><h3>After Change</h3><pre><code class='java'>
        if quaternion.ndim != 2 or quaternion.shape[1] != 4:
            raise ValueError("Quaternions can only be 4-D vectors.")

        checks_enabled<a id="change">, silent_unchecks = </a><a id="change">_LieGroupCheckContext.get_context()</a>
        if checks_enabled:
            QUANTERNION_EPS = theseus.constants._SO3_QUATERNION_EPS[quaternion.dtype]

            if quaternion.dtype != torch.float64:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/facebookresearch/theseus/commit/b30b28cd4ff72a68f4e59e625954a129544d3c3d#diff-e280bf56ff67b77f7c002b2f7d530ca64133819c65e166cebb762368a675a724L155' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 105204580</div><div id='project'> Project Name: facebookresearch/theseus</div><div id='commit'> Commit Name: b30b28cd4ff72a68f4e59e625954a129544d3c3d</div><div id='time'> Time: 2022-11-04</div><div id='author'> Author: luisen.p@gmail.com</div><div id='file'> File Name: theseus/geometry/so3.py</div><div id='m_class'> M Class Name: SO3</div><div id='n_method'> N Class Name: SO3</div><div id='m_method'> M Method Name: _unit_quaternion_check(1)</div><div id='n_method'> N Method Name: _unit_quaternion_check(1)</div><div id='m_parent_class'> M Parent Class: LieGroup</div><div id='n_parent_class'> N Parent Class: LieGroup</div><div id='m_file'> M File Name: theseus/geometry/so3.py</div><div id='n_file'> N File Name: theseus/geometry/so3.py</div><div id='m_start'> M Start Line: 159</div><div id='m_end'> M End Line: 174</div><div id='n_start'> N Start Line: 159</div><div id='n_end'> N End Line: 175</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if tensor is None and dtype is None:
            dtype = torch.get_default_dtype()
        if tensor is not None:
            if <a id="change">_LieGroupCheckContext.get_context()</a>:
                tensor = self._check_tensor(tensor, strict)
            else:
                warnings.warn(</code></pre><h3>After Change</h3><pre><code class='java'>
        if tensor is None and dtype is None:
            dtype = torch.get_default_dtype()
        if tensor is not None:
            checks_enabled<a id="change">, silent_unchecks = </a><a id="change">_LieGroupCheckContext.get_context()</a>
            if checks_enabled:
                tensor = self._check_tensor(tensor, strict)
            elif not silent_unchecks:
                warnings.warn(</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/facebookresearch/theseus/commit/b30b28cd4ff72a68f4e59e625954a129544d3c3d#diff-36af48d836ebf22f64ee1d1cd36b093ee79c7015ecc42133ad3977f3df7b8488L32' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 105204582</div><div id='project'> Project Name: facebookresearch/theseus</div><div id='commit'> Commit Name: b30b28cd4ff72a68f4e59e625954a129544d3c3d</div><div id='time'> Time: 2022-11-04</div><div id='author'> Author: luisen.p@gmail.com</div><div id='file'> File Name: theseus/geometry/manifold.py</div><div id='m_class'> M Class Name: Manifold</div><div id='n_method'> N Class Name: Manifold</div><div id='m_method'> M Method Name: __init__(0)</div><div id='n_method'> N Method Name: __init__(0)</div><div id='m_parent_class'> M Parent Class: abc.ABC,Variable</div><div id='n_parent_class'> N Parent Class: abc.ABC,Variable</div><div id='m_file'> M File Name: theseus/geometry/manifold.py</div><div id='n_file'> N File Name: theseus/geometry/manifold.py</div><div id='m_start'> M Start Line: 45</div><div id='m_end'> M End Line: 52</div><div id='n_start'> N Start Line: 45</div><div id='n_end'> N End Line: 53</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    def _hat_matrix_check(matrix: torch.Tensor):
        _check = matrix.ndim == 3 and matrix.shape[1:] == (2, 2)

        if <a id="change">_LieGroupCheckContext.get_context()</a>:
            _check &= matrix[:, 0, 0].abs().max().item() &lt; theseus.constants.EPS
            _check &= matrix[:, 1, 1].abs().max().item() &lt; theseus.constants.EPS
            _check &= torch.allclose(matrix[:, 0, 1], -matrix[:, 1, 0])</code></pre><h3>After Change</h3><pre><code class='java'>
    def _hat_matrix_check(matrix: torch.Tensor):
        _check = matrix.ndim == 3 and matrix.shape[1:] == (2, 2)

        checks_enabled<a id="change">, silent_unchecks = </a><a id="change">_LieGroupCheckContext.get_context()</a>
        if checks_enabled:
            _check &= matrix[:, 0, 0].abs().max().item() &lt; theseus.constants.EPS
            _check &= matrix[:, 1, 1].abs().max().item() &lt; theseus.constants.EPS
            _check &= torch.allclose(matrix[:, 0, 1], -matrix[:, 1, 0])</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/facebookresearch/theseus/commit/b30b28cd4ff72a68f4e59e625954a129544d3c3d#diff-592f3951880bfd7ee91cdf8f93a7098eff06f56639709436379d18111ac6087dL140' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 105204579</div><div id='project'> Project Name: facebookresearch/theseus</div><div id='commit'> Commit Name: b30b28cd4ff72a68f4e59e625954a129544d3c3d</div><div id='time'> Time: 2022-11-04</div><div id='author'> Author: luisen.p@gmail.com</div><div id='file'> File Name: theseus/geometry/so2.py</div><div id='m_class'> M Class Name: SO2</div><div id='n_method'> N Class Name: SO2</div><div id='m_method'> M Method Name: _hat_matrix_check(1)</div><div id='n_method'> N Method Name: _hat_matrix_check(1)</div><div id='m_parent_class'> M Parent Class: LieGroup</div><div id='n_parent_class'> N Parent Class: LieGroup</div><div id='m_file'> M File Name: theseus/geometry/so2.py</div><div id='n_file'> N File Name: theseus/geometry/so2.py</div><div id='m_start'> M Start Line: 143</div><div id='m_end'> M End Line: 152</div><div id='n_start'> N Start Line: 143</div><div id='n_end'> N End Line: 153</div><BR>