<html><h3>Pattern ID :3015
</h3><img src='11679345.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    assert handle_queue.empty()
    _add_worker(args, &quotip1&quot, shard_id=0)
    _add_worker(args, &quotip2&quot, shard_id=1)
    <a id="change">_add_worker(</a>args, &quotip3&quot<a id="change">, shard_id=2)</a>
    assert handle_queue.empty()

    data_request = _create_test_data_message()
    result = GrpcConnectionPool.send_requests_sync(</code></pre><h3>After Change</h3><pre><code class='java'>
    else:
        args = set_pod_parser().parse_args([&quot--disable-reduce&quot])
    args.polling = PollingType.ALL
    connection_list_dict = {0: [f&quotip1:8080&quot], 1: <a id="change">[f&quotip2:8080&quot</a>], 2: [f&quotip3:8080&quot]}
    args.connection_list = json.dumps(connection_list_dict)
    cancel_event, handle_queue, runtime_thread = _create_runtime(args)
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 7</div><BR><div id='size'>Non-data size: 2</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/ef662b529b2a2eecea7bb99759a9f7b9d86d3062#diff-46388b1e5294ec63024b9aee270cfacdcb1ed75ef72f566884814cfd0f788106L52' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 11679345</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: ef662b529b2a2eecea7bb99759a9f7b9d86d3062</div><div id='time'> Time: 2022-06-08</div><div id='author'> Author: joan.martinez@jina.ai</div><div id='file'> File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_message_merging(1)</div><div id='n_method'> N Method Name: test_message_merging(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='n_file'> N File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_start'> M Start Line: 84</div><div id='m_end'> M End Line: 87</div><div id='n_start'> N Start Line: 52</div><div id='n_end'> N End Line: 53</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    args.polling = PollingType.ANY
    cancel_event, handle_queue, runtime_thread = _create_runtime(args)

    <a id="change">_add_worker(</a>args<a id="change">)</a>

    with grpc.insecure_channel(
        f&quot{args.host}:{args.port}&quot,
        options=GrpcConnectionPool.get_default_grpc_options(),</code></pre><h3>After Change</h3><pre><code class='java'>
def test_regular_data_case():
    args = set_pod_parser().parse_args([])
    args.polling = PollingType.ANY
    connection_list_dict = {0: <a id="change">[f&quotfake_ip:8080&quot</a>]}
    args.connection_list = json.dumps(connection_list_dict)
    cancel_event, handle_queue, runtime_thread = _create_runtime(args)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/ef662b529b2a2eecea7bb99759a9f7b9d86d3062#diff-46388b1e5294ec63024b9aee270cfacdcb1ed75ef72f566884814cfd0f788106L25' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 11679350</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: ef662b529b2a2eecea7bb99759a9f7b9d86d3062</div><div id='time'> Time: 2022-06-08</div><div id='author'> Author: joan.martinez@jina.ai</div><div id='file'> File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_regular_data_case(0)</div><div id='n_method'> N Method Name: test_regular_data_case(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='n_file'> N File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_start'> M Start Line: 26</div><div id='m_end'> M End Line: 30</div><div id='n_start'> N Start Line: 24</div><div id='n_end'> N End Line: 27</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    assert handle_queue.empty()
    _add_worker(args, &quotip1&quot, shard_id=0)
    <a id="change">_add_worker(</a>args, &quotip2&quot<a id="change">, shard_id=1)</a>
    _add_worker(args, &quotip3&quot, shard_id=2)
    assert handle_queue.empty()

    result = GrpcConnectionPool.send_request_sync(</code></pre><h3>After Change</h3><pre><code class='java'>
    args.polling = PollingType.ALL
    args.uses_before_address = &quotfake_address&quot
    args.uses_after_address = &quotfake_address&quot
    connection_list_dict = {0: [f&quotip1:8080&quot], 1: [f&quotip2:8080&quot], 2: <a id="change">[f&quotip3:8080&quot</a>]}
    args.connection_list = json.dumps(connection_list_dict)
    cancel_event, handle_queue, runtime_thread = _create_runtime(args)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/ef662b529b2a2eecea7bb99759a9f7b9d86d3062#diff-46388b1e5294ec63024b9aee270cfacdcb1ed75ef72f566884814cfd0f788106L100' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 11679348</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: ef662b529b2a2eecea7bb99759a9f7b9d86d3062</div><div id='time'> Time: 2022-06-08</div><div id='author'> Author: joan.martinez@jina.ai</div><div id='file'> File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_uses_before_uses_after(0)</div><div id='n_method'> N Method Name: test_uses_before_uses_after(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='n_file'> N File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_start'> M Start Line: 101</div><div id='m_end'> M End Line: 111</div><div id='n_start'> N Start Line: 70</div><div id='n_end'> N End Line: 75</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    )
    cancel_event, handle_queue, runtime_thread = _create_runtime(args)

    <a id="change">_add_worker(</a>args<a id="change">, shard_id=0)</a>
    _add_worker(args, shard_id=1)

    with grpc.insecure_channel(
        f&quot{args.host}:{args.port}&quot,</code></pre><h3>After Change</h3><pre><code class='java'>
            str(2),
        ]
    )
    connection_list_dict = {0: <a id="change">[f&quotfake_ip:8080&quot</a>], 1: [f&quotfake_ip:8080&quot]}
    args.connection_list = json.dumps(connection_list_dict)
    cancel_event, handle_queue, runtime_thread = _create_runtime(args)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/ef662b529b2a2eecea7bb99759a9f7b9d86d3062#diff-46388b1e5294ec63024b9aee270cfacdcb1ed75ef72f566884814cfd0f788106L208' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 11679349</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: ef662b529b2a2eecea7bb99759a9f7b9d86d3062</div><div id='time'> Time: 2022-06-08</div><div id='author'> Author: joan.martinez@jina.ai</div><div id='file'> File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_base_polling(1)</div><div id='n_method'> N Method Name: test_base_polling(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='n_file'> N File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_start'> M Start Line: 209</div><div id='m_end'> M End Line: 220</div><div id='n_start'> N Start Line: 177</div><div id='n_end'> N End Line: 186</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    )
    cancel_event, handle_queue, runtime_thread = _create_runtime(args)

    <a id="change">_add_worker(</a>args<a id="change">, shard_id=0)</a>
    _add_worker(args, shard_id=1)

    with grpc.insecure_channel(
        f&quot{args.host}:{args.port}&quot,</code></pre><h3>After Change</h3><pre><code class='java'>
        ]
    )

    connection_list_dict = {0: <a id="change">[f&quotfake_ip:8080&quot</a>], 1: [f&quotfake_ip:8080&quot]}
    args.connection_list = json.dumps(connection_list_dict)

    cancel_event, handle_queue, runtime_thread = _create_runtime(args)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/ef662b529b2a2eecea7bb99759a9f7b9d86d3062#diff-46388b1e5294ec63024b9aee270cfacdcb1ed75ef72f566884814cfd0f788106L164' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 11679353</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: ef662b529b2a2eecea7bb99759a9f7b9d86d3062</div><div id='time'> Time: 2022-06-08</div><div id='author'> Author: joan.martinez@jina.ai</div><div id='file'> File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_dynamic_polling(1)</div><div id='n_method'> N Method Name: test_dynamic_polling(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='n_file'> N File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_start'> M Start Line: 165</div><div id='m_end'> M End Line: 178</div><div id='n_start'> N Start Line: 132</div><div id='n_end'> N End Line: 144</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    args.polling = PollingType.ANY
    cancel_event, handle_queue, runtime_thread = _create_runtime(args)

    <a id="change">_add_worker(</a>args<a id="change">)</a>

    with grpc.insecure_channel(
        f&quot{args.host}:{args.port}&quot,
        options=GrpcConnectionPool.get_default_grpc_options(),</code></pre><h3>After Change</h3><pre><code class='java'>
def test_timeout_behaviour():
    args = set_pod_parser().parse_args([&quot--timeout-send&quot, &quot100&quot])
    args.polling = PollingType.ANY
    connection_list_dict = {0: <a id="change">[f&quotfake_ip:8080&quot</a>]}
    args.connection_list = json.dumps(connection_list_dict)
    cancel_event, handle_queue, runtime_thread = _create_runtime(args)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/ef662b529b2a2eecea7bb99759a9f7b9d86d3062#diff-46388b1e5294ec63024b9aee270cfacdcb1ed75ef72f566884814cfd0f788106L275' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 11679358</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: ef662b529b2a2eecea7bb99759a9f7b9d86d3062</div><div id='time'> Time: 2022-06-08</div><div id='author'> Author: joan.martinez@jina.ai</div><div id='file'> File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_timeout_behaviour(0)</div><div id='n_method'> N Method Name: test_timeout_behaviour(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='n_file'> N File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_start'> M Start Line: 276</div><div id='m_end'> M End Line: 280</div><div id='n_start'> N Start Line: 242</div><div id='n_end'> N End Line: 245</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    args.polling = PollingType.ANY
    cancel_event, handle_queue, runtime_thread = _create_runtime(args)

    <a id="change">_add_worker(</a>args<a id="change">)</a>

    with grpc.insecure_channel(
        f&quot{args.host}:{args.port}&quot,
        options=GrpcConnectionPool.get_default_grpc_options(),</code></pre><h3>After Change</h3><pre><code class='java'>

    args = set_pod_parser().parse_args([])
    args.polling = PollingType.ANY
    connection_list_dict = {0: <a id="change">[f&quotfake_ip:8080&quot</a>]}
    args.connection_list = json.dumps(connection_list_dict)
    cancel_event, handle_queue, runtime_thread = _create_runtime(args)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/jina/commit/ef662b529b2a2eecea7bb99759a9f7b9d86d3062#diff-46388b1e5294ec63024b9aee270cfacdcb1ed75ef72f566884814cfd0f788106L123' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 11679340</div><div id='project'> Project Name: jina-ai/jina</div><div id='commit'> Commit Name: ef662b529b2a2eecea7bb99759a9f7b9d86d3062</div><div id='time'> Time: 2022-06-08</div><div id='author'> Author: joan.martinez@jina.ai</div><div id='file'> File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_decompress(1)</div><div id='n_method'> N Method Name: test_decompress(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='n_file'> N File Name: tests/unit/serve/runtimes/head/test_head_runtime.py</div><div id='m_start'> M Start Line: 140</div><div id='m_end'> M End Line: 144</div><div id='n_start'> N Start Line: 107</div><div id='n_end'> N End Line: 110</div><BR>