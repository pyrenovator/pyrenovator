<html><h3>Pattern ID :25505
</h3><img src='77714305.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    intrinsic_metrix[2, 2] = 1

    if inv:
        intrinsic_metrix = <a id="change">np.linalg.inv(</a>intrinsic_metrix<a id="change">)</a>.astype(np.float32)
    return intrinsic_metrix
</code></pre><h3>After Change</h3><pre><code class='java'>
    intrinsic_metrix = np.zeros((3, 3)).astype(np.float32)

    if inv:
        intrinsic_metrix[0, 0] = 1.0 / <a id="change">f[0]</a>
        intrinsic_metrix[0, 2] = -c[0] / f[0]
        intrinsic_metrix[1, 1] = 1.0 / f[1]
        intrinsic_metrix[1, 2] = -c[1] / f[1]
        intrinsic_metrix[2, 2] = 1</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 2</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/jeff-sjtu/hybrik/commit/92acf081ef9614671c907a697ba7eeea5a0b08e6#diff-12791748c0eda60f16f6bd76c6384f448120ab406d13642a973563df052db57dL122' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 77714305</div><div id='project'> Project Name: jeff-sjtu/hybrik</div><div id='commit'> Commit Name: 92acf081ef9614671c907a697ba7eeea5a0b08e6</div><div id='time'> Time: 2021-10-22</div><div id='author'> Author: jeff.lee.sjtu@gmail.com</div><div id='file'> File Name: hybrik/utils/pose_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: get_intrinsic_metrix(3)</div><div id='n_method'> N Method Name: get_intrinsic_metrix(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: hybrik/utils/pose_utils.py</div><div id='n_file'> N File Name: hybrik/utils/pose_utils.py</div><div id='m_start'> M Start Line: 122</div><div id='m_end'> M End Line: 131</div><div id='n_start'> N Start Line: 122</div><div id='n_end'> N End Line: 137</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                                                                                                   device=H2.device).float()

        &#47&#47 performs the inverse square root of the covariance matrices by the cholesky decomposition. This is more stable than using SVD
        SigmaHat11RootInv = <a id="change">torch.linalg.inv(</a>torch.linalg.cholesky(_minimal_regularisation(SigmaHat11, self.eps))<a id="change">)</a>
        SigmaHat22RootInv = torch.linalg.inv(torch.linalg.cholesky(_minimal_regularisation(SigmaHat22, self.eps)))

        Tval = torch.matmul(torch.matmul(SigmaHat11RootInv,
                                         SigmaHat12), SigmaHat22RootInv)</code></pre><h3>After Change</h3><pre><code class='java'>
        o1 = H1.shape[1]
        o2 = H2.shape[1]

        n = <a id="change">H1.shape[0]</a>

        H1bar, H2bar = _demean(H1, H2)

        SigmaHat12 = (1.0 / (n - 1)) * torch.matmul(H1bar.T, H2bar)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jameschapman19/cca_zoo/commit/109657aa0c08d40d8571bc16e653094cb6206408#diff-abb7a5d5582a748bb8e9b037ee50860d69b8505da48d9f6c9c4a34060dd0bac9L142' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 77714304</div><div id='project'> Project Name: jameschapman19/cca_zoo</div><div id='commit'> Commit Name: 109657aa0c08d40d8571bc16e653094cb6206408</div><div id='time'> Time: 2021-07-14</div><div id='author'> Author: james.chapman.19@ucl.ac.uk</div><div id='file'> File Name: cca_zoo/deepmodels/objectives.py</div><div id='m_class'> M Class Name: CCA</div><div id='n_method'> N Class Name: CCA</div><div id='m_method'> M Method Name: loss(3)</div><div id='n_method'> N Method Name: loss(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: cca_zoo/deepmodels/objectives.py</div><div id='n_file'> N File Name: cca_zoo/deepmodels/objectives.py</div><div id='m_start'> M Start Line: 143</div><div id='m_end'> M End Line: 171</div><div id='n_start'> N Start Line: 145</div><div id='n_end'> N End Line: 166</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    while len(p_list) &lt; max_iter:
        D = torch.eye(j.shape[1], device=j.device)
        D *= 1 if meth == &quotlev&quot else torch.max(torch.maximum(H.diagonal(), D.diagonal()))
        h = -torch.matmul(<a id="change">torch.linalg.inv(</a>H+u*D<a id="change">)</a>, g)
        f_h = fun(p+h)
        rho_denom = torch.matmul(h, u*h-g)
        rho_nom = torch.matmul(f, f) - torch.matmul(f_h, f_h)</code></pre><h3>After Change</h3><pre><code class='java'>
    while len(p_list) &lt; max_iter:
        D = torch.eye(j.shape[1], device=j.device)
        D *= 1 if meth == &quotlev&quot else torch.max(torch.maximum(H.diagonal(), D.diagonal()))
        h = -<a id="change">torch.linalg.lstsq(H+u*D, g, rcond=None, driver=None)[0]</a>
        f_h = fun(p+h)
        rho_denom = torch.matmul(h, u*h-g)
        rho_nom = torch.matmul(f, f) - torch.matmul(f_h, f_h)
        rho = rho_nom / rho_denom if rho_denom &gt; 0 else torch.inf if rho_nom &gt; 0 else -torch.inf</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hahnec/torchimize/commit/ae6c7bb89c2593b2732ab9c2fedfee0d9bea8399#diff-5880beb70bb8d323dcf0009681a99a67c726e6b1a98c09d12ed9e51011d7754fL23' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 77714306</div><div id='project'> Project Name: hahnec/torchimize</div><div id='commit'> Commit Name: ae6c7bb89c2593b2732ab9c2fedfee0d9bea8399</div><div id='time'> Time: 2022-05-16</div><div id='author'> Author: christopher.hahne@unibe.ch</div><div id='file'> File Name: torchimize/functions/lma_fun.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: lsq_lma(14)</div><div id='n_method'> N Method Name: lsq_lma(14)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: torchimize/functions/lma_fun.py</div><div id='n_file'> N File Name: torchimize/functions/lma_fun.py</div><div id='m_start'> M Start Line: 72</div><div id='m_end'> M End Line: 80</div><div id='n_start'> N Start Line: 72</div><div id='n_end'> N End Line: 80</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        mat_contPts_w = np.concatenate((contPts_w, np.array([np.ones((4))])), axis=0)
        
        &#47&#47 Calculate Alpha
        Alpha = np.matmul(<a id="change">np.linalg.inv(</a>mat_contPts_w<a id="change">)</a>, mat_objPts_w) &#47&#47 simple method
        Alpha = Alpha.transpose()
        &#47&#47 Alpha = solve(mat_contPts_w, mat_objPts_w) &#47&#47 General method
        &#47&#47 Alpha = Alpha.transpose()</code></pre><h3>After Change</h3><pre><code class='java'>
            torch.Tensor: alphas, shape (batch_size, num_pts, 4)
        
        batch_size = objPts.shape[0]
        num_pts = <a id="change">objPts.shape[1]</a>
        batched_ones = torch.ones((batch_size, num_pts, 1), dtype=objPts.dtype, device=objPts.device)
        &#47&#47 concatenate object points with ones
        objPts = torch.cat((objPts, batched_ones), dim=-1)
        &#47&#47 concatenate control points with ones</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/pypose/pypose/commit/f6e65aa4066f56f1715c9ddfd89f5307c1ebe043#diff-052b8dfcb4f5d16ac2df9676fd039e877588b354a969db2f245a098529fc6d31L127' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 77714312</div><div id='project'> Project Name: pypose/pypose</div><div id='commit'> Commit Name: f6e65aa4066f56f1715c9ddfd89f5307c1ebe043</div><div id='time'> Time: 2023-02-24</div><div id='author'> Author: ztzhan1108@gmail.com</div><div id='file'> File Name: pypose/module/pnp.py</div><div id='m_class'> M Class Name: EPnP</div><div id='n_method'> N Class Name: EPnP</div><div id='m_method'> M Method Name: compute_alphas(4)</div><div id='n_method'> N Method Name: compute_alphas(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: pypose/module/pnp.py</div><div id='n_file'> N File Name: pypose/module/pnp.py</div><div id='m_start'> M Start Line: 127</div><div id='m_end'> M End Line: 140</div><div id='n_start'> N Start Line: 131</div><div id='n_end'> N End Line: 158</div><BR>