<html><h3>Pattern ID :6945
</h3><img src='23279665.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

def process_checkpoint(in_file):
    tmp_file = in_file + ".tmp"
    <a id="change">subprocess.Popen(</a>[&quotcp&quot, in_file, tmp_file]<a id="change">)</a>
    sha = subprocess.check_output([&quotsha256sum&quot, tmp_file]).decode()
    out_file = in_file
    if out_file.endswith(&quot.pth&quot):
        out_file = out_file[:-4]</code></pre><h3>After Change</h3><pre><code class='java'>
    else:
        torch.save(checkpoint, out_file)

    <a id="change">if </a>decode:
        sha = subprocess.check_output([&quotsha256sum&quot, out_file]).decode()
        if out_file.endswith(&quot.pth&quot):
            out_file_name = out_file[:-4]
        else:
            out_file_name = out_file
        final_file<a id="change"> = </a>out_file_name + f&quot-{sha[:8]}.pth&quot
        subprocess.Popen([&quotmv&quot, out_file, final_file])

</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/westlake-ai/openbioseq/commit/f678533fb9c8c5320abdd86ba57bd50d6357835f#diff-df2bdd976500f5594a90d51275819e5dbbc8baf1a1834b8e6327bf5707d879d8L13' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 23279665</div><div id='project'> Project Name: westlake-ai/openbioseq</div><div id='commit'> Commit Name: f678533fb9c8c5320abdd86ba57bd50d6357835f</div><div id='time'> Time: 2023-03-05</div><div id='author'> Author: 1070535169@qq.com</div><div id='file'> File Name: tools/model_converters/publish_model.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: process_checkpoint(3)</div><div id='n_method'> N Method Name: process_checkpoint(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tools/model_converters/publish_model.py</div><div id='n_file'> N File Name: tools/model_converters/publish_model.py</div><div id='m_start'> M Start Line: 13</div><div id='m_end'> M End Line: 24</div><div id='n_start'> N Start Line: 24</div><div id='n_end'> N End Line: 45</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            if not args.disable_numactl:
                process = subprocess.Popen(cmd_s, env=os.environ, shell=True)
            elif enable_taskset:
                process = <a id="change">subprocess.Popen(</a>cmd<a id="change">, env=os.environ)</a>
            processes.append(process)

            if args.instance_idx != -1: &#47&#47 launches single instance, instance_idx, only
                break</code></pre><h3>After Change</h3><pre><code class='java'>

        if not args.disable_taskset:
            enable_taskset = True
        <a id="change">if </a>args.disable_numactl and args.disable_taskset:
            &#47&#47 If numactl and taskset are both disabled, KMP_AFFINITY should be set False
            &#47&#47 so that all the cpu resource can be used.
            set_kmp_affinity<a id="change"> = </a>False

        self.set_multi_thread_and_allocator(args.ncore_per_instance,
                                            args.disable_iomp,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/oap-project/cloudtik/commit/1bd207b9d6e2107a414081a2b6422d1442295283#diff-919af80963850d06791447802111e520d41c0308b8eb6af68b959b870c08407fL19' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 23279662</div><div id='project'> Project Name: oap-project/cloudtik</div><div id='commit'> Commit Name: 1bd207b9d6e2107a414081a2b6422d1442295283</div><div id='time'> Time: 2023-03-30</div><div id='author'> Author: hao.jin@intel.com</div><div id='file'> File Name: python/cloudtik/runtime/ml/runner/cpu/multi_instance_launcher.py</div><div id='m_class'> M Class Name: MultiInstanceLauncher</div><div id='n_method'> N Class Name: MultiInstanceLauncher</div><div id='m_method'> M Method Name: launch(1)</div><div id='n_method'> N Method Name: launch(1)</div><div id='m_parent_class'> M Parent Class: CPULauncher</div><div id='n_parent_class'> N Parent Class: CPULauncher</div><div id='m_file'> M File Name: python/cloudtik/runtime/ml/runner/cpu/multi_instance_launcher.py</div><div id='n_file'> N File Name: python/cloudtik/runtime/ml/runner/cpu/multi_instance_launcher.py</div><div id='m_start'> M Start Line: 20</div><div id='m_end'> M End Line: 212</div><div id='n_start'> N Start Line: 20</div><div id='n_end'> N End Line: 212</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

def process_checkpoint(in_file):
    tmp_file = in_file + ".tmp"
    <a id="change">subprocess.Popen(</a>[&quotcp&quot, in_file, tmp_file]<a id="change">)</a>
    sha = subprocess.check_output([&quotsha256sum&quot, tmp_file]).decode()
    out_file = in_file
    if out_file.endswith(&quot.pth&quot):
        out_file = out_file[:-4]</code></pre><h3>After Change</h3><pre><code class='java'>
    else:
        torch.save(checkpoint, out_file)

    <a id="change">if </a>decode:
        sha = subprocess.check_output([&quotsha256sum&quot, out_file]).decode()
        if out_file.endswith(&quot.pth&quot):
            out_file_name = out_file[:-4]
        else:
            out_file_name = out_file
        final_file<a id="change"> = </a>out_file_name + f&quot-{sha[:8]}.pth&quot
        subprocess.Popen([&quotmv&quot, out_file, final_file])

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/westlake-ai/openmixup/commit/cb7ae3bae6ffe76f12f0c307e16325e7952f4274#diff-df2bdd976500f5594a90d51275819e5dbbc8baf1a1834b8e6327bf5707d879d8L13' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 23279661</div><div id='project'> Project Name: westlake-ai/openmixup</div><div id='commit'> Commit Name: cb7ae3bae6ffe76f12f0c307e16325e7952f4274</div><div id='time'> Time: 2023-02-26</div><div id='author'> Author: 1070535169@qq.com</div><div id='file'> File Name: tools/model_converters/publish_model.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: process_checkpoint(3)</div><div id='n_method'> N Method Name: process_checkpoint(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tools/model_converters/publish_model.py</div><div id='n_file'> N File Name: tools/model_converters/publish_model.py</div><div id='m_start'> M Start Line: 13</div><div id='m_end'> M End Line: 24</div><div id='n_start'> N Start Line: 24</div><div id='n_end'> N End Line: 45</div><BR>