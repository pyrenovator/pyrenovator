<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        Xs = stft(wavs.data.cpu().numpy(), n_fft=1024, hop_length=512)
        Xs = np.log(1 + np.abs(Xs))
        Xs<a id="change"> = </a><a id="change">torch.Tensor(Xs).float()</a>.to(self.device)

        &#47&#47 Concatenate labels (due to data augmentation)
        if stage == sb.Stage.TRAIN and False:</code></pre><h3>After Change</h3><pre><code class='java'>
                self.hparams.lr_annealing.on_batch_end(self.optimizer)

        self.last_batch = batch
        self.batch_to_plot = (reconstructions.clone(), <a id="change">X_stft_logpower.clone()</a>)

        theta_out = -torch.log(theta_out)
        loss_fdi = (F.softmax(classification_out, dim=1) @ theta_out.T).sum()</code></pre>