<html><h3>Pattern ID :35461
</h3><img src='100742833.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        sel_rows = 0.5 * (self[near_pi, major] + self[near_pi, :, major])
        aux = torch.ones(sel_rows.shape[0], dtype=torch.bool)
        cosine_near_pi = 0.5 * (
            self[near_pi<a id="change">, 0, 0</a>] + self[near_pi, 1, 1] + self[near_pi, 2, 2] - 1
        )
        sel_rows[aux, major] -= cosine_near_pi
        axis = (</code></pre><h3>After Change</h3><pre><code class='java'>

        near_zero = w &gt; 1 - self._NEAR_ZERO_EPS
        near_pi = w &lt;= self._NEAR_PI_EPS
        non_zero = <a id="change">self.tensor.new_ones(</a>[1]<a id="change">)</a>

        ret = self.tensor.new_zeros(self.shape[0], 4)
        &#47&#47 theta != pi
        ret[:, 0] = w</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 2</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/facebookresearch/theseus/commit/36a1b32982b112e5e5f3d3d19c0944e035a2d544#diff-e280bf56ff67b77f7c002b2f7d530ca64133819c65e166cebb762368a675a724L356' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 100742833</div><div id='project'> Project Name: facebookresearch/theseus</div><div id='commit'> Commit Name: 36a1b32982b112e5e5f3d3d19c0944e035a2d544</div><div id='time'> Time: 2022-09-07</div><div id='author'> Author: 6612911+fantaosha@users.noreply.github.com</div><div id='file'> File Name: theseus/geometry/so3.py</div><div id='m_class'> M Class Name: SO3</div><div id='n_method'> N Class Name: SO3</div><div id='m_method'> M Method Name: to_quaternion(1)</div><div id='n_method'> N Method Name: to_quaternion(1)</div><div id='m_parent_class'> M Parent Class: LieGroup</div><div id='n_parent_class'> N Parent Class: LieGroup</div><div id='m_file'> M File Name: theseus/geometry/so3.py</div><div id='n_file'> N File Name: theseus/geometry/so3.py</div><div id='m_start'> M Start Line: 356</div><div id='m_end'> M End Line: 389</div><div id='n_start'> N Start Line: 372</div><div id='n_end'> N End Line: 409</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            next_batch_decoder_attention_mask = torch.cat(
                [
                    next_batch_decoder_attention_mask,
                    torch.ones((next_batch_size<a id="change">, 1</a>)).to(self.device),
                ],
                dim=1,
            )</code></pre><h3>After Change</h3><pre><code class='java'>
            next_batch_decoder_attention_mask = torch.cat(
                [
                    next_batch_decoder_attention_mask,
                    <a id="change">next_batch_decoder_attention_mask.new_ones(</a>next_batch_size, 1<a id="change">)</a>,
                ],
                dim=1,
            )</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/text-generation-inference/commit/31d76e238df7654157ab1e372b7d57ef859daaa7#diff-5f73de5207b539d091eab9836962b8a5516a93798467b3a1870ddac878757681L367' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 100742827</div><div id='project'> Project Name: huggingface/text-generation-inference</div><div id='commit'> Commit Name: 31d76e238df7654157ab1e372b7d57ef859daaa7</div><div id='time'> Time: 2022-12-05</div><div id='author'> Author: nickhill@us.ibm.com</div><div id='file'> File Name: server/text_generation/models/seq2seq_lm.py</div><div id='m_class'> M Class Name: Seq2SeqLM</div><div id='n_method'> N Class Name: Seq2SeqLM</div><div id='m_method'> M Method Name: generate_token(2)</div><div id='n_method'> N Method Name: generate_token(2)</div><div id='m_parent_class'> M Parent Class: Model</div><div id='n_parent_class'> N Parent Class: Model</div><div id='m_file'> M File Name: server/text_generation/models/seq2seq_lm.py</div><div id='n_file'> N File Name: server/text_generation/models/seq2seq_lm.py</div><div id='m_start'> M Start Line: 393</div><div id='m_end'> M End Line: 502</div><div id='n_start'> N Start Line: 392</div><div id='n_end'> N End Line: 501</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        next_batch_attention_mask = torch.cat(
            [
                next_batch_attention_mask,
                torch.ones((next_batch_size<a id="change">, 1</a>)).to(self.device),
            ],
            dim=1,
        )</code></pre><h3>After Change</h3><pre><code class='java'>
        next_batch_attention_mask = torch.cat(
            [
                next_batch_attention_mask,
                <a id="change">next_batch_attention_mask.new_ones(</a>next_batch_size, 1<a id="change">)</a>,
            ],
            dim=1,
        )</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/text-generation-inference/commit/31d76e238df7654157ab1e372b7d57ef859daaa7#diff-ddf51fed54a3f6f10409487d931b35506acd36999839574d37b0a5cfb452ed95L274' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 100742829</div><div id='project'> Project Name: huggingface/text-generation-inference</div><div id='commit'> Commit Name: 31d76e238df7654157ab1e372b7d57ef859daaa7</div><div id='time'> Time: 2022-12-05</div><div id='author'> Author: nickhill@us.ibm.com</div><div id='file'> File Name: server/text_generation/models/causal_lm.py</div><div id='m_class'> M Class Name: CausalLM</div><div id='n_method'> N Class Name: CausalLM</div><div id='m_method'> M Method Name: generate_token(2)</div><div id='n_method'> N Method Name: generate_token(2)</div><div id='m_parent_class'> M Parent Class: Model</div><div id='n_parent_class'> N Parent Class: Model</div><div id='m_file'> M File Name: server/text_generation/models/causal_lm.py</div><div id='n_file'> N File Name: server/text_generation/models/causal_lm.py</div><div id='m_start'> M Start Line: 295</div><div id='m_end'> M End Line: 384</div><div id='n_start'> N Start Line: 294</div><div id='n_end'> N End Line: 383</div><BR>