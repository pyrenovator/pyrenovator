<html><h3>Pattern ID :35847
</h3><img src='101873186.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                not self.to_keep_higher_scores and client_scores[i] &gt; self.upper_bound
            ) or (self.to_keep_higher_scores and client_scores[i] &lt; self.lower_bound):
                &#47&#47 we do not remove the score in self.score_list to avoid mis-deleting due to severe non-iid among clients
                <a id="change">raw_client_grad_list.pop(</a>i<a id="change">)</a>
                print(f"pop -- i = {i}")
        return raw_client_grad_list

    def compute_gaussian_distribution(self):</code></pre><h3>After Change</h3><pre><code class='java'>
        print(f"mu = {mu}, sigma = {sigma}, upperbound = {self.upper_bound}")
        new_client_models, _ = self.kick_out_poisoned_local_models(client_scores, raw_client_grad_list)
        importance_feature_list = self._get_importance_feature(new_client_models)
        alphas = [1 / <a id="change">len(</a>importance_feature_list<a id="change">)</a>] * len(importance_feature_list)
        self.median<a id="change"> = </a>compute_middle_point(alphas, importance_feature_list)
        self.iteration_num += 1
        return new_client_models
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 7</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/fedml-ai/fedml/commit/0c00424b8658cf7b1d36fdf61146a5bee2465478#diff-70cf382fe695f6a8a80eeceb699773854944cd2ed6df4f50fde94cb85acba11fL55' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 101873186</div><div id='project'> Project Name: fedml-ai/fedml</div><div id='commit'> Commit Name: 0c00424b8658cf7b1d36fdf61146a5bee2465478</div><div id='time'> Time: 2022-10-22</div><div id='author'> Author: sshan0731@hotmail.com</div><div id='file'> File Name: python/fedml/core/security/defense/three_sigma_krum_defense.py</div><div id='m_class'> M Class Name: ThreeSigmaKrumDefense</div><div id='n_method'> N Class Name: ThreeSigmaKrumDefense</div><div id='m_method'> M Method Name: defend_before_aggregation(3)</div><div id='n_method'> N Method Name: defend_before_aggregation(3)</div><div id='m_parent_class'> M Parent Class: BaseDefenseMethod</div><div id='n_parent_class'> N Parent Class: BaseDefenseMethod</div><div id='m_file'> M File Name: python/fedml/core/security/defense/three_sigma_krum_defense.py</div><div id='n_file'> N File Name: python/fedml/core/security/defense/three_sigma_krum_defense.py</div><div id='m_start'> M Start Line: 57</div><div id='m_end'> M End Line: 77</div><div id='n_start'> N Start Line: 55</div><div id='n_end'> N End Line: 65</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47     print(regress[i])
        bin_index = min(bin_index, num_bins-1)
        for elt in range(len(data[i][1])):
            <a id="change">data[i][1].pop()</a>
        &#47&#47 for b in range(num_bins):
        &#47&#47     data[i][1].append(0)
        &#47&#47 data[i][1][bin_index] = 1
        data[i][1].append(bin_index)</code></pre><h3>After Change</h3><pre><code class='java'>
def convert_to_classes(data, num_bins=20):
    print(&quotNum bins for binning: {}&quot.format(num_bins))
    old_data = deepcopy(data)
    num_tasks<a id="change"> = </a><a id="change">len(</a>data[0][1]<a id="change">)</a>
    for task in range(num_tasks):
        regress = np.array([d[1][task] for d in data])
        bin_edges = np.quantile(regress, [float(i)/float(num_bins) for i in range(num_bins+1)])
        for i in range(len(data)):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/aamini/chemprop/commit/282ebf6536c6987b85ee291850db47e34e2bac2f#diff-09d0cbaf891d623ac245ccf84485a687b554217349ca55557c60b33234b969aeL14' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 101873185</div><div id='project'> Project Name: aamini/chemprop</div><div id='commit'> Commit Name: 282ebf6536c6987b85ee291850db47e34e2bac2f</div><div id='time'> Time: 2018-09-26</div><div id='author'> Author: yangk@mit.edu</div><div id='file'> File Name: utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: convert_to_classes(2)</div><div id='n_method'> N Method Name: convert_to_classes(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: utils.py</div><div id='n_file'> N File Name: utils.py</div><div id='m_start'> M Start Line: 17</div><div id='m_end'> M End Line: 30</div><div id='n_start'> N Start Line: 17</div><div id='n_end'> N End Line: 25</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            num_to_add = len(p_list) + len(n_list)
            while add_counter != num_to_add and u_idx:
                add_counter += 1
                pool.append(<a id="change">u_idx.pop()</a>)

        self.base_estimator.fit(X, y)
        self.base_estimator_2.fit(X_2, y)</code></pre><h3>After Change</h3><pre><code class='java'>
        X_2=copy.copy(X_2)
        y=copy.copy(y)

        unlabled_y=np.ones(<a id="change">len(</a>unlabled_X<a id="change">)</a>)*-1

        u_idx=np.arange(len(unlabled_X))

        random.shuffle(u_idx)

        pool = u_idx[-min(len(u_idx), self.s):]

        u_idx=u_idx[:-len(pool)]

        it = 0  &#47&#47 number of cotraining iterations we&quotve done so far

        while it != self.k and len(u_idx):
            it += 1

            self.base_estimator.fit(X, y)
            self.base_estimator_2.fit(X_2, y)

            y1_prob = self.base_estimator.predict_proba(unlabled_X[pool])
            y2_prob = self.base_estimator_2.predict_proba(unlabled_X_2[pool])

            n_list, p_list = [], []

            for i in (y1_prob[:, 0].argsort())[-self.n:]:
                if y1_prob[i, 0] &gt; 0.5:
                    n_list.append(i)
            for i in (y1_prob[:, 1].argsort())[-self.p:]:
                if y1_prob[i, 1] &gt; 0.5:
                    p_list.append(i)

            for i in (y2_prob[:, 0].argsort())[-self.n:]:
                if y2_prob[i, 0] &gt; 0.5:
                    n_list.append(i)
            for i in (y2_prob[:, 1].argsort())[-self.p:]:
                if y2_prob[i, 1] &gt; 0.5:
                    p_list.append(i)

            &#47&#47 label the samples and remove thes newly added samples from U_

            unlabled_y[[pool[x] for x in p_list]] = 1
            unlabled_y[[pool[x] for x in n_list]] = 0



            for x in p_list:
                X = np.vstack([X, unlabled_X[pool[x]]])
                X_2 = np.vstack([X_2, unlabled_X_2[pool[x]]])
                y=np.hstack([y,unlabled_y[pool[x]]])

            for x in n_list:
                X = np.vstack([X, unlabled_X[pool[x]]])
                X_2 = np.vstack([X_2, unlabled_X_2[pool[x]]])
                y<a id="change">=</a>np.hstack([y,unlabled_y[pool[x]]])


            pool = [elem for elem in pool if not (elem in p_list or elem in n_list)]</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ygzwqzd/lamda-ssl/commit/84bf1c836e04d961adff782a23bfa91cf4cc62ef#diff-74cceb3b888a8031ef23d86f6d011cc6afe20582c31fc5812de068578104a733L24' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 101873174</div><div id='project'> Project Name: ygzwqzd/lamda-ssl</div><div id='commit'> Commit Name: 84bf1c836e04d961adff782a23bfa91cf4cc62ef</div><div id='time'> Time: 2022-02-11</div><div id='author'> Author: 1129198222@qq.com</div><div id='file'> File Name: Semi_sklearn/Model/Classifier/Co_training.py</div><div id='m_class'> M Class Name: Co_training</div><div id='n_method'> N Class Name: Co_training</div><div id='m_method'> M Method Name: fit(6)</div><div id='n_method'> N Method Name: fit(6)</div><div id='m_parent_class'> M Parent Class: ClassifierMixin,InductiveEstimator</div><div id='n_parent_class'> N Parent Class: ClassifierMixin,InductiveEstimator</div><div id='m_file'> M File Name: Semi_sklearn/Model/Classifier/Co_training.py</div><div id='n_file'> N File Name: Semi_sklearn/Model/Classifier/Co_training.py</div><div id='m_start'> M Start Line: 33</div><div id='m_end'> M End Line: 94</div><div id='n_start'> N Start Line: 34</div><div id='n_end'> N End Line: 101</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            s.append(t.rstrip().lstrip().lower())
        s.append(spl_tokens[NEWLINE].lower())
    if s[-1] != spl_tokens[NEWLINE]:
        <a id="change">s.pop()</a>
    if s[-1] != &quot&quot:
        s.append(&quot&quot)
    return s
</code></pre><h3>After Change</h3><pre><code class='java'>
    if is_docstr:
        n = len(lines) if len(lines) &lt;= 2 else 2  &#47&#47 we do not consider more than 4 lines of docstring
    else:
        n<a id="change"> = </a><a id="change">len(</a>lines<a id="change">)</a>
    for line in lines[:n]:
        toks = line.lstrip().rstrip().split(" ")
        if toks[0].startswith(&quot&quot):
            toks = toks[1:]</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/autosoft-dev/code-bert/commit/7bbc5dee490adc7db3a73a334c9cf060c032dbf9#diff-689269b4e97ad8c5354f1a101dcf53f546b7c62e81d1604d1990db8fa66133b3L22' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 101873158</div><div id='project'> Project Name: autosoft-dev/code-bert</div><div id='commit'> Commit Name: 7bbc5dee490adc7db3a73a334c9cf060c032dbf9</div><div id='time'> Time: 2020-03-03</div><div id='author'> Author: shubhadeeproychowdhury@gmail.com</div><div id='file'> File Name: code_bert/core/data_reader.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: process_string_tokes(2)</div><div id='n_method'> N Method Name: process_string_tokes(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: code_bert/core/data_reader.py</div><div id='n_file'> N File Name: code_bert/core/data_reader.py</div><div id='m_start'> M Start Line: 22</div><div id='m_end'> M End Line: 37</div><div id='n_start'> N Start Line: 22</div><div id='n_end'> N End Line: 29</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 batch graphs will be shipped to device in forward part of model
        labels = labels.to(args.device)
        graphs = graphs.to(args.device)
        feat = <a id="change">graphs.ndata.pop(</a>&quotattr&quot<a id="change">)</a>
        outputs = net(graphs, feat)

        loss = criterion(outputs, labels)
        running_loss += loss.item()</code></pre><h3>After Change</h3><pre><code class='java'>
    bar = tqdm(range(total_iters), unit=&quotbatch&quot, position=2, file=sys.stdout)

    for pos, data in zip(bar, trainloader):
        data = [data[i].to(args.device) for i in range(<a id="change">len(</a>data<a id="change">)</a>)]
        _<a id="change">, labels = </a>data
        &#47&#47 batch graphs will be shipped to device in forward part of model
        &#47&#47labels = labels.to(args.device)
        &#47&#47graphs = graphs.to(args.device)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/thumnlab/autogl/commit/a663908ada829942f679c2971aeb7d329c986f47#diff-afdf7175eebd7fadae06c0865441d2937c5eef487437b60a0424682dcee1c8dbL30' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 101873172</div><div id='project'> Project Name: thumnlab/autogl</div><div id='commit'> Commit Name: a663908ada829942f679c2971aeb7d329c986f47</div><div id='time'> Time: 2021-10-18</div><div id='author'> Author: changheng95@126.com</div><div id='file'> File Name: test/model_glf/gclf_dgl_gin.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(6)</div><div id='n_method'> N Method Name: train(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: test/model_glf/gclf_dgl_gin.py</div><div id='n_file'> N File Name: test/model_glf/gclf_dgl_gin.py</div><div id='m_start'> M Start Line: 40</div><div id='m_end'> M End Line: 43</div><div id='n_start'> N Start Line: 38</div><div id='n_end'> N End Line: 46</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 batch graphs will be shipped to device in forward part of model
        labels = labels.to(args.device)
        graphs = graphs.to(args.device)
        feat = <a id="change">graphs.ndata.pop(</a>&quotattr&quot<a id="change">)</a>
        outputs = net(graphs, feat)

        loss = criterion(outputs, labels)
        running_loss += loss.item()</code></pre><h3>After Change</h3><pre><code class='java'>
    bar = tqdm(range(total_iters), unit=&quotbatch&quot, position=2, file=sys.stdout)

    for pos, data in zip(bar, trainloader):
        data = [data[i].to(args.device) for i in range(<a id="change">len(</a>data<a id="change">)</a>)]
        _<a id="change">, labels = </a>data
        &#47&#47 batch graphs will be shipped to device in forward part of model
        &#47&#47labels = labels.to(args.device)
        &#47&#47graphs = graphs.to(args.device)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/thumnlab/autogl/commit/a663908ada829942f679c2971aeb7d329c986f47#diff-2420b554243acca57045facc1117a4725196b2c2ad2da5fe84db1391fed1d02cL30' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 101873163</div><div id='project'> Project Name: thumnlab/autogl</div><div id='commit'> Commit Name: a663908ada829942f679c2971aeb7d329c986f47</div><div id='time'> Time: 2021-10-18</div><div id='author'> Author: changheng95@126.com</div><div id='file'> File Name: test/model_glf/gclf_dgl_topk.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(6)</div><div id='n_method'> N Method Name: train(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: test/model_glf/gclf_dgl_topk.py</div><div id='n_file'> N File Name: test/model_glf/gclf_dgl_topk.py</div><div id='m_start'> M Start Line: 40</div><div id='m_end'> M End Line: 43</div><div id='n_start'> N Start Line: 38</div><div id='n_end'> N End Line: 46</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        print(&quotprepare dataset&quot)
        target = self.target_class
        source = list(range(self.dataset.num_classes))
        <a id="change">source.pop(</a>target<a id="change">)</a>
        self.target_loader = self.dataset.get_dataloader(&quottrain&quot, full=True, classes=target,
                                                         batch_size=self.poison_num, shuffle=True, num_workers=0)
        self.source_loader = self.dataset.get_dataloader(&quottrain&quot, full=True, classes=source,
                                                         batch_size=self.poison_num, shuffle=True, num_workers=0)</code></pre><h3>After Change</h3><pre><code class='java'>
        source_feats = self.model.get_layer(source_imgs, layer_output=self.preprocess_layer).detach()

        target_imgs, _ = self.model.get_data(next(iter(self.target_loader)))
        target_imgs<a id="change"> = </a>target_imgs[:<a id="change">len(</a>source_imgs<a id="change">)</a>]
        &#47&#47 -----------------------------Poison Frog--------------------------------- &#47&#47

        def loss_func(poison_imgs):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ain-soph/trojanzoo/commit/ba7a05c0e1d8e0b546a7c0e7c168b1e57ccc0eba#diff-307145e6df05bb45b944d3a184fed6c8f5f4bed53fb2b1a381acee3a66c1bebdL83' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 101873165</div><div id='project'> Project Name: ain-soph/trojanzoo</div><div id='commit'> Commit Name: ba7a05c0e1d8e0b546a7c0e7c168b1e57ccc0eba</div><div id='time'> Time: 2020-09-23</div><div id='author'> Author: ain-soph@live.com</div><div id='file'> File Name: trojanzoo/attack/backdoor/hidden_trigger.py</div><div id='m_class'> M Class Name: Hidden_Trigger</div><div id='n_method'> N Class Name: Hidden_Trigger</div><div id='m_method'> M Method Name: generate_poisoned_data(2)</div><div id='n_method'> N Method Name: generate_poisoned_data(1)</div><div id='m_parent_class'> M Parent Class: BadNet</div><div id='n_parent_class'> N Parent Class: BadNet</div><div id='m_file'> M File Name: trojanzoo/attack/backdoor/hidden_trigger.py</div><div id='n_file'> N File Name: trojanzoo/attack/backdoor/hidden_trigger.py</div><div id='m_start'> M Start Line: 106</div><div id='m_end'> M End Line: 136</div><div id='n_start'> N Start Line: 92</div><div id='n_end'> N End Line: 124</div><BR>