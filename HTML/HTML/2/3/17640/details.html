<html><h3>Pattern ID :17640
</h3><img src='58260909.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    am = input.argmax(axis=axis)
    am = np.expand_dims(am, axis=axis) if axis is not None else np.array([am])
    ctx.save_for_backward(input.shape, am, axis)
    return <a id="change">np.take_along_axis(input, am, axis=axis).squeeze(axis=axis)</a>

  @staticmethod
  def backward(ctx, grad_output):
    shape, am, axis = ctx.saved_tensors</code></pre><h3>After Change</h3><pre><code class='java'>
class Max(Function):
  @staticmethod
  def forward(ctx, inp, axis=None):
    axis = [axis]<a id="change"> if type(axis) == int</a><a id="change"> else </a>axis
    ret = np.amax(inp, axis=None if axis is None else tuple(axis), keepdims=True) 
    ctx.save_for_backward(inp, axis, ret)
    if axis is not None:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/geohot/tinygrad/commit/e2f833f58fa165aabae3b587cb84733eadcbd490#diff-3069c8687d7a5f656b0ef0db6c30b5bd2b9f603931c68497b3ebf60aa742a166L119' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 58260909</div><div id='project'> Project Name: geohot/tinygrad</div><div id='commit'> Commit Name: e2f833f58fa165aabae3b587cb84733eadcbd490</div><div id='time'> Time: 2020-12-30</div><div id='author'> Author: 65973015+marcelbischoff@users.noreply.github.com</div><div id='file'> File Name: tinygrad/ops_cpu.py</div><div id='m_class'> M Class Name: Max</div><div id='n_method'> N Class Name: Max</div><div id='m_method'> M Method Name: forward(3)</div><div id='n_method'> N Method Name: forward(3)</div><div id='m_parent_class'> M Parent Class: Function</div><div id='n_parent_class'> N Parent Class: Function</div><div id='m_file'> M File Name: tinygrad/ops_cpu.py</div><div id='n_file'> N File Name: tinygrad/ops_cpu.py</div><div id='m_start'> M Start Line: 119</div><div id='m_end'> M End Line: 122</div><div id='n_start'> N Start Line: 119</div><div id='n_end'> N End Line: 124</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        Process Emitters
        frames, target, weight, tar_emitter = self._process_sample(frames, tar_emitter, bg_frame)

        return self._return_sample(frames, target.squeeze(0), <a id="change">weight.squeeze(</a>0<a id="change">)</a>, tar_emitter)


class SMLMLiveDataset(SMLMDataset):</code></pre><h3>After Change</h3><pre><code class='java'>
        Pad index, get frames and emitters.
        ix = self._pad_index(ix)

        tar_emitter = self._emitter[ix]<a id="change"> if self._emitter is not None</a><a id="change"> else </a>None
        frames = self._get_frames(self._frames, ix)
        bg_frame = self._bg_frames[ix] if self._bg_frames is not None else None
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/turagalab/decode/commit/2852e463f5f59d1baa6b119500929967a9a2d5f3#diff-ada64902b98e0ef5b5ac72d023e6b46f4921556f320a298897923a817b5eb9d2L132' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 58260910</div><div id='project'> Project Name: turagalab/decode</div><div id='commit'> Commit Name: 2852e463f5f59d1baa6b119500929967a9a2d5f3</div><div id='time'> Time: 2020-05-26</div><div id='author'> Author: gitdev@LRM.PHOTO</div><div id='file'> File Name: deepsmlm/neuralfitter/dataset.py</div><div id='m_class'> M Class Name: SMLMStaticDataset</div><div id='n_method'> N Class Name: SMLMStaticDataset</div><div id='m_method'> M Method Name: __getitem__(2)</div><div id='n_method'> N Method Name: __getitem__(2)</div><div id='m_parent_class'> M Parent Class: SMLMDataset</div><div id='n_parent_class'> N Parent Class: SMLMDataset</div><div id='m_file'> M File Name: deepsmlm/neuralfitter/dataset.py</div><div id='n_file'> N File Name: deepsmlm/neuralfitter/dataset.py</div><div id='m_start'> M Start Line: 147</div><div id='m_end'> M End Line: 155</div><div id='n_start'> N Start Line: 148</div><div id='n_end'> N End Line: 156</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                    logp_targets = torch.cat(
                        (logp_targets, log_probs.view(-1)[0:1])
                    )
                    positions = torch.cat((positions + 1, <a id="change">blank.squeeze(</a>1<a id="change">)</a>))

                    &#47&#47 Extend hyp by  selection
                    for j in range(logp_targets.size(0)):</code></pre><h3>After Change</h3><pre><code class='java'>
                        log_probs.view(-1), k=self.beam_size, dim=-1
                    )
                    best_logp = (
                        logp_targets[0]<a id="change">
                        if positions[0] != blank</a><a id="change">
                        else </a>logp_targets[1]
                    )

                    &#47&#47 Extend hyp by  selection</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/speechbrain/speechbrain/commit/17a7851375fa654da16a5828035f90f8eae334d6#diff-30ec10b39e03a0e388bd2214e87ed0a72e7187210492b3bfa13bbe5279d8d6c8L226' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 58260912</div><div id='project'> Project Name: speechbrain/speechbrain</div><div id='commit'> Commit Name: 17a7851375fa654da16a5828035f90f8eae334d6</div><div id='time'> Time: 2020-11-15</div><div id='author'> Author: ff936tw@gmail.com</div><div id='file'> File Name: speechbrain/decoders/transducer.py</div><div id='m_class'> M Class Name: TransducerBeamSearcher</div><div id='n_method'> N Class Name: TransducerBeamSearcher</div><div id='m_method'> M Method Name: transducer_beam_search_decode(2)</div><div id='n_method'> N Method Name: transducer_beam_search_decode(2)</div><div id='m_parent_class'> M Parent Class: torch.nn.Module</div><div id='n_parent_class'> N Parent Class: torch.nn.Module</div><div id='m_file'> M File Name: speechbrain/decoders/transducer.py</div><div id='n_file'> N File Name: speechbrain/decoders/transducer.py</div><div id='m_start'> M Start Line: 260</div><div id='m_end'> M End Line: 339</div><div id='n_start'> N Start Line: 260</div><div id='n_end'> N End Line: 337</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if self.output_layer.bias is not None:
            new_bias = torch.mean(self.output_layer.bias).unsqueeze(1).T
            if n_classes_to_add &gt; 1:
                new_bias = <a id="change">new_bias.unsqueeze(1).T.repeat(1, n_classes_to_add, 1).squeeze()</a>
            self.output_layer.bias = nn.parameter.Parameter(
                torch.cat([self.output_layer.bias, new_bias], axis=0)
            )
        self.output_layer.out_features += n_classes_to_add</code></pre><h3>After Change</h3><pre><code class='java'>
            new_bias = torch.empty(n_classes_to_add)
            fan_in, _ = nn.init._calculate_fan_in_and_fan_out(
                self.output_layer.weight)
            bound = 1 / math.sqrt(fan_in)<a id="change"> if fan_in &gt; 0</a><a id="change"> else </a>0
            nn.init.uniform_(new_bias, -bound, bound)
            self.output_layer.bias = nn.parameter.Parameter(
                torch.cat([self.output_layer.bias, new_bias], axis=0)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/online-ml/river-torch/commit/569c438c27a92f58d761de6d54cc27c9cb1ec88f#diff-b7b3dc93db412db0f1b244453a944c127c40d624ca0330c220405196365d357aL291' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 58260913</div><div id='project'> Project Name: online-ml/river-torch</div><div id='commit'> Commit Name: 569c438c27a92f58d761de6d54cc27c9cb1ec88f</div><div id='time'> Time: 2022-09-28</div><div id='author'> Author: cedric.kulbahc@googlemail.com</div><div id='file'> File Name: river_torch/classification/classifier.py</div><div id='m_class'> M Class Name: Classifier</div><div id='n_method'> N Class Name: Classifier</div><div id='m_method'> M Method Name: _add_output_features(2)</div><div id='n_method'> N Method Name: _add_output_features(2)</div><div id='m_parent_class'> M Parent Class: DeepEstimator,base.Classifier</div><div id='n_parent_class'> N Parent Class: DeepEstimator,base.Classifier</div><div id='m_file'> M File Name: river_torch/classification/classifier.py</div><div id='n_file'> N File Name: river_torch/classification/classifier.py</div><div id='m_start'> M Start Line: 308</div><div id='m_end'> M End Line: 311</div><div id='n_start'> N Start Line: 303</div><div id='n_end'> N End Line: 312</div><BR>