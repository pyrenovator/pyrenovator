<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        x.requires_grad_()
        output = self.prunner.forward(_input)
        loss = self.model.criterion(output, _label)
        <a id="change">loss.backward()</a>
        x.requires_grad = False

        return self.get_prunning_plan()
</code></pre><h3>After Change</h3><pre><code class='java'>
        _input, _label = self.model.get_data(next(self.dataset.loader[&quottrain&quot]))
        x = _input.detach()
        x.requires_grad_()
        output<a id="change"> = </a>self.helper.forward(_input)
        loss = self.model.criterion(output, _label)
        <a id="change">torch.autograd.grad(</a>loss, x<a id="change">)</a>    &#47&#47 not using backward() to avoid gradient saving in tensor
        x.requires_grad_(False)
        prune_num = int(self.prune_ratio * self.filter_num)
</code></pre>