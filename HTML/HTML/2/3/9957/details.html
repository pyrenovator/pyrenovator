<html><h3>Pattern ID :9957
</h3><img src='35601023.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        task["record"] = {
            "class": "SignalRecord",
            "module_path": "qlib.workflow.record_temp",
            "kwargs": <a id="change">{</a>"dataset": "&lt;DATASET&gt;", "model": "&lt;MODEL&gt;"<a id="change">}</a>,
        }

        exp_name = "online_srv_test"</code></pre><h3>After Change</h3><pre><code class='java'>
        good_pred = rec.load_object("pred.pkl")

        mod_range = slice(latest_date - pd.Timedelta(days=20), latest_date - pd.Timedelta(days=10))
        mod_range2 = <a id="change">slice(</a>latest_date - pd.Timedelta(days=9), latest_date - pd.Timedelta(days=2)<a id="change">)</a>
        mod_pred = good_pred.copy()

        mod_pred.loc[mod_range] = -1
        <a id="change">mod_pred.loc[mod_range2]</a> = -2

        rec.save_objects(**{"pred.pkl": mod_pred})
        online_tool.update_online_pred(</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/45ebb1d0e0dc3b1a8f8f98953157b8320c78988f#diff-47254ab35e837c25de00c45cc83e8fa20ff3e6c731a2fc8fce7b5b58c928185dL24' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 35601023</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: 45ebb1d0e0dc3b1a8f8f98953157b8320c78988f</div><div id='time'> Time: 2021-11-22</div><div id='author'> Author: you-n-g@users.noreply.github.com</div><div id='file'> File Name: tests/rolling_tests/test_update_pred.py</div><div id='m_class'> M Class Name: TestRolling</div><div id='n_method'> N Class Name: TestRolling</div><div id='m_method'> M Method Name: test_update_pred(1)</div><div id='n_method'> N Method Name: test_update_pred(1)</div><div id='m_parent_class'> M Parent Class: TestAutoData</div><div id='n_parent_class'> N Parent Class: TestAutoData</div><div id='m_file'> M File Name: tests/rolling_tests/test_update_pred.py</div><div id='n_file'> N File Name: tests/rolling_tests/test_update_pred.py</div><div id='m_start'> M Start Line: 24</div><div id='m_end'> M End Line: 28</div><div id='n_start'> N Start Line: 24</div><div id='n_end'> N End Line: 75</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    if not keepdim and indices.ndim&gt;1:
        indices = indices.squeeze(dim)
        values = values.squeeze(dim)
    return <a id="change">[</a>values,indices<a id="change"></a>]

jt.Var.kthvalue = kthvalue
</code></pre><h3>After Change</h3><pre><code class='java'>
    if dim&lt;0:
        dim+=input.ndim
    index,values = jt.argsort(input,dim=dim)
    dims = (slice(None),)*(dim-1)+(<a id="change">slice(</a>k-1,k<a id="change">)</a>,)
    indices = index[dims]
    values = <a id="change">values[dims]</a>
    if not keepdim and indices.ndim&gt;1:
        indices = indices.squeeze(dim)
        values = values.squeeze(dim)
    return values,indices</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jittor/jittor/commit/8e010e8f612c85bb156af4f0ebeee52e3a02a219#diff-9f0bfce0c0e21a07cd9342d9fcbe7511308c81f70bb9a6b347d23cb72ab0f4a8L435' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 35601037</div><div id='project'> Project Name: jittor/jittor</div><div id='commit'> Commit Name: 8e010e8f612c85bb156af4f0ebeee52e3a02a219</div><div id='time'> Time: 2020-09-09</div><div id='author'> Author: dllgdxlxl@gmail.com</div><div id='file'> File Name: python/jittor/misc.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: kthvalue(4)</div><div id='n_method'> N Method Name: kthvalue(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: python/jittor/misc.py</div><div id='n_file'> N File Name: python/jittor/misc.py</div><div id='m_start'> M Start Line: 437</div><div id='m_end'> M End Line: 452</div><div id='n_start'> N Start Line: 422</div><div id='n_end'> N End Line: 432</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    values = values[:k]
    indices = indices.transpose(transpose_dims)
    values = values.transpose(transpose_dims)
    return <a id="change">[</a>values,indices<a id="change"></a>]

jt.Var.topk = topk
</code></pre><h3>After Change</h3><pre><code class='java'>
        dim+=input.ndim
    
    index,values = jt.argsort(input,dim=dim,descending=largest)
    dims = (slice(None),)*(dim-1)+(<a id="change">slice(</a>0,k<a id="change">)</a>,)
    indices = index[dims]
    values = <a id="change">values[dims]</a>
    return values,indices

jt.Var.topk = topk
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jittor/jittor/commit/8e010e8f612c85bb156af4f0ebeee52e3a02a219#diff-9f0bfce0c0e21a07cd9342d9fcbe7511308c81f70bb9a6b347d23cb72ab0f4a8L416' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 35601036</div><div id='project'> Project Name: jittor/jittor</div><div id='commit'> Commit Name: 8e010e8f612c85bb156af4f0ebeee52e3a02a219</div><div id='time'> Time: 2020-09-09</div><div id='author'> Author: dllgdxlxl@gmail.com</div><div id='file'> File Name: python/jittor/misc.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: topk(5)</div><div id='n_method'> N Method Name: topk(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: python/jittor/misc.py</div><div id='n_file'> N File Name: python/jittor/misc.py</div><div id='m_start'> M Start Line: 418</div><div id='m_end'> M End Line: 431</div><div id='n_start'> N Start Line: 408</div><div id='n_end'> N End Line: 416</div><BR>