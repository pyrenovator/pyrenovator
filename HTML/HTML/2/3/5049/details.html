<html><h3>Pattern ID :5049
</h3><img src='17759880.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        index = len(self.arch_managers)
        recipe_path = os.path.join(
            output_dir, RECIPE_TEMPLATE.format(f"_{index:02d}"<a id="change"> if index &gt; 0</a><a id="change"> else </a>"")
        )
        checkpoint_path = os.path.join(self.args.output_dir, RECIPE_NAME)
</code></pre><h3>After Change</h3><pre><code class='java'>
                base_recipe=str(self.arch_manager),
                additional_recipe=str(self.manager),
            )
            <a id="change">composed_manager.save(</a>recipe_path<a id="change">)</a>
        else:

            self.manager.save(recipe_path)
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/neuralmagic/sparseml/commit/23bea1713f57363caca92b76cb08f0ea2731b1e6#diff-60bdb678df317727d1f4d56c35e0dcbd033dffc1f72c05f753cbb66399da8f36L373' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 17759880</div><div id='project'> Project Name: neuralmagic/sparseml</div><div id='commit'> Commit Name: 23bea1713f57363caca92b76cb08f0ea2731b1e6</div><div id='time'> Time: 2022-04-08</div><div id='author'> Author: 97082108+dbogunowicz@users.noreply.github.com</div><div id='file'> File Name: src/sparseml/transformers/sparsification/trainer.py</div><div id='m_class'> M Class Name: RecipeManagerTrainerInterface</div><div id='n_method'> N Class Name: RecipeManagerTrainerInterface</div><div id='m_method'> M Method Name: save_model(3)</div><div id='n_method'> N Method Name: save_model(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/sparseml/transformers/sparsification/trainer.py</div><div id='n_file'> N File Name: src/sparseml/transformers/sparsification/trainer.py</div><div id='m_start'> M Start Line: 383</div><div id='m_end'> M End Line: 393</div><div id='n_start'> N Start Line: 373</div><div id='n_end'> N End Line: 384</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                    &#47&#47 Process HR image
                    image = raw_image.resize((int(raw_image.width * scale_ratio), int(raw_image.height * scale_ratio)), Image.BICUBIC)
                    image = image.rotate(rotate_angle, expand=True)
                    image = image.transpose(Image.FLIP_LEFT_RIGHT)<a id="change"> if flip_ratio &gt; 0.5</a><a id="change"> else </a>image
                    image.save(f"{raw_image_dir}/{file_name.split(&quot.&quot)[-2]}_{index:04d}.{file_name.split(&quot.&quot)[-1]}")
                    index += 1
    print("Data augment successful.")</code></pre><h3>After Change</h3><pre><code class='java'>
                crop_hr_image = hr_image.crop([pos_x, pos_y, pos_x + args.image_size, pos_y + args.image_size])
                &#47&#47 Save all images
                crop_lr_image.save(f"{new_inputs_dir}/{file_name.split(&quot.&quot)[-2]}_{pos_x}_{pos_y}.{file_name.split(&quot.&quot)[-1]}")
                <a id="change">crop_hr_image.save(</a>f"{new_target_dir}/{file_name.split(&quot.&quot)[-2]}_{pos_x}_{pos_y}.{file_name.split(&quot.&quot)[-1]}"<a id="change">)</a>
    print("Data split successful.")

    shutil.rmtree(raw_inputs_image_dir)
    shutil.rmtree(raw_target_image_dir)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/lornatang/vdsr-pytorch/commit/4e24f1c9892bfa6178aed97d12926379f3c40492#diff-0b98e85a7205055fa6d3ef3a8c2e37a80de3ee37091286945a09dacc88f5ed7aL22' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 17759881</div><div id='project'> Project Name: lornatang/vdsr-pytorch</div><div id='commit'> Commit Name: 4e24f1c9892bfa6178aed97d12926379f3c40492</div><div id='time'> Time: 2021-11-22</div><div id='author'> Author: liuchangyu1111@gmail.com</div><div id='file'> File Name: scripts/prepare_dataset.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(1)</div><div id='n_method'> N Method Name: main(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: scripts/prepare_dataset.py</div><div id='n_file'> N File Name: scripts/prepare_dataset.py</div><div id='m_start'> M Start Line: 39</div><div id='m_end'> M End Line: 59</div><div id='n_start'> N Start Line: 24</div><div id='n_end'> N End Line: 76</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        path = Path(cfg.path) / i
        split = path / "lang_annotations/auto_lang_ann.npy"
        data = np.load(split, allow_pickle=True).reshape(-1)[0]
        task_ann = cfg.val_instructions<a id="change"> if "val" in i</a><a id="change"> else </a>cfg.train_instructions
        if cfg.reannotate and "train" in i:
            print("Re-annotating sequences...")
            data["language"]["ann"] = [</code></pre><h3>After Change</h3><pre><code class='java'>
            language_embedding = model(list(ann))
            embeddings[task]["emb"] = language_embedding.cpu().numpy()
            embeddings[task]["ann"] = ann
        <a id="change">np.save(</a>save_path / "embeddings", embeddings<a id="change">)</a>  &#47&#47 type:ignore
        print("Done saving val language embeddings for Rollouts !")

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/mees/calvin/commit/e5b712f12f5a2c5bf461a633771f1f7be42666a2#diff-a8af52d2b408a2118467e90ca6cc196f882296e11f9a1a15d03163a462e8aacbL19' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 17759877</div><div id='project'> Project Name: mees/calvin</div><div id='commit'> Commit Name: e5b712f12f5a2c5bf461a633771f1f7be42666a2</div><div id='time'> Time: 2022-04-14</div><div id='author'> Author: oier.mees@gmail.com</div><div id='file'> File Name: calvin_models/calvin_agent/utils/relabel_with_new_lang_model.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(1)</div><div id='n_method'> N Method Name: main(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: calvin_models/calvin_agent/utils/relabel_with_new_lang_model.py</div><div id='n_file'> N File Name: calvin_models/calvin_agent/utils/relabel_with_new_lang_model.py</div><div id='m_start'> M Start Line: 21</div><div id='m_end'> M End Line: 41</div><div id='n_start'> N Start Line: 23</div><div id='n_end'> N End Line: 55</div><BR>