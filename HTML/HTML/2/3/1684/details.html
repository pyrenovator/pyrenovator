<html><h3>Pattern ID :1684
</h3><img src='7974905.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            feature = df[event]
            lw = configs.lower_window
            uw = configs.upper_window
            <a id="change">all_events_list.append(</a>event<a id="change">)</a>
            &#47&#47 create lower and upper window features
            for offset in range(lw, uw + 1):
                key = utils.create_event_names_for_offsets(event, offset)
                offset_feature = feature.shift(periods=offset, fill_value=0)</code></pre><h3>After Change</h3><pre><code class='java'>
    

    additive_events = pd.DataFrame()
    multiplicative_events = <a id="change">pd.DataFrame()</a>

    &#47&#47 create all user specified events
    if events_config is not None:
        for event, configs in events_config.items():
            if event not in df.columns:
                df[event] = 0.
            feature = df[event]
            lw = configs.lower_window
            uw = configs.upper_window
            mode = configs["mode"]
            &#47&#47 create lower and upper window features
            for offset in range(lw, uw + 1):
                key = utils.create_event_names_for_offsets(event, offset)
                offset_feature = feature.shift(periods=offset, fill_value=0)
                if mode == "additive":
                    additive_events[key] = offset_feature
                else:
                    multiplicative_events[key] = offset_feature

    &#47&#47 create all country specific holidays
    if country_holidays_config is not None:
        lw = country_holidays_config["lower_window"]
        uw = country_holidays_config["upper_window"]
        mode = country_holidays_config["mode"]
        year_list = list({x.year for x in df.ds})
        country_holidays_dict = make_country_specific_holidays_df(year_list, country_holidays_config["country"])
        for holiday in country_holidays_config["holiday_names"]:
            feature = pd.Series([0.] * df.shape[0])
            if holiday in country_holidays_dict.keys():
                dates = country_holidays_dict[holiday]
                feature[df.ds.isin(dates)] = 1.
            for offset in range(lw, uw + 1):
                key = utils.create_event_names_for_offsets(holiday, offset)
                offset_feature = feature.shift(periods=offset, fill_value=0)
                if mode == "additive":
                    additive_events[key] = offset_feature
                else:
                    multiplicative_events[key] = offset_feature

    &#47&#47 Make sure column order is consistent
    additive_events = additive_events[sorted(additive_events.columns.tolist())]
    multiplicative_events<a id="change"> = </a>multiplicative_events[sorted(multiplicative_events.columns.tolist())]

    &#47&#47 convert to numpy array
    additive_events = additive_events.values</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/ourownstory/neural_prophet/commit/3e3146ddae5b180c2c2f6bd90bbdb650e9d8d6af#diff-19e8b8bb76c45be0b19f9651c6c08d9e4641f5f993cdbaa581338cc45aff7516L286' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 7974905</div><div id='project'> Project Name: ourownstory/neural_prophet</div><div id='commit'> Commit Name: 3e3146ddae5b180c2c2f6bd90bbdb650e9d8d6af</div><div id='time'> Time: 2020-08-19</div><div id='author'> Author: hansika.hewamalage@monash.edu</div><div id='file'> File Name: neuralprophet/time_dataset.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: make_events_features(3)</div><div id='n_method'> N Method Name: make_events_features(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: neuralprophet/time_dataset.py</div><div id='n_file'> N File Name: neuralprophet/time_dataset.py</div><div id='m_start'> M Start Line: 286</div><div id='m_end'> M End Line: 332</div><div id='n_start'> N Start Line: 301</div><div id='n_end'> N End Line: 349</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                    row[col_name] = context[j]
                for j, col_name in enumerate(self.data_columns):
                    row[col_name] = data[j][i]
                <a id="change">rows.append(</a>row<a id="change">)</a>

        columns = self.entity_columns + self.context_columns + self.data_columns
        return pd.DataFrame(rows, columns=columns)
</code></pre><h3>After Change</h3><pre><code class='java'>
        
        columns = self.entity_columns + self.context_columns + self.data_columns

        groups<a id="change"> = </a><a id="change">pd.DataFrame()</a>
        for entity_id in range(num_entities):
            &#47&#47 Sample data, given resampled context
            context = self._context.sample(1).iloc[0].tolist()
            sequence = self.sample_sequence(context)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/sdv-dev/deepecho/commit/1e8ddefc8bf9828847c2deb06084e962a8870c45#diff-b77bd867af44f00d2a4f6508af37f7632252dce8b86c615f93813c5b0cae0f48L153' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 7974907</div><div id='project'> Project Name: sdv-dev/deepecho</div><div id='commit'> Commit Name: 1e8ddefc8bf9828847c2deb06084e962a8870c45</div><div id='time'> Time: 2020-07-16</div><div id='author'> Author: carles@pythiac.com</div><div id='file'> File Name: deepecho/base.py</div><div id='m_class'> M Class Name: DeepEcho</div><div id='n_method'> N Class Name: DeepEcho</div><div id='m_method'> M Method Name: sample(2)</div><div id='n_method'> N Method Name: sample(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: deepecho/base.py</div><div id='n_file'> N File Name: deepecho/base.py</div><div id='m_start'> M Start Line: 168</div><div id='m_end'> M End Line: 187</div><div id='n_start'> N Start Line: 168</div><div id='n_end'> N End Line: 183</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        pred = result.text
        target, pred = normalize(target), normalize(pred)
        errors = editdistance.eval(pred, target)
        <a id="change">wers.append(</a>errors / len(target)<a id="change">)</a>
        n_edits += errors
        n += len(target)
        print("Cur WER: {}".format(wers[-1]))
    print("WER:", np.mean(wers))</code></pre><h3>After Change</h3><pre><code class='java'>
    df = pd.DataFrame(scores)
    print("WER:", n_edits / n)

    df<a id="change"> = </a><a id="change">pd.DataFrame(</a>scores<a id="change">)</a>
    print("Mean WAcc for the files is ", np.mean(df["wacc"]))

    if args.score_file:
        df.to_csv(args.score_file)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/rikorose/deepfilternet/commit/15488ca668ecdb2f59a980d2ac2c998efce659a0#diff-38a7469f302d64f367329b4254b3e1312998df85737233633dd90df97e0ca0bbL27' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 7974902</div><div id='project'> Project Name: rikorose/deepfilternet</div><div id='commit'> Commit Name: 15488ca668ecdb2f59a980d2ac2c998efce659a0</div><div id='time'> Time: 2022-12-20</div><div id='author'> Author: h.schroeter@pm.me</div><div id='file'> File Name: scripts/WAcc_whisper.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(1)</div><div id='n_method'> N Method Name: main(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: scripts/WAcc_whisper.py</div><div id='n_file'> N File Name: scripts/WAcc_whisper.py</div><div id='m_start'> M Start Line: 28</div><div id='m_end'> M End Line: 53</div><div id='n_start'> N Start Line: 29</div><div id='n_end'> N End Line: 60</div><BR>