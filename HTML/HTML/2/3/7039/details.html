<html><h3>Pattern ID :7039
</h3><img src='23434357.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                    edge_attr = self.explain_edges_with_loop(x, walks, ex_label)
                    mask = edge_attr
                    mask = self.control_sparsity(mask, kwargs.get(&quotsparsity&quot))
                    mask = <a id="change">mask.sigmoid()</a>
                    masks.append(mask.detach())

                related_preds = self.eval_related_pred(x, edge_index, masks, **kwargs)</code></pre><h3>After Change</h3><pre><code class='java'>
            self.subset, _, _, self.hard_edge_mask = subgraph(
                node_idx, self.__num_hops__, edge_index_with_loop, relabel_nodes=True,
                num_nodes=None, flow=self.__flow__())
            self.new_node_idx = <a id="change">torch.where(self.subset == node_idx</a><a id="change">)</a>[0]

            &#47&#47 walk indices list mask
            edge2node_idx = edge_index_with_loop[1] == node_idx</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/divelab/dig/commit/d2838464a04282f7b1b6e3a98cdec42f3a3a29c7#diff-5d068dcea6950e5d3838e17dbd3ef99d21b35907914dd017e0f9efc391aed595L67' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 23434357</div><div id='project'> Project Name: divelab/dig</div><div id='commit'> Commit Name: d2838464a04282f7b1b6e3a98cdec42f3a3a29c7</div><div id='time'> Time: 2022-05-25</div><div id='author'> Author: haiyang@tamu.edu</div><div id='file'> File Name: dig/xgraph/method/gnn_lrp.py</div><div id='m_class'> M Class Name: GNN_LRP</div><div id='n_method'> N Class Name: GNN_LRP</div><div id='m_method'> M Method Name: forward(3)</div><div id='n_method'> N Method Name: forward(3)</div><div id='m_parent_class'> M Parent Class: WalkBase</div><div id='n_parent_class'> N Parent Class: WalkBase</div><div id='m_file'> M File Name: dig/xgraph/method/gnn_lrp.py</div><div id='n_file'> N File Name: dig/xgraph/method/gnn_lrp.py</div><div id='m_start'> M Start Line: 68</div><div id='m_end'> M End Line: 205</div><div id='n_start'> N Start Line: 67</div><div id='n_end'> N End Line: 211</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

def activate_grad(inp: jnp.ndarray) -&gt; jnp.ndarray:
    gate = lax.tanh(softplus(inp))
    sigmoid = <a id="change">jax.nn.sigmoid(</a>inp<a id="change">)</a>
    return (1 - sigmoid) * gate + sigmoid * (inp + gate - gate ** 2 * inp)


def activate(ctx: Context, inp: jnp.ndarray) -&gt; jnp.ndarray:</code></pre><h3>After Change</h3><pre><code class='java'>


def activate_grad(inp: jnp.ndarray) -&gt; jnp.ndarray:
    return <a id="change">jnp.where(inp &lt; 0</a>, 0.01, 1<a id="change">)</a>


def activate(ctx: Context, inp: jnp.ndarray) -&gt; jnp.ndarray:
    if ctx.is_initializing:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/homebrewnlp/homebrewnlp-jax/commit/3b85d5a95e15aae8898f2ce9fd9be106047444cd#diff-e89be554227a05a2f8aebcca13855faaebd8b3b491d2d149b7108e9873c004c3L15' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 23434356</div><div id='project'> Project Name: homebrewnlp/homebrewnlp-jax</div><div id='commit'> Commit Name: 3b85d5a95e15aae8898f2ce9fd9be106047444cd</div><div id='time'> Time: 2022-08-24</div><div id='author'> Author: 39779310+ClashLuke@users.noreply.github.com</div><div id='file'> File Name: src/model/activate.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: activate_grad(1)</div><div id='n_method'> N Method Name: activate_grad(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/model/activate.py</div><div id='n_file'> N File Name: src/model/activate.py</div><div id='m_start'> M Start Line: 16</div><div id='m_end'> M End Line: 18</div><div id='n_start'> N Start Line: 12</div><div id='n_end'> N End Line: 12</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                    edge_attr = self.explain_edges_with_loop(x, walks, ex_label)
                    mask = edge_attr
                    mask = self.control_sparsity(mask, kwargs.get(&quotsparsity&quot))
                    mask = <a id="change">mask.sigmoid()</a>
                    masks.append(mask.detach())

                related_preds = self.eval_related_pred(x, edge_index, masks, **kwargs)</code></pre><h3>After Change</h3><pre><code class='java'>
            self.subset, _, _, self.hard_edge_mask = subgraph(
                node_idx, self.__num_hops__, self_loop_edge_index, relabel_nodes=True,
                num_nodes=None, flow=self.__flow__())
            self.new_node_idx = <a id="change">torch.where(self.subset == node_idx</a><a id="change">)</a>[0]

        if kwargs.get(&quotwalks&quot):
            walks = kwargs.pop(&quotwalks&quot)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/divelab/dig/commit/d2838464a04282f7b1b6e3a98cdec42f3a3a29c7#diff-6ec0ebef828e44dc923d4557573c3b1330dd11f1927c80b2fee107cd3f82b002L28' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 23434358</div><div id='project'> Project Name: divelab/dig</div><div id='commit'> Commit Name: d2838464a04282f7b1b6e3a98cdec42f3a3a29c7</div><div id='time'> Time: 2022-05-25</div><div id='author'> Author: haiyang@tamu.edu</div><div id='file'> File Name: dig/xgraph/method/gnn_gi.py</div><div id='m_class'> M Class Name: GNN_GI</div><div id='n_method'> N Class Name: GNN_GI</div><div id='m_method'> M Method Name: forward(3)</div><div id='n_method'> N Method Name: forward(3)</div><div id='m_parent_class'> M Parent Class: WalkBase</div><div id='n_parent_class'> N Parent Class: WalkBase</div><div id='m_file'> M File Name: dig/xgraph/method/gnn_gi.py</div><div id='n_file'> N File Name: dig/xgraph/method/gnn_gi.py</div><div id='m_start'> M Start Line: 69</div><div id='m_end'> M End Line: 121</div><div id='n_start'> N Start Line: 68</div><div id='n_end'> N End Line: 124</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    else:
        raise ValueError("reduction should in (&quotmean&quot, &quotsum&quot)")
    if with_logits:
        y_pred = <a id="change">torch.sigmoid(</a>y_pred<a id="change">)</a>
    y_pred = torch.clamp(y_pred, 1e-6, 1 - 1e-6)

    &#47&#47 前式与后式关于0.5对称(The former and the latter are symmetric about 0.5)
    &#47&#47 y_true 为-1. 即: 既不是正样本、也不是负样本。</code></pre><h3>After Change</h3><pre><code class='java'>

    &#47&#47 target == -1. It&quots neither a positive sample nor a negative sample.
    return torch.sum(
        <a id="change">torch.where(target == -1</a>, torch.tensor(0., device=target.device),
                    alpha * (1 - pred) ** gamma * target * torch.clamp_max(-torch.log(pred), 100) +
                    (1 - alpha) * pred ** gamma * (1 - target) * torch.clamp_max(-torch.log(1 - pred), 100)<a id="change">)</a>)


class FocalLoss(nn.Module):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jintao-huang/efficientdet_pytorch/commit/b140444fc9d402a1206ec4a8d6e0514b82003371#diff-4c422858fce93337b79d5c0e8f87c16b917c07d87986359aef07294446b24b38L9' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 23434355</div><div id='project'> Project Name: jintao-huang/efficientdet_pytorch</div><div id='commit'> Commit Name: b140444fc9d402a1206ec4a8d6e0514b82003371</div><div id='time'> Time: 2021-03-31</div><div id='author'> Author: hjt_study@qq.com</div><div id='file'> File Name: models/loss.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: weighted_binary_focal_loss(4)</div><div id='n_method'> N Method Name: weighted_binary_focal_loss(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: models/loss.py</div><div id='n_file'> N File Name: models/loss.py</div><div id='m_start'> M Start Line: 9</div><div id='m_end'> M End Line: 32</div><div id='n_start'> N Start Line: 21</div><div id='n_end'> N End Line: 24</div><BR>