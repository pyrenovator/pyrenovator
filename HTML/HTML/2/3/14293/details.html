<html><h3>Pattern ID :14293
</h3><img src='47364818.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    )

    print("[+] Start to train tokenizer")
    <a id="change">tokenizer.train(</a>glob(args.data_pattern), trainer<a id="change">)</a>

    print(f"[+] Save tokenizer to {args.tokenizer_path}")
    pretrained_tokenizer = PreTrainedTokenizerFast(
        tokenizer_object=tokenizer,</code></pre><h3>After Change</h3><pre><code class='java'>


def main(args: argparse.Namespace):
    <a id="change">with tempfile</a><a id="change">.TemporaryDirectory() as tmpdir:
        </a>model_prefix = os.path.join(tmpdir, "tokenizer")

        spm.SentencePieceTrainer.train(
            input=",".join(glob(args.data_pattern)),</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/cosmoquester/2021-dialogue-summary-competition/commit/a838bbb19625cb84a10539a0a136f7893f6634bc#diff-7de16900e6d13481f22caec2f92e43a27ff02da5e8803e8ff595f775987a83c0L42' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 47364818</div><div id='project'> Project Name: cosmoquester/2021-dialogue-summary-competition</div><div id='commit'> Commit Name: a838bbb19625cb84a10539a0a136f7893f6634bc</div><div id='time'> Time: 2021-12-26</div><div id='author'> Author: cosmoquester@gmail.com</div><div id='file'> File Name: run/train_tokenizer.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(1)</div><div id='n_method'> N Method Name: main(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: run/train_tokenizer.py</div><div id='n_file'> N File Name: run/train_tokenizer.py</div><div id='m_start'> M Start Line: 42</div><div id='m_end'> M End Line: 55</div><div id='n_start'> N Start Line: 52</div><div id='n_end'> N End Line: 88</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    optimizer = SGD(WRAPPED_MODEL.parameters(), lr=hyp[&quotlr0&quot], momentum=hyp[&quotmomentum&quot], nesterov=True)
    compute_loss = ComputeLoss(model, num_coords=num_coords)

    <a id="change">WRAPPED_MODEL.train()</a>
    ti = time.time()
    for i, (imgs, targets, paths, _) in enumerate(train_device_loader):
        optimizer.zero_grad()
        if i == 10:</code></pre><h3>After Change</h3><pre><code class='java'>
def _mp_fn(index, opt):
    device = xm.xla_device()

    <a id="change">with open</a><a id="change">(opt.hyp) as f:
        </a>hyp = yaml.safe_load(f)  &#47&#47 load hyps dict

    data_dict = check_dataset(opt.data)
    num_coords = data_dict[&quotnum_coords&quot] if &quotnum_coords&quot in data_dict.keys() else 0</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/wmcnally/kapao/commit/1018ab4edb5524113273902f7fee44b87dbacba9#diff-7e148fa2e81b94a05eade834e12405b45a90128bf9351ceefb153baa303b3dadL32' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 47364814</div><div id='project'> Project Name: wmcnally/kapao</div><div id='commit'> Commit Name: 1018ab4edb5524113273902f7fee44b87dbacba9</div><div id='time'> Time: 2021-10-13</div><div id='author'> Author: wmcnally@uwaterloo.ca</div><div id='file'> File Name: xla_tests/train_step.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _mp_fn(2)</div><div id='n_method'> N Method Name: _mp_fn(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: xla_tests/train_step.py</div><div id='n_file'> N File Name: xla_tests/train_step.py</div><div id='m_start'> M Start Line: 33</div><div id='m_end'> M End Line: 60</div><div id='n_start'> N Start Line: 33</div><div id='n_end'> N End Line: 68</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    prior_means[t + 1], _prior_std_dev = torch.chunk(transition_model.fc_state_prior(hidden), 2, dim=1)
    prior_std_devs[t + 1] = F.softplus(_prior_std_dev) + transition_model.min_std_dev
    prior_states[t + 1] = prior_means[t + 1] + prior_std_devs[t + 1] * torch.randn_like(prior_means[t + 1])     
  <a id="change">transition_model.train()</a>&#47&#47&#47&#47&#47&#47&#47&#47 reactivate the training mode of actor_model
  &#47&#47 Return new hidden states
  &#47&#47 imagined_traj = [beliefs, prior_states, prior_means, prior_std_devs]
  imagined_traj = [torch.stack(beliefs[1:], dim=0), torch.stack(prior_states[1:], dim=0), torch.stack(prior_means[1:], dim=0), torch.stack(prior_std_devs[1:], dim=0)]</code></pre><h3>After Change</h3><pre><code class='java'>
          torch.Size([49, 50, 200]) torch.Size([49, 50, 30]) torch.Size([49, 50, 30]) torch.Size([49, 50, 30])
  &quot&quot&quot
  flatten = lambda x: x.view([-1]+list(x.size()[2:]))
  <a id="change">with torch</a><a id="change">.no_grad(): &#47&#47 Delete the gradient from transition_model
    </a>prev_belief = flatten(prev_belief)
    prev_state = flatten(prev_state)
  
  &#47&#47 Create lists for hidden states (cannot use single tensor as buffer because autograd won&quott work with inplace writes)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/yusukeurakami/dreamer-pytorch/commit/e331a0af2cd9f5c3ed3cb218560d9556de47e5cc#diff-09d0cbaf891d623ac245ccf84485a687b554217349ca55557c60b33234b969aeL43' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 47364815</div><div id='project'> Project Name: yusukeurakami/dreamer-pytorch</div><div id='commit'> Commit Name: e331a0af2cd9f5c3ed3cb218560d9556de47e5cc</div><div id='time'> Time: 2020-06-22</div><div id='author'> Author: you@example.com</div><div id='file'> File Name: utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: imagine_ahead(5)</div><div id='n_method'> N Method Name: imagine_ahead(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: utils.py</div><div id='n_file'> N File Name: utils.py</div><div id='m_start'> M Start Line: 51</div><div id='m_end'> M End Line: 75</div><div id='n_start'> N Start Line: 53</div><div id='n_end'> N End Line: 58</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                 use_amp=cfg.use_amp,
                 ) as trainer:
        for _ in trainer.epoch_range(cfg.optim.epochs):
            <a id="change">trainer.train(</a>train_loader<a id="change">)</a>
            trainer.test(test_loader)
            trainer.scheduler.step()

        print(f"Max Test Accuracy={max(trainer.reporter.history(&quotaccuracy/test&quot)):.3f}")</code></pre><h3>After Change</h3><pre><code class='java'>
@chika.main(cfg_cls=Config, strict=True)
def main(cfg: Config):
    torch.cuda.set_device(cfg.gpu)
    <a id="change">with homura</a><a id="change">.set_seed(cfg.seed):
        </a>_main(cfg)


if __name__ == &quot__main__&quot:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/moskomule/sam.pytorch/commit/700f08793657ccf203ce104684ce9de2e9e76559#diff-d2e999a343da3360dfb817b9228dc42f3dace9123e5515af24c522da04d66d9fL57' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 47364812</div><div id='project'> Project Name: moskomule/sam.pytorch</div><div id='commit'> Commit Name: 700f08793657ccf203ce104684ce9de2e9e76559</div><div id='time'> Time: 2020-12-30</div><div id='author'> Author: hataya@keio.jp</div><div id='file'> File Name: cifar10.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(1)</div><div id='n_method'> N Method Name: main(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: cifar10.py</div><div id='n_file'> N File Name: cifar10.py</div><div id='m_start'> M Start Line: 57</div><div id='m_end'> M End Line: 79</div><div id='n_start'> N Start Line: 85</div><div id='n_end'> N End Line: 90</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        update_best_ckpt = ap50_95 &gt; self.best_ap
        self.best_ap = max(self.best_ap, ap50_95)

        <a id="change">self.model.train()</a>
        if self.rank == 0:
            if self.args.logger == "tensorboard":
                self.tblogger.add_scalar("val/COCOAP50", ap50, self.epoch + 1)
                self.tblogger.add_scalar("val/COCOAP50_95", ap50_95, self.epoch + 1)</code></pre><h3>After Change</h3><pre><code class='java'>
            if is_parallel(evalmodel):
                evalmodel = evalmodel.module

        <a id="change">with adjust_status</a><a id="change">(evalmodel, training=False):
            </a>ap50_95, ap50, summary = self.exp.eval(
                evalmodel, self.evaluator, self.is_distributed
            )
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/megvii-basedetection/yolox/commit/5bbfc110d73e80df4406e96b3c1103bb3555770f#diff-553d2d392dc26adff45a30c6c35b9aba76d3fc68be5206b52c7ba39040eb7524L315' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 47364813</div><div id='project'> Project Name: megvii-basedetection/yolox</div><div id='commit'> Commit Name: 5bbfc110d73e80df4406e96b3c1103bb3555770f</div><div id='time'> Time: 2022-03-05</div><div id='author'> Author: wangfeng19950315@163.com</div><div id='file'> File Name: yolox/core/trainer.py</div><div id='m_class'> M Class Name: Trainer</div><div id='n_method'> N Class Name: Trainer</div><div id='m_method'> M Method Name: evaluate_and_save_model(1)</div><div id='n_method'> N Method Name: evaluate_and_save_model(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: yolox/core/trainer.py</div><div id='n_file'> N File Name: yolox/core/trainer.py</div><div id='m_start'> M Start Line: 323</div><div id='m_end'> M End Line: 329</div><div id='n_start'> N Start Line: 323</div><div id='n_end'> N End Line: 328</div><BR>