<html><h3>Pattern ID :18841
</h3><img src='61116948.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        preprocess_input_fn = get_preprocess_input_fn(self._config, self._is_train)
        preprocess_pipeline = lambda record: preprocess_input_fn(decoder_fn(record))

        dataset<a id="change"> = </a><a id="change">dataset.map(</a>preprocess_pipeline<a id="change">, num_parallel_calls=self._num_preprocess_workers)</a>
        dataset = dataset.batch(self.global_batch_size, drop_remainder=True)
        dataset = dataset.prefetch(tf.data.experimental.AUTOTUNE)

        return dataset</code></pre><h3>After Change</h3><pre><code class='java'>
            dataset = dataset.repeat()
            dataset = dataset.shuffle(self._shuffle_buffer_size)

        tfds_decoder<a id="change">, preprocess_input_fn</a> = get_preprocess_input_fn(self._config, self._is_train)

        if self._dataset_type == &quottfrecords&quot:
            decoder_fn = partial(self._dataset_loader.decoder, include_mask=self._include_mask)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/openvinotoolkit/nncf/commit/1e5f506a54908a0a4256e592b2d4c881106236b2#diff-357b5b0d237fa88d641599429bc27c75ca8acc12f6636627f11927edf274dc1dL56' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 61116948</div><div id='project'> Project Name: openvinotoolkit/nncf</div><div id='commit'> Commit Name: 1e5f506a54908a0a4256e592b2d4c881106236b2</div><div id='time'> Time: 2021-04-03</div><div id='author'> Author: evgeny.tsykunov@intel.com</div><div id='file'> File Name: beta/examples/tensorflow/common/object_detection/datasets/builder.py</div><div id='m_class'> M Class Name: COCODatasetBuilder</div><div id='n_method'> N Class Name: COCODatasetBuilder</div><div id='m_method'> M Method Name: _pipeline(2)</div><div id='n_method'> N Method Name: _pipeline(2)</div><div id='m_parent_class'> M Parent Class: BaseDatasetBuilder</div><div id='n_parent_class'> N Parent Class: BaseDatasetBuilder</div><div id='m_file'> M File Name: beta/examples/tensorflow/common/object_detection/datasets/builder.py</div><div id='n_file'> N File Name: beta/examples/tensorflow/common/object_detection/datasets/builder.py</div><div id='m_start'> M Start Line: 91</div><div id='m_end'> M End Line: 106</div><div id='n_start'> N Start Line: 56</div><div id='n_end'> N End Line: 69</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    train = train.map(
        lambda p: preprocess_function(p, tokenizer), batched=True
    )
    val<a id="change"> = </a><a id="change">val.map(</a>lambda p: preprocess_function(p, tokenizer)<a id="change">, batched=True)</a>

    return train, val

</code></pre><h3>After Change</h3><pre><code class='java'>

@pytest.fixture
def data():
    return RegressionDataset()<a id="change">, RegressionDataset()</a>


@pytest.fixture
def model():</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/iterative/dvclive/commit/e670f3814784ea72f0e9436187ccbe4d38b4202a#diff-adc6a7274d33addcd33ea22ba11d663c9276e1b574a4d71891627b9c325d502dL41' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 61116944</div><div id='project'> Project Name: iterative/dvclive</div><div id='commit'> Commit Name: e670f3814784ea72f0e9436187ccbe4d38b4202a</div><div id='time'> Time: 2022-10-04</div><div id='author'> Author: daviddelaiglesiacastro@gmail.com</div><div id='file'> File Name: tests/test_huggingface.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: data(0)</div><div id='n_method'> N Method Name: data(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_huggingface.py</div><div id='n_file'> N File Name: tests/test_huggingface.py</div><div id='m_start'> M Start Line: 41</div><div id='m_end'> M End Line: 50</div><div id='n_start'> N Start Line: 86</div><div id='n_end'> N End Line: 86</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        new_col_name = node + "_Idx"
        col_map[node] = new_col_name
        &#47&#47 add new Idx to dataframe
        df[new_col_name]<a id="change"> = </a><a id="change">df[config["node_columns"][i]].map(</a>dict[key]<a id="change">)</a>
        &#47&#47 offset = len(dict[key]) &#47&#47remove if doing hetero mapping where all types start from zero
    t_renum = time.time()
    print("Re-enumerated column map: ", col_map)
    print("Time to renumerate", t_renum - t_load_data)</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47 2. Renumbering - generating node/edge ids starting from zero
    print("Node renumbering")
    &#47&#47 heterogeneous mapping where all types start from zero
    mapping<a id="change">, col_map</a> = tokenize_node_ids(df, config, homogeneous=False)

    t_renum = time.time()
    print("Time to renumerate", t_renum - t_load_data)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/oap-project/cloudtik/commit/dbf87797df081d065af5505a78544d5facbd4cdb#diff-2c78708da7e1befa7131d3ae449407c934104f3e487f442d304e8da400a1ee17L13' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 61116941</div><div id='project'> Project Name: oap-project/cloudtik</div><div id='commit'> Commit Name: dbf87797df081d065af5505a78544d5facbd4cdb</div><div id='time'> Time: 2023-06-21</div><div id='author'> Author: haifeng.chen@intel.com</div><div id='file'> File Name: python/cloudtik/runtime/ai/modeling/graph_modeling/graph_sage/modeling/build_graph.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: build_graph(4)</div><div id='n_method'> N Method Name: build_graph(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: python/cloudtik/runtime/ai/modeling/graph_modeling/graph_sage/modeling/build_graph.py</div><div id='n_file'> N File Name: python/cloudtik/runtime/ai/modeling/graph_modeling/graph_sage/modeling/build_graph.py</div><div id='m_start'> M Start Line: 26</div><div id='m_end'> M End Line: 50</div><div id='n_start'> N Start Line: 27</div><div id='n_end'> N End Line: 34</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    df = pd.DataFrame(
        data=breast_cancer.data, columns=breast_cancer.feature_names
    )
    df["class"]<a id="change"> = </a>pd.Categorical(
        <a id="change">pd.Series(breast_cancer.target).map(
            </a>lambda x: breast_cancer.target_names[x]<a id="change">
        )</a>
    )

    &#47&#47 leverage the whylogs sub-context to generate a whylogs profile
    profile = context.whylogs.profile_dataframe(df, dataset_name="input_data")</code></pre><h3>After Change</h3><pre><code class='java'>
    context: StepContext,
) -&gt; Output(data=pd.DataFrame, profile=DatasetProfile,):
    Load the diabetes dataset.
    X<a id="change">, y</a> = datasets.load_diabetes(return_X_y=True, as_frame=True)

    &#47&#47 merge X an y together
    df = pd.merge(X, y, left_index=True, right_index=True)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/maiot-io/zenml/commit/2d2ea2721bbf029871de5e8f2736149d9a320886#diff-140a4fd5b47de19991a62e3fd85df004c0997932f1f5366f2f3f920da9fffb67L56' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 61116943</div><div id='project'> Project Name: maiot-io/zenml</div><div id='commit'> Commit Name: 2d2ea2721bbf029871de5e8f2736149d9a320886</div><div id='time'> Time: 2022-01-21</div><div id='author'> Author: stefan@zenml.io</div><div id='file'> File Name: examples/whylogs/run.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: data_loader(1)</div><div id='n_method'> N Method Name: data_loader(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: examples/whylogs/run.py</div><div id='n_file'> N File Name: examples/whylogs/run.py</div><div id='m_start'> M Start Line: 60</div><div id='m_end'> M End Line: 69</div><div id='n_start'> N Start Line: 61</div><div id='n_end'> N End Line: 64</div><BR>