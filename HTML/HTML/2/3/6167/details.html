<html><h3>Pattern ID :6167
</h3><img src='21160608.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        model_path = os.path.join(save_folder, ckpt_name)

        if not os.path.isdir(save_folder):
            <a id="change">os.makedirs(</a>save_folder<a id="change">, exist_ok=True)</a>
        if only_state_dict:
            state_dict = run_context.evaluator.network
            mindspore.save_checkpoint(state_dict, model_path)
        else:</code></pre><h3>After Change</h3><pre><code class='java'>
        model = run_context.network
        ckpt_name = "best_so_far.ckpt"
        mindspore.save_checkpoint(model, self.save_path + &quot/&quot + ckpt_name)
        print(<a id="change">"---------------Best Model: {} has been saved in epoch:{}.---------------"\
              .format(</a>ckpt_name, run_context.cur_epoch_nums-1<a id="change">)</a>)

    def _load_model(self, run_context):
        </code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 2</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/mindlab-ai/mindnlp/commit/5a3c3e313c7e91acfd13133b862a71acd3a28f6f#diff-51e921c0c6acabc86e10b85311d0dc8418da2e557ac3f2d6b58eb1942f2e0419L91' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 21160608</div><div id='project'> Project Name: mindlab-ai/mindnlp</div><div id='commit'> Commit Name: 5a3c3e313c7e91acfd13133b862a71acd3a28f6f</div><div id='time'> Time: 2022-09-01</div><div id='author'> Author: laixinyi@cqu.edu.cn</div><div id='file'> File Name: text/engine/callbacks/best_model_callback.py</div><div id='m_class'> M Class Name: BestModelCallback</div><div id='n_method'> N Class Name: BestModelCallback</div><div id='m_method'> M Method Name: _save_model(2)</div><div id='n_method'> N Method Name: _save_model(4)</div><div id='m_parent_class'> M Parent Class: Callback</div><div id='n_parent_class'> N Parent Class: Callback</div><div id='m_file'> M File Name: text/engine/callbacks/best_model_callback.py</div><div id='n_file'> N File Name: text/engine/callbacks/best_model_callback.py</div><div id='m_start'> M Start Line: 188</div><div id='m_end'> M End Line: 209</div><div id='n_start'> N Start Line: 91</div><div id='n_end'> N End Line: 105</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                setattr(gs_args, key, value)

            &#47&#47 Set up logging for training
            <a id="change">os.makedirs(</a>args.save_dir<a id="change">, exist_ok=True)</a>
            fh = logging.FileHandler(os.path.join(args.save_dir, args.log_name))
            fh.setLevel(logging.DEBUG)

            &#47&#47 Cross validate</code></pre><h3>After Change</h3><pre><code class='java'>
        best_result = results[0]
        logger.info(&quotbest&quot)
        logger.info(best_result[&quothyperparams&quot])
        logger.info(<a id="change">&quotnum params: {:,}&quot.format(</a>best_result[&quotnum_params&quot]<a id="change">)</a>)
        logger.info(&quot{} +/- {} {}&quot.format(best_result[&quotmean_score&quot], best_result[&quotstd_score&quot], metric))

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/aamini/chemprop/commit/b221474e6942b2df892595d4043b55e6bec27262#diff-c624d8a3b784c9e86f446211415fc04b8facf066bf4510e9b4039374b05a330dL34' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 21160609</div><div id='project'> Project Name: aamini/chemprop</div><div id='commit'> Commit Name: b221474e6942b2df892595d4043b55e6bec27262</div><div id='time'> Time: 2018-12-20</div><div id='author'> Author: swansonk.14@gmail.com</div><div id='file'> File Name: grid_search.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: grid_search(1)</div><div id='n_method'> N Method Name: grid_search(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: grid_search.py</div><div id='n_file'> N File Name: grid_search.py</div><div id='m_start'> M Start Line: 52</div><div id='m_end'> M End Line: 74</div><div id='n_start'> N Start Line: 40</div><div id='n_end'> N End Line: 84</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    def __init__(self, args):
        super(BaseFlow, self).__init__()
        <a id="change">os.makedirs(</a>"./checkpoints"<a id="change">, exist_ok=True)</a>
        self.evaluator = None

        self.load_from_checkpoint = hasattr(args, "checkpoint") and args.checkpoint
        if self.load_from_checkpoint:</code></pre><h3>After Change</h3><pre><code class='java'>

        self.load_from_checkpoint = True
        if self.load_from_checkpoint:
            self._checkpoint = os.path.join(<a id="change">"./openhgnn/output/{}".format(</a>args.model<a id="change">)</a>, f"{args.model}_{args.dataset}.pt")
            atexit.register(self.save_checkpoint)
        else:
            self._checkpoint = None</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/bupt-gamma/openhgnn/commit/74981f4fd6ced6ddb99698e9aa45dcea27de098c#diff-7cdd88e302ccd8c98e288943a382e599692f08d98d03961ec08c4cacdbc61b93L23' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 21160605</div><div id='project'> Project Name: bupt-gamma/openhgnn</div><div id='commit'> Commit Name: 74981f4fd6ced6ddb99698e9aa45dcea27de098c</div><div id='time'> Time: 2021-05-27</div><div id='author'> Author: theheavenszhao@outlook.com</div><div id='file'> File Name: openhgnn/trainerflow/base_flow.py</div><div id='m_class'> M Class Name: BaseFlow</div><div id='n_method'> N Class Name: BaseFlow</div><div id='m_method'> M Method Name: __init__(2)</div><div id='n_method'> N Method Name: __init__(2)</div><div id='m_parent_class'> M Parent Class: ABC</div><div id='n_parent_class'> N Parent Class: ABC</div><div id='m_file'> M File Name: openhgnn/trainerflow/base_flow.py</div><div id='n_file'> N File Name: openhgnn/trainerflow/base_flow.py</div><div id='m_start'> M Start Line: 25</div><div id='m_end'> M End Line: 30</div><div id='n_start'> N Start Line: 27</div><div id='n_end'> N End Line: 29</div><BR>