<html><h3>Pattern ID :33105
</h3><img src='95765893.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        )

        token_logits = outputs.logits
        loss<a id="change"> = </a><a id="change">nn.CrossEntropyLoss()</a>(token_logits.view(-1, token_logits.size(-1)), labels.view(-1))

        return loss
</code></pre><h3>After Change</h3><pre><code class='java'>

        if self.label_smoothing:
            return self.compute_labelsmooth_loss(outputs.logits, labels)
        <a id="change">return </a>outputs.loss
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/rucaibox/textbox/commit/e0d4c2c5018ccebbe7d6a916c85741e743920116#diff-cb6154a8f614953fc099f2d791b0b41c862387b24dc8dc538bfe98ebbaa4a3b7L64' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 95765893</div><div id='project'> Project Name: rucaibox/textbox</div><div id='commit'> Commit Name: e0d4c2c5018ccebbe7d6a916c85741e743920116</div><div id='time'> Time: 2021-10-21</div><div id='author'> Author: 1020139164@qq.com</div><div id='file'> File Name: textbox/model/Seq2Seq/bart.py</div><div id='m_class'> M Class Name: BART</div><div id='n_method'> N Class Name: BART</div><div id='m_method'> M Method Name: forward(3)</div><div id='n_method'> N Method Name: forward(3)</div><div id='m_parent_class'> M Parent Class: Seq2SeqGenerator</div><div id='n_parent_class'> N Parent Class: Seq2SeqGenerator</div><div id='m_file'> M File Name: textbox/model/Seq2Seq/bart.py</div><div id='n_file'> N File Name: textbox/model/Seq2Seq/bart.py</div><div id='m_start'> M Start Line: 68</div><div id='m_end'> M End Line: 81</div><div id='n_start'> N Start Line: 64</div><div id='n_end'> N End Line: 83</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            class_w = tf.convert_to_tensor(class_w, dtype=tf.float32)
            self.criterion = torch.nn.CrossEntropyLoss(weight=class_w, ignore_index=-1)
        else:
            self.criterion<a id="change"> = </a><a id="change">torch.nn.CrossEntropyLoss(ignore_index=-1)</a>
        self.deform_fitting_mode = config.deform_fitting_mode
        self.deform_fitting_power = config.deform_fitting_power
        self.deform_lr_factor = config.deform_lr_factor
        self.repulse_extent = config.repulse_extent</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 self.reg_loss = 0
        &#47&#47 self.l1 = nn.L1Loss()

        <a id="change">return</a>

    def organise_inputs(self, flat_inputs):
        cfg = self.cfg
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/isl-org/open3d-ml/commit/87ca7bd50781d154e3d025de7d057a08a0f37575#diff-26488cc3cf762f6527691159619886ac36c6e6c7268597efa9979783609b880bL605' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 95765895</div><div id='project'> Project Name: isl-org/open3d-ml</div><div id='commit'> Commit Name: 87ca7bd50781d154e3d025de7d057a08a0f37575</div><div id='time'> Time: 2020-08-21</div><div id='author'> Author: sanskaragrawal107@gmail.com</div><div id='file'> File Name: ml3d/tf/models/kpconv.py</div><div id='m_class'> M Class Name: KPFCNN</div><div id='n_method'> N Class Name: KPFCNN</div><div id='m_method'> M Method Name: __init__(2)</div><div id='n_method'> N Method Name: __init__(2)</div><div id='m_parent_class'> M Parent Class: tf.keras.Model</div><div id='n_parent_class'> N Parent Class: tf.keras.Model</div><div id='m_file'> M File Name: ml3d/tf/models/kpconv.py</div><div id='n_file'> N File Name: ml3d/tf/models/kpconv.py</div><div id='m_start'> M Start Line: 632</div><div id='m_end'> M End Line: 732</div><div id='n_start'> N Start Line: 46</div><div id='n_end'> N End Line: 146</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            shift_logits = lm_logits[..., :-1, :].contiguous()
            shift_labels = labels[..., 1:].contiguous()
            &#47&#47 Flatten the tokens
            loss_fct<a id="change"> = </a><a id="change">nn.CrossEntropyLoss(ignore_index=-1)</a>
            loss = loss_fct(shift_logits.view(-1, shift_logits.size(-1)),
                            shift_labels.view(-1))
            outputs = (loss,) + outputs
</code></pre><h3>After Change</h3><pre><code class='java'>
                                               head_mask=head_mask)
        hidden_states = transformer_outputs[0]
        lm_logits = self.lm_head(hidden_states)
        <a id="change">return </a>lm_logits

if __name__ == &quot__main__&quot:
    from attrdict import AttrDict</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/audioku/cross-accent-maml-asr/commit/4269deef92de0ea7b871fd3e1b7a9cd0a7dc4664#diff-02fd75624fce8b0281c3940ab794946335f747736d6a2798b49976860006a3aeL352' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 95765894</div><div id='project'> Project Name: audioku/cross-accent-maml-asr</div><div id='commit'> Commit Name: 4269deef92de0ea7b871fd3e1b7a9cd0a7dc4664</div><div id='time'> Time: 2019-11-04</div><div id='author'> Author: samuel.cahyawijaya@gmail.com</div><div id='file'> File Name: modules/cpt2.py</div><div id='m_class'> M Class Name: CPT2LMHeadModel</div><div id='n_method'> N Class Name: CPT2LMHeadModel</div><div id='m_method'> M Method Name: forward(9)</div><div id='n_method'> N Method Name: forward(10)</div><div id='m_parent_class'> M Parent Class: GPT2LMHeadModel</div><div id='n_parent_class'> N Parent Class: GPT2LMHeadModel</div><div id='m_file'> M File Name: modules/cpt2.py</div><div id='n_file'> N File Name: modules/cpt2.py</div><div id='m_start'> M Start Line: 353</div><div id='m_end'> M End Line: 375</div><div id='n_start'> N Start Line: 369</div><div id='n_end'> N End Line: 370</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                "starting training process of client [{}]".format(id))

            SerializationTool.deserialize_model(self._model, model_parameters)
            criterion<a id="change"> = </a><a id="change">torch.nn.CrossEntropyLoss()</a>
            data_loader = self._get_dataloader(id=id, batch_size=batch_size)

            optimizer = torch.optim.SGD(self._model.parameters(), lr=lr)
            self._train_alone(id,</code></pre><h3>After Change</h3><pre><code class='java'>
            &#47&#47 aggregate model parameters
            return self.aggregator(param_list)
        else:
            <a id="change">return </a>param_list
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/smilelab-fl/fedlab/commit/16befdf9173a4b4f4430f456b5353765c6d4d3e3#diff-e01aa4d5e3a24cb22ed367c39c0994beb14dac9396433f905576a6531ad38c42L139' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 95765891</div><div id='project'> Project Name: smilelab-fl/fedlab</div><div id='commit'> Commit Name: 16befdf9173a4b4f4430f456b5353765c6d4d3e3</div><div id='time'> Time: 2021-08-08</div><div id='author'> Author: 928255708@qq.com</div><div id='file'> File Name: fedlab/core/client/serial_trainer.py</div><div id='m_class'> M Class Name: SerialTrainer</div><div id='n_method'> N Class Name: SerialTrainer</div><div id='m_method'> M Method Name: train(5)</div><div id='n_method'> N Method Name: train(7)</div><div id='m_parent_class'> M Parent Class: ClientTrainer</div><div id='n_parent_class'> N Parent Class: ClientTrainer</div><div id='m_file'> M File Name: fedlab/core/client/serial_trainer.py</div><div id='n_file'> N File Name: fedlab/core/client/serial_trainer.py</div><div id='m_start'> M Start Line: 139</div><div id='m_end'> M End Line: 175</div><div id='n_start'> N Start Line: 121</div><div id='n_end'> N End Line: 150</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            &#47&#47print(sequence_output.shape)
            prediction_scores = self.MLMhead(sequence_output)
            &#47&#47print(prediction_scores.shape) &#47&#47&#47&#47(32,192,105879)
            loss_fct<a id="change"> = </a><a id="change">torch.nn.CrossEntropyLoss()</a>  &#47&#47 -100 index = padding token
            label = label.cuda()
            masked_lm_loss = loss_fct(prediction_scores.view(-1, self.config.vocab_size), label.view(-1))
            &#47&#47print(masked_lm_loss)</code></pre><h3>After Change</h3><pre><code class='java'>
            return self.score(self.query(*Q), self.doc(*D))
        
        if mode == "qlm": 
            <a id="change">return </a>self.qlm_score(Q,D,label)


    def query(self, input_ids, attention_mask):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hannawong/colxlm/commit/f2b7324027b5065806e55151805a16a36ae1bd0b#diff-560b1e3f76ec05070753e08bff6850d7b1f99bc4f984a8493b5477a43b6b7f36L109' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 95765896</div><div id='project'> Project Name: hannawong/colxlm</div><div id='commit'> Commit Name: f2b7324027b5065806e55151805a16a36ae1bd0b</div><div id='time'> Time: 2021-11-21</div><div id='author'> Author: zh-wang17@mails.tsinghua.edu.cn</div><div id='file'> File Name: colXLM/modeling/colbert.py</div><div id='m_class'> M Class Name: ColBERT</div><div id='n_method'> N Class Name: ColBERT</div><div id='m_method'> M Method Name: forward(5)</div><div id='n_method'> N Method Name: forward(5)</div><div id='m_parent_class'> M Parent Class: BertPreTrainedModel</div><div id='n_parent_class'> N Parent Class: BertPreTrainedModel</div><div id='m_file'> M File Name: colXLM/modeling/colbert.py</div><div id='n_file'> N File Name: colXLM/modeling/colbert.py</div><div id='m_start'> M Start Line: 117</div><div id='m_end'> M End Line: 130</div><div id='n_start'> N Start Line: 52</div><div id='n_end'> N End Line: 52</div><BR>