<html><h3>Pattern ID :12938
</h3><img src='43603484.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            assert real_db_schema
            assert fake_db_schema
            fake_db_set = set(map(lambda x: x[1:3], fake_db_schema))
            real_db_set<a id="change"> = </a><a id="change">set(</a>map(lambda x: x[1:3], real_db_schema)<a id="change">)</a>
            assert fake_db_set == real_db_set

    def test_index_on_article_id(self, real_sqlalchemy_engine):
        inspector = sqlalchemy.inspect(real_sqlalchemy_engine)</code></pre><h3>After Change</h3><pre><code class='java'>
            assert fake_columns
            for x, y in zip(real_columns, fake_columns):
                assert str(x[&quottype&quot]) == str(y[&quottype&quot])
                <a id="change">assert </a>x[&quotname&quot] == y[&quotname&quot]
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/bluebrain/search/commit/393d69b752d37450339da6bae479147c841abe76#diff-82fbc96aa3f082d4667c09a2a35aec050c73120de9174e1f37bef26ef9cd3115L72' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 43603484</div><div id='project'> Project Name: bluebrain/search</div><div id='commit'> Commit Name: 393d69b752d37450339da6bae479147c841abe76</div><div id='time'> Time: 2020-08-07</div><div id='author'> Author: 47669575+EmilieDel@users.noreply.github.com</div><div id='file'> File Name: tests/test_database.py</div><div id='m_class'> M Class Name: TestDatabaseCreation</div><div id='n_method'> N Class Name: TestDatabaseCreation</div><div id='m_method'> M Method Name: test_real_equals_fake_db(3)</div><div id='n_method'> N Method Name: test_real_equals_fake_db(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_database.py</div><div id='n_file'> N File Name: tests/test_database.py</div><div id='m_start'> M Start Line: 72</div><div id='m_end'> M End Line: 87</div><div id='n_start'> N Start Line: 89</div><div id='n_end'> N End Line: 105</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            via these strategies will be returned. If None (the default), all syns will be returned
        :return:
        
        result<a id="change">: Set[str] = </a><a id="change">set()</a>
        synonym_term = self.get(name, synonym)
        if strategy_filters is not None and synonym_term.aggregated_by not in strategy_filters:
            return result
        for equiv_id_set in synonym_term.associated_id_sets:</code></pre><h3>After Change</h3><pre><code class='java'>
        synonym: str,
        strategy_filters: Optional[Set[EquivalentIdAggregationStrategy]] = None,
    ) -&gt; Set[str]:
        <a id="change">assert </a>self.instance is not None
        return self.instance.get_syns_sharing_id(name, synonym, strategy_filters)

    def get_all(self, name: str) -&gt; Dict[str, SynonymTerm]:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/astrazeneca/kazu/commit/1a115c2739afab0a8bc044f84a0c8da4f469a507#diff-5ccaabacba26e01c264b06957a584f1ce5e03cc0385f809b4bbe220316cae2aaL162' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 43603486</div><div id='project'> Project Name: astrazeneca/kazu</div><div id='commit'> Commit Name: 1a115c2739afab0a8bc044f84a0c8da4f469a507</div><div id='time'> Time: 2022-11-30</div><div id='author'> Author: elliot.ford@astrazeneca.com</div><div id='file'> File Name: kazu/modelling/database/in_memory_db.py</div><div id='m_class'> M Class Name: SynonymDatabase</div><div id='n_method'> N Class Name: SynonymDatabase</div><div id='m_method'> M Method Name: get_syns_sharing_id(4)</div><div id='n_method'> N Method Name: get_syns_sharing_id(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: kazu/modelling/database/in_memory_db.py</div><div id='n_file'> N File Name: kazu/modelling/database/in_memory_db.py</div><div id='m_start'> M Start Line: 176</div><div id='m_end'> M End Line: 188</div><div id='n_start'> N Start Line: 196</div><div id='n_end'> N End Line: 197</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        self._prepare_cuda_chunks(cpu_chunk_id_list)

        self.evict_backlist<a id="change"> = </a><a id="change">set()</a>
        &#47&#47 new ids chunk_offset + offset_in_chunk
        mapped_ids = [self._id_to_cached_cuda_id(id) for id in ids.view(-1)]
        return torch.IntTensor(mapped_ids).to(ids.device).view(ids.shape)
</code></pre><h3>After Change</h3><pre><code class='java'>
            chunk_id, offset_in_chunk = self.index_mapping_table[id]
            chunk_id_set.add(chunk_id)

        <a id="change">assert </a>len(chunk_id_set) &lt;= self.cuda_chunk_num, \
            f"the input indices pull {len(chunk_id_set)} chunks, " \
            f"which is larger than the preseted {self.cuda_chunk_num}, " \
            f"please increase cuda_chunk_num and chunk_size or shrink batch size"</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hpcaitech/freqcacheembedding/commit/6ab22ec1ef66582725457a315bd38911665bd5c1#diff-36b3f4838511b570b842a69043e333802b2b42d06cce152bd7fd883bdf01bd56L103' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 43603493</div><div id='project'> Project Name: hpcaitech/freqcacheembedding</div><div id='commit'> Commit Name: 6ab22ec1ef66582725457a315bd38911665bd5c1</div><div id='time'> Time: 2022-07-19</div><div id='author'> Author: 34452939+zxgx@users.noreply.github.com</div><div id='file'> File Name: recsys/modules/embeddings/freq_aware_embedding.py</div><div id='m_class'> M Class Name: ChunkCUDAWeightMgr</div><div id='n_method'> N Class Name: ChunkCUDAWeightMgr</div><div id='m_method'> M Method Name: prepare_ids(2)</div><div id='n_method'> N Method Name: prepare_ids(2)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: recsys/modules/embeddings/freq_aware_embedding.py</div><div id='n_file'> N File Name: recsys/modules/embeddings/freq_aware_embedding.py</div><div id='m_start'> M Start Line: 129</div><div id='m_end'> M End Line: 132</div><div id='n_start'> N Start Line: 116</div><div id='n_end'> N End Line: 135</div><BR>