<html><h3>Pattern ID :16878
</h3><img src='56772242.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
def get_kw(cls, kwargs):
    &quot&quot&quot保留排除cls的入参后的kwargs
    &quot&quot&quot
    <a id="change">kwargs_new = </a><a id="change">{}</a>
    <a id="change">for </a>k in kwargs<a id="change">:
        if </a>k not in set(inspect.getargspec(cls)[0]):
            <a id="change">kwargs_new[k]</a><a id="change"> = </a>kwargs[k]
    <a id="change">return kwargs_new</a></code></pre><h3>After Change</h3><pre><code class='java'>
def get_kw(cls, kwargs, start_idx=3):
    &quot&quot&quot保留类下的kwargs
    &quot&quot&quot
    <a id="change">return </a><a id="change">{i:kwargs[i] for i in inspect.getargspec(cls)[0][start_idx:]}</a>
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 10</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/tongjilibo/rec4torch/commit/2e58b4617f63bad6f32e64ccb1b4b3a2569f0eb5#diff-39abedd9e2652fa38ebb25a6208395db419eae8c44ea91fc298d46f09a05c048L524' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56772242</div><div id='project'> Project Name: tongjilibo/rec4torch</div><div id='commit'> Commit Name: 2e58b4617f63bad6f32e64ccb1b4b3a2569f0eb5</div><div id='time'> Time: 2022-10-17</div><div id='author'> Author: lb@libos-MacBook-Pro.local</div><div id='file'> File Name: rec4torch/snippets.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: get_kw(3)</div><div id='n_method'> N Method Name: get_kw(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: rec4torch/snippets.py</div><div id='n_file'> N File Name: rec4torch/snippets.py</div><div id='m_start'> M Start Line: 527</div><div id='m_end'> M End Line: 531</div><div id='n_start'> N Start Line: 524</div><div id='n_end'> N End Line: 527</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    :param module: the module to grab all linear layers for
    :return: a list of all linear layers in the module
    
    <a id="change">linears = </a><a id="change">{}</a>

    <a id="change">for </a>name, mod in module.named_modules()<a id="change">:
        if </a>isinstance(mod, Linear):
            <a id="change">linears[name]</a><a id="change"> = </a>mod

    <a id="change">return </a>linears


def get_prunable_layers(module: Module) -&gt; List[Tuple[str, Module]]:</code></pre><h3>After Change</h3><pre><code class='java'>
    :param module: the module to grab all linear layers for
    :return: a list of all linear layers in the module
    
    <a id="change">return </a><a id="change">{
        name: mod for name, mod in module.named_modules() if isinstance(mod, Linear)
    }</a>


def get_prunable_layers(module: Module) -&gt; List[Tuple[str, Module]]:
    </code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/neuralmagic/sparseml/commit/23b37a7c38f6219cf0d77cc338190b7348a25337#diff-e4641131c1f8247b6757bfced41700173b2e55724e29484210d9ecc59ae5d3c7L748' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56772243</div><div id='project'> Project Name: neuralmagic/sparseml</div><div id='commit'> Commit Name: 23b37a7c38f6219cf0d77cc338190b7348a25337</div><div id='time'> Time: 2022-03-10</div><div id='author'> Author: 29055749+zjzh@users.noreply.github.com</div><div id='file'> File Name: src/sparseml/pytorch/utils/helpers.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: get_linear_layers(1)</div><div id='n_method'> N Method Name: get_linear_layers(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/sparseml/pytorch/utils/helpers.py</div><div id='n_file'> N File Name: src/sparseml/pytorch/utils/helpers.py</div><div id='m_start'> M Start Line: 753</div><div id='m_end'> M End Line: 759</div><div id='n_start'> N Start Line: 749</div><div id='n_end'> N End Line: 751</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
  Returns:
    dict mapping flag names (string) to values (various types).
  
  <a id="change">ret = </a><a id="change">{}</a>
  <a id="change">for </a>name, value in FLAGS.flag_values_dict().items()<a id="change">:
    if </a>FLAGS.find_module_defining_flag(name) == __name__:
      <a id="change">ret[name]</a><a id="change"> = </a>value
  <a id="change">return </a>ret
</code></pre><h3>After Change</h3><pre><code class='java'>

def get_flags():
  Get all of the flags in SERVER_FLAGS in this module.
  <a id="change">return </a><a id="change">{entry.name: entry.value for entry in _SERVER_FLAGS}</a>
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/pair-code/lit/commit/3d82886025a01aef20594a52f5dd0f702d42641c#diff-ef0ed6bb5ca4406373be8a5a176ff05bb45389ffc460915c9d4182c7dc062885L85' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56772244</div><div id='project'> Project Name: pair-code/lit</div><div id='commit'> Commit Name: 3d82886025a01aef20594a52f5dd0f702d42641c</div><div id='time'> Time: 2022-08-09</div><div id='author'> Author: iftenney@google.com</div><div id='file'> File Name: lit_nlp/server_flags.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: get_flags(0)</div><div id='n_method'> N Method Name: get_flags(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: lit_nlp/server_flags.py</div><div id='n_file'> N File Name: lit_nlp/server_flags.py</div><div id='m_start'> M Start Line: 91</div><div id='m_end'> M End Line: 95</div><div id='n_start'> N Start Line: 96</div><div id='n_end'> N End Line: 96</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    :param module: the module to grab all conv layers for
    :return: a list of all the conv layers in the module
    
    <a id="change">convs = </a><a id="change">{}</a>

    <a id="change">for </a>name, mod in module.named_modules()<a id="change">:
        if </a>isinstance(mod, _ConvNd):
            <a id="change">convs[name]</a><a id="change"> = </a>mod

    <a id="change">return </a>convs


def get_linear_layers(module: Module) -&gt; Dict[str, Module]:</code></pre><h3>After Change</h3><pre><code class='java'>
    :param module: the module to grab all conv layers for
    :return: a list of all the conv layers in the module
    
    <a id="change">return </a><a id="change">{
        name: mod for name, mod in module.named_modules() if isinstance(mod, _ConvNd)
    }</a>


def get_linear_layers(module: Module) -&gt; Dict[str, Module]:
    </code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/neuralmagic/sparseml/commit/23b37a7c38f6219cf0d77cc338190b7348a25337#diff-e4641131c1f8247b6757bfced41700173b2e55724e29484210d9ecc59ae5d3c7L734' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56772245</div><div id='project'> Project Name: neuralmagic/sparseml</div><div id='commit'> Commit Name: 23b37a7c38f6219cf0d77cc338190b7348a25337</div><div id='time'> Time: 2022-03-10</div><div id='author'> Author: 29055749+zjzh@users.noreply.github.com</div><div id='file'> File Name: src/sparseml/pytorch/utils/helpers.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: get_conv_layers(1)</div><div id='n_method'> N Method Name: get_conv_layers(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/sparseml/pytorch/utils/helpers.py</div><div id='n_file'> N File Name: src/sparseml/pytorch/utils/helpers.py</div><div id='m_start'> M Start Line: 739</div><div id='m_end'> M End Line: 745</div><div id='n_start'> N Start Line: 739</div><div id='n_end'> N End Line: 741</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    if es_aggregations is None:
        return None

    <a id="change">aggs = </a><a id="change">{}</a>
    <a id="change">for </a>key, values in es_aggregations.items() or {}<a id="change">:
        </a>split_key = key.split(".")
        base_key = split_key[0]
        rest_key = ".".join(split_key[1:])
        aggregation = {
            bucket["key"]: bucket["doc_count"] for bucket in values.get("buckets", {})
        }

        <a id="change">if </a>not rest_key:
            <a id="change">aggs[base_key]</a><a id="change"> = </a>aggregation
        else:
            current_value = aggs.get(base_key)
            if current_value is None:
                aggs[base_key] = {rest_key: aggregation}
            else:
                current_value[rest_key] = aggregation
    <a id="change">return </a>aggs


def decode_sortable_field(field: SortableField) -&gt; str:</code></pre><h3>After Change</h3><pre><code class='java'>
    if es_aggregations is None:
        return None

    <a id="change">return </a><a id="change">{
        key: {
            bucket["key"]: bucket["doc_count"] for bucket in values.get("buckets", {})
        }
        for key, values in es_aggregations.items() or {}
    }</a>


def decode_sortable_field(field: SortableField) -&gt; str:
    return field.value</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/recognai/rubrix/commit/3131418c72d274ede822de0e4404376cc00bf18b#diff-85f3826c3838697b9e94605276d48851d2c30db38e95e7f9996a8003348d2f1bL74' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 56772235</div><div id='project'> Project Name: recognai/rubrix</div><div id='commit'> Commit Name: 3131418c72d274ede822de0e4404376cc00bf18b</div><div id='time'> Time: 2021-04-14</div><div id='author'> Author: francisco@recogn.ai</div><div id='file'> File Name: src/rubrix/server/dataset_records/es_helpers.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: parse_aggregations(1)</div><div id='n_method'> N Method Name: parse_aggregations(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/rubrix/server/dataset_records/es_helpers.py</div><div id='n_file'> N File Name: src/rubrix/server/dataset_records/es_helpers.py</div><div id='m_start'> M Start Line: 82</div><div id='m_end'> M End Line: 99</div><div id='n_start'> N Start Line: 82</div><div id='n_end'> N End Line: 87</div><BR>