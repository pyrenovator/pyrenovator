<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

    def test_step_linear(self):
        model = Linear()
        x<a id="change"> = </a><a id="change">torch.ones(16</a>, <a id="change">16</a><a id="change">)</a>
        pruner = SimplePruner(model, None, None)
        pruner.prepare()
        pruner.enable_mask_update = True
        for g in pruner.module_groups:</code></pre><h3>After Change</h3><pre><code class='java'>
            self._check_pruner_valid_after_step(model, pruner, {1, 2}, device)

    def test_step_linear(self):
        basic_models = <a id="change">[</a>Linear(), <a id="change">LinearB()</a>]
        complex_models = [MultipleLinear(), MultipleLinearB(), MultipleLinearMixed()]
        <a id="change">for </a>device in DEVICES<a id="change">:
            for model</a> in basic_models<a id="change">:
                </a>self._test_step_linear_on_device(model, True, <a id="change">torch.device(device</a><a id="change">)</a>)
            for model in complex_models:
                self._test_step_linear_on_device(model, False, torch.device(device))
</code></pre>