<html><h3>Pattern ID :39508
</h3><img src='112158015.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                    break
            assert moving_mean_read is not None, _BN_STRUCTURE_ERROR_MSG
        else:
            <a id="change">logger.error(</a>"Error, unknown BN op"<a id="change">)</a>
            assert False

        if moving_mean_read.type == &quotIdentity&quot:
            assert len(moving_mean_read.inputs) == 1, _BN_STRUCTURE_ERROR_MSG</code></pre><h3>After Change</h3><pre><code class='java'>
                    break
            assert moving_mean_read is not None, _BN_STRUCTURE_ERROR_MSG

        elif <a id="change">bn_op.type in [&quotIdentity&quot]</a>:
            <a id="change">assert </a>len(bn_op.inputs) == 1
            cond<a id="change"> = </a>bn_op.inputs[0].op
            moving_mean_read<a id="change"> = cond.inputs[3]</a>.op

        else:
            <a id="change">logger.error(</a>"Error, unknown BN op"<a id="change">)</a>
            assert False

        if moving_mean_read.type == &quotIdentity&quot:
            assert len(moving_mean_read.inputs) == 1, _BN_STRUCTURE_ERROR_MSG</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 9</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/quic/aimet/commit/5e26fd735b69781c9e0a531e6c94b093c7ec699c#diff-4d4c6b2b283172f6b18adb34c493d4a8c54e3dd52877eabf1542f231dd4f0518L594' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 112158015</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: 5e26fd735b69781c9e0a531e6c94b093c7ec699c</div><div id='time'> Time: 2022-08-01</div><div id='author'> Author: quic_bharathr@quicinc.com</div><div id='file'> File Name: TrainingExtensions/tensorflow/src/python/aimet_tensorflow/utils/op/fusedbatchnorm.py</div><div id='m_class'> M Class Name: BNUtils</div><div id='n_method'> N Class Name: BNUtils</div><div id='m_method'> M Method Name: get_moving_mean_as_read_op(1)</div><div id='n_method'> N Method Name: get_moving_mean_as_read_op(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: TrainingExtensions/tensorflow/src/python/aimet_tensorflow/utils/op/fusedbatchnorm.py</div><div id='n_file'> N File Name: TrainingExtensions/tensorflow/src/python/aimet_tensorflow/utils/op/fusedbatchnorm.py</div><div id='m_start'> M Start Line: 594</div><div id='m_end'> M End Line: 595</div><div id='n_start'> N Start Line: 618</div><div id='n_end'> N End Line: 625</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                    break
            assert moving_var_read is not None, _BN_STRUCTURE_ERROR_MSG
        else:
            <a id="change">logger.error(</a>"Error, unknown BN op"<a id="change">)</a>
            assert False

        if moving_var_read.type == &quotIdentity&quot:
            assert len(moving_var_read.inputs) == 1, _BN_STRUCTURE_ERROR_MSG</code></pre><h3>After Change</h3><pre><code class='java'>
                    break
            assert moving_var_read is not None, _BN_STRUCTURE_ERROR_MSG

        elif <a id="change">bn_op.type in [&quotIdentity&quot]</a>:
            <a id="change">assert </a>len(bn_op.inputs) == 1
            cond<a id="change"> = </a>bn_op.inputs[0].op
            moving_var_read<a id="change"> = cond.inputs[4]</a>.op
        else:
            <a id="change">logger.error(</a>"Error, unknown BN op"<a id="change">)</a>
            assert False

        if moving_var_read.type == &quotIdentity&quot:
            assert len(moving_var_read.inputs) == 1, _BN_STRUCTURE_ERROR_MSG</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/5e26fd735b69781c9e0a531e6c94b093c7ec699c#diff-4d4c6b2b283172f6b18adb34c493d4a8c54e3dd52877eabf1542f231dd4f0518L389' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 112158014</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: 5e26fd735b69781c9e0a531e6c94b093c7ec699c</div><div id='time'> Time: 2022-08-01</div><div id='author'> Author: quic_bharathr@quicinc.com</div><div id='file'> File Name: TrainingExtensions/tensorflow/src/python/aimet_tensorflow/utils/op/fusedbatchnorm.py</div><div id='m_class'> M Class Name: BNUtils</div><div id='n_method'> N Class Name: BNUtils</div><div id='m_method'> M Method Name: get_moving_variance_as_read_op(1)</div><div id='n_method'> N Method Name: get_moving_variance_as_read_op(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: TrainingExtensions/tensorflow/src/python/aimet_tensorflow/utils/op/fusedbatchnorm.py</div><div id='n_file'> N File Name: TrainingExtensions/tensorflow/src/python/aimet_tensorflow/utils/op/fusedbatchnorm.py</div><div id='m_start'> M Start Line: 418</div><div id='m_end'> M End Line: 419</div><div id='n_start'> N Start Line: 436</div><div id='n_end'> N End Line: 442</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                gamma_read = gamma_read.inputs[0].op
                assert &quotread&quot in gamma_read.name or gamma_read.type == &quotConst&quot
        else:
            <a id="change">logger.error(</a>"Error, unknown BN op"<a id="change">)</a>
            assert False
        assert gamma_read.type in [&quotReadVariableOp&quot, &quotIdentity&quot, &quotConst&quot]    &#47&#47 Will be identity for tf slim BNs
        return gamma_read
</code></pre><h3>After Change</h3><pre><code class='java'>
            if gamma_read.type == &quotSwitch&quot:      &#47&#47 tf slim bn using training tensor form
                gamma_read = gamma_read.inputs[0].op
                assert &quotread&quot in gamma_read.name or gamma_read.type == &quotConst&quot
        elif <a id="change">bn_op.type in [&quotIdentity&quot]</a>:
            <a id="change">assert </a>len(bn_op.inputs) == 1
            cond<a id="change"> = </a>bn_op.inputs[0].op
            gamma_read<a id="change"> = cond.inputs[1]</a>.op
        else:
            <a id="change">logger.error(</a>"Error, unknown BN op"<a id="change">)</a>
            assert False
        assert gamma_read.type in [&quotReadVariableOp&quot, &quotIdentity&quot, &quotConst&quot, &quotVarHandleOp&quot]    &#47&#47 Will be identity for tf slim BNs
        return gamma_read
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/quic/aimet/commit/5e26fd735b69781c9e0a531e6c94b093c7ec699c#diff-4d4c6b2b283172f6b18adb34c493d4a8c54e3dd52877eabf1542f231dd4f0518L238' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 112158017</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: 5e26fd735b69781c9e0a531e6c94b093c7ec699c</div><div id='time'> Time: 2022-08-01</div><div id='author'> Author: quic_bharathr@quicinc.com</div><div id='file'> File Name: TrainingExtensions/tensorflow/src/python/aimet_tensorflow/utils/op/fusedbatchnorm.py</div><div id='m_class'> M Class Name: BNUtils</div><div id='n_method'> N Class Name: BNUtils</div><div id='m_method'> M Method Name: get_gamma_as_read_op(1)</div><div id='n_method'> N Method Name: get_gamma_as_read_op(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: TrainingExtensions/tensorflow/src/python/aimet_tensorflow/utils/op/fusedbatchnorm.py</div><div id='n_file'> N File Name: TrainingExtensions/tensorflow/src/python/aimet_tensorflow/utils/op/fusedbatchnorm.py</div><div id='m_start'> M Start Line: 259</div><div id='m_end'> M End Line: 260</div><div id='n_start'> N Start Line: 272</div><div id='n_end'> N End Line: 278</div><BR>