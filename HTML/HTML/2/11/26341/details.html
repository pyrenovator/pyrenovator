<html><h3>Pattern ID :26341
</h3><img src='79089548.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        if ext.lower() in IMG_EXTENSIONS:
            files.append(ti)
            labels.append(label)
    <a id="change">for </a>idx, <a id="change">c</a> in enumerate(sorted(<a id="change">class_to_idx.keys()</a>, key=natural_key))<a id="change">:
        class_to_idx[c] = </a>idx
    tarinfo_and_targets = zip(files, [class_to_idx[l] for l in labels])
    tarinfo_and_targets = sorted(tarinfo_and_targets, key=lambda k: natural_key(k[0].path))
    <a id="change">return </a>tarinfo_and_targets


class DatasetTar(data.Dataset):</code></pre><h3>After Change</h3><pre><code class='java'>
    if class_to_idx is None:
        unique_labels = set(labels)
        sorted_labels = list(sorted(unique_labels, key=natural_key))
        class_to_idx<a id="change"> = </a><a id="change">{c: idx for idx, c in enumerate(sorted_labels)}</a>
    tarinfo_and_targets = zip(files, [class_to_idx[l] for l in labels])
    if sort:
        tarinfo_and_targets = sorted(tarinfo_and_targets, key=lambda k: natural_key(k[0].path))
    <a id="change">return </a>tarinfo_and_targets<a id="change">, class_to_idx</a>


class DatasetTar(data.Dataset):
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 10</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/alvinwan/nbdt-pytorch-image-models/commit/1daa303744763c141a137c589aa6068c174aa669#diff-bf0bed803b304dd59a70a5731c1a1c56dfb5b781c6b435177fab26210d291087L95' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 79089548</div><div id='project'> Project Name: alvinwan/nbdt-pytorch-image-models</div><div id='commit'> Commit Name: 1daa303744763c141a137c589aa6068c174aa669</div><div id='time'> Time: 2020-02-01</div><div id='author'> Author: rwightman@gmail.com</div><div id='file'> File Name: timm/data/dataset.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _extract_tar_info(3)</div><div id='n_method'> N Method Name: _extract_tar_info(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: timm/data/dataset.py</div><div id='n_file'> N File Name: timm/data/dataset.py</div><div id='m_start'> M Start Line: 95</div><div id='m_end'> M End Line: 113</div><div id='n_start'> N Start Line: 107</div><div id='n_end'> N End Line: 126</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if ext.lower() in IMG_EXTENSIONS:
            files.append(ti)
            labels.append(label)
    <a id="change">for </a>idx, <a id="change">c</a> in enumerate(sorted(<a id="change">class_to_idx.keys()</a>, key=natural_key))<a id="change">:
        class_to_idx[c] = </a>idx
    tarinfo_and_targets = zip(files, [class_to_idx[l] for l in labels])
    tarinfo_and_targets = sorted(tarinfo_and_targets, key=lambda k: natural_key(k[0].path))
    <a id="change">return </a>tarinfo_and_targets


class DatasetTar(data.Dataset):</code></pre><h3>After Change</h3><pre><code class='java'>
    if class_to_idx is None:
        unique_labels = set(labels)
        sorted_labels = list(sorted(unique_labels, key=natural_key))
        class_to_idx<a id="change"> = </a><a id="change">{c: idx for idx, c in enumerate(sorted_labels)}</a>
    tarinfo_and_targets = zip(files, [class_to_idx[l] for l in labels])
    if sort:
        tarinfo_and_targets = sorted(tarinfo_and_targets, key=lambda k: natural_key(k[0].path))
    <a id="change">return </a>tarinfo_and_targets<a id="change">, class_to_idx</a>


class DatasetTar(data.Dataset):
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/feng-lab/pytorch-image-models/commit/1daa303744763c141a137c589aa6068c174aa669#diff-bf0bed803b304dd59a70a5731c1a1c56dfb5b781c6b435177fab26210d291087L95' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 79089549</div><div id='project'> Project Name: feng-lab/pytorch-image-models</div><div id='commit'> Commit Name: 1daa303744763c141a137c589aa6068c174aa669</div><div id='time'> Time: 2020-02-01</div><div id='author'> Author: rwightman@gmail.com</div><div id='file'> File Name: timm/data/dataset.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _extract_tar_info(3)</div><div id='n_method'> N Method Name: _extract_tar_info(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: timm/data/dataset.py</div><div id='n_file'> N File Name: timm/data/dataset.py</div><div id='m_start'> M Start Line: 95</div><div id='m_end'> M End Line: 113</div><div id='n_start'> N Start Line: 107</div><div id='n_end'> N End Line: 126</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            self.train_process_comm_chief.broadcast(None)
            worker_metrics = cast(List[ipc.MetricsInfo], worker_metrics)

            <a id="change">for metric_name</a> in <a id="change">metrics.keys():
                metrics_lists[metric_name] = </a>[metrics[metric_name]]
                for worker_metric in worker_metrics:
                    metrics_lists[metric_name].append(worker_metric.metrics[metric_name])

            batches_per_process.append(num_batches)
            for worker_metric in worker_metrics:
                batches_per_process.append(worker_metric.num_batches)

            <a id="change">return </a>metrics_lists, batches_per_process
        else:
            self.train_process_comm_worker = cast(
                ipc.ZMQBroadcastClient, self.train_process_comm_worker</code></pre><h3>After Change</h3><pre><code class='java'>
        all_metrics, all_num_batches = zip(*all_args)

        &#47&#47 convert all_metrics from List[Dict[str, Any]] to Dict[str, List[Any]].
        metrics_lists<a id="change"> = </a><a id="change">{key: [m[key] for m in all_metrics] for key in metrics}</a>

        <a id="change">return </a>metrics_lists<a id="change">, all_num_batches</a>

    def _load(self) -&gt; None:
        if not self.load_path:
            return</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/determined-ai/determined/commit/c0e23f463f646bea8c22968aa09bf548e987ddd8#diff-31d6b7cf29d7c9ddaa96513a19ddbda78c2005cc7c6fdcb275248702871fc9beL540' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 79089547</div><div id='project'> Project Name: determined-ai/determined</div><div id='commit'> Commit Name: c0e23f463f646bea8c22968aa09bf548e987ddd8</div><div id='time'> Time: 2021-05-20</div><div id='author'> Author: rb@determined.ai</div><div id='file'> File Name: harness/determined/pytorch/_pytorch_trial.py</div><div id='m_class'> M Class Name: PyTorchTrialController</div><div id='n_method'> N Class Name: PyTorchTrialController</div><div id='m_method'> M Method Name: _combine_metrics_across_processes(3)</div><div id='n_method'> N Method Name: _combine_metrics_across_processes(3)</div><div id='m_parent_class'> M Parent Class: det.LoopTrialController</div><div id='n_parent_class'> N Parent Class: det.LoopTrialController</div><div id='m_file'> M File Name: harness/determined/pytorch/_pytorch_trial.py</div><div id='n_file'> N File Name: harness/determined/pytorch/_pytorch_trial.py</div><div id='m_start'> M Start Line: 546</div><div id='m_end'> M End Line: 578</div><div id='n_start'> N Start Line: 546</div><div id='n_end'> N End Line: 557</div><BR>