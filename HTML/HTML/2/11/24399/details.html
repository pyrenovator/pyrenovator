<html><h3>Pattern ID :24399
</h3><img src='75726147.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    dataset_module = dataset_module_factory(
        path, download_config=download_config, force_local_path=local_path, **download_kwargs
    )
    <a id="change">print(
        f"The processing script for dataset {path} can be inspected at {local_path}. "
        f"The main class is in {dataset_module.module_path}. "
        f"You can modify this processing script and use it with `datasets.load_dataset({local_path})`."</a><a id="change">
    )</a>


def inspect_metric(path: str, local_path: str, download_config: Optional[DownloadConfig] = None, **download_kwargs):
    r</code></pre><h3>After Change</h3><pre><code class='java'>
    module_source_path = inspect.getsourcefile(builder_cls)
    module_source_dirpath = os.path.dirname(module_source_path)
    for dirpath, dirnames, filenames in os.walk(module_source_dirpath):
        dst_dirpath<a id="change"> = </a>os.path.join(local_path, os.path.relpath(dirpath, module_source_dirpath))
        os.makedirs(dst_dirpath, exist_ok=True)
        &#47&#47 skipping hidden directories; prune the search
        &#47&#47 [:] for the in-place list modification required by os.walk
        dirnames[:]<a id="change"> = </a><a id="change">[dirname for dirname in dirnames if not dirname.startswith((".", "__"))]</a>
        <a id="change">for </a>filename in filenames<a id="change">:
            </a>shutil.copy2(os.path.join(dirpath, filename), os.path.join(dst_dirpath, filename))
        shutil.copystat(dirpath, dst_dirpath)
    local_path = relative_to_absolute_path(local_path)
    print(</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 7</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/huggingface/datasets/commit/8239e7968ddcaaf6a9eff9297a5431478c1e0242#diff-18ce4c83cac98e6a65b00b0bf62b244153c55556f8597ca43c179bfa0d7ad5a7L124' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 75726147</div><div id='project'> Project Name: huggingface/datasets</div><div id='commit'> Commit Name: 8239e7968ddcaaf6a9eff9297a5431478c1e0242</div><div id='time'> Time: 2022-06-09</div><div id='author'> Author: mariosasko777@gmail.com</div><div id='file'> File Name: src/datasets/inspect.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: inspect_dataset(3)</div><div id='n_method'> N Method Name: inspect_dataset(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/datasets/inspect.py</div><div id='n_file'> N File Name: src/datasets/inspect.py</div><div id='m_start'> M Start Line: 124</div><div id='m_end'> M End Line: 128</div><div id='n_start'> N Start Line: 126</div><div id='n_end'> N End Line: 144</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    metric_module = metric_module_factory(
        path, download_config=download_config, force_local_path=local_path, **download_kwargs
    )
    <a id="change">print(
        f"The processing scripts for metric {path} can be inspected at {local_path}. "
        f"The main class is in {metric_module.module_path}. "
        f"You can modify this processing scripts and use it with `datasets.load_metric({local_path})`."</a><a id="change">
    )</a>


def get_dataset_infos(
    path: str,</code></pre><h3>After Change</h3><pre><code class='java'>
    builder_cls = import_main_class(metric_module.module_path, dataset=False)
    module_source_path = inspect.getsourcefile(builder_cls)
    module_source_dirpath = os.path.dirname(module_source_path)
    for dirpath, dirnames, <a id="change">filenames</a> in os.walk(module_source_dirpath):
        dst_dirpath<a id="change"> = </a>os.path.join(local_path, os.path.relpath(dirpath, module_source_dirpath))
        os.makedirs(dst_dirpath, exist_ok=True)
        &#47&#47 skipping hidden directories; prune the search
        dirnames[:]<a id="change"> = </a><a id="change">[dirname for dirname in dirnames if not dirname.startswith((".", "__"))]</a>
        <a id="change">for </a>filename in filenames<a id="change">:
            </a>shutil.copy2(os.path.join(dirpath, filename), os.path.join(dst_dirpath, filename))
        shutil.copystat(dirpath, dst_dirpath)
    local_path = relative_to_absolute_path(local_path)
    print(</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/datasets/commit/8239e7968ddcaaf6a9eff9297a5431478c1e0242#diff-18ce4c83cac98e6a65b00b0bf62b244153c55556f8597ca43c179bfa0d7ad5a7L131' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 75726145</div><div id='project'> Project Name: huggingface/datasets</div><div id='commit'> Commit Name: 8239e7968ddcaaf6a9eff9297a5431478c1e0242</div><div id='time'> Time: 2022-06-09</div><div id='author'> Author: mariosasko777@gmail.com</div><div id='file'> File Name: src/datasets/inspect.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: inspect_metric(3)</div><div id='n_method'> N Method Name: inspect_metric(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/datasets/inspect.py</div><div id='n_file'> N File Name: src/datasets/inspect.py</div><div id='m_start'> M Start Line: 149</div><div id='m_end'> M End Line: 153</div><div id='n_start'> N Start Line: 162</div><div id='n_end'> N End Line: 179</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    else: scheduler = None

    &#47&#47 Train
    <a id="change">print("Begin training."</a><a id="change">)</a>
    for e in range(1, args.epochs + 1):
        train_loss, train_acc = train(model, criterion, optimizer, train_loader, scheduler=scheduler, accumulation=args.accumulation, device=device)
        valid_loss, valid_acc = evaluate(model, criterion, valid_loader, device=device)
</code></pre><h3>After Change</h3><pre><code class='java'>

    &#47&#47 Run finetuning
    &#47&#47 Use hyperparameter search
    if <a id="change">args.optimize_hyperparameters</a>:
        import optuna
        study = optuna.create_study(direction=&quotmaximize&quot)
        study.optimize(objective, n_trials=args.opt_n_trials)

        pruned_trials = [t for t in study.trials if t.state == optuna.trial.TrialState.PRUNED]
        complete_trials<a id="change"> = </a><a id="change">[t for t in study.trials if t.state == optuna.trial.TrialState.COMPLETE]</a>

        print("Study statistics: ")
        print("  Number of finished trials: ", len(study.trials))
        print("  Number of pruned trials: ", len(pruned_trials))
        print("  Number of complete trials: ", len(complete_trials))

        print("Best trial:")
        trial = study.best_trial
        print("  Validation Accuracy : {:.4f}".format(trial.value))
        print("  Params: ")
        <a id="change">for </a>key, value in trial.params.items()<a id="change">:
            </a>print("    {}: {}".format(key, value))
    
    &#47&#47 Run standard finetuning without hyperparameter search
    else:
        _<a id="change"> = </a>objective(None)

def main():
    parser = argparse.ArgumentParser()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jcblaisecruz02/filipino-text-benchmarks/commit/15609e90770528e9ab579af62caf962d30560f76#diff-ed183d67207df065a11e1289f19d34cc2abbc5448dea952683cfe9728c342b95L53' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 75726151</div><div id='project'> Project Name: jcblaisecruz02/filipino-text-benchmarks</div><div id='commit'> Commit Name: 15609e90770528e9ab579af62caf962d30560f76</div><div id='time'> Time: 2020-06-06</div><div id='author'> Author: jan_christian_cruz@dlsu.edu.ph</div><div id='file'> File Name: train.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: finetune(1)</div><div id='n_method'> N Method Name: finetune(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: train.py</div><div id='n_file'> N File Name: train.py</div><div id='m_start'> M Start Line: 55</div><div id='m_end'> M End Line: 115</div><div id='n_start'> N Start Line: 143</div><div id='n_end'> N End Line: 166</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    dataset_module = dataset_module_factory(
        path, download_config=download_config, force_local_path=local_path, **download_kwargs
    )
    <a id="change">print(
        f"The processing script for dataset {path} can be inspected at {local_path}. "
        f"The main class is in {dataset_module.module_path}. "
        f"You can modify this processing script and use it with `datasets.load_dataset({local_path})`."</a><a id="change">
    )</a>


def inspect_metric(path: str, local_path: str, download_config: Optional[DownloadConfig] = None, **download_kwargs):
    r</code></pre><h3>After Change</h3><pre><code class='java'>
    builder_cls = import_main_class(dataset_module.module_path, dataset=True)
    module_source_path = inspect.getsourcefile(builder_cls)
    module_source_dirpath = os.path.dirname(module_source_path)
    for dirpath, dirnames, <a id="change">filenames</a> in os.walk(module_source_dirpath):
        dst_dirpath<a id="change"> = </a>os.path.join(local_path, os.path.relpath(dirpath, module_source_dirpath))
        os.makedirs(dst_dirpath, exist_ok=True)
        &#47&#47 skipping hidden directories; prune the search
        &#47&#47 [:] for the in-place list modification required by os.walk
        dirnames[:]<a id="change"> = </a><a id="change">[dirname for dirname in dirnames if not dirname.startswith((".", "__"))]</a>
        <a id="change">for </a>filename in filenames<a id="change">:
            </a>shutil.copy2(os.path.join(dirpath, filename), os.path.join(dst_dirpath, filename))
        shutil.copystat(dirpath, dst_dirpath)
    local_path = relative_to_absolute_path(local_path)
    print(</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/datasets/commit/8239e7968ddcaaf6a9eff9297a5431478c1e0242#diff-18ce4c83cac98e6a65b00b0bf62b244153c55556f8597ca43c179bfa0d7ad5a7L104' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 75726167</div><div id='project'> Project Name: huggingface/datasets</div><div id='commit'> Commit Name: 8239e7968ddcaaf6a9eff9297a5431478c1e0242</div><div id='time'> Time: 2022-06-09</div><div id='author'> Author: mariosasko777@gmail.com</div><div id='file'> File Name: src/datasets/inspect.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: inspect_dataset(3)</div><div id='n_method'> N Method Name: inspect_dataset(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/datasets/inspect.py</div><div id='n_file'> N File Name: src/datasets/inspect.py</div><div id='m_start'> M Start Line: 124</div><div id='m_end'> M End Line: 128</div><div id='n_start'> N Start Line: 126</div><div id='n_end'> N End Line: 144</div><BR>