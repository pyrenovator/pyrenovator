<html><h3>Pattern ID :32028
</h3><img src='93785716.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    return &quot &quot.join(input_tokens)

def text_infilling(input_sequence, num_text_spans, mask_token, thingtalk):
    all_entities<a id="change"> = </a><a id="change">[]</a>
    all_device_tokens = []
    if thingtalk:
        all_entities = quoted_pattern_maybe_space.findall(thingtalk)
        for token in device_pattern.findall(thingtalk):</code></pre><h3>After Change</h3><pre><code class='java'>
    if thingtalk:
        all_entities = quoted_pattern_maybe_space.findall(thingtalk)
        
        <a id="change">for </a>entity in all_entities<a id="change">:
            </a>entity_tokens<a id="change"> = entity</a><a id="change">.split(&quot &quot</a><a id="change">)</a>
            beg = find_index(input_tokens, entity_tokens)
            if <a id="change">beg != -1</a>:
                all_entity_spans.append((beg, beg<a id="change">+</a><a id="change">len(</a>entity_tokens<a id="change">)</a>))
        
        for token in device_pattern.findall(thingtalk):
            all_device_tokens.extend(token.split(&quot.&quot))</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 8</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/stanford-oval/genienlp/commit/d115a89777ce01ede1c3631bd8f65949bcc789bb#diff-282dc979bfecd6e0539625f0962d48d9f6dbcb603e2032dd23b35988bcd65662L158' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 93785716</div><div id='project'> Project Name: stanford-oval/genienlp</div><div id='commit'> Commit Name: d115a89777ce01ede1c3631bd8f65949bcc789bb</div><div id='time'> Time: 2020-12-30</div><div id='author'> Author: mehrad@stanford.edu</div><div id='file'> File Name: genienlp/paraphrase/data_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: text_infilling(4)</div><div id='n_method'> N Method Name: text_infilling(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: genienlp/paraphrase/data_utils.py</div><div id='n_file'> N File Name: genienlp/paraphrase/data_utils.py</div><div id='m_start'> M Start Line: 158</div><div id='m_end'> M End Line: 181</div><div id='n_start'> N Start Line: 175</div><div id='n_end'> N End Line: 205</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if len(w)==10 and w[0].isdecimal():
          v=tokenizer(w[1],add_special_tokens=False)["input_ids"]
          i+=v
          u<a id="change">+=</a>[w[3]] if len(v)==1 else ["B-"+w[3]]+<a id="change">[</a>"I-"+w[3]<a id="change"></a>]*(len(v)-1)
        elif t.strip()=="" and len(i)&gt;0:
          self.ids.append([tokenizer.cls_token_id]+i+[tokenizer.sep_token_id])
          self.upos.append(["SYM"]+u+["SYM"])</code></pre><h3>After Change</h3><pre><code class='java'>
    self.ids=[]
    self.upos=[]
    with open(conllu,"r",encoding="utf-8") as f:
      <a id="change">for s</a> in f.read().strip().split("\n\n")<a id="change">:
        </a>u=[(w[1],w[3]) for w in [t.split("\t") for t in <a id="change">s.split("\n"</a><a id="change">)</a>] if len(w)==10 and w[0].isdecimal()]
        v<a id="change">=</a>tokenizer([t for t,p in u],add_special_tokens=False)["input_ids"]
        self.ids.append([tokenizer.cls_token_id]+sum(v,[])+[tokenizer.sep_token_id])
        self.upos.append(["SYM"]+sum([["B-"+p]+["I-"+p]<a id="change">*</a>(<a id="change">len(</a>v[i]<a id="change">)</a>-1) if <a id="change">len(v[i])&gt;1</a> else [p] for i,(t,p) in enumerate(u)],[])+["SYM"])
    self.label2id={l:i for i,l in enumerate(sorted(set(sum(self.upos,[]))))}
  def __call__(*args):
    lid={l:i for i,l in enumerate(sorted(set(sum([list(t.label2id) for t in args],[]))))}</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/koichiyasuoka/esupar/commit/8949e58a868c421549cc4bd44d90eb15fff109d3#diff-5c9a99099f28048bee1e5ade1dd2cb0b174ff1230b8f3a69e408e809843070c5L7' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 93785715</div><div id='project'> Project Name: koichiyasuoka/esupar</div><div id='commit'> Commit Name: 8949e58a868c421549cc4bd44d90eb15fff109d3</div><div id='time'> Time: 2022-01-03</div><div id='author'> Author: yasuoka@kanji.zinbun.kyoto-u.ac.jp</div><div id='file'> File Name: esupar/train.py</div><div id='m_class'> M Class Name: UPOSDataset</div><div id='n_method'> N Class Name: UPOSDataset</div><div id='m_method'> M Method Name: __init__(3)</div><div id='n_method'> N Method Name: __init__(3)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: esupar/train.py</div><div id='n_file'> N File Name: esupar/train.py</div><div id='m_start'> M Start Line: 10</div><div id='m_end'> M End Line: 22</div><div id='n_start'> N Start Line: 10</div><div id='n_end'> N End Line: 16</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    
def token_masking(input_sequence, mlm_probability, mask_token, thingtalk):
    
    all_entities<a id="change"> = </a><a id="change">[]</a>
    all_device_tokens = []
    if thingtalk:
        all_entities = quoted_pattern_maybe_space.findall(thingtalk)
        for token in device_pattern.findall(thingtalk):</code></pre><h3>After Change</h3><pre><code class='java'>
    if thingtalk:
        all_entities = quoted_pattern_maybe_space.findall(thingtalk)
        
        <a id="change">for entity</a> in all_entities<a id="change">:
            </a>entity_tokens<a id="change"> = </a><a id="change">entity.split(&quot &quot</a><a id="change">)</a>
            beg = find_index(input_tokens, entity_tokens)
            if <a id="change">beg != -1</a>:
                all_entity_spans.append((beg, beg<a id="change"> + </a><a id="change">len(</a>entity_tokens<a id="change">)</a>))
        
        for token in device_pattern.findall(thingtalk):
            all_device_tokens.extend(token.split(&quot.&quot))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/stanford-oval/genienlp/commit/ed3f2961b6bafe5fc41c11e76c931d548e862a5d#diff-282dc979bfecd6e0539625f0962d48d9f6dbcb603e2032dd23b35988bcd65662L104' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 93785708</div><div id='project'> Project Name: stanford-oval/genienlp</div><div id='commit'> Commit Name: ed3f2961b6bafe5fc41c11e76c931d548e862a5d</div><div id='time'> Time: 2020-12-30</div><div id='author'> Author: mehrad@stanford.edu</div><div id='file'> File Name: genienlp/paraphrase/data_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: token_masking(4)</div><div id='n_method'> N Method Name: token_masking(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: genienlp/paraphrase/data_utils.py</div><div id='n_file'> N File Name: genienlp/paraphrase/data_utils.py</div><div id='m_start'> M Start Line: 106</div><div id='m_end'> M End Line: 118</div><div id='n_start'> N Start Line: 121</div><div id='n_end'> N End Line: 140</div><BR>