<html><h3>Pattern ID :20607
</h3><img src='66398772.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            &#47&#47 for learning the q functions
            &quot(qfunc) Q1 pred&quot: float(mean_of_unmasked_elements(Q1_predictions, b.m)),
            &quot(qfunc) Q2 pred&quot: float(mean_of_unmasked_elements(Q2_predictions, b.m)),
            &quot(qfunc) Q1 Q2 pairwise abs diff&quot: float(mean_of_unmasked_elements(<a id="change">torch.abs(</a>Q1_predictions - Q2_predictions<a id="change">)</a>, b.m)),
            &quot(qfunc) Q1 loss&quot: float(Q1_loss),
            &quot(qfunc) Q2 loss&quot: float(Q2_loss),
            &#47&#47 for learning the actor</code></pre><h3>After Change</h3><pre><code class='java'>
        polyak_update(targ_net=self.Q2_targ, pred_net=self.Q2, polyak=self.polyak)

        m_numpy = b.m.pu().numpy().astype(bool)
        Q1_predictions_numpy = <a id="change">Q1_predictions.detach().cpu().numpy()</a>
        Q2_predictions_numpy<a id="change"> = </a><a id="change">Q2_predictions.detach().cpu().numpy()</a>

        Q1_predictions_filtered = Q1_predictions_numpy[m_numpy]
        Q2_predictions_filtered<a id="change"> = </a>Q2_predictions_numpy[m_numpy]

        corr_matrix<a id="change"> = </a>np.corrcoef(Q1_predictions_filtered, Q2_predictions_filtered)
        corr<a id="change"> = </a>corr_matrix[0, 1]

        return {
            &#47&#47 for learning the q functions</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 11</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/zhihanyang2022/off-policy-continuous-control/commit/a66de6c52d4247eda06fcaf27a07ddd1724b9426#diff-19eb4565ebe473b0b4951f15c69f87573379cefbae22b613e3334d493d59c357L139' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 66398772</div><div id='project'> Project Name: zhihanyang2022/off-policy-continuous-control</div><div id='commit'> Commit Name: a66de6c52d4247eda06fcaf27a07ddd1724b9426</div><div id='time'> Time: 2021-09-30</div><div id='author'> Author: yangz2@carleton.edu</div><div id='file'> File Name: offpcc/algorithms_recurrent/recurrent_sac_sharing.py</div><div id='m_class'> M Class Name: RecurrentSACSharing</div><div id='n_method'> N Class Name: RecurrentSACSharing</div><div id='m_method'> M Method Name: update_networks(2)</div><div id='n_method'> N Method Name: update_networks(2)</div><div id='m_parent_class'> M Parent Class: RecurrentOffPolicyRLAlgorithm</div><div id='n_parent_class'> N Parent Class: RecurrentOffPolicyRLAlgorithm</div><div id='m_file'> M File Name: offpcc/algorithms_recurrent/recurrent_sac_sharing.py</div><div id='n_file'> N File Name: offpcc/algorithms_recurrent/recurrent_sac_sharing.py</div><div id='m_start'> M Start Line: 139</div><div id='m_end'> M End Line: 242</div><div id='n_start'> N Start Line: 139</div><div id='n_end'> N End Line: 252</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            &quot(qfunc) Q1 pred&quot: float(mean_of_unmasked_elements(Q1_predictions, b.m)),
            &quot(qfunc) Q2 pred&quot: float(mean_of_unmasked_elements(Q2_predictions, b.m)),
            &quot(qfunc) Q1 Q2 pairwise abs diff&quot: float(
                mean_of_unmasked_elements(<a id="change">torch.abs(</a>Q1_predictions - Q2_predictions<a id="change">)</a>, b.m)),
            &quot(qfunc) Q1 loss&quot: float(Q1_loss),
            &quot(qfunc) Q2 loss&quot: float(Q2_loss),
            &#47&#47 for learning the actor</code></pre><h3>After Change</h3><pre><code class='java'>
        polyak_update(targ_net=self.Q2_targ, pred_net=self.Q2, polyak=self.polyak)

        m_numpy = b.m.pu().numpy().astype(bool)
        Q1_predictions_numpy = <a id="change">Q1_predictions.detach().cpu().numpy()</a>
        Q2_predictions_numpy<a id="change"> = </a><a id="change">Q2_predictions.detach().cpu().numpy()</a>

        Q1_predictions_filtered = Q1_predictions_numpy[m_numpy]
        Q2_predictions_filtered<a id="change"> = </a>Q2_predictions_numpy[m_numpy]

        corr_matrix<a id="change"> = </a>np.corrcoef(Q1_predictions_filtered, Q2_predictions_filtered)
        corr<a id="change"> = </a>corr_matrix[0, 1]

        return {
            &#47&#47 for learning the q functions</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/zhihanyang2022/off-policy-continuous-control/commit/a66de6c52d4247eda06fcaf27a07ddd1724b9426#diff-128f3641094025042825cd1a1dc549083804b2559d080a4c2e655314d22f0a54L126' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 66398710</div><div id='project'> Project Name: zhihanyang2022/off-policy-continuous-control</div><div id='commit'> Commit Name: a66de6c52d4247eda06fcaf27a07ddd1724b9426</div><div id='time'> Time: 2021-09-30</div><div id='author'> Author: yangz2@carleton.edu</div><div id='file'> File Name: offpcc/algorithms_recurrent/recurrent_sac.py</div><div id='m_class'> M Class Name: RecurrentSAC</div><div id='n_method'> N Class Name: RecurrentSAC</div><div id='m_method'> M Method Name: update_networks(2)</div><div id='n_method'> N Method Name: update_networks(2)</div><div id='m_parent_class'> M Parent Class: RecurrentOffPolicyRLAlgorithm</div><div id='n_parent_class'> N Parent Class: RecurrentOffPolicyRLAlgorithm</div><div id='m_file'> M File Name: offpcc/algorithms_recurrent/recurrent_sac.py</div><div id='n_file'> N File Name: offpcc/algorithms_recurrent/recurrent_sac.py</div><div id='m_start'> M Start Line: 147</div><div id='m_end'> M End Line: 253</div><div id='n_start'> N Start Line: 147</div><div id='n_end'> N End Line: 262</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    ratio = estimated_sources_amplitude / estimated_sources_amplitude.sum(dim=0)
    estimated_sources = ratio * mixture

    norm = max(1, <a id="change">torch.abs(</a>mixture<a id="change">)</a>.max() / 10)
    mixture, estimated_sources = mixture / norm, estimated_sources / norm
    estimated_sources = update_em(mixture, estimated_sources, iterations, eps=eps)
    estimated_sources = norm * estimated_sources</code></pre><h3>After Change</h3><pre><code class='java'>
    device = mixture.device
    dtype = mixture.dtype

    mixture = <a id="change">mixture.detach().cpu().numpy()</a>
    estimated_amplitude<a id="change"> = </a><a id="change">estimated_amplitude.detach().cpu().numpy()</a>

    mixture = mixture.transpose(2, 1, 0)
    estimated_amplitude<a id="change"> = </a>estimated_amplitude.transpose(3, 2, 1, 0)
    estimated_sources = norbert.wiener(estimated_amplitude, mixture, eps=eps)
    estimated_sources<a id="change"> = </a>estimated_sources.transpose(3, 2, 1, 0)
    estimated_sources<a id="change"> = </a>torch.from_numpy(estimated_sources).to(device, dtype)

    return estimated_sources</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tky823/dnn-based_source_separation/commit/11a2e82888f76547df72eff58c6a592e3473e65c#diff-7c5b1018ab6bf19cc2f7c1fc385abd4adb493c178cdd1548dcae8770f80fb8fdL383' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 66398774</div><div id='project'> Project Name: tky823/dnn-based_source_separation</div><div id='commit'> Commit Name: 11a2e82888f76547df72eff58c6a592e3473e65c</div><div id='time'> Time: 2021-08-20</div><div id='author'> Author: 40362510+tky823@users.noreply.github.com</div><div id='file'> File Name: egs/musdb18/d3net/src/adhoc_driver.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: apply_multichannel_wiener_filter(4)</div><div id='n_method'> N Method Name: apply_multichannel_wiener_filter(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: egs/musdb18/d3net/src/adhoc_driver.py</div><div id='n_file'> N File Name: egs/musdb18/d3net/src/adhoc_driver.py</div><div id='m_start'> M Start Line: 383</div><div id='m_end'> M End Line: 401</div><div id='n_start'> N Start Line: 397</div><div id='n_end'> N End Line: 413</div><BR>