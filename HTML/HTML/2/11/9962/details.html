<html><h3>Pattern ID :9962
</h3><img src='35605599.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    def __init__(self, args):
        if args.model == "LeNet":
            self.model = LeNet()
        elif <a id="change"></a>args.model == "resnet56":
            self.model<a id="change"> = </a>resnet56(10, pretrained=False, path=None)
        elif <a id="change">args.model == "resnet20"</a>:
            self.model<a id="change"> = </a>resnet20(10)
        else:
            <a id="change">raise </a>Exception(f"do not support this model: {args.model}")
        if args.dataset in ["cifar10", "cifar100"]:
            self.original_data_size = torch.Size([1, 3, 32, 32])
            if args.dataset == "cifar10":</code></pre><h3>After Change</h3><pre><code class='java'>
        else:
            self.protected_layers = None  &#47&#47 no protected layers
        self.iteration_num = 0
        <a id="change">if </a><a id="change">hasattr(</a>args, <a id="change">"attack_iteration_idxs"</a><a id="change">)</a>:
            self.attack_iteration_idxs<a id="change"> = </a>args.attack_iteration_idxs
        else:
            self.attack_iteration_idxs<a id="change"> = </a>[args.comm_round - 1]
            &#47&#47 attack the last iteration, as it contains more information

    def get_model(self):</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 10</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/fedml-ai/fedml/commit/39bf27af26663618517d25750f6f3ee40b08590c#diff-a92997ecfd5ba4b0ec93d15f6288db32b01531d977514bb529e3da431799ae44L26' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 35605599</div><div id='project'> Project Name: fedml-ai/fedml</div><div id='commit'> Commit Name: 39bf27af26663618517d25750f6f3ee40b08590c</div><div id='time'> Time: 2023-03-08</div><div id='author'> Author: sshan0731@hotmail.com</div><div id='file'> File Name: python/fedml/core/security/attack/dlg_attack.py</div><div id='m_class'> M Class Name: DLGAttack</div><div id='n_method'> N Class Name: DLGAttack</div><div id='m_method'> M Method Name: __init__(2)</div><div id='n_method'> N Method Name: __init__(2)</div><div id='m_parent_class'> M Parent Class: BaseAttackMethod</div><div id='n_parent_class'> N Parent Class: BaseAttackMethod</div><div id='m_file'> M File Name: python/fedml/core/security/attack/dlg_attack.py</div><div id='n_file'> N File Name: python/fedml/core/security/attack/dlg_attack.py</div><div id='m_start'> M Start Line: 26</div><div id='m_end'> M End Line: 34</div><div id='n_start'> N Start Line: 28</div><div id='n_end'> N End Line: 62</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    def __init__(self, args):
        if args.model == "LeNet":
            self.model = LeNet()
        elif <a id="change"></a>args.model == "resnet56":
            self.model<a id="change"> = </a>resnet56(10, pretrained=False, path=None)
        elif <a id="change">args.model == "resnet20"</a>:
            self.model<a id="change"> = </a>resnet20(10)
        else:
            <a id="change">raise </a>Exception(f"do not support this model: {args.model}")
        if args.dataset in ["cifar10", "cifar100"]:
            self.original_data_size = torch.Size([1, 3, 32, 32])
            if args.dataset == "cifar10":</code></pre><h3>After Change</h3><pre><code class='java'>
        else:
            self.protected_layers = None  &#47&#47 no protected layers
        self.iteration_num = 0
        <a id="change">if </a><a id="change">hasattr(</a>args, <a id="change">"attack_iteration_idxs"</a><a id="change">)</a>:
            self.attack_iteration_idxs<a id="change"> = </a>args.attack_iteration_idxs
        else:
            self.attack_iteration_idxs<a id="change"> = </a>[args.comm_round - 1]
            &#47&#47 attack the last iteration, as it contains more information

    def get_model(self):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/fedml-ai/fedml/commit/0e1c17c36b2dbf50ff5b58a8209d5c0f7e6e280b#diff-a92997ecfd5ba4b0ec93d15f6288db32b01531d977514bb529e3da431799ae44L25' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 35605631</div><div id='project'> Project Name: fedml-ai/fedml</div><div id='commit'> Commit Name: 0e1c17c36b2dbf50ff5b58a8209d5c0f7e6e280b</div><div id='time'> Time: 2023-03-08</div><div id='author'> Author: sshan0731@hotmail.com</div><div id='file'> File Name: python/fedml/core/security/attack/dlg_attack.py</div><div id='m_class'> M Class Name: DLGAttack</div><div id='n_method'> N Class Name: DLGAttack</div><div id='m_method'> M Method Name: __init__(2)</div><div id='n_method'> N Method Name: __init__(2)</div><div id='m_parent_class'> M Parent Class: BaseAttackMethod</div><div id='n_parent_class'> N Parent Class: BaseAttackMethod</div><div id='m_file'> M File Name: python/fedml/core/security/attack/dlg_attack.py</div><div id='n_file'> N File Name: python/fedml/core/security/attack/dlg_attack.py</div><div id='m_start'> M Start Line: 26</div><div id='m_end'> M End Line: 34</div><div id='n_start'> N Start Line: 28</div><div id='n_end'> N End Line: 62</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        (lambda _: 1e100) if lr_schedule is None else lr_schedule,
    }

    <a id="change">if </a>isinstance(encoder, policy_class):
        policy<a id="change"> = </a>encoder
    elif policy_class == sb3_pols.ActorCriticCnnPolicy:
        policy_kwargs.update({&quotortho_init&quot: ortho_init,
                              &quotlog_std_init&quot: log_std_init})

        policy = policy_class(**policy_kwargs)
    elif <a id="change">policy_class == CnnPolicy</a>:
        policy_kwargs.update({&quotoptimizer_class&quot: optimizer_class,
                              &quotoptimizer_kwargs&quot: optimizer_kwargs,
                              })

        policy<a id="change"> = </a>policy_class(**policy_kwargs)
    else:
        <a id="change">raise </a>NotImplementedError

    if print_policy_summary:
        &#47&#47 print policy info in case it is useful for the caller</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 training we still need the full encoder (linear layers included),
        &#47&#47 so here we load the weights for conv layers, and leave linear
        &#47&#47 layers randomly initialized.
        <a id="change">if </a><a id="change">hasattr(</a>encoder, <a id="change">&quotnetwork&quot</a><a id="change">)</a> and \
           not isinstance(encoder.network.shared_network[-1], th.nn.Linear):
            full_encoder = BaseEncoder(observation_space,
                                       **encoder_kwargs)

            partial_encoder_dict = encoder.state_dict()
            full_encoder_dict = full_encoder.state_dict()

            &#47&#47 pretrained_dict contains weights & bias for conv layers only.
            pretrained_dict<a id="change"> = </a>{k: v for k, v in partial_encoder_dict.items() if
                               k in full_encoder_dict}
            full_encoder_dict.update(pretrained_dict)
            full_encoder.load_state_dict(full_encoder_dict)

            encoder<a id="change"> = </a>full_encoder

        policy_kwargs = {
            &quotfeatures_extractor_class&quot: EncoderFeatureExtractor,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/humancompatibleai/eirli/commit/bd5e3f1d81db75a1241a9fd43d7b1daba1286152#diff-c89e267c35244f4a7b1392541f3a998a20951f7d934bb7dc532f18d3bdc5ab04L32' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 35605661</div><div id='project'> Project Name: humancompatibleai/eirli</div><div id='commit'> Commit Name: bd5e3f1d81db75a1241a9fd43d7b1daba1286152</div><div id='time'> Time: 2021-10-18</div><div id='author'> Author: cyn0531@hku.hk</div><div id='file'> File Name: src/il_representations/scripts/policy_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: make_policy(0)</div><div id='n_method'> N Method Name: make_policy(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/il_representations/scripts/policy_utils.py</div><div id='n_file'> N File Name: src/il_representations/scripts/policy_utils.py</div><div id='m_start'> M Start Line: 49</div><div id='m_end'> M End Line: 87</div><div id='n_start'> N Start Line: 57</div><div id='n_end'> N End Line: 118</div><BR>