<html><h3>Pattern ID :15491
</h3><img src='52554754.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    &#47&#47 evaluate all clients
    def evaluate(self):
        stats = self.test_accuracy()
        <a id="change">stats_train = </a>self.train_accuracy_and_loss()

        test_acc = sum(stats[2])*1.0 / sum(stats[1])
        train_acc<a id="change"> = </a><a id="change">sum(stats_train[2])*1.0 / sum(stats_train</a><a id="change">[1])</a>
        train_loss = sum(stats_train[3])*1.0 / sum(stats_train[1])
        
        self.rs_test_acc.append(test_acc)
        self.rs_train_acc.append(train_acc)
        <a id="change">self.rs_train_loss.append(</a>train_loss<a id="change">)</a>
        <a id="change">self.print_(</a>test_acc, train_acc, train_loss<a id="change">)</a>


    def print_(self, test_acc, train_acc, train_loss):
        print("Average Test Accurancy: {:.4f}".format(test_acc))</code></pre><h3>After Change</h3><pre><code class='java'>
        self.rs_test_auc.append(test_auc)
        &#47&#47 self.rs_train_loss.append(train_loss)

        <a id="change">print(</a><a id="change">"Average Test Accurancy: {:.4f}".format(</a>test_acc<a id="change">))</a>
        print("Average Test AUC: {:.4f}".format(test_auc))
        &#47&#47 self.print_(test_acc, train_acc, train_loss)

</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 12</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/tsingz0/pfl-non-iid/commit/4f394efe04f30dbd3cab4278467631854f997903#diff-ac261f9cd25ad22dde1199e199bfa3189d71fd2a5e873894cab0119281e51cffL193' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 52554754</div><div id='project'> Project Name: tsingz0/pfl-non-iid</div><div id='commit'> Commit Name: 4f394efe04f30dbd3cab4278467631854f997903</div><div id='time'> Time: 2022-01-14</div><div id='author'> Author: 2719584131@qq.com</div><div id='file'> File Name: system/flcore/servers/serverbase.py</div><div id='m_class'> M Class Name: Server</div><div id='n_method'> N Class Name: Server</div><div id='m_method'> M Method Name: evaluate(1)</div><div id='n_method'> N Method Name: evaluate(1)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: system/flcore/servers/serverbase.py</div><div id='n_file'> N File Name: system/flcore/servers/serverbase.py</div><div id='m_start'> M Start Line: 195</div><div id='m_end'> M End Line: 204</div><div id='n_start'> N Start Line: 193</div><div id='n_end'> N End Line: 205</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            c.train_one_step()

        stats = self.test_accuracy()
        <a id="change">stats_train = </a>self.train_accuracy_and_loss()

        &#47&#47 set local model back to client for training process
        for i, c in enumerate(self.clients):
            c.clone_model(models_temp[i], c.model)

        test_acc = sum(stats[2])*1.0 / sum(stats[1])
        train_acc<a id="change"> = </a><a id="change">sum(stats_train[2])*1.0 / sum(</a><a id="change">stats_train[1])</a>
        train_loss = sum(stats_train[3])*1.0 / sum(stats_train[1])
        
        self.rs_test_acc.append(test_acc)
        self.rs_train_acc.append(train_acc)
        <a id="change">self.rs_train_loss.append(</a>train_loss<a id="change">)</a>
        <a id="change">self.print_(</a>test_acc, train_acc, train_loss<a id="change">)</a>
</code></pre><h3>After Change</h3><pre><code class='java'>
        test_acc = sum(stats[2])*1.0 / sum(stats[1])
        
        self.rs_test_acc.append(test_acc)
        <a id="change">print(</a><a id="change">"Average Test Accurancy: {:.4f}".format(</a>test_acc<a id="change">))</a></code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tsingz0/pfl-non-iid/commit/4f394efe04f30dbd3cab4278467631854f997903#diff-10a1896f9371842f10f37e974093fc1a8c2d4996494525d7e6c2391f51081669L58' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 52554741</div><div id='project'> Project Name: tsingz0/pfl-non-iid</div><div id='commit'> Commit Name: 4f394efe04f30dbd3cab4278467631854f997903</div><div id='time'> Time: 2022-01-14</div><div id='author'> Author: 2719584131@qq.com</div><div id='file'> File Name: system/flcore/servers/serverperavg.py</div><div id='m_class'> M Class Name: PerAvg</div><div id='n_method'> N Class Name: PerAvg</div><div id='m_method'> M Method Name: evaluate_one_step(1)</div><div id='n_method'> N Method Name: evaluate_one_step(1)</div><div id='m_parent_class'> M Parent Class: Server</div><div id='n_parent_class'> N Parent Class: Server</div><div id='m_file'> M File Name: system/flcore/servers/serverperavg.py</div><div id='n_file'> N File Name: system/flcore/servers/serverperavg.py</div><div id='m_start'> M Start Line: 65</div><div id='m_end'> M End Line: 78</div><div id='n_start'> N Start Line: 64</div><div id='n_end'> N End Line: 67</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    def evaluate_personalized_model(self):
        stats = self.test_accuracy_personalized()
        <a id="change">stats_train = </a>self.train_accuracy_and_loss_personalized()

        test_acc = sum(stats[2])*1.0 / sum(stats[1])
        train_acc<a id="change"> = </a><a id="change">sum(stats_train[2])*1.0 / sum(</a><a id="change">stats_train[1])</a>
        train_loss = sum(stats_train[3])*1.0 / sum(stats_train[1])
        
        self.rs_test_acc_per.append(test_acc)
        self.rs_train_acc_per.append(train_acc)
        <a id="change">self.rs_train_loss_per.append(</a>train_loss<a id="change">)</a>
        <a id="change">self.print_(</a>test_acc, train_acc, train_loss<a id="change">)</a>

    def save_results(self):
        algo = self.dataset + "_" + self.algorithm
        result_path = "../results/"</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 self.rs_train_acc_per.append(train_acc)
        &#47&#47 self.rs_train_loss_per.append(train_loss)

        <a id="change">print(</a><a id="change">"Average Personalized Test Accurancy: {:.4f}".format(</a>test_acc<a id="change">))</a>
        &#47&#47 self.print_(test_acc, train_acc, train_loss)

    def save_results(self):
        algo = self.dataset + "_" + self.algorithm</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tsingz0/pfl-non-iid/commit/4f394efe04f30dbd3cab4278467631854f997903#diff-ebc38f9217157d9add64395a705ea848c87eefef7ddc3ef7ee6748b7ec1fa5c9L103' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 52554745</div><div id='project'> Project Name: tsingz0/pfl-non-iid</div><div id='commit'> Commit Name: 4f394efe04f30dbd3cab4278467631854f997903</div><div id='time'> Time: 2022-01-14</div><div id='author'> Author: 2719584131@qq.com</div><div id='file'> File Name: system/flcore/servers/serverpFedMe.py</div><div id='m_class'> M Class Name: pFedMe</div><div id='n_method'> N Class Name: pFedMe</div><div id='m_method'> M Method Name: evaluate_personalized_model(1)</div><div id='n_method'> N Method Name: evaluate_personalized_model(1)</div><div id='m_parent_class'> M Parent Class: Server</div><div id='n_parent_class'> N Parent Class: Server</div><div id='m_file'> M File Name: system/flcore/servers/serverpFedMe.py</div><div id='n_file'> N File Name: system/flcore/servers/serverpFedMe.py</div><div id='m_start'> M Start Line: 105</div><div id='m_end'> M End Line: 114</div><div id='n_start'> N Start Line: 102</div><div id='n_end'> N End Line: 110</div><BR>