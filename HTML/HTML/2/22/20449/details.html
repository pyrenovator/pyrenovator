<html><h3>Pattern ID :20449
</h3><img src='66177859.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        &#47&#47 Ensure continuity at `kappa_switch`
        offset = cls.log_cmk_approx(m, kappa_switch) - cls.log_cmk_exact(m, kappa_switch)
        <a id="change">return </a><a id="change">torch.where(
            kappa</a><a id="change"> &lt; kappa_switch</a>,
            <a id="change">cls.log_cmk_exact(m</a>, <a id="change">kappa</a><a id="change">)</a>,
            <a id="change">cls.log_cmk_approx(</a>m, kappa<a id="change">) - </a>offset<a id="change">,
        )</a>

    def _evaluate(self, prediction: Tensor, target: Tensor) -&gt; Tensor:
        Calculates the von Mises-Fisher loss for a vector in D-dimensonal space.
</code></pre><h3>After Change</h3><pre><code class='java'>
        ensuring continuity at this point.
        
        kappa_switch = torch.tensor([kappa_switch]).to(kappa.device)
        <a id="change">mask_exact = </a><a id="change">(kappa &lt; kappa_switch)</a>

        &#47&#47 Ensure continuity at `kappa_switch`
        offset = cls.log_cmk_approx(m, kappa_switch) - cls.log_cmk_exact(m, kappa_switch)
        <a id="change">ret = </a><a id="change">cls.log_cmk_approx(</a>m, kappa<a id="change">) - </a>offset
        <a id="change">ret[mask_exact] = </a><a id="change">cls.log_cmk_exact(m</a>, <a id="change">kappa[mask_exact]</a><a id="change">)</a>
        <a id="change">return ret</a>

    def _evaluate(self, prediction: Tensor, target: Tensor) -&gt; Tensor:
        Calculates the von Mises-Fisher loss for a vector in D-dimensonal space.
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 16</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/graphnet-team/graphnet/commit/14acdd3ac5573e07523726df6e717bb015fe5391#diff-54d337be01412c43b21943d0f7477629f3271da5f20b06757918c472755640adL190' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 66177859</div><div id='project'> Project Name: graphnet-team/graphnet</div><div id='commit'> Commit Name: 14acdd3ac5573e07523726df6e717bb015fe5391</div><div id='time'> Time: 2022-01-06</div><div id='author'> Author: andreas.sogaard@gmail.com</div><div id='file'> File Name: src/graphnet/components/loss_functions.py</div><div id='m_class'> M Class Name: VonMisesFisherLoss</div><div id='n_method'> N Class Name: VonMisesFisherLoss</div><div id='m_method'> M Method Name: log_cmk(4)</div><div id='n_method'> N Method Name: log_cmk(4)</div><div id='m_parent_class'> M Parent Class: LossFunction</div><div id='n_parent_class'> N Parent Class: LossFunction</div><div id='m_file'> M File Name: src/graphnet/components/loss_functions.py</div><div id='n_file'> N File Name: src/graphnet/components/loss_functions.py</div><div id='m_start'> M Start Line: 190</div><div id='m_end'> M End Line: 198</div><div id='n_start'> N Start Line: 190</div><div id='n_end'> N End Line: 197</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        &#47&#47 Ensure continuity at `kappa_switch`
        offset = cls.log_cmk_approx(m, kappa_switch) - cls.log_cmk_exact(m, kappa_switch)
        <a id="change">return </a><a id="change">torch.where(
            </a><a id="change">kappa &lt; kappa_switch</a>,
            <a id="change">cls.log_cmk_exact(</a>m, kappa<a id="change">)</a>,
            <a id="change">cls.log_cmk_approx(</a>m, kappa<a id="change">) - </a>offset<a id="change">,
        )</a>

    def _evaluate(self, prediction: Tensor, target: Tensor) -&gt; Tensor:
        Calculates the von Mises-Fisher loss for a vector in D-dimensonal space.
</code></pre><h3>After Change</h3><pre><code class='java'>
        ensuring continuity at this point.
        
        kappa_switch = torch.tensor([kappa_switch]).to(kappa.device)
        <a id="change">mask_exact = </a><a id="change">(kappa &lt; kappa_switch)</a>

        &#47&#47 Ensure continuity at `kappa_switch`
        offset = cls.log_cmk_approx(m, kappa_switch) - cls.log_cmk_exact(m, kappa_switch)
        <a id="change">ret = </a><a id="change">cls.log_cmk_approx(</a>m, kappa<a id="change">) - </a>offset
        <a id="change">ret[mask_exact] = </a><a id="change">cls.log_cmk_exact(</a>m, <a id="change">kappa[mask_exact]</a><a id="change">)</a>
        <a id="change">return </a>ret

    def _evaluate(self, prediction: Tensor, target: Tensor) -&gt; Tensor:
        Calculates the von Mises-Fisher loss for a vector in D-dimensonal space.</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/icecube/graphnet/commit/3aeecfe4ff8f1ea1bdd682e79b72f078ac4bfb93#diff-54d337be01412c43b21943d0f7477629f3271da5f20b06757918c472755640adL182' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 66177858</div><div id='project'> Project Name: icecube/graphnet</div><div id='commit'> Commit Name: 3aeecfe4ff8f1ea1bdd682e79b72f078ac4bfb93</div><div id='time'> Time: 2022-01-06</div><div id='author'> Author: andreas.sogaard@gmail.com</div><div id='file'> File Name: src/graphnet/components/loss_functions.py</div><div id='m_class'> M Class Name: VonMisesFisherLoss</div><div id='n_method'> N Class Name: VonMisesFisherLoss</div><div id='m_method'> M Method Name: log_cmk(4)</div><div id='n_method'> N Method Name: log_cmk(4)</div><div id='m_parent_class'> M Parent Class: LossFunction</div><div id='n_parent_class'> N Parent Class: LossFunction</div><div id='m_file'> M File Name: src/graphnet/components/loss_functions.py</div><div id='n_file'> N File Name: src/graphnet/components/loss_functions.py</div><div id='m_start'> M Start Line: 190</div><div id='m_end'> M End Line: 198</div><div id='n_start'> N Start Line: 190</div><div id='n_end'> N End Line: 197</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        &#47&#47 Ensure continuity at `kappa_switch`
        offset = cls.log_cmk_approx(m, kappa_switch) - cls.log_cmk_exact(m, kappa_switch)
        <a id="change">return </a><a id="change">torch.where(
            </a><a id="change">kappa &lt; kappa_switch</a>,
            <a id="change">cls.log_cmk_exact(</a>m, kappa<a id="change">)</a>,
            <a id="change">cls.log_cmk_approx(</a>m, kappa<a id="change">) - </a>offset<a id="change">,
        )</a>

    def _evaluate(self, prediction: Tensor, target: Tensor) -&gt; Tensor:
        Calculates the von Mises-Fisher loss for a vector in D-dimensonal space.
</code></pre><h3>After Change</h3><pre><code class='java'>
        ensuring continuity at this point.
        
        kappa_switch = torch.tensor([kappa_switch]).to(kappa.device)
        <a id="change">mask_exact = </a><a id="change">(kappa &lt; kappa_switch)</a>

        &#47&#47 Ensure continuity at `kappa_switch`
        offset = cls.log_cmk_approx(m, kappa_switch) - cls.log_cmk_exact(m, kappa_switch)
        <a id="change">ret = </a><a id="change">cls.log_cmk_approx(</a>m, kappa<a id="change">) - </a>offset
        <a id="change">ret[mask_exact] = </a><a id="change">cls.log_cmk_exact(</a>m, <a id="change">kappa[mask_exact]</a><a id="change">)</a>
        <a id="change">return </a>ret

    def _evaluate(self, prediction: Tensor, target: Tensor) -&gt; Tensor:
        Calculates the von Mises-Fisher loss for a vector in D-dimensonal space.</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/icecube/graphnet/commit/14acdd3ac5573e07523726df6e717bb015fe5391#diff-54d337be01412c43b21943d0f7477629f3271da5f20b06757918c472755640adL182' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 66177860</div><div id='project'> Project Name: icecube/graphnet</div><div id='commit'> Commit Name: 14acdd3ac5573e07523726df6e717bb015fe5391</div><div id='time'> Time: 2022-01-06</div><div id='author'> Author: andreas.sogaard@gmail.com</div><div id='file'> File Name: src/graphnet/components/loss_functions.py</div><div id='m_class'> M Class Name: VonMisesFisherLoss</div><div id='n_method'> N Class Name: VonMisesFisherLoss</div><div id='m_method'> M Method Name: log_cmk(4)</div><div id='n_method'> N Method Name: log_cmk(4)</div><div id='m_parent_class'> M Parent Class: LossFunction</div><div id='n_parent_class'> N Parent Class: LossFunction</div><div id='m_file'> M File Name: src/graphnet/components/loss_functions.py</div><div id='n_file'> N File Name: src/graphnet/components/loss_functions.py</div><div id='m_start'> M Start Line: 190</div><div id='m_end'> M End Line: 198</div><div id='n_start'> N Start Line: 190</div><div id='n_end'> N End Line: 197</div><BR>