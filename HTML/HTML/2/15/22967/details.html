<html><h3>Pattern ID :22967
</h3><img src='72963771.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    )

    if additional_formats:
        <a id="change">spec_path = </a><a id="change">os.path.join(</a>output, <a id="change">"rdf.yaml"</a><a id="change">)</a>
        <a id="change">for </a>add_format in additional_formats<a id="change">:
            </a><a id="change">if add_format == "onnx"</a>:
                <a id="change">convert_to_onnx(spec_path</a><a id="change">)</a>
            elif <a id="change">add_format == "torchscript"</a>:
                <a id="change">convert_to_pytorch_script(spec_path</a><a id="change">)</a>


if __name__ == &quot__main__&quot:
    parser = argparse.ArgumentParser()</code></pre><h3>After Change</h3><pre><code class='java'>
    tags += ["boundary-prediction"] if is_aff_model else ["affinity-prediction"]

    &#47&#47 eventually we should refactor the citation logic
    cite = <a id="change">get_default_citations(
        model="AnisotropicUNet", model_output="affinities" if is_aff_model else "boundaries"
    )</a>
    cite["data"] = "https://cremi.org"

    doc = _get_doc(is_aff_model)
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 7</div><BR><div id='size'>Non-data size: 10</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/constantinpape/torch-em/commit/eccf8dda0d1d121b22eae55f3747aff53f27ad2b#diff-1a83fa01ca65cb24e0c9b5ac157e820b99d2cf296cbf3d2d992db5c592c5044dL59' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 72963771</div><div id='project'> Project Name: constantinpape/torch-em</div><div id='commit'> Commit Name: eccf8dda0d1d121b22eae55f3747aff53f27ad2b</div><div id='time'> Time: 2021-07-15</div><div id='author'> Author: constantin.pape@embl.de</div><div id='file'> File Name: experiments/neuron-segmentation/cremi/export_bioimageio_model.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: export_to_bioimageio(5)</div><div id='n_method'> N Method Name: export_to_bioimageio(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: experiments/neuron-segmentation/cremi/export_bioimageio_model.py</div><div id='n_file'> N File Name: experiments/neuron-segmentation/cremi/export_bioimageio_model.py</div><div id='m_start'> M Start Line: 59</div><div id='m_end'> M End Line: 102</div><div id='n_start'> N Start Line: 72</div><div id='n_end'> N End Line: 93</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        for_deepimagej="torchscript" in additional_formats
    )

    <a id="change">spec_path = </a><a id="change">os.path.join(</a>output, <a id="change">"rdf.yaml"</a><a id="change">)</a>
    <a id="change">for </a><a id="change">add_format</a> in additional_formats<a id="change">:
        </a><a id="change">if add_format == "onnx"</a>:
            <a id="change">convert_to_onnx(</a>spec_path<a id="change">)</a>
        elif <a id="change">add_format == "torchscript"</a>:
            <a id="change">convert_to_pytorch_script(</a>spec_path<a id="change">)</a>


if __name__ == &quot__main__&quot:
    parser = argparse.ArgumentParser()</code></pre><h3>After Change</h3><pre><code class='java'>

    &#47&#47 eventually we should refactor the citation logic
    plantseg_pub = "https://doi.org/10.7554/eLife.57613.sa2"
    cite = <a id="change">get_default_citations(
        model="UNet2d" if is2d else "UNet3d", model_output="affinities" if is_aff_model else "boundaries"
    )</a>
    cite["data"] = plantseg_pub
    cite["segmentation algorithm"] = plantseg_pub

    doc = _get_doc(is_aff_model, specimen)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/constantinpape/torch-em/commit/eccf8dda0d1d121b22eae55f3747aff53f27ad2b#diff-b8d932450cc65ecfb298cfa5b59218ee92620bf653c9ae225f7f709273e4ae41L54' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 72963785</div><div id='project'> Project Name: constantinpape/torch-em</div><div id='commit'> Commit Name: eccf8dda0d1d121b22eae55f3747aff53f27ad2b</div><div id='time'> Time: 2021-07-15</div><div id='author'> Author: constantin.pape@embl.de</div><div id='file'> File Name: experiments/plantseg/export_bioimageio_model.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: export_to_bioimageio(5)</div><div id='n_method'> N Method Name: export_to_bioimageio(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: experiments/plantseg/export_bioimageio_model.py</div><div id='n_file'> N File Name: experiments/plantseg/export_bioimageio_model.py</div><div id='m_start'> M Start Line: 66</div><div id='m_end'> M End Line: 114</div><div id='n_start'> N Start Line: 83</div><div id='n_end'> N End Line: 108</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        for_deepimagej="torchscript" in additional_formats
    )

    <a id="change">spec_path = </a><a id="change">os.path.join(</a>output, <a id="change">"rdf.yaml"</a><a id="change">)</a>
    <a id="change">for </a><a id="change">add_format</a> in additional_formats<a id="change">:
        </a><a id="change">if add_format == "onnx"</a>:
            <a id="change">convert_to_onnx(</a>spec_path<a id="change">)</a>
        elif <a id="change">add_format == "torchscript"</a>:
            <a id="change">convert_to_pytorch_script(</a>spec_path<a id="change">)</a>


if __name__ == &quot__main__&quot:
    &#47&#47 TODO refactor this into a parser helper</code></pre><h3>After Change</h3><pre><code class='java'>
    tags += ["boundary-prediction"] if is_aff_model else ["affinity-prediction"]

    &#47&#47 eventually we should refactor the citation logic
    cite = <a id="change">get_default_citations(
        model="UNet2d", model_output="affinities" if is_aff_model else "boundaries"
    )</a>
    cite["data"] = "https://www.nature.com/articles/s41592-019-0612-7"

    doc = _get_doc(is_aff_model)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/constantinpape/torch-em/commit/eccf8dda0d1d121b22eae55f3747aff53f27ad2b#diff-dab184752d045d2968f1d4d9bb9e714014b5a7792c8c139dba44ff662d8640a8L42' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 72963784</div><div id='project'> Project Name: constantinpape/torch-em</div><div id='commit'> Commit Name: eccf8dda0d1d121b22eae55f3747aff53f27ad2b</div><div id='time'> Time: 2021-07-15</div><div id='author'> Author: constantin.pape@embl.de</div><div id='file'> File Name: experiments/dsb/export_bioimageio_model.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: export_to_bioimageio(5)</div><div id='n_method'> N Method Name: export_to_bioimageio(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: experiments/dsb/export_bioimageio_model.py</div><div id='n_file'> N File Name: experiments/dsb/export_bioimageio_model.py</div><div id='m_start'> M Start Line: 50</div><div id='m_end'> M End Line: 94</div><div id='n_start'> N Start Line: 63</div><div id='n_end'> N End Line: 86</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    )

    if additional_formats:
        <a id="change">spec_path = </a><a id="change">os.path.join(</a>output, <a id="change">"rdf.yaml"</a><a id="change">)</a>
        <a id="change">for </a><a id="change">add_format</a> in additional_formats<a id="change">:
            </a><a id="change">if add_format == "onnx"</a>:
                <a id="change">convert_to_onnx(</a>spec_path<a id="change">)</a>
            elif <a id="change">add_format == "torchscript"</a>:
                <a id="change">convert_to_pytorch_script(</a>spec_path<a id="change">)</a>


if __name__ == &quot__main__&quot:
    parser = argparse.ArgumentParser()</code></pre><h3>After Change</h3><pre><code class='java'>
    tags += ["boundary-prediction"] if is_aff_model else ["affinity-prediction"]

    &#47&#47 eventually we should refactor the citation logic
    cite = <a id="change">get_default_citations(
        model="AnisotropicUNet", model_output="affinities" if is_aff_model else "boundaries"
    )</a>
    cite["data"] = "https://cremi.org"

    doc = _get_doc(is_aff_model)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/constantinpape/torch-em/commit/eccf8dda0d1d121b22eae55f3747aff53f27ad2b#diff-1a83fa01ca65cb24e0c9b5ac157e820b99d2cf296cbf3d2d992db5c592c5044dL50' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 72963787</div><div id='project'> Project Name: constantinpape/torch-em</div><div id='commit'> Commit Name: eccf8dda0d1d121b22eae55f3747aff53f27ad2b</div><div id='time'> Time: 2021-07-15</div><div id='author'> Author: constantin.pape@embl.de</div><div id='file'> File Name: experiments/neuron-segmentation/cremi/export_bioimageio_model.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: export_to_bioimageio(5)</div><div id='n_method'> N Method Name: export_to_bioimageio(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: experiments/neuron-segmentation/cremi/export_bioimageio_model.py</div><div id='n_file'> N File Name: experiments/neuron-segmentation/cremi/export_bioimageio_model.py</div><div id='m_start'> M Start Line: 59</div><div id='m_end'> M End Line: 102</div><div id='n_start'> N Start Line: 72</div><div id='n_end'> N End Line: 93</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    )

    if additional_formats:
        <a id="change">spec_path = </a><a id="change">os.path.join(</a>output, <a id="change">"rdf.yaml"</a><a id="change">)</a>
        <a id="change">for </a><a id="change">add_format</a> in additional_formats<a id="change">:
            </a><a id="change">if add_format == "onnx"</a>:
                <a id="change">convert_to_onnx(</a>spec_path<a id="change">)</a>
            elif <a id="change">add_format == "torchscript"</a>:
                <a id="change">convert_to_pytorch_script(</a>spec_path<a id="change">)</a>


if __name__ == &quot__main__&quot:
    parser = argparse.ArgumentParser()</code></pre><h3>After Change</h3><pre><code class='java'>
    tags = ["u-net", f"{organelle}-segmentation", "segmentation", "volume-em", "platynereis", organelle]
    tags += ["boundary-prediction"] if is_aff_model else ["affinity-prediction"]

    cite = <a id="change">get_default_citations(
        model="AnisotropicUNet",
        model_output="affinities" if is_aff_model else "boundaries"
    )</a>
    cite["data"] = "https://doi.org/10.1101/2020.02.26.961037"

    doc = _get_doc(is_aff_model, organelle)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/constantinpape/torch-em/commit/eccf8dda0d1d121b22eae55f3747aff53f27ad2b#diff-01fee40c60b4192927a66b02834a42ef0ff8ebd84fbb11985d38e8b0eb7d1fc3L52' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 72963770</div><div id='project'> Project Name: constantinpape/torch-em</div><div id='commit'> Commit Name: eccf8dda0d1d121b22eae55f3747aff53f27ad2b</div><div id='time'> Time: 2021-07-15</div><div id='author'> Author: constantin.pape@embl.de</div><div id='file'> File Name: experiments/platynereis/export_bioimageio_model.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: export_to_bioimageio(5)</div><div id='n_method'> N Method Name: export_to_bioimageio(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: experiments/platynereis/export_bioimageio_model.py</div><div id='n_file'> N File Name: experiments/platynereis/export_bioimageio_model.py</div><div id='m_start'> M Start Line: 63</div><div id='m_end'> M End Line: 109</div><div id='n_start'> N Start Line: 78</div><div id='n_end'> N End Line: 100</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        for_deepimagej="torchscript" in additional_formats
    )

    <a id="change">spec_path = </a><a id="change">os.path.join(</a>output, <a id="change">"rdf.yaml"</a><a id="change">)</a>
    <a id="change">for </a><a id="change">add_format</a> in additional_formats<a id="change">:
        </a><a id="change">if add_format == "onnx"</a>:
            <a id="change">convert_to_onnx(</a>spec_path<a id="change">)</a>
        elif <a id="change">add_format == "torchscript"</a>:
            <a id="change">convert_to_pytorch_script(</a>spec_path<a id="change">)</a>


if __name__ == &quot__main__&quot:
    parser = argparse.ArgumentParser()</code></pre><h3>After Change</h3><pre><code class='java'>
    tags = ["u-net", "neuron-segmentation", "segmentation", "volume-em", "isbi2012-challenge"]
    tags += ["boundary-prediction"] if is_aff_model else ["affinity-prediction"]

    cite = <a id="change">get_default_citations(
        model="UNet2d" if ndim == 2 else "AnisotropicUNet",
        model_output="affinities" if is_aff_model else "boundaries"
    )</a>
    cite["data"] = "https://doi.org/10.3389/fnana.2015.00142"
    doc = _get_doc(is_aff_model, ndim)

    export_biomageio_model(</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/constantinpape/torch-em/commit/77e1718b025567a1d3f422ff9bb5fd2c6c6fd1b6#diff-76596b10b022b87dd1043feb5e32bc45c69e3a4ec885a6195b131457bbc36117L55' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 72963772</div><div id='project'> Project Name: constantinpape/torch-em</div><div id='commit'> Commit Name: 77e1718b025567a1d3f422ff9bb5fd2c6c6fd1b6</div><div id='time'> Time: 2021-07-14</div><div id='author'> Author: constantin.pape@embl.de</div><div id='file'> File Name: experiments/neuron-segmentation/isbi2012/export_bioimageio_model.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: export_to_bioimageio(5)</div><div id='n_method'> N Method Name: export_to_bioimageio(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: experiments/neuron-segmentation/isbi2012/export_bioimageio_model.py</div><div id='n_file'> N File Name: experiments/neuron-segmentation/isbi2012/export_bioimageio_model.py</div><div id='m_start'> M Start Line: 59</div><div id='m_end'> M End Line: 107</div><div id='n_start'> N Start Line: 74</div><div id='n_end'> N End Line: 95</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        for_deepimagej="torchscript" in additional_formats
    )

    <a id="change">spec_path = </a><a id="change">os.path.join(</a>output, <a id="change">"rdf.yaml"</a><a id="change">)</a>
    <a id="change">for </a><a id="change">add_format</a> in additional_formats<a id="change">:
        </a><a id="change">if add_format == "onnx"</a>:
            <a id="change">convert_to_onnx(</a>spec_path<a id="change">)</a>
        elif <a id="change">add_format == "torchscript"</a>:
            <a id="change">convert_to_pytorch_script(</a>spec_path<a id="change">)</a>


if __name__ == &quot__main__&quot:
    parser = argparse.ArgumentParser()</code></pre><h3>After Change</h3><pre><code class='java'>
    tags += ["boundary-prediction"] if is_aff_model else ["affinity-prediction"]

    &#47&#47 eventually we should refactor the citation logic
    cite = <a id="change">get_default_citations(
        model="AnisotropicUNet",
        model_output="affinities" if is_aff_model else "boundaries"
    )</a>
    cite["data"] = "https://doi.org/10.1007/978-3-030-59722-1_7"

    doc = _get_doc(is_aff_model)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/constantinpape/torch-em/commit/77e1718b025567a1d3f422ff9bb5fd2c6c6fd1b6#diff-1a906b3aaee5de3028e716c426db408449f0369544074ed89adb9fc635af6966L40' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 72963774</div><div id='project'> Project Name: constantinpape/torch-em</div><div id='commit'> Commit Name: 77e1718b025567a1d3f422ff9bb5fd2c6c6fd1b6</div><div id='time'> Time: 2021-07-14</div><div id='author'> Author: constantin.pape@embl.de</div><div id='file'> File Name: experiments/mito-em/export_bioimageio_model.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: export_to_bioimageio(5)</div><div id='n_method'> N Method Name: export_to_bioimageio(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: experiments/mito-em/export_bioimageio_model.py</div><div id='n_file'> N File Name: experiments/mito-em/export_bioimageio_model.py</div><div id='m_start'> M Start Line: 40</div><div id='m_end'> M End Line: 97</div><div id='n_start'> N Start Line: 40</div><div id='n_end'> N End Line: 90</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        for_deepimagej="torchscript" in additional_formats
    )

    <a id="change">spec_path = </a><a id="change">os.path.join(</a>output, <a id="change">"rdf.yaml"</a><a id="change">)</a>
    <a id="change">for </a><a id="change">add_format</a> in additional_formats<a id="change">:
        </a><a id="change">if add_format == "onnx"</a>:
            <a id="change">convert_to_onnx(</a>spec_path<a id="change">)</a>
        elif <a id="change">add_format == "torchscript"</a>:
            <a id="change">convert_to_pytorch_script(</a>spec_path<a id="change">)</a>


if __name__ == &quot__main__&quot:
    &#47&#47 TODO refactor this into a parser helper</code></pre><h3>After Change</h3><pre><code class='java'>

    &#47&#47 eventually we should refactor the citation logic
    covid_if_pub = "https://doi.org/10.1002/bies.202000257"
    cite = <a id="change">get_default_citations(
        model="UNet2d", model_output="affinities" if is_aff_model else "boundaries"
    )</a>
    cite["data"] = covid_if_pub
    if not is_aff_model:
        cite["segmentation algorithm"] = covid_if_pub
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/constantinpape/torch-em/commit/eccf8dda0d1d121b22eae55f3747aff53f27ad2b#diff-c1b71af8a8e5153c9ee2f0e7d92c12e34eb0b5048734649f236b0aa16643309dL40' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 72963777</div><div id='project'> Project Name: constantinpape/torch-em</div><div id='commit'> Commit Name: eccf8dda0d1d121b22eae55f3747aff53f27ad2b</div><div id='time'> Time: 2021-07-15</div><div id='author'> Author: constantin.pape@embl.de</div><div id='file'> File Name: experiments/covid-if/export_bioimageio_model.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: export_to_bioimageio(5)</div><div id='n_method'> N Method Name: export_to_bioimageio(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: experiments/covid-if/export_bioimageio_model.py</div><div id='n_file'> N File Name: experiments/covid-if/export_bioimageio_model.py</div><div id='m_start'> M Start Line: 49</div><div id='m_end'> M End Line: 97</div><div id='n_start'> N Start Line: 50</div><div id='n_end'> N End Line: 90</div><BR>