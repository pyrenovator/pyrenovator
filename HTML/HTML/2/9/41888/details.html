<html><h3>Pattern ID :41888
</h3><img src='117428991.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        for i in range(B):
            &#47&#47 expand to ---  no, c, h, w
            _k4e, _v4e = k4[i].expand(n_objects[i], -1, -1,
                                      -1), <a id="change">v4[i].expand(n_objects[i]</a>, -1, <a id="change">-1</a>, <a id="change">-1</a><a id="change">)</a>
            _r3e, _r2e = r3[i].expand(n_objects[i], -1, -1,
                                      -1), r2[i].expand(n_objects[i], -1, -1, -1)
            _key = keys[i, 1:n_objects[i] + 1]
            _value = values[i, 1:n_objects[i] + 1]</code></pre><h3>After Change</h3><pre><code class='java'>
        for i in range(B):
            &#47&#47 expand to ---  no, c, h, w
            _k4e = k4[i].expand(n_objects[i], -1, -1, -1)
            _v4e<a id="change"> = </a><a id="change">v4[i].expand(n_objects[i]</a>, -1, <a id="change">-1</a>, <a id="change">-1</a><a id="change">)</a>
            _r3e = r3[i].expand(n_objects[i], -1, -1, -1)
            _r2e = r2[i].expand(n_objects[i], -1, -1, -1)
            _key = keys[i, 1:n_objects[i] + 1]
            _value = values[i, 1:n_objects[i] + 1]</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/hzxie/rmnet/commit/58588f7d6e836bba85f46437150e5e62c3998992#diff-086109d7d67f119dd8c55e6ca645e7f71af66a013cd5dbfe1c453292f58a01bfL320' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 117428991</div><div id='project'> Project Name: hzxie/rmnet</div><div id='commit'> Commit Name: 58588f7d6e836bba85f46437150e5e62c3998992</div><div id='time'> Time: 2020-07-12</div><div id='author'> Author: root@haozhexie.com</div><div id='file'> File Name: models/stm.py</div><div id='m_class'> M Class Name: STM</div><div id='n_method'> N Class Name: STM</div><div id='m_method'> M Method Name: segment(5)</div><div id='n_method'> N Method Name: segment(5)</div><div id='m_parent_class'> M Parent Class: torch.nn.Module</div><div id='n_parent_class'> N Parent Class: torch.nn.Module</div><div id='m_file'> M File Name: models/stm.py</div><div id='n_file'> N File Name: models/stm.py</div><div id='m_start'> M Start Line: 320</div><div id='m_end'> M End Line: 323</div><div id='n_start'> N Start Line: 320</div><div id='n_end'> N End Line: 323</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            _k4e, _v4e = k4[i].expand(n_objects[i], -1, -1,
                                      -1), v4[i].expand(n_objects[i], -1, -1, -1)
            _r3e, _r2e = r3[i].expand(n_objects[i], -1, -1,
                                      -1), <a id="change">r2[i].expand(n_objects[i]</a>, -1, <a id="change">-1</a>, <a id="change">-1</a><a id="change">)</a>
            _key = keys[i, 1:n_objects[i] + 1]
            _value = values[i, 1:n_objects[i] + 1]
            &#47&#47 print(_k4e.shape) &#47&#47 torch.Size([n_objects, 128, 30, 57])
            &#47&#47 print(_v4e.shape) &#47&#47 torch.Size([n_objects, 512, 30, 57])</code></pre><h3>After Change</h3><pre><code class='java'>
        for i in range(B):
            _r4e = r4[i].expand(n_objects[i], -1, -1, -1)
            _r3e = r3[i].expand(n_objects[i], -1, -1, -1)
            _r2e<a id="change"> = </a><a id="change">r2[i].expand(n_objects[i]</a>, -1, <a id="change">-1</a>, <a id="change">-1</a><a id="change">)</a>
            &#47&#47 print(_r4e.shape) &#47&#47 torch.Size([n_objects, 1024, 30, 57])
            &#47&#47 print(_r3e.shape) &#47&#47 torch.Size([n_objects, 512, 60, 114])
            &#47&#47 print(_r2e.shape) &#47&#47 torch.Size([n_objects, 256, 120, 228])
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hzxie/rmnet/commit/69815437b1b170901900d8efd3933ae5b815c928#diff-086109d7d67f119dd8c55e6ca645e7f71af66a013cd5dbfe1c453292f58a01bfL278' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 117428988</div><div id='project'> Project Name: hzxie/rmnet</div><div id='commit'> Commit Name: 69815437b1b170901900d8efd3933ae5b815c928</div><div id='time'> Time: 2020-04-28</div><div id='author'> Author: root@haozhexie.com</div><div id='file'> File Name: models/stm.py</div><div id='m_class'> M Class Name: STM</div><div id='n_method'> N Class Name: STM</div><div id='m_method'> M Method Name: segment(6)</div><div id='n_method'> N Method Name: segment(5)</div><div id='m_parent_class'> M Parent Class: torch.nn.Module</div><div id='n_parent_class'> N Parent Class: torch.nn.Module</div><div id='m_file'> M File Name: models/stm.py</div><div id='n_file'> N File Name: models/stm.py</div><div id='m_start'> M Start Line: 288</div><div id='m_end'> M End Line: 312</div><div id='n_start'> N Start Line: 278</div><div id='n_end'> N End Line: 317</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            notes: LongTensor[batch, time]
        
        x = self.emb(notes) &#47&#47 batch, time, emb_size
        h, _ = self.rnn(x, <a id="change">self.h0[None].expand(1</a>, <a id="change">x.shape[0]</a>, <a id="change">-1</a><a id="change">)</a>) &#47&#47batch, time, hidden_size
        logits = self.proj(h[:,:-1]) &#47&#47 batch, time-1, 128
        logits = F.log_softmax(logits, -1) &#47&#47 logits = logits - logits.logsumexp(-1, keepdim=True)
        targets = notes[:,1:,None] &#47&#47batch, time-1, 1</code></pre><h3>After Change</h3><pre><code class='java'>
            notes: LongTensor[batch, time]
        
        x = self.emb(notes) &#47&#47 batch, time, emb_size
        h0 = <a id="change">self.h0[None].expand(1</a>, <a id="change">x.shape[0]</a>, <a id="change">-1</a><a id="change">)</a>.contiguous() &#47&#47 1 x batch x hidden_size
        h<a id="change">, _ = </a>self.rnn(x, h0) &#47&#47batch, time, hidden_size
        logits = self.proj(h[:,:-1]) &#47&#47 batch, time-1, 128
        logits = F.log_softmax(logits, -1) &#47&#47 logits = logits - logits.logsumexp(-1, keepdim=True)
        targets = notes[:,1:,None] &#47&#47batch, time-1, 1</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/intelligent-instruments-lab/iil-python-tools/commit/d2354c1ab3771fda885583859cbfe6fec08b064d#diff-40cd3638789a4762e91c747bb354a0f97a8c9b7cfa59a76105a95a39e5005cecL33' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 117429018</div><div id='project'> Project Name: intelligent-instruments-lab/iil-python-tools</div><div id='commit'> Commit Name: d2354c1ab3771fda885583859cbfe6fec08b064d</div><div id='time'> Time: 2022-02-22</div><div id='author'> Author: victor.shepardson@gmail.com</div><div id='file'> File Name: notepredictor/notepredictor/model.py</div><div id='m_class'> M Class Name: PitchPredictor</div><div id='n_method'> N Class Name: PitchPredictor</div><div id='m_method'> M Method Name: forward(2)</div><div id='n_method'> N Method Name: forward(2)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: notepredictor/notepredictor/model.py</div><div id='n_file'> N File Name: notepredictor/notepredictor/model.py</div><div id='m_start'> M Start Line: 38</div><div id='m_end'> M End Line: 39</div><div id='n_start'> N Start Line: 38</div><div id='n_end'> N End Line: 40</div><BR>