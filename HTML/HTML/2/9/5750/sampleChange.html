<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                        num_hosts, num_devices_per_host, "all")
                    for num_micro_batches in cases:
                        for i in range(num_runs):
                            (num_devices<a id="change">, num_autosharding_configs,
                             compute_cost,
                             max_n_succ_stages</a>) = test_stage_construction(
                                 submesh_choices, num_hosts,
                                 num_devices_per_host, num_layers,
                                 max_n_succ_stages_n)</code></pre><h3>After Change</h3><pre><code class='java'>
                        num_hosts, num_devices_per_host, "all")
                    for num_micro_batches in [1, 16, 512]:
                        for i in range(num_runs):
                            compute_cost_factor = np.random.rand()<a id="change"> * 4</a> - 2
                            device_memory_size_factor = np.random.rand() * 4
                            num_devices<a id="change"> = </a>num_hosts * num_devices_per_host
                            num_autosharding_configs<a id="change"> = </a><a id="change">np.random.randint(1</a>, <a id="change">5</a><a id="change">)</a>
                            (compute_cost, max_n_succ_stages
                            ) = generate_stage_construction_test_case(
                                num_devices, submesh_choices, num_layers,
                                num_autosharding_configs, compute_cost_factor,</code></pre>