<html><h3>Pattern ID :5750
</h3><img src='20129457.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                        num_hosts, num_devices_per_host, "all")
                    for num_micro_batches in cases:
                        for i in range(num_runs):
                            (num_devices<a id="change">, num_autosharding_configs,
                             compute_cost,
                             max_n_succ_stages</a>) = test_stage_construction(
                                 submesh_choices, num_hosts,
                                 num_devices_per_host, num_layers,
                                 max_n_succ_stages_n)</code></pre><h3>After Change</h3><pre><code class='java'>
                        num_hosts, num_devices_per_host, "all")
                    for num_micro_batches in [1, 16, 512]:
                        for i in range(num_runs):
                            compute_cost_factor = np.random.rand()<a id="change"> * 4</a> - 2
                            device_memory_size_factor = np.random.rand() * 4
                            num_devices<a id="change"> = </a>num_hosts * num_devices_per_host
                            num_autosharding_configs<a id="change"> = </a><a id="change">np.random.randint(1</a>, <a id="change">5</a><a id="change">)</a>
                            (compute_cost, max_n_succ_stages
                            ) = generate_stage_construction_test_case(
                                num_devices, submesh_choices, num_layers,
                                num_autosharding_configs, compute_cost_factor,</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/alpa-projects/alpa/commit/91e13b2a0499bf1e8b10f73935ff89c4b652031f#diff-6bd1810fbe078267199f4462a1a2b19d1d3f3e7359b4c649ebf65eae587a8577L30' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 20129457</div><div id='project'> Project Name: alpa-projects/alpa</div><div id='commit'> Commit Name: 91e13b2a0499bf1e8b10f73935ff89c4b652031f</div><div id='time'> Time: 2022-08-26</div><div id='author'> Author: zhuohan123@gmail.com</div><div id='file'> File Name: tests/pipeline_parallel/test_old_dp_vs_new_dp.py</div><div id='m_class'> M Class Name: OldNewDPTest</div><div id='n_method'> N Class Name: OldNewDPTest</div><div id='m_method'> M Method Name: test_dp(1)</div><div id='n_method'> N Method Name: test_dp(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: tests/pipeline_parallel/test_old_dp_vs_new_dp.py</div><div id='n_file'> N File Name: tests/pipeline_parallel/test_old_dp_vs_new_dp.py</div><div id='m_start'> M Start Line: 30</div><div id='m_end'> M End Line: 58</div><div id='n_start'> N Start Line: 76</div><div id='n_end'> N End Line: 106</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        for box in boxs:
            cv2.rectangle(img, (int(box[0]), int(box[1])),
                          (int(box[2]), int(box[3])), (0<a id="change">, 255, 0</a>), 2)
            cv2.putText(img, box[-1],
                        (int(box[0]), int(box[1])), cv2.FONT_HERSHEY_SIMPLEX, 1, (255, 255, 255), 2, cv2.LINE_AA)
            boundingBox = BoundingBox()</code></pre><h3>After Change</h3><pre><code class='java'>
        for i in boxs:
            count += 1

        for <a id="change">box</a> in boxs:
            boundingBox = BoundingBox()
            boundingBox.probability =np.float64(box[4])
            boundingBox.xmin = np.int64(box[0])
            boundingBox.ymin = np.int64(box[1])
            boundingBox.xmax = np.int64(box[2])
            boundingBox.ymax = np.int64(box[3])
            boundingBox.num = np.int16(count)
            boundingBox.Class = box[-1]

            if box[-1] in self.classes_colors.keys():
                color<a id="change"> = </a>self.classes_colors[box[-1]]
            else:
                color = <a id="change">np.random.randint(</a>0, <a id="change">183</a>, <a id="change">3</a><a id="change">)</a>
                self.classes_colors[box[-1]]<a id="change"> = </a>color

            cv2.rectangle(img, (int(box[0]), int(box[1])),
                          (int(box[2]), int(box[3])), (int(color[0]),int(color[1]), int(color[2])), 2)
            cv2.putText(img, box[-1],
                        (int(box[0]), int(box[1])<a id="change">-10</a>), cv2.FONT_HERSHEY_SIMPLEX, 0.6, (255, 255, 255), 2, cv2.LINE_AA)


            self.boundingBoxes.bounding_boxes.append(boundingBox)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/qq44642754a/yolov5_ros/commit/4a6b6e2d99238a0fd558ea4738cf8f02ad861c48#diff-4852216a3fb44a13b013340bea77dac248217539cf55a5a413e4afdd50ea2850L75' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 20129393</div><div id='project'> Project Name: qq44642754a/yolov5_ros</div><div id='commit'> Commit Name: 4a6b6e2d99238a0fd558ea4738cf8f02ad861c48</div><div id='time'> Time: 2022-02-17</div><div id='author'> Author: qq44642754@gmail.com</div><div id='file'> File Name: yolov5_ros/yolov5_ros/scripts/yolo_v5.py</div><div id='m_class'> M Class Name: Yolo_Dect</div><div id='n_method'> N Class Name: Yolo_Dect</div><div id='m_method'> M Method Name: dectshow(5)</div><div id='n_method'> N Method Name: dectshow(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: yolov5_ros/yolov5_ros/scripts/yolo_v5.py</div><div id='n_file'> N File Name: yolov5_ros/yolov5_ros/scripts/yolo_v5.py</div><div id='m_start'> M Start Line: 83</div><div id='m_end'> M End Line: 86</div><div id='n_start'> N Start Line: 85</div><div id='n_end'> N End Line: 104</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                        num_hosts, num_devices_per_host, "all")
                    for num_micro_batches in cases:
                        for i in range(num_runs):
                            (num_devices<a id="change">, num_autosharding_configs,
                             compute_cost,
                             max_n_succ_stages</a>) = test_stage_construction(
                                 submesh_choices, num_hosts,
                                 num_devices_per_host, num_layers,
                                 max_n_succ_stages_n)</code></pre><h3>After Change</h3><pre><code class='java'>
        num_runs = 2
        np.random.seed(0)

        for <a id="change">num_layers</a> in [4, 8]:
            for num_hosts in [1, 4]:
                for num_devices_per_host in [1, 4]:
                    submesh_choices = get_submesh_choices(
                        num_hosts, num_devices_per_host, "all")
                    for num_micro_batches in [1, 16, 512]:
                        for i in range(num_runs):
                            compute_cost_factor = np.random.rand()<a id="change"> * 4</a> - 2
                            device_memory_size_factor<a id="change"> = </a>np.random.rand() * 4
                            num_devices = num_hosts * num_devices_per_host
                            num_autosharding_configs<a id="change"> = </a><a id="change">np.random.randint(1</a>, <a id="change">5</a><a id="change">)</a>
                            (compute_cost, max_n_succ_stages
                            ) = generate_stage_construction_test_case(
                                num_devices, submesh_choices, num_layers,
                                num_autosharding_configs, compute_cost_factor,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/alpa-projects/alpa/commit/91e13b2a0499bf1e8b10f73935ff89c4b652031f#diff-6bd1810fbe078267199f4462a1a2b19d1d3f3e7359b4c649ebf65eae587a8577L29' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 20129456</div><div id='project'> Project Name: alpa-projects/alpa</div><div id='commit'> Commit Name: 91e13b2a0499bf1e8b10f73935ff89c4b652031f</div><div id='time'> Time: 2022-08-26</div><div id='author'> Author: zhuohan123@gmail.com</div><div id='file'> File Name: tests/pipeline_parallel/test_old_dp_vs_new_dp.py</div><div id='m_class'> M Class Name: OldNewDPTest</div><div id='n_method'> N Class Name: OldNewDPTest</div><div id='m_method'> M Method Name: test_dp(1)</div><div id='n_method'> N Method Name: test_dp(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: tests/pipeline_parallel/test_old_dp_vs_new_dp.py</div><div id='n_file'> N File Name: tests/pipeline_parallel/test_old_dp_vs_new_dp.py</div><div id='m_start'> M Start Line: 30</div><div id='m_end'> M End Line: 58</div><div id='n_start'> N Start Line: 76</div><div id='n_end'> N End Line: 106</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        cap.set(1, start)
        nb_frames = 0
        while True:
            ret<a id="change">, img</a> = cap.read()
            assert ret, &quotexception: {}, start={}, length={}&quot.format(path, start, length)
            if crop_augment: pass
            if mirror_augment: img = cv2.flip(img, 1)</code></pre><h3>After Change</h3><pre><code class='java'>
            else: img = np.zeros((112, 112, 3), dtype=np.uint8)
        if crop_augment:
            img = cv2.resize(img, (128, 128))
            if <a id="change">is_training</a>:
                crop_x = random.randint(0, 16)
                crop_y<a id="change"> = </a><a id="change">random.randint(0</a>, <a id="change">16</a><a id="change">)</a>
                img<a id="change"> = </a>img[crop_y: crop_y + 112, crop_x: crop_x<a id="change"> + 112</a>]
            else:
                img = img[8: 120, 8: 120]
        if mirror_augment and is_training: img = cv2.flip(img, 1)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/sailordiary/m3f.pytorch/commit/639f60090b44d3fdb3b40ae0df467ffed523da9e#diff-2730a8c5bd5549f02454fcdfd4a30faef0d608acd1627662eacd9e71c765c6feL46' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 20129397</div><div id='project'> Project Name: sailordiary/m3f.pytorch</div><div id='commit'> Commit Name: 639f60090b44d3fdb3b40ae0df467ffed523da9e</div><div id='time'> Time: 2020-02-01</div><div id='author'> Author: me@sailorzhang.com</div><div id='file'> File Name: models/dataset.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: load_video(7)</div><div id='n_method'> N Method Name: load_video(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: models/dataset.py</div><div id='n_file'> N File Name: models/dataset.py</div><div id='m_start'> M Start Line: 50</div><div id='m_end'> M End Line: 75</div><div id='n_start'> N Start Line: 47</div><div id='n_end'> N End Line: 70</div><BR>