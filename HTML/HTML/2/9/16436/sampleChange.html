<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

    def loss_unknown_structure(self, seq, pairs, score_paired, score_unpaired, pred_bp):
        pred_unpaired = torch.ones_like(score_unpaired, dtype=torch.bool)
        print(<a id="change">torch.max(</a>score_paired[1:, 1:]<a id="change">)</a>)
        for i, j in enumerate(pred_bp):
            if i &lt; j:
                pred_unpaired[i] = pred_unpaired[j] = False</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 print(score_unpaired)
        score_paired = 1 - score_unpaired
        &#47&#47print(pred_bp)
        <a id="change">pairs_not_nan = </a>torch.logical_not(torch.isnan(pairs))
        loss  = torch.sum(pairs[<a id="change">pairs_not_nan[:, 0]</a>, 0] * score_unpaired[pairs_not_nan[:, 0]])
        loss += torch.sum(pairs[pairs_not_nan[:, 1], 1] * score_paired[<a id="change">pairs_not_nan[:, 1]</a>])

        return loss
</code></pre>