<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
&#47&#47 use pipline to extract all the features, (num_points, max_seq_length, feature_dim): np.ndarray
def get_bert_features(bert_extractor, all_text):
    bert_feartures = bert_extractor(all_text)
    <a id="change">return </a><a id="change">np.array(</a>bert_feartures<a id="change">)</a>


&#47&#47 get raw text from the datasets
def get_rawtext(path, data_kind, vids=None):</code></pre><h3>After Change</h3><pre><code class='java'>
&#47&#47 contextual embedding:if True output the last hidden state of bert, if False, output the embedding of words
def get_bert_features(all_text, contextual_embedding=False):
    inputs = tokenizer(all_text, padding=True, truncation=True, return_tensors="pt")
    bert_feartures<a id="change"> = </a>bert(**inputs)
    outputs = bert_feartures.hidden_states
    <a id="change">if contextual_embedding</a>:
        return <a id="change">outputs[-1].detach().numpy()</a>
    else:
        <a id="change">return </a>outputs[0].detach().numpy()


&#47&#47 get raw text from the datasets</code></pre>