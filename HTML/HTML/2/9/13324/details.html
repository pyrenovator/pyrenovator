<html><h3>Pattern ID :13324
</h3><img src='45097781.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        with Flow.load_config(&quotflow-query.yml&quot) as f:
            f.use_rest_gateway()
            f.block()
    elif <a id="change">task == &quotquery_restful&quot</a>:
        if not os.path.exists(workspace):
            logger.warning(f&quotThe directory {workspace} does not exist. Please index first via `python app.py -t index`&quot)
        <a id="change">query_restful()</a>
    elif task == &quotdryrun&quot:
        dryrun()

</code></pre><h3>After Change</h3><pre><code class='java'>
                    \n +------------------------------------------------------------------------------------+&quot
            )
            sys.exit(1)
    if <a id="change">&quotquery&quot in task</a> and not os.path.exists(workspace):
        logger.info(f"The directory {workspace} does not exist. Please index first via `python app.py -t index`")
        sys.exit(1)
    logger.info(f&quot&#47&#47&#47&#47&#47&#47 task = {task}&quot)
    if task == &quotindex&quot:
        index(data_set, num_docs, request_size)
    if <a id="change">task == &quotquery_restful&quot</a>:
        <a id="change">query_restful()</a>


if __name__ == &quot__main__&quot:
    main()</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/jina-ai/examples/commit/daef97343259340be474fd5e3f55f578bcf176c9#diff-65875dec66851abea420703f90a17205ba13845961aa9059e9fff70a4f2b910cL73' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 45097781</div><div id='project'> Project Name: jina-ai/examples</div><div id='commit'> Commit Name: daef97343259340be474fd5e3f55f578bcf176c9</div><div id='time'> Time: 2021-05-20</div><div id='author'> Author: nan.wang@jina.ai</div><div id='file'> File Name: cross-modal-search/app.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(5)</div><div id='n_method'> N Method Name: main(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: cross-modal-search/app.py</div><div id='n_file'> N File Name: cross-modal-search/app.py</div><div id='m_start'> M Start Line: 90</div><div id='m_end'> M End Line: 110</div><div id='n_start'> N Start Line: 73</div><div id='n_end'> N End Line: 82</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if not os.path.exists(workspace):
            print(f&quotThe directory {workspace} does not exist. Please index first via `python app.py -t index`&quot)
        query(top_k)
    if <a id="change">task == &quotquery_restful&quot</a>:
        if not os.path.exists(workspace):
            print(f&quotThe directory {workspace} does not exist. Please index first via `python app.py -t index`&quot)
        <a id="change">query_restful()</a>


if __name__ == &quot__main__&quot:
    main()</code></pre><h3>After Change</h3><pre><code class='java'>
                    \n +----------------------------------------------------------------------------------+&quot
            )
            sys.exit()
    if <a id="change">&quotquery&quot in task</a>:
        if not os.path.exists(workspace):
            logger.error(f&quotThe directory {workspace} does not exist. Please index first via `python app.py -t index`&quot)
            sys.exit(1)
    if task == &quotindex&quot:
        index(num_docs)
    if task == &quotindex_restful&quot:
        index_rest(num_docs)
    if task == &quotquery&quot:
        query(top_k)
    if <a id="change">task == &quotquery_restful&quot</a>:
        <a id="change">query_restful()</a>


if __name__ == &quot__main__&quot:
    main()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/examples/commit/dc36fee6c43ef11c33354b58c79af6ce11fae6ff#diff-44b0c66c8c1caaf228c1371a0d640c09059dcdf9e6d941ae255663a68cf81626L107' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 45097782</div><div id='project'> Project Name: jina-ai/examples</div><div id='commit'> Commit Name: dc36fee6c43ef11c33354b58c79af6ce11fae6ff</div><div id='time'> Time: 2021-05-10</div><div id='author'> Author: 51201318+slettner@users.noreply.github.com</div><div id='file'> File Name: wikipedia-sentences-incremental/app.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(3)</div><div id='n_method'> N Method Name: main(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: wikipedia-sentences-incremental/app.py</div><div id='n_file'> N File Name: wikipedia-sentences-incremental/app.py</div><div id='m_start'> M Start Line: 109</div><div id='m_end'> M End Line: 134</div><div id='n_start'> N Start Line: 122</div><div id='n_end'> N End Line: 143</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        index(num_docs)
    if task == &quotindex_restful&quot:
        index_restful(num_docs)
    if <a id="change">task == &quotquery_restful&quot</a>:
        if not os.path.exists(workspace):
            logger.error(f&quotThe directory {workspace} does not exist. Please index first via `python app.py -t index`&quot)
            sys.exit(1)
        <a id="change">query_restful(</a>return_image<a id="change">)</a>
    if task == &quotdry&quot:
        dryrun()

</code></pre><h3>After Change</h3><pre><code class='java'>
                logger.info(&quotdeleting workspace...&quot)
                shutil.rmtree(workspace)

    elif <a id="change">&quotquery&quot in task</a>:
        if not os.path.exists(workspace):
            logger.info(f"The directory {workspace} does not exist. Please index first via `python app.py -t index`")
            sys.exit(1)

    if task == &quotindex&quot:
        f = Flow.load_config(&quotflow-index.yml&quot)
        with f:
            f.index_files(data_path, batch_size=batch_size, read_mode=&quotrb&quot, size=num_docs)
    elif task == &quotindex_restful&quot:
        index_restful(num_docs)
    elif task == &quotquery&quot:
        f = Flow.load_config(f&quotflow-query-{return_image}.yml&quot)
        with f:
            f.block()
    elif <a id="change">task == &quotquery_restful&quot</a>:
        <a id="change">query_restful(</a>return_image<a id="change">)</a>
    elif task == &quotdryrun&quot:
        dryrun()

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/examples/commit/cf0804415e2a0fbdc08cf539885702c233eb9522#diff-61772287228b4a8282f7781ee4eba2e76a8d7f8b1dff4b4fc54ea5caa23bb59bL81' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 45097783</div><div id='project'> Project Name: jina-ai/examples</div><div id='commit'> Commit Name: cf0804415e2a0fbdc08cf539885702c233eb9522</div><div id='time'> Time: 2021-05-06</div><div id='author'> Author: cristianmtr@users.noreply.github.com</div><div id='file'> File Name: object-search/app.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(6)</div><div id='n_method'> N Method Name: main(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: object-search/app.py</div><div id='n_file'> N File Name: object-search/app.py</div><div id='m_start'> M Start Line: 81</div><div id='m_end'> M End Line: 104</div><div id='n_start'> N Start Line: 86</div><div id='n_end'> N End Line: 121</div><BR>