<html><h3>Pattern ID :26631
</h3><img src='79680527.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    if not os.path.exists(args.out_dir):
        os.makedirs(args.out_dir)
    
    <a id="change">for </a>file in os.listdir(args.raw_data_dir)<a id="change">:
        </a>if not file.startswith(&quot.&quot):
            readP = os.path.join(args.raw_data_dir, file)
            &#47&#47nerWrtP = os.path.join(args.out_dir, "ner_{}.tsv".format(file.split(&quot.&quot)[0]))
            &#47&#47posWrtP = os.path.join(args.out_dir, "pos_{}.tsv".format(file.split(&quot.&quot)[0]))
            wrtP<a id="change"> = </a>os.path.join(args.out_dir, "entailment_{}.tsv".format(<a id="change">file.split(&quot.&quot)[0]</a>))
            isTrain = False
            if "train" in file:
                isTrain = True</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47making transform params
    transformParams = TransformParams(args.transform_file)

    for transformName, transformFn in <a id="change">transformParams.transformFnMap.items()</a>:
        transformParameters = transformParams.transformParamsMap[transformName]
        dataDir = transformParams.readDirMap[transformName]
        assert os.path.exists(dataDir), "{} doesnt exist".format(dataDir)
        saveDir = transformParams.saveDirMap[transformName]
        if not os.path.exists(saveDir):
            os.makedirs(saveDir)
        isTrain = True
        <a id="change">for </a>file in transformParams.readFileNamesMap[transformName]<a id="change">:
            &#47&#47calling respective transform function over file
            </a>TRANSFORM_FUNCS[transformFn](dataDir = dataDir, readFile=file,
                                        wrtDir=saveDir, transParamDict=transformParameters,
                                        isTrainFile=isTrain)
            &#47&#47 only the first file will be considered as train file for making label map</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/hellohaptik/multi-task-nlp/commit/205789e76b3a8d739f20ff0f1d18ffb09e1c0563#diff-fb64ac9c7a972e26a72fcd0716172c098938281076d82a2313789e4e6ecc3cb8L14' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 79680527</div><div id='project'> Project Name: hellohaptik/multi-task-nlp</div><div id='commit'> Commit Name: 205789e76b3a8d739f20ff0f1d18ffb09e1c0563</div><div id='time'> Time: 2020-05-26</div><div id='author'> Author: mehtasaransh614@gmail.com</div><div id='file'> File Name: data_transformations.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: data_transformations.py</div><div id='n_file'> N File Name: data_transformations.py</div><div id='m_start'> M Start Line: 167</div><div id='m_end'> M End Line: 193</div><div id='n_start'> N Start Line: 14</div><div id='n_end'> N End Line: 34</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    elif isinstance(resources.cloud, clouds.GCP):
        if isinstance(resources.types, tuple):
            <a id="change">for </a><a id="change">t</a> in resources.types<a id="change">:
                </a>if &quotx V100&quot in t:
                    num_v100s<a id="change"> = </a>int(<a id="change">t.split(&quotx V100&quot)[0]</a>)
                    assert num_v100s in [1, 2, 4, 8], resources.types
                    return _v100(num_v100s)
</code></pre><h3>After Change</h3><pre><code class='java'>
            assert False, &quotnot supported&quot

        assert len(accelerators) == 1, resources
        <a id="change">for </a>acc, acc_count in <a id="change">accelerators.items():
            </a>break
        if acc == &quotV100&quot:
            assert acc_count in [1, 2, 4, 8], resources
            return _v100(acc_count)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/skypilot-org/skypilot/commit/b8d9669b1a46a70a91e7061d44e4ba3630a4878b#diff-6e6afd5e63b7229eaa3ceaf5046e5dc0fe81b314398a71d8328c285946318e0cL4' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 79680526</div><div id='project'> Project Name: skypilot-org/skypilot</div><div id='commit'> Commit Name: b8d9669b1a46a70a91e7061d44e4ba3630a4878b</div><div id='time'> Time: 2021-10-14</div><div id='author'> Author: zongheng.y@gmail.com</div><div id='file'> File Name: prototype/time_estimators.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: resnet50_estimate_runtime(1)</div><div id='n_method'> N Method Name: resnet50_estimate_runtime(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: prototype/time_estimators.py</div><div id='n_file'> N File Name: prototype/time_estimators.py</div><div id='m_start'> M Start Line: 49</div><div id='m_end'> M End Line: 56</div><div id='n_start'> N Start Line: 49</div><div id='n_end'> N End Line: 60</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            &#47&#47 Parametrize tests that spin up an ecs cluster with unique name
            if images_to_parametrize and "ecs_container_instance" in metafunc.fixturenames:
                ecs_parametrization = []
                <a id="change">for </a>index, <a id="change">image</a> in enumerate(images_to_parametrize)<a id="change">:
                    </a>image_tag<a id="change"> = image.split(":")[-1]</a>.replace(".", "-")
                    ecs_parametrization.append(
                        (
                            image,</code></pre><h3>After Change</h3><pre><code class='java'>
                metafunc, images_to_parametrize, values_to_generate_for_fixture
            )
            if fixtures_parametrized:
                <a id="change">for </a>new_fixture_name, test_parametrization in <a id="change">fixtures_parametrized.items():
                    </a>metafunc.parametrize(f"{fixture},{new_fixture_name}", test_parametrization)
            else:
                metafunc.parametrize(fixture, images_to_parametrize)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/aws/deep-learning-containers/commit/396813053eeb041349bde37d85b0403b713a280e#diff-c7a1c9feb86ba95d32acfcef82beb230ca23f1924e32364ae9fbf9f6724fb910L119' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 79680530</div><div id='project'> Project Name: aws/deep-learning-containers</div><div id='commit'> Commit Name: 396813053eeb041349bde37d85b0403b713a280e</div><div id='time'> Time: 2020-03-29</div><div id='author'> Author: 54188298+saimidu@users.noreply.github.com</div><div id='file'> File Name: test/dlc_tests/conftest.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: pytest_generate_tests(1)</div><div id='n_method'> N Method Name: pytest_generate_tests(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: test/dlc_tests/conftest.py</div><div id='n_file'> N File Name: test/dlc_tests/conftest.py</div><div id='m_start'> M Start Line: 126</div><div id='m_end'> M End Line: 157</div><div id='n_start'> N Start Line: 192</div><div id='n_end'> N End Line: 220</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        gpu = None
        gpu_count = 0
        pos = None
        <a id="change">for </a>i, <a id="change">typ</a> in enumerate(typs)<a id="change">:
            </a>if typ in GCP._ON_DEMAND_PRICES_GPUS:
                assert gpu is None, &quotGPU doubly specified? {}&quot.format(
                    task.best_resources)
                splits = <a id="change">typ.split(&quotx &quot</a><a id="change">)</a>
                gpu<a id="change"> = </a>splits[-1]
                gpu_count = 1 if len(splits) == 1 else int(<a id="change">splits[0]</a>)
                pos = i
        if gpu:
            &#47&#47 Convert to GCP spec.</code></pre><h3>After Change</h3><pre><code class='java'>
        accelerators = r.get_accelerators()
        if accelerators is not None:
            assert len(accelerators) == 1, r
            <a id="change">for </a>gpu, gpu_count in <a id="change">accelerators.items():
                </a>break
        if gpu is not None:
            &#47&#47 Convert to GCP names: https://cloud.google.com/compute/docs/gpus
            gpu = &quotnvidia-tesla-{}&quot.format(gpu.lower())</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/skypilot-org/skypilot/commit/b8d9669b1a46a70a91e7061d44e4ba3630a4878b#diff-09de192ed6f9999f63536f07adff81ca0029840d3f3ebf27ad194e4c0e8b5e68L79' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 79680529</div><div id='project'> Project Name: skypilot-org/skypilot</div><div id='commit'> Commit Name: b8d9669b1a46a70a91e7061d44e4ba3630a4878b</div><div id='time'> Time: 2021-10-14</div><div id='author'> Author: zongheng.y@gmail.com</div><div id='file'> File Name: prototype/sky/clouds/gcp.py</div><div id='m_class'> M Class Name: GCP</div><div id='n_method'> N Class Name: GCP</div><div id='m_method'> M Method Name: make_deploy_resources_variables(2)</div><div id='n_method'> N Method Name: make_deploy_resources_variables(2)</div><div id='m_parent_class'> M Parent Class: clouds.Cloud</div><div id='n_parent_class'> N Parent Class: clouds.Cloud</div><div id='m_file'> M File Name: prototype/sky/clouds/gcp.py</div><div id='n_file'> N File Name: prototype/sky/clouds/gcp.py</div><div id='m_start'> M Start Line: 80</div><div id='m_end'> M End Line: 108</div><div id='n_start'> N Start Line: 91</div><div id='n_end'> N End Line: 107</div><BR>