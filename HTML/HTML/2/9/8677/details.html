<html><h3>Pattern ID :8677
</h3><img src='30088395.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        rouge_dict = {}
        for i in rouge_metrics:
            rouge_dict[i] = []
        <a id="change">for </a>i in range(len(generate_corpus))<a id="change">:
            </a>pred_sent<a id="change"> = </a>generate_corpus[i]
            gold_sent<a id="change"> = </a>reference_corpus[i]
            result = self.calc_rouge(gen_corpus=[pred_sent], ref_corpus=[gold_sent])
            for key_ in rouge_dict:
                rouge_dict[key_].append(result[key_]["f"])</code></pre><h3>After Change</h3><pre><code class='java'>
    def _calc_metrics_info(self, generate_corpus, reference_corpus):
        generate_corpus = [self._preprocess(generate_sentence) for generate_sentence in generate_corpus]
        reference_corpus = [self._preprocess(reference_sentence) for reference_sentence in reference_corpus]
        <a id="change">with tempfile</a><a id="change">.TemporaryDirectory() as path:
            </a>generate_path = os.path.join(path, &quotgenerate_corpus.txt&quot)
            reference_path = os.path.join(path, &quotreference_corpus.txt&quot)
            self._write_file(generate_path, generate_corpus)
            self._write_file(reference_path, reference_corpus)
            
            calc_args<a id="change"> = </a>{
                &quotsumm_path&quot: generate_path,
                &quotref_path&quot: reference_path,
                &quoteos&quot: &quot.&quot,
                &quotignore_empty_reference&quot: False,
                &quotignore_empty_summary&quot: False,
                &quotstemming&quot: True
            }
            res<a id="change"> = </a>self._calc_rouge(calc_args)
        return res</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 7</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/rucaibox/textbox/commit/ca43fa8706693cd72c9b0a3ad2a6623b7afc7c11#diff-f486c6d1908ed14f11d8f0c69db671b61da7b54430ef8e005a656fdeff2172bdL81' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 30088395</div><div id='project'> Project Name: rucaibox/textbox</div><div id='commit'> Commit Name: ca43fa8706693cd72c9b0a3ad2a6623b7afc7c11</div><div id='time'> Time: 2021-04-25</div><div id='author'> Author: 602525931@qq.com</div><div id='file'> File Name: textbox/evaluator/rouge_evaluator.py</div><div id='m_class'> M Class Name: RougeEvaluator</div><div id='n_method'> N Class Name: RougeEvaluator</div><div id='m_method'> M Method Name: _calc_metrics_info(3)</div><div id='n_method'> N Method Name: _calc_metrics_info(3)</div><div id='m_parent_class'> M Parent Class: AbstractEvaluator,Rouge155</div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: textbox/evaluator/rouge_evaluator.py</div><div id='n_file'> N File Name: textbox/evaluator/rouge_evaluator.py</div><div id='m_start'> M Start Line: 81</div><div id='m_end'> M End Line: 91</div><div id='n_start'> N Start Line: 101</div><div id='n_end'> N End Line: 118</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                        heuristic_count += 1
                        continue
                    should_skip = False
                    <a id="change">for q</a> in quote_values<a id="change">:
                        </a>if q not in all_input_columns:
                            heuristic_count<a id="change"> += </a>1
                            should_skip<a id="change"> = </a>True
                            break
                    if should_skip:
                        continue</code></pre><h3>After Change</h3><pre><code class='java'>

        if args.thrown_away is not None:
            &#47&#47 write the thrown away exampels into a file
            <a id="change">with open</a><a id="change">(args.thrown_away, &quotw&quot) as output_file:
                </a>for o in all_thrown_away_rows:
                    output_row<a id="change"> = </a>""
                    for i, column in enumerate(args.output_columns):
                        output_row<a id="change"> += </a>o[column]
                        if i &lt; len(args.output_columns)-1:
                            output_row += &quot\t&quot
                    output_file.write(output_row + &quot\n&quot)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/stanford-oval/genienlp/commit/d2eacd4e5c5347cb45907aea9e0a81a54b9fd5bf#diff-ee119052413383bfd6476efcd585c7782e225b9afadedd52e593204c70c2e120L15' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 30088394</div><div id='project'> Project Name: stanford-oval/genienlp</div><div id='commit'> Commit Name: d2eacd4e5c5347cb45907aea9e0a81a54b9fd5bf</div><div id='time'> Time: 2020-05-26</div><div id='author'> Author: s.j.semnani@gmail.com</div><div id='file'> File Name: genienlp/paraphrase/scripts/transform_dataset.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: genienlp/paraphrase/scripts/transform_dataset.py</div><div id='n_file'> N File Name: genienlp/paraphrase/scripts/transform_dataset.py</div><div id='m_start'> M Start Line: 55</div><div id='m_end'> M End Line: 162</div><div id='n_start'> N Start Line: 31</div><div id='n_end'> N End Line: 196</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        rouge_dict = {}
        for i in rouge_metrics:
            rouge_dict[i] = []
        <a id="change">for i</a> in range(len(generate_corpus))<a id="change">:
            </a>pred_sent = generate_corpus[i]
            gold_sent<a id="change"> = </a>reference_corpus[i]
            result<a id="change"> = </a>self.calc_rouge(gen_corpus=[pred_sent], ref_corpus=[gold_sent])
            for key_ in rouge_dict:
                rouge_dict[key_].append(result[key_]["f"])
        return rouge_dict</code></pre><h3>After Change</h3><pre><code class='java'>
    def _calc_metrics_info(self, generate_corpus, reference_corpus):
        generate_corpus = [self._preprocess(generate_sentence) for generate_sentence in generate_corpus]
        reference_corpus = [self._preprocess(reference_sentence) for reference_sentence in reference_corpus]
        <a id="change">with tempfile</a><a id="change">.TemporaryDirectory() as path:
            </a>generate_path = os.path.join(path, &quotgenerate_corpus.txt&quot)
            reference_path = os.path.join(path, &quotreference_corpus.txt&quot)
            self._write_file(generate_path, generate_corpus)
            self._write_file(reference_path, reference_corpus)
            
            calc_args<a id="change"> = </a>{
                &quotsumm_path&quot: generate_path,
                &quotref_path&quot: reference_path,
                &quoteos&quot: &quot.&quot,
                &quotignore_empty_reference&quot: False,
                &quotignore_empty_summary&quot: False,
                &quotstemming&quot: True
            }
            res<a id="change"> = </a>self._calc_rouge(calc_args)
        return res</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/rucaibox/textbox/commit/ca43fa8706693cd72c9b0a3ad2a6623b7afc7c11#diff-f486c6d1908ed14f11d8f0c69db671b61da7b54430ef8e005a656fdeff2172bdL71' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 30088392</div><div id='project'> Project Name: rucaibox/textbox</div><div id='commit'> Commit Name: ca43fa8706693cd72c9b0a3ad2a6623b7afc7c11</div><div id='time'> Time: 2021-04-25</div><div id='author'> Author: 602525931@qq.com</div><div id='file'> File Name: textbox/evaluator/rouge_evaluator.py</div><div id='m_class'> M Class Name: RougeEvaluator</div><div id='n_method'> N Class Name: RougeEvaluator</div><div id='m_method'> M Method Name: _calc_metrics_info(3)</div><div id='n_method'> N Method Name: _calc_metrics_info(3)</div><div id='m_parent_class'> M Parent Class: AbstractEvaluator,Rouge155</div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: textbox/evaluator/rouge_evaluator.py</div><div id='n_file'> N File Name: textbox/evaluator/rouge_evaluator.py</div><div id='m_start'> M Start Line: 81</div><div id='m_end'> M End Line: 91</div><div id='n_start'> N Start Line: 101</div><div id='n_end'> N End Line: 118</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        config_names = self.dataset_tester.prepare_config_names()
        dataset_builder_class_cls = self.dataset_tester.load_builder_cls()

        <a id="change">for config_name</a> in config_names<a id="change">:
            &#47&#47 create config and dataset
            </a>dataset_builder<a id="change"> = </a>dataset_builder_class_cls(config_name)

            path_to_dummy_data = self.dataset_tester.download_dummy_data(config_name)

            &#47&#47 create mock data loader manager with test specific mock_folder_strucutre_fn
            mock_dl_manager<a id="change"> = </a>DatasetTesterMixin.MockDataLoaderManager(path_to_dummy_data)

            &#47&#47 use the mock_dl_manager to create mock data and get split generators from there
            split_generators = dataset_builder._split_generators(mock_dl_manager)</code></pre><h3>After Change</h3><pre><code class='java'>
        builder_configs = self.dataset_tester.load_all_configs()

        for config in builder_configs:
            <a id="change">with tempfile</a><a id="change">.TemporaryDirectory() as processed_temp_dir, </a>tempfile.TemporaryDirectory() as raw_temp_dir:
                &#47&#47 create config and dataset
                dataset_builder = self.dataset_tester.load_builder(config, data_dir=processed_temp_dir)
                &#47&#47 get version
                version<a id="change"> = </a>dataset_builder.version
                version_name<a id="change"> = </a>str(version.major) + "." + str(version.minor) + "." + str(version.patch)

                &#47&#47 dowloads dummy data
                path_to_dummy_data = self.dataset_tester.download_dummy_data(config_name=config.name, version_name=version_name, cache_dir=raw_temp_dir)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/datasets/commit/e265044d925d92277f5664628d4fd4cd11dc7ef5#diff-a1bc225bd9a5bade373d1f140e24d09cbbdc97971c2f73bb627daaa803ada002L69' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 30088397</div><div id='project'> Project Name: huggingface/datasets</div><div id='commit'> Commit Name: e265044d925d92277f5664628d4fd4cd11dc7ef5</div><div id='time'> Time: 2020-04-27</div><div id='author'> Author: patrick.v.platen@gmail.com</div><div id='file'> File Name: tests/test_dataset_common.py</div><div id='m_class'> M Class Name: DatasetTesterMixin</div><div id='n_method'> N Class Name: DatasetTesterMixin</div><div id='m_method'> M Method Name: test_load_dataset(1)</div><div id='n_method'> N Method Name: test_load_dataset(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/test_dataset_common.py</div><div id='n_file'> N File Name: tests/test_dataset_common.py</div><div id='m_start'> M Start Line: 73</div><div id='m_end'> M End Line: 90</div><div id='n_start'> N Start Line: 77</div><div id='n_end'> N End Line: 107</div><BR>