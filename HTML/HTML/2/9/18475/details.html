<html><h3>Pattern ID :18475
</h3><img src='60334136.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        mean_over = [x for x in range(len(loss_mat.shape))]
        loss_mat = loss_mat.mean(dim=mean_over[:-2])

        <a id="change">if </a>self.hungarian:
            raise NotImplementedError
        else:
             &#47&#47 fast pit --&gt; trades speed for memory here.... might as well also do the opposite
             loss = None
             assigned_perm = None
             for p in permutations(range(n_sources)):
                 c_loss = loss_mat[range(n_sources), p].mean()
                 <a id="change">if loss is None</a><a id="change"> or loss &gt; c_loss</a>:
                     loss<a id="change"> = </a>c_loss
                     assigned_perm<a id="change"> = </a>p
             return loss, assigned_perm

    def forward(self, preds, targets):</code></pre><h3>After Change</h3><pre><code class='java'>
        mean_over = [x for x in range(len(loss_mat.shape))]
        loss_mat = loss_mat.mean(dim=mean_over[:-2])

        <a id="change">return </a>self._fast_pit(loss_mat)

    def reorder_tensor(self, tensor, p):
        </code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 8</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/speechbrain/speechbrain/commit/945aa944678b0aed98c1d86bfe67f74a9df58c6a#diff-dacadc87130a104a9b34b5d369c53e34f52662470ff3e0d91783d3ede95fee82L87' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60334136</div><div id='project'> Project Name: speechbrain/speechbrain</div><div id='commit'> Commit Name: 945aa944678b0aed98c1d86bfe67f74a9df58c6a</div><div id='time'> Time: 2020-06-22</div><div id='author'> Author: cornellsamuele@gmail.com</div><div id='file'> File Name: speechbrain/nnet/losses.py</div><div id='m_class'> M Class Name: PitWrapper</div><div id='n_method'> N Class Name: PitWrapper</div><div id='m_method'> M Method Name: _opt_perm_loss(3)</div><div id='n_method'> N Method Name: _opt_perm_loss(3)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: speechbrain/nnet/losses.py</div><div id='n_file'> N File Name: speechbrain/nnet/losses.py</div><div id='m_start'> M Start Line: 222</div><div id='m_end'> M End Line: 243</div><div id='n_start'> N Start Line: 87</div><div id='n_end'> N End Line: 95</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        mean_over = [x for x in range(len(loss_mat.shape))]
        loss_mat = loss_mat.mean(dim=mean_over[:-2])

        <a id="change">if </a>self.hungarian:
            raise NotImplementedError
        else:
             &#47&#47 fast pit --&gt; trades speed for memory here.... might as well also do the opposite
             <a id="change">loss</a> = None
             assigned_perm = None
             for p in permutations(range(n_sources)):
                 c_loss = loss_mat[range(n_sources), p].mean()
                 <a id="change">if loss is None</a><a id="change"> or loss &gt; c_loss</a>:
                     loss<a id="change"> = </a>c_loss
                     assigned_perm<a id="change"> = </a>p
             return loss, assigned_perm

    def forward(self, preds, targets):</code></pre><h3>After Change</h3><pre><code class='java'>
        mean_over = [x for x in range(len(loss_mat.shape))]
        loss_mat = loss_mat.mean(dim=mean_over[:-2])

        <a id="change">return </a>self._fast_pit(loss_mat)

    def reorder_tensor(self, tensor, p):
        </code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/speechbrain/speechbrain/commit/945aa944678b0aed98c1d86bfe67f74a9df58c6a#diff-dacadc87130a104a9b34b5d369c53e34f52662470ff3e0d91783d3ede95fee82L220' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60334152</div><div id='project'> Project Name: speechbrain/speechbrain</div><div id='commit'> Commit Name: 945aa944678b0aed98c1d86bfe67f74a9df58c6a</div><div id='time'> Time: 2020-06-22</div><div id='author'> Author: cornellsamuele@gmail.com</div><div id='file'> File Name: speechbrain/nnet/losses.py</div><div id='m_class'> M Class Name: PitWrapper</div><div id='n_method'> N Class Name: PitWrapper</div><div id='m_method'> M Method Name: _opt_perm_loss(3)</div><div id='n_method'> N Method Name: _opt_perm_loss(3)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: speechbrain/nnet/losses.py</div><div id='n_file'> N File Name: speechbrain/nnet/losses.py</div><div id='m_start'> M Start Line: 222</div><div id='m_end'> M End Line: 243</div><div id='n_start'> N Start Line: 87</div><div id='n_end'> N End Line: 95</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        mean_over = [x for x in range(len(loss_mat.shape))]
        loss_mat = loss_mat.mean(dim=mean_over[:-2])

        <a id="change">if </a>self.hungarian:
            raise NotImplementedError
        else:
             &#47&#47 fast pit --&gt; trades speed for memory here.... might as well also do the opposite
             <a id="change">loss</a> = None
             assigned_perm = None
             for p in permutations(range(n_sources)):
                 c_loss = loss_mat[range(n_sources), p].mean()
                 <a id="change">if loss is None</a><a id="change"> or loss &gt; c_loss</a>:
                     loss<a id="change"> = </a>c_loss
                     assigned_perm<a id="change"> = </a>p
             return loss, assigned_perm

    def forward(self, preds, targets):</code></pre><h3>After Change</h3><pre><code class='java'>
        mean_over = [x for x in range(len(loss_mat.shape))]
        loss_mat = loss_mat.mean(dim=mean_over[:-2])

        <a id="change">return </a>self._fast_pit(loss_mat)

    def reorder_tensor(self, tensor, p):
        </code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/speechbrain/speechbrain/commit/84b632ff28d516bccd44a675751fbe3b46aac51f#diff-dacadc87130a104a9b34b5d369c53e34f52662470ff3e0d91783d3ede95fee82L220' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60334138</div><div id='project'> Project Name: speechbrain/speechbrain</div><div id='commit'> Commit Name: 84b632ff28d516bccd44a675751fbe3b46aac51f</div><div id='time'> Time: 2020-06-22</div><div id='author'> Author: cornellsamuele@gmail.com</div><div id='file'> File Name: speechbrain/nnet/losses.py</div><div id='m_class'> M Class Name: PitWrapper</div><div id='n_method'> N Class Name: PitWrapper</div><div id='m_method'> M Method Name: _opt_perm_loss(3)</div><div id='n_method'> N Method Name: _opt_perm_loss(3)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: speechbrain/nnet/losses.py</div><div id='n_file'> N File Name: speechbrain/nnet/losses.py</div><div id='m_start'> M Start Line: 222</div><div id='m_end'> M End Line: 243</div><div id='n_start'> N Start Line: 87</div><div id='n_end'> N End Line: 95</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        new_sample = {}
        &#47&#47 mapping to `albumentations` acceptable parameters
        for <a id="change">source</a>, target in self.transform_targets.items():
            <a id="change">if </a>source in sample:
                <a id="change">if source == &quotinput&quot</a><a id="change"> or source == &quottarget&quot</a>:
                    new_sample[target]<a id="change"> = </a>sample[source]
                else:
                    new_sample[source]<a id="change"> = </a>sample[source]

        new_sample = transform(**new_sample)
        &#47&#47 inverse mapping</code></pre><h3>After Change</h3><pre><code class='java'>

        valid_sample = {key: value for (key, value) in sample.items() if key in self.__valid_transform_params}
        new_sample = transform(**valid_sample)
        <a id="change">return </a>new_sample

    def _read_image(self, image_path: str) -&gt; np.ndarray:
        full_image_path = self.data_folder / image_path</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/eora-ai/torchok/commit/8eed040a824ef97af24c29a4106f0457205bc490#diff-e3dde24584ad502d0a08c11f07439f277b82e9744617d00b4d4da23b13f3852bL53' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60334173</div><div id='project'> Project Name: eora-ai/torchok</div><div id='commit'> Commit Name: 8eed040a824ef97af24c29a4106f0457205bc490</div><div id='time'> Time: 2022-04-11</div><div id='author'> Author: patr982@gmail.com</div><div id='file'> File Name: src/data/datasets/base.py</div><div id='m_class'> M Class Name: ImageDataset</div><div id='n_method'> N Class Name: ImageDataset</div><div id='m_method'> M Method Name: _apply_transform(3)</div><div id='n_method'> N Method Name: _apply_transform(3)</div><div id='m_parent_class'> M Parent Class: ABC,Dataset</div><div id='n_parent_class'> N Parent Class: ABC,Dataset</div><div id='m_file'> M File Name: src/data/datasets/base.py</div><div id='n_file'> N File Name: src/data/datasets/base.py</div><div id='m_start'> M Start Line: 67</div><div id='m_end'> M End Line: 83</div><div id='n_start'> N Start Line: 59</div><div id='n_end'> N End Line: 61</div><BR>