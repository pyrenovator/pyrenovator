<html><h3>Pattern ID :32266
</h3><img src='94397216.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    img *= 0.15

    &#47&#47 Center crop
    img = <a id="change">img[25:-25, 25:-25, :]</a>

    &#47&#47 Clip to [0, 1]
    img += 0.5
    img = np.clip(img, 0, 1)</code></pre><h3>After Change</h3><pre><code class='java'>
    img *= 0.15

    &#47&#47 Center crop
    <a id="change">hh_crop</a><a id="change">, ww_crop</a> = int(img.shape[0] * crop_border), int(img.shape[1] * crop_border)
    img = <a id="change">img[hh_crop:-hh_crop, ww_crop:-ww_crop]</a>

    &#47&#47 Clip to [0, 1]
    img += 0.5
    img = np.clip(img, 0, 1)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 7</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/leondgarse/keras_cv_attention_models/commit/d411c57807dedc4b03ca737a6596ae6ecc429dd5#diff-1ec9a19aafb9379c6e226dccc101dafcc65576f11136e0603301b13fca3f7db4L31' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 94397216</div><div id='project'> Project Name: leondgarse/keras_cv_attention_models</div><div id='commit'> Commit Name: d411c57807dedc4b03ca737a6596ae6ecc429dd5</div><div id='time'> Time: 2022-01-07</div><div id='author'> Author: leondgarse@gmail.com</div><div id='file'> File Name: keras_cv_attention_models/visualizing/visualizing.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: __deprocess_image__(2)</div><div id='n_method'> N Method Name: __deprocess_image__(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: keras_cv_attention_models/visualizing/visualizing.py</div><div id='n_file'> N File Name: keras_cv_attention_models/visualizing/visualizing.py</div><div id='m_start'> M Start Line: 37</div><div id='m_end'> M End Line: 44</div><div id='n_start'> N Start Line: 31</div><div id='n_end'> N End Line: 39</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    img *= 0.15

    &#47&#47 Center crop
    img = <a id="change">img[25:-25, 25:-25, :]</a>

    &#47&#47 Clip to [0, 1]
    img += 0.5
    img = np.clip(img, 0, 1)</code></pre><h3>After Change</h3><pre><code class='java'>
    img *= 0.15

    &#47&#47 Center crop
    hh_crop<a id="change">, ww_crop</a> = int(img.shape[0] * crop_border), int(img.shape[1] * crop_border)
    img = <a id="change">img[hh_crop:-hh_crop, ww_crop:-ww_crop]</a>

    &#47&#47 Clip to [0, 1]
    img += 0.5
    img = np.clip(img, 0, 1)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/leondgarse/keras_cv_attention_models/commit/d411c57807dedc4b03ca737a6596ae6ecc429dd5#diff-1ec9a19aafb9379c6e226dccc101dafcc65576f11136e0603301b13fca3f7db4L37' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 94397217</div><div id='project'> Project Name: leondgarse/keras_cv_attention_models</div><div id='commit'> Commit Name: d411c57807dedc4b03ca737a6596ae6ecc429dd5</div><div id='time'> Time: 2022-01-07</div><div id='author'> Author: leondgarse@gmail.com</div><div id='file'> File Name: keras_cv_attention_models/visualizing/visualizing.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: __deprocess_image__(2)</div><div id='n_method'> N Method Name: __deprocess_image__(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: keras_cv_attention_models/visualizing/visualizing.py</div><div id='n_file'> N File Name: keras_cv_attention_models/visualizing/visualizing.py</div><div id='m_start'> M Start Line: 37</div><div id='m_end'> M End Line: 44</div><div id='n_start'> N Start Line: 31</div><div id='n_end'> N End Line: 39</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    ret = np.zeros(s, dtype=grad_output.dtype)
    for Y in range(2):
      for X in range(2):
        <a id="change">ret[:, :, Y:my:2, X:mx:2]</a> = grad_output * (idxs == (Y*2+X))
    return ret
register(&quotmax_pool2d&quot, MaxPool2D)
</code></pre><h3>After Change</h3><pre><code class='java'>
  @staticmethod
  def backward(ctx, grad_output):
    idxs,s = ctx.saved_tensors
    py<a id="change">, px</a> = ctx.pool_size
    my, mx = (s[2]//py)*py, (s[3]//px)*px
    ret = np.zeros(s, dtype=grad_output.dtype)
    for Y in range(py):
      for X in range(px):
        <a id="change">ret[:, :, Y:my:py, X:mx:px]</a> = grad_output * (idxs == (Y*px+X))
    return ret
register(&quotmax_pool2d&quot, MaxPool2D)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/geohot/tinygrad/commit/15e59883232642c5f80643b407829f05a39be4b0#diff-5736814df0b2c07a42d5c1bfef6b5aa5635ce18043f4aa030e21768694259ca3L145' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 94397202</div><div id='project'> Project Name: geohot/tinygrad</div><div id='commit'> Commit Name: 15e59883232642c5f80643b407829f05a39be4b0</div><div id='time'> Time: 2020-10-26</div><div id='author'> Author: timothy@mcalister.ch</div><div id='file'> File Name: tinygrad/ops.py</div><div id='m_class'> M Class Name: MaxPool2D</div><div id='n_method'> N Class Name: MaxPool2D</div><div id='m_method'> M Method Name: backward(2)</div><div id='n_method'> N Method Name: backward(2)</div><div id='m_parent_class'> M Parent Class: Function</div><div id='n_parent_class'> N Parent Class: Function</div><div id='m_file'> M File Name: tinygrad/ops.py</div><div id='n_file'> N File Name: tinygrad/ops.py</div><div id='m_start'> M Start Line: 147</div><div id='m_end'> M End Line: 152</div><div id='n_start'> N Start Line: 147</div><div id='n_end'> N End Line: 153</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    ret = np.zeros(s, dtype=grad_output.dtype)
    for Y in range(2):
      for X in range(2):
        <a id="change">ret[:, :, Y:my:2, X:mx:2]</a> = grad_output/4
    return ret
register(&quotavg_pool2d&quot, AvgPool2D)
</code></pre><h3>After Change</h3><pre><code class='java'>
  @staticmethod
  def backward(ctx, grad_output):
    s, = ctx.saved_tensors
    py<a id="change">, px</a> = ctx.pool_size
    my, mx = (s[2]//py)*py, (s[3]//px)*px
    ret = np.zeros(s, dtype=grad_output.dtype)
    for Y in range(py):
      for X in range(px):
        <a id="change">ret[:, :, Y:my:py, X:mx:px]</a> = grad_output/py/px
    return ret
register(&quotavg_pool2d&quot, AvgPool2D)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/geohot/tinygrad/commit/15e59883232642c5f80643b407829f05a39be4b0#diff-5736814df0b2c07a42d5c1bfef6b5aa5635ce18043f4aa030e21768694259ca3L163' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 94397179</div><div id='project'> Project Name: geohot/tinygrad</div><div id='commit'> Commit Name: 15e59883232642c5f80643b407829f05a39be4b0</div><div id='time'> Time: 2020-10-26</div><div id='author'> Author: timothy@mcalister.ch</div><div id='file'> File Name: tinygrad/ops.py</div><div id='m_class'> M Class Name: AvgPool2D</div><div id='n_method'> N Class Name: AvgPool2D</div><div id='m_method'> M Method Name: backward(2)</div><div id='n_method'> N Method Name: backward(2)</div><div id='m_parent_class'> M Parent Class: Function</div><div id='n_parent_class'> N Parent Class: Function</div><div id='m_file'> M File Name: tinygrad/ops.py</div><div id='n_file'> N File Name: tinygrad/ops.py</div><div id='m_start'> M Start Line: 165</div><div id='m_end'> M End Line: 170</div><div id='n_start'> N Start Line: 166</div><div id='n_end'> N End Line: 172</div><BR>