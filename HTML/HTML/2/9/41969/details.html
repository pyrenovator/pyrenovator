<html><h3>Pattern ID :41969
</h3><img src='117635363.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            raise ValueError(f"unknown --loss-type {self.loss_type}")

        if self.use_dtw_loss:
            <a id="change">print(</a><a id="change">"Regular Loss: {}".format(</a>loss<a id="change">))</a>
            dtw_loss = self.dtw_criterion(after_outs, speech).mean() / 2000.0  &#47&#47 division to balance orders of magnitude
            &#47&#47 print("\n\n")
            &#47&#47 import matplotlib.pyplot as plt
            &#47&#47 import librosa.display as lbd</code></pre><h3>After Change</h3><pre><code class='java'>
            loss = loss + attn_loss

        &#47&#47 calculate alignment loss
        <a id="change">if </a><a id="change">self.use_alignment_loss</a>:
            if self.reduction_factor &gt; 1:
                olens_in<a id="change"> = </a>speech_lengths.new(<a id="change">[olen // self.reduction_factor for olen in speech_lengths]</a>)
            else:
                olens_in = speech_lengths
            align_loss = self.alignment_loss(att_ws, text_lengths, olens_in, step)
            loss<a id="change"> = </a>loss + align_loss

        return loss
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 7</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/digitalphonetics/ims-toucan/commit/f4b6225ffb1360b67aca1559ae7fb18b17788dbf#diff-f8d05eb08ac38b212e3d3c6104a5e5618a8484d7eb2df04df282d6599e5473daL183' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 117635363</div><div id='project'> Project Name: digitalphonetics/ims-toucan</div><div id='commit'> Commit Name: f4b6225ffb1360b67aca1559ae7fb18b17788dbf</div><div id='time'> Time: 2021-09-26</div><div id='author'> Author: florian.lux@ims.uni-stuttgart.de</div><div id='file'> File Name: TrainingInterfaces/Text_to_Spectrogram/Tacotron2/Tacotron2.py</div><div id='m_class'> M Class Name: Tacotron2</div><div id='n_method'> N Class Name: Tacotron2</div><div id='m_method'> M Method Name: forward(8)</div><div id='n_method'> N Method Name: forward(7)</div><div id='m_parent_class'> M Parent Class: torch.nn.Module</div><div id='n_parent_class'> N Parent Class: torch.nn.Module</div><div id='m_file'> M File Name: TrainingInterfaces/Text_to_Spectrogram/Tacotron2/Tacotron2.py</div><div id='n_file'> N File Name: TrainingInterfaces/Text_to_Spectrogram/Tacotron2/Tacotron2.py</div><div id='m_start'> M Start Line: 233</div><div id='m_end'> M End Line: 242</div><div id='n_start'> N Start Line: 183</div><div id='n_end'> N End Line: 261</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                      &quotYou may see unexpected behavior when restarting &quot
                      &quotfrom checkpoints.&quot)

    <a id="change">print(</a><a id="change">"Use GPU: {} for training".format(</a>args.gpu<a id="change">))</a>
    cudnn.benchmark = True

    &#47&#47 Data loading code
    normalize = transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])</code></pre><h3>After Change</h3><pre><code class='java'>
    classifier = ImageClassifier(backbone, num_classes).cuda()

    &#47&#47 define loss function
    <a id="change">if </a><a id="change">args.adversarial</a>:
        thetas<a id="change"> = </a><a id="change">[Theta(dim).cuda() for dim in (classifier.features_dim, num_classes)]</a>
    else:
        thetas<a id="change"> = </a>None
    jmmd_loss = JointMultipleKernelMaximumMeanDiscrepancy(
        kernels=(
            [GaussianKernel(alpha=2 ** k) for k in range(-3, 2)],</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/thuml/transfer-learning-library/commit/904ddf1c2173d282968c2eb2efac00a133583180#diff-28ba5cedb6b2c0fa16adedcae547a23d0ebab339c6b95203b27e586c47dae0ecL29' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 117635367</div><div id='project'> Project Name: thuml/transfer-learning-library</div><div id='commit'> Commit Name: 904ddf1c2173d282968c2eb2efac00a133583180</div><div id='time'> Time: 2020-04-29</div><div id='author'> Author: 13126830206@163.com</div><div id='file'> File Name: examples/jan.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(1)</div><div id='n_method'> N Method Name: main(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: examples/jan.py</div><div id='n_file'> N File Name: examples/jan.py</div><div id='m_start'> M Start Line: 40</div><div id='m_end'> M End Line: 86</div><div id='n_start'> N Start Line: 74</div><div id='n_end'> N End Line: 93</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                      &quotYou may see unexpected behavior when restarting &quot
                      &quotfrom checkpoints.&quot)

    <a id="change">print(</a><a id="change">"Use GPU: {} for training".format(</a>args.gpu<a id="change">))</a>
    cudnn.benchmark = True

    &#47&#47 Data loading code
    normalize = transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])</code></pre><h3>After Change</h3><pre><code class='java'>
    classifier = ImageClassifier(backbone, num_classes).cuda()

    &#47&#47 define loss function
    <a id="change">if </a><a id="change">args.adversarial</a>:
        thetas<a id="change"> = </a><a id="change">[Theta(dim).cuda() for dim in (classifier.features_dim, num_classes)]</a>
    else:
        thetas<a id="change"> = </a>None
    jmmd_loss = JointMultipleKernelMaximumMeanDiscrepancy(
        kernels=(
            [GaussianKernel(alpha=2 ** k) for k in range(-3, 2)],</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/thuml/transfer-learning-library/commit/a14c5201dda7a853703a470501d4b82b42d46182#diff-28ba5cedb6b2c0fa16adedcae547a23d0ebab339c6b95203b27e586c47dae0ecL29' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 117635365</div><div id='project'> Project Name: thuml/transfer-learning-library</div><div id='commit'> Commit Name: a14c5201dda7a853703a470501d4b82b42d46182</div><div id='time'> Time: 2020-04-29</div><div id='author'> Author: 13126830206@163.com</div><div id='file'> File Name: examples/jan.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(1)</div><div id='n_method'> N Method Name: main(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: examples/jan.py</div><div id='n_file'> N File Name: examples/jan.py</div><div id='m_start'> M Start Line: 40</div><div id='m_end'> M End Line: 86</div><div id='n_start'> N Start Line: 74</div><div id='n_end'> N End Line: 95</div><BR>