<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

            if is_mixed_precision:
                &#47&#47 2/3 & 3/3 of mixed precision training with amp
                <a id="change">with amp.scale_loss(</a><a id="change">loss, optimizer) as scaled_loss:
                    scaled_loss.backward()</a>
            else:
                loss.backward()
            optimizer.step()
            lr_scheduler.step()</code></pre><h3>After Change</h3><pre><code class='java'>
                    loss, stats = criterion(outputs, labels)

            if is_mixed_precision:
                accelerator.backward(<a id="change">scaler.scale(</a>loss<a id="change">)</a>)
                <a id="change">scaler.step(</a>optimizer<a id="change">)</a>
                <a id="change">scaler.update()</a>
            else:
                accelerator.backward(loss)
                optimizer.step()
</code></pre>