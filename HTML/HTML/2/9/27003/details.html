<html><h3>Pattern ID :27003
</h3><img src='80368153.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    if res is None:
        res = []
    entity = []
    <a id="change">for </a>j in range(len(x))<a id="change">:
        </a>if y[j] == &quotB&quot:
            entity = [x[j]]
        elif <a id="change"></a>y[j] == &quotM&quot and <a id="change">len(entity) != 0</a>:
            <a id="change">entity.append(</a>x[j]<a id="change">)</a>
        elif y[j] == &quotE&quot and len(entity) != 0:
            entity.append(x[j])
            res.append(entity)
            entity = []</code></pre><h3>After Change</h3><pre><code class='java'>
        res = []
    entity = []
    prev_tag = &quotO&quot  &#47&#47 start tag
    <a id="change">for </a>i, tag in enumerate(y + [&quotP&quot])<a id="change">:  &#47&#47 end tag
        </a>if end_of_chunk(prev_tag, tag):
            res.append(entity)
            entity = []
        if start_of_chunk(prev_tag, tag) and tag != &quotP&quot:
            entity = [x[i]]
        elif <a id="change">tag != &quotP&quot</a>:
            entity.append(x[i])
        else:
            <a id="change">continue</a>
        prev_tag = tag
    return res

</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 8</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/hemingkx/wordseg/commit/2f934c2e354a87dab632a69ec989dea329f35663#diff-0ffb23ae39cc9a695be609f6bbaeb9b9674a920dacb79a596ab2c44f9a09df1dL8' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 80368153</div><div id='project'> Project Name: hemingkx/wordseg</div><div id='commit'> Commit Name: 2f934c2e354a87dab632a69ec989dea329f35663</div><div id='time'> Time: 2021-03-29</div><div id='author'> Author: hemingkx@gmail.com</div><div id='file'> File Name: BiLSTM-CRF/metric.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: calculate(3)</div><div id='n_method'> N Method Name: calculate(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: BiLSTM-CRF/metric.py</div><div id='n_file'> N File Name: BiLSTM-CRF/metric.py</div><div id='m_start'> M Start Line: 8</div><div id='m_end'> M End Line: 25</div><div id='n_start'> N Start Line: 19</div><div id='n_end'> N End Line: 31</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    if res is None:
        res = []
    entity = []
    <a id="change">for j</a> in range(len(x))<a id="change">:
        </a>if y[j] == &quotB&quot:
            entity = [x[j]]
        elif <a id="change">y[j] == &quotM&quot</a> and len(entity) != 0:
            entity.append(x[j])
        elif y[j] == &quotE&quot and len(entity) != 0:
            entity.append(x[j])
            <a id="change">res.append(</a>entity<a id="change">)</a>
            entity = []
        elif y[j] == &quotS&quot:
            entity = [x[j]]
            res.append(entity)</code></pre><h3>After Change</h3><pre><code class='java'>
        res = []
    entity = []
    prev_tag = &quotO&quot  &#47&#47 start tag
    <a id="change">for </a>i, tag in enumerate(y + [&quotP&quot])<a id="change">:  &#47&#47 end tag
        </a>if end_of_chunk(prev_tag, tag):
            res.append(entity)
            entity = []
        if start_of_chunk(prev_tag, tag) and tag != &quotP&quot:
            entity = [x[i]]
        elif <a id="change">tag != &quotP&quot</a>:
            entity.append(x[i])
        else:
            <a id="change">continue</a>
        prev_tag = tag
    return res

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hemingkx/wordseg/commit/2f934c2e354a87dab632a69ec989dea329f35663#diff-0ffb23ae39cc9a695be609f6bbaeb9b9674a920dacb79a596ab2c44f9a09df1dL6' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 80368143</div><div id='project'> Project Name: hemingkx/wordseg</div><div id='commit'> Commit Name: 2f934c2e354a87dab632a69ec989dea329f35663</div><div id='time'> Time: 2021-03-29</div><div id='author'> Author: hemingkx@gmail.com</div><div id='file'> File Name: BiLSTM-CRF/metric.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: calculate(3)</div><div id='n_method'> N Method Name: calculate(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: BiLSTM-CRF/metric.py</div><div id='n_file'> N File Name: BiLSTM-CRF/metric.py</div><div id='m_start'> M Start Line: 8</div><div id='m_end'> M End Line: 25</div><div id='n_start'> N Start Line: 19</div><div id='n_end'> N End Line: 31</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 Add similarity that we previously removed.
        ranked = []

        <a id="change">for document</a> in intersection<a id="change">:
            </a>similarity = similarities.get(document.get(self.key, None), None)
            <a id="change">if similarity is not None</a>:
                <a id="change">ranked.append(</a>{**document, **{"similarity": similarity}}<a id="change">)</a>
            else:
                ranked.append(document)

        return ranked</code></pre><h3>After Change</h3><pre><code class='java'>
                counter_docs[tuple(sorted(document.items()))] += 1

        ranked = []
        <a id="change">for </a>document, count in counter_docs.items()<a id="change">:
            </a><a id="change">if count &lt; len(self.models)</a>:
                <a id="change">continue</a>
            document = dict(document)
            document["similarity"] = scores[document[self.key]]
            ranked.append(document)
        return ranked</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/raphaelsty/cherche/commit/40c675780df1743f794da93d6fa77e2b334c9521#diff-37a4d75affa791906e5597c519152c9666fc0218311d70e35dc13d45619b180aL251' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 80368156</div><div id='project'> Project Name: raphaelsty/cherche</div><div id='commit'> Commit Name: 40c675780df1743f794da93d6fa77e2b334c9521</div><div id='time'> Time: 2022-10-17</div><div id='author'> Author: raphael.sourty@gmail.com</div><div id='file'> File Name: cherche/compose/union_inter_vote.py</div><div id='m_class'> M Class Name: Intersection</div><div id='n_method'> N Class Name: Intersection</div><div id='m_method'> M Method Name: __call__(2)</div><div id='n_method'> N Method Name: __call__(2)</div><div id='m_parent_class'> M Parent Class: UnionIntersection</div><div id='n_parent_class'> N Parent Class: UnionIntersection</div><div id='m_file'> M File Name: cherche/compose/union_inter_vote.py</div><div id='n_file'> N File Name: cherche/compose/union_inter_vote.py</div><div id='m_start'> M Start Line: 260</div><div id='m_end'> M End Line: 288</div><div id='n_start'> N Start Line: 259</div><div id='n_end'> N End Line: 282</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        &#47&#47 create a list of all the requests and their corresponding samples
        sample_requests = []
        <a id="change">for sample</a> in samples<a id="change">:
            </a>metadata = filename_to_metadata[sample.file_name]
            <a id="change">if metadata is not None</a>:
                update_sample_request = SampleUpdateRequest(
                    custom_meta_data=metadata
                )
                <a id="change">sample_requests.append(</a>(update_sample_request, sample)<a id="change">)</a>

        &#47&#47Â limit number of concurrent requests
        with ThreadPoolExecutor(max_workers=max_workers) as executor:
            &#47&#47 get iterator over results</code></pre><h3>After Change</h3><pre><code class='java'>
        }

        upload_requests = []
        <a id="change">for </a>metadata in custom_metadata[COCO_ANNOTATION_KEYS.custom_metadata]<a id="change">:
            </a>image_id = metadata[COCO_ANNOTATION_KEYS.custom_metadata_image_id]
            filename = image_id_to_filename.get(image_id, None)
            if filename is None:
                print_as_warning(
                    f&quotNo image found for custom metadata annotation &quot
                    f&quotwith image_id {image_id}. &quot
                    f&quotThis custom metadata annotation is skipped. &quot,
                    InvalidCustomMetadataWarning
                )
                continue
            sample_id = filename_to_sample_id.get(filename, None)
            <a id="change">if sample_id is None</a>:
                print_as_warning(
                    f&quotYou tried to upload custom metadata for a sample with &quot
                    f&quotfilename {{{filename}}}, &quot
                    f&quotbut a sample with this filename &quot
                    f&quotdoes not exist on the server. &quot
                    f&quotThis custom metadata annotation is skipped. &quot,
                    InvalidCustomMetadataWarning
                )
                <a id="change">continue</a>
            upload_request = (metadata, sample_id)
            upload_requests.append(upload_request)

        &#47&#47 retry upload if it times out</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/lightly-ai/lightly/commit/ad42377093f1168889faa601bcf86c637aabeb05#diff-be57b233f5bf6063e59932f261fbe614c60035e59b7f7355d4a19914570fff36L116' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 80368157</div><div id='project'> Project Name: lightly-ai/lightly</div><div id='commit'> Commit Name: ad42377093f1168889faa601bcf86c637aabeb05</div><div id='time'> Time: 2022-03-11</div><div id='author'> Author: malte.ebner@gmail.com</div><div id='file'> File Name: lightly/api/api_workflow_upload_metadata.py</div><div id='m_class'> M Class Name: _UploadCustomMetadataMixin</div><div id='n_method'> N Class Name: _UploadCustomMetadataMixin</div><div id='m_method'> M Method Name: upload_custom_metadata(4)</div><div id='n_method'> N Method Name: upload_custom_metadata(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: lightly/api/api_workflow_upload_metadata.py</div><div id='n_file'> N File Name: lightly/api/api_workflow_upload_metadata.py</div><div id='m_start'> M Start Line: 172</div><div id='m_end'> M End Line: 205</div><div id='n_start'> N Start Line: 156</div><div id='n_end'> N End Line: 195</div><BR>