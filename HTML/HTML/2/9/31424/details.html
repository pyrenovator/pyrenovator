<html><h3>Pattern ID :31424
</h3><img src='92091263.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

    seconds_per_beat = 60 / DEFAULT_TEMPO
    seconds_per_tick = seconds_per_beat / float(ticks_per_beat)
    ticks_per_second = <a id="change">float(</a>ticks_per_beat<a id="change">) / </a>seconds_per_beat

    &#47&#47 get specific time for notes
    notes = []
    i = 0
    st = 0
    while i &lt; len(temp_notes):
        pitch = temp_notes[i]
        j = i
        while j + 1 &lt; len(temp_notes) and temp_notes[j + 1] == pitch:
            j += 1
        duration = int((j<a id="change"> - i + </a>1) * ticks_per_second / rate)
        &#47&#47 duration (end time)
        ed = st + duration
        st = ed
        notes.append(
            miditoolkit.midi.containers.Note(
                start=st, end=ed, pitch=pitch, velocity=DEFAULT_VELOCITY
            )
        )
        i = j + 1

    &#47&#47 get specific time for tempos
    tempos = []
    i = 0
    st = 0
    while i &lt; len(temp_tempos):
        bpm = temp_tempos[i]
        j = i
        while j + 1 &lt; len(temp_tempos) and temp_tempos[j + 1] == bpm:
            j += 1
        duration<a id="change"> = </a>int((j - i + 1) * ticks_per_second / rate)
        tempos.append(
            miditoolkit.midi.containers.TempoChange(bpm, st)
        )
        st = st<a id="change"> + </a>duration
        i = j + 1

    &#47&#47 write</code></pre><h3>After Change</h3><pre><code class='java'>
        
        start = np.searchsorted(tick_to_time, st, "left")
        end = np.searchsorted(tick_to_time, ed, "left")
        <a id="change">if </a><a id="change">pitch &gt; 0 and pitch &lt;=128</a>:
            notes.append(
                miditoolkit.midi.containers.Note(
                    start = start, end=end, pitch=pitch, velocity=DEFAULT_VELOCITY</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 8</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/sjtmusicteam/muskits/commit/6d602b1150c42852c587245c54b9412824d1a842#diff-fa0e8b40b7d4f3b12f66685446b0d3165f6e397b28b96f892aa8a2fde7b74972L54' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 92091263</div><div id='project'> Project Name: sjtmusicteam/muskits</div><div id='commit'> Commit Name: 6d602b1150c42852c587245c54b9412824d1a842</div><div id='time'> Time: 2021-09-17</div><div id='author'> Author: 934356561@qq.com</div><div id='file'> File Name: muskit/fileio/utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: seq_to_midi(6)</div><div id='n_method'> N Method Name: seq_to_midi(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: muskit/fileio/utils.py</div><div id='n_file'> N File Name: muskit/fileio/utils.py</div><div id='m_start'> M Start Line: 54</div><div id='m_end'> M End Line: 98</div><div id='n_start'> N Start Line: 88</div><div id='n_end'> N End Line: 141</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                        sm=softmax(out[i])
                        pts.append((sm[1].item(), j[-1][i].item()))
        valloss=totalloss/totals
        acc<a id="change"> = </a><a id="change">float(</a>correct<a id="change">)/</a>totals
        print("Epoch "+str(epoch)+" valid loss: "+<a id="change">str(valloss)+</a><a id="change">" acc: "+</a>str(acc))
        if auprc:
            print("AUPRC: "+str(AUPRC(pts)))
        if acc&gt;bestvalacc:</code></pre><h3>After Change</h3><pre><code class='java'>
            torch.save(model,save)
        else:
            patience += 1
        <a id="change">if </a><a id="change">early_stop and patience &gt; 20</a>:
            break
        
        scheduler.step()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/pliang279/multibench/commit/0566c062ada67f67199bb5b63046fab1fd680654#diff-d18b23b61842526d6956b06a29d725aed1c3962fa548edca68f628dea2178c2dL42' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 92091269</div><div id='project'> Project Name: pliang279/multibench</div><div id='commit'> Commit Name: 0566c062ada67f67199bb5b63046fab1fd680654</div><div id='time'> Time: 2021-04-26</div><div id='author'> Author: ztwu_nil@zju.edu.cn</div><div id='file'> File Name: training_structures/Contrastive_Learning.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(14)</div><div id='n_method'> N Method Name: train(14)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: training_structures/Contrastive_Learning.py</div><div id='n_file'> N File Name: training_structures/Contrastive_Learning.py</div><div id='m_start'> M Start Line: 99</div><div id='m_end'> M End Line: 161</div><div id='n_start'> N Start Line: 99</div><div id='n_end'> N End Line: 157</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                        sm=softmax(out[i])
                        pts.append((sm[1].item(), j[-1][i].item()))
        valloss=totalloss/totals
        acc<a id="change"> = </a><a id="change">float(</a>correct<a id="change">)/</a>totals
        print("Epoch "+str(epoch)+" valid loss: "+<a id="change">str(valloss)+</a><a id="change">" acc: "+</a>str(acc))
        if auprc:
            print("AUPRC: "+str(AUPRC(pts)))
        if acc&gt;bestvalacc:</code></pre><h3>After Change</h3><pre><code class='java'>
            torch.save(model,save)
        else:
            patience += 1
        <a id="change">if </a><a id="change">early_stop and patience &gt; 20</a>:
            break
        
        scheduler.step()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/pliang279/multibench/commit/62bf78b72dde077b9febf7fe1cc3e50c936fbcbb#diff-d18b23b61842526d6956b06a29d725aed1c3962fa548edca68f628dea2178c2dL42' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 92091270</div><div id='project'> Project Name: pliang279/multibench</div><div id='commit'> Commit Name: 62bf78b72dde077b9febf7fe1cc3e50c936fbcbb</div><div id='time'> Time: 2021-04-26</div><div id='author'> Author: ztwu_nil@zju.edu.cn</div><div id='file'> File Name: training_structures/Contrastive_Learning.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(14)</div><div id='n_method'> N Method Name: train(14)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: training_structures/Contrastive_Learning.py</div><div id='n_file'> N File Name: training_structures/Contrastive_Learning.py</div><div id='m_start'> M Start Line: 99</div><div id='m_end'> M End Line: 161</div><div id='n_start'> N Start Line: 99</div><div id='n_end'> N End Line: 157</div><BR>