<html><h3>Pattern ID :956
</h3><img src='4535557.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    if word_idx is None:
        raise ValueError(f&quotCouldn\&quott find "{word}" in "{prompt}"&quot)

    <a id="change">for </a>idx, token in enumerate(tokens)<a id="change">:
        </a>merge_idxs.append(idx)

        if &quot&lt;/w&gt;&quot in token:
            curr_token += token[:-4]

            <a id="change">if </a>idx &gt;= word_idx and <a id="change">curr_token == word</a>:
                <a id="change">break</a>

            curr_token = &quot&quot
            curr_idx<a id="change"> += </a>1
            merge_idxs.clear()
        else:
            curr_token<a id="change"> += </a>token
            merge_idxs.append(idx)

    return [x + 1 for x in merge_idxs], word_idx  &#47&#47 Offset by 1.</code></pre><h3>After Change</h3><pre><code class='java'>
            &#47&#47 merge together all tokens in the word
            return [first_pos + i + offset_idx for i in range(0, token_len)]

        <a id="change">for </a>idx, w_token in enumerate(word_tokens)<a id="change">:
            &#47&#47 if the word contains more than one token
            </a>if len(w_token) &gt; len(search_tokens):
                &#47&#47 check to see if the extra tokens were from punctuation
                no_punc = [t for t in w_token if <a id="change">t not in punc_tokens</a>]
                search_no_punc = [t for t in search_tokens if t not in punc_tokens]
                if no_punc and no_punc == search_no_punc:
                    merge_idxs += calc_token_positions(idx, len(search_tokens))</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 8</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/castorini/daam/commit/854e6ddfdae1781009b31b66b2d5bb15d852fccf#diff-ea4e615a144dec76002186f2cde018c58e9a14487f738b334af1572531829aaeL53' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4535557</div><div id='project'> Project Name: castorini/daam</div><div id='commit'> Commit Name: 854e6ddfdae1781009b31b66b2d5bb15d852fccf</div><div id='time'> Time: 2022-12-08</div><div id='author'> Author: alotofcatz@gmail.com</div><div id='file'> File Name: daam/utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: compute_token_merge_indices(5)</div><div id='n_method'> N Method Name: compute_token_merge_indices(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: daam/utils.py</div><div id='n_file'> N File Name: daam/utils.py</div><div id='m_start'> M Start Line: 53</div><div id='m_end'> M End Line: 90</div><div id='n_start'> N Start Line: 54</div><div id='n_end'> N End Line: 91</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        model.resize_token_embeddings(new_num_tokens=orig_num_tokens + num_added_tokens)

def has_match(sentence, all_entities):
    <a id="change">for </a><a id="change">entity</a> in all_entities<a id="change">:
        </a>j = 0
        entity_tokenized = entity.split(&quot &quot)
        found<a id="change"> = </a>True
        while j &lt; len(entity_tokenized):
            <a id="change">if sentence[j] == entity_tokenized[j]</a>:
                j += 1
            else:
                found<a id="change"> = </a>False
                <a id="change">break</a>
        if found:
            return True
    return False
    </code></pre><h3>After Change</h3><pre><code class='java'>

def has_match(input_sequence, all_entities):
    sentence = &quot &quot.join(input_sequence)
    <a id="change">for </a>entity in all_entities<a id="change">:
        </a>if <a id="change">entity in sentence</a>:
            return True
    return False
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/stanford-oval/genienlp/commit/d115a89777ce01ede1c3631bd8f65949bcc789bb#diff-282dc979bfecd6e0539625f0962d48d9f6dbcb603e2032dd23b35988bcd65662L96' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4535541</div><div id='project'> Project Name: stanford-oval/genienlp</div><div id='commit'> Commit Name: d115a89777ce01ede1c3631bd8f65949bcc789bb</div><div id='time'> Time: 2020-12-30</div><div id='author'> Author: mehrad@stanford.edu</div><div id='file'> File Name: genienlp/paraphrase/data_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: has_match(2)</div><div id='n_method'> N Method Name: has_match(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: genienlp/paraphrase/data_utils.py</div><div id='n_file'> N File Name: genienlp/paraphrase/data_utils.py</div><div id='m_start'> M Start Line: 97</div><div id='m_end'> M End Line: 109</div><div id='n_start'> N Start Line: 97</div><div id='n_end'> N End Line: 101</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    if word_idx is None:
        raise ValueError(f&quotCouldn\&quott find "{word}" in "{prompt}"&quot)

    <a id="change">for </a>idx, <a id="change">token</a> in enumerate(tokens)<a id="change">:
        </a>merge_idxs.append(idx)

        if &quot&lt;/w&gt;&quot in token:
            curr_token += token[:-4]

            <a id="change">if </a>idx &gt;= word_idx and <a id="change">curr_token == word</a>:
                <a id="change">break</a>

            curr_token = &quot&quot
            curr_idx<a id="change"> += </a>1
            merge_idxs.clear()
        else:
            curr_token<a id="change"> += </a>token
            merge_idxs.append(idx)

    return [x + 1 for x in merge_idxs], word_idx  &#47&#47 Offset by 1.</code></pre><h3>After Change</h3><pre><code class='java'>
            &#47&#47 merge together all tokens in the word
            return [first_pos + i + offset_idx for i in range(0, token_len)]

        <a id="change">for </a>idx, w_token in enumerate(word_tokens)<a id="change">:
            &#47&#47 if the word contains more than one token
            </a>if len(w_token) &gt; len(search_tokens):
                &#47&#47 check to see if the extra tokens were from punctuation
                no_punc = [t for t in w_token if t not in punc_tokens]
                search_no_punc = [t for t in search_tokens if <a id="change">t not in punc_tokens</a>]
                if no_punc and no_punc == search_no_punc:
                    merge_idxs += calc_token_positions(idx, len(search_tokens))
                    word_idx = idx</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/castorini/daam/commit/854e6ddfdae1781009b31b66b2d5bb15d852fccf#diff-ea4e615a144dec76002186f2cde018c58e9a14487f738b334af1572531829aaeL52' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4535556</div><div id='project'> Project Name: castorini/daam</div><div id='commit'> Commit Name: 854e6ddfdae1781009b31b66b2d5bb15d852fccf</div><div id='time'> Time: 2022-12-08</div><div id='author'> Author: alotofcatz@gmail.com</div><div id='file'> File Name: daam/utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: compute_token_merge_indices(5)</div><div id='n_method'> N Method Name: compute_token_merge_indices(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: daam/utils.py</div><div id='n_file'> N File Name: daam/utils.py</div><div id='m_start'> M Start Line: 53</div><div id='m_end'> M End Line: 90</div><div id='n_start'> N Start Line: 54</div><div id='n_end'> N End Line: 91</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        int(math.log2(edge_type_num)+1)
    step_cnt = 0

    <a id="change">for </a><a id="change">_</a> in range(edge_type_num)<a id="change">:
        </a>while True:
            &#47&#47 Avoid infinite loop.
            step_cnt<a id="change"> += </a>1
            if step_cnt &gt; maximal_reasonable_steps or len(remaining_edge_types) == 0:
                warnings.warn(
                    f"Can&quott find enough ({edge_type_num}) edge types!", UserWarning)
                break

            edge_type_idx = random.randint(0, len(remaining_edge_types)-1)
            new_edge_type = remaining_edge_types[edge_type_idx]
            new_edge_type_tuple = EdgeTypeStr2Tuple(new_edge_type)
            <a id="change">if len(set(new_edge_type_tuple) & explored_node_type_set) == 0</a>:
                continue
            chosen_edge_types_list.append(new_edge_type)
            explored_node_type_set<a id="change"> |= </a>set(new_edge_type_tuple)
            remaining_edge_types.pop(edge_type_idx)
            <a id="change">break</a>
    return tuple(sorted(chosen_edge_types_list))


&#47&#47 Ways of choosing k items from n items.</code></pre><h3>After Change</h3><pre><code class='java'>
    for _ in range(edge_type_num):
        &#47&#47 Move edge types from other_edge_types_list to candidate_edge_types_list.
        idx_to_rm = []
        <a id="change">for </a>idx, et in enumerate(other_edge_types_list)<a id="change">:
            </a>et_tuple = EdgeTypeStr2Tuple(et)
            if <a id="change">len(set(et_tuple) & explored_node_type_set) &gt; 0</a>:
                candidate_edge_types_list.append(et)
                idx_to_rm.append(idx)
        &#47&#47 Since pop() will change the index of following elements,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/pku-dair/sgl/commit/93e7aac75c7a5fe5266c08615e4e5c0de463a86d#diff-a42813c7bb6f36db6c7dc4df3f1fb029e01d435597a169b5c1ae027c2d0ae0e3L27' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4535552</div><div id='project'> Project Name: pku-dair/sgl</div><div id='commit'> Commit Name: 93e7aac75c7a5fe5266c08615e4e5c0de463a86d</div><div id='time'> Time: 2022-04-21</div><div id='author'> Author: 82886739+ZhenbangYou@users.noreply.github.com</div><div id='file'> File Name: dataset/choose_edge_type.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: ChooseEdgeType(3)</div><div id='n_method'> N Method Name: ChooseEdgeType(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: dataset/choose_edge_type.py</div><div id='n_file'> N File Name: dataset/choose_edge_type.py</div><div id='m_start'> M Start Line: 29</div><div id='m_end'> M End Line: 56</div><div id='n_start'> N Start Line: 31</div><div id='n_end'> N End Line: 62</div><BR>