<html><h3>Pattern ID :8834
</h3><img src='32509984.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        crop_img = np.array(letterbox_image(image, self.image_size))
        photo = np.array(crop_img,dtype = np.float32)
        photo = np.transpose(preprocess_input(photo), (2, 0, 1))
        <a id="change">images</a><a id="change"> = </a><a id="change">[]</a>
        <a id="change">images.append(</a>photo<a id="change">)</a>
        images<a id="change"> = </a><a id="change">np.asarray(images</a><a id="change">)</a>

        <a id="change">with torch</a><a id="change">.no_grad():
            </a>images<a id="change"> = </a>torch.from_numpy(images)
            <a id="change">if </a>self.cuda:
                images = images.cuda()
            _<a id="change">, regression, classification, anchors = </a>self.net(images)
            
            regression<a id="change"> = </a>decodebox(regression, anchors, images)
            detection<a id="change"> = </a>torch.cat([regression,classification],axis=-1)
            batch_detections<a id="change"> = </a>non_max_suppression(detection, len(self.class_names),
                                                    conf_thres=self.confidence,
                                                    nms_thres=self.iou)
        try:</code></pre><h3>After Change</h3><pre><code class='java'>
        photo = np.array(crop_img,dtype = np.float32)
        photo = np.transpose(preprocess_input(photo), (2, 0, 1))

        <a id="change">with torch</a><a id="change">.no_grad():
            </a>images<a id="change"> = </a>torch.from_numpy(<a id="change">np.asarray([</a>photo<a id="change"></a>]<a id="change">)</a>)
            <a id="change">if </a>self.cuda:
                images = images.cuda()

            &#47&#47---------------------------------------------------------&#47&#47
            &#47&#47   传入网络当中进行预测
            &#47&#47---------------------------------------------------------&#47&#47
            _<a id="change">, regression, classification, anchors = </a>self.net(images)
            
            &#47&#47-----------------------------------------------------------&#47&#47
            &#47&#47   将预测结果进行解码
            &#47&#47-----------------------------------------------------------&#47&#47
            regression<a id="change"> = </a>decodebox(regression, anchors, images)
            detection<a id="change"> = </a>torch.cat([regression,classification],axis=-1)
            batch_detections<a id="change"> = </a>non_max_suppression(detection, len(self.class_names),
                                                    conf_thres=self.confidence,
                                                    nms_thres=self.iou)
            &#47&#47--------------------------------------&#47&#47</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 23</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/bubbliiiing/retinanet-pytorch/commit/b891c38c3b4260fd7958c83ab9cc473c0f5dbb8f#diff-be24762c194cbd637f6d4ac2d7d7dd057ed69fd3777c63feddb563d10d634078L100' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 32509984</div><div id='project'> Project Name: bubbliiiing/retinanet-pytorch</div><div id='commit'> Commit Name: b891c38c3b4260fd7958c83ab9cc473c0f5dbb8f</div><div id='time'> Time: 2021-01-19</div><div id='author'> Author: 47347516+bubbliiiing@users.noreply.github.com</div><div id='file'> File Name: retinanet.py</div><div id='m_class'> M Class Name: RetinaNet</div><div id='n_method'> N Class Name: RetinaNet</div><div id='m_method'> M Method Name: detect_image(2)</div><div id='n_method'> N Method Name: detect_image(2)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: retinanet.py</div><div id='n_file'> N File Name: retinanet.py</div><div id='m_start'> M Start Line: 100</div><div id='m_end'> M End Line: 134</div><div id='n_start'> N Start Line: 112</div><div id='n_end'> N End Line: 180</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        crop_img = np.array(letterbox_image(image, self.image_size))
        photo = np.array(crop_img,dtype = np.float32)
        photo = np.transpose(preprocess_input(photo), (2, 0, 1))
        <a id="change">images</a><a id="change"> = </a><a id="change">[]</a>
        <a id="change">images.append(</a>photo<a id="change">)</a>
        images<a id="change"> = </a><a id="change">np.asarray(</a>images<a id="change">)</a>

        <a id="change">with torch</a><a id="change">.no_grad():
            </a>images<a id="change"> = </a>torch.from_numpy(images)
            <a id="change">if </a>self.cuda:
                images = images.cuda()
            _<a id="change">, regression, classification, anchors = </a>self.net(images)
            
            regression<a id="change"> = </a>decodebox(regression, anchors, images)
            detection<a id="change"> = </a>torch.cat([regression,classification],axis=-1)
            batch_detections<a id="change"> = </a>non_max_suppression(detection, len(self.class_names),
                                                    conf_thres=self.confidence,
                                                    nms_thres=self.iou)
        try:</code></pre><h3>After Change</h3><pre><code class='java'>
        photo = np.array(crop_img,dtype = np.float32)
        photo = np.transpose(preprocess_input(photo), (2, 0, 1))

        <a id="change">with torch</a><a id="change">.no_grad():
            </a>images<a id="change"> = </a>torch.from_numpy(<a id="change">np.asarray([</a>photo<a id="change"></a>]<a id="change">)</a>)
            <a id="change">if </a>self.cuda:
                images = images.cuda()

            &#47&#47---------------------------------------------------------&#47&#47
            &#47&#47   传入网络当中进行预测
            &#47&#47---------------------------------------------------------&#47&#47
            _<a id="change">, regression, classification, anchors = </a>self.net(images)
            
            &#47&#47-----------------------------------------------------------&#47&#47
            &#47&#47   将预测结果进行解码
            &#47&#47-----------------------------------------------------------&#47&#47
            regression<a id="change"> = </a>decodebox(regression, anchors, images)
            detection<a id="change"> = </a>torch.cat([regression,classification],axis=-1)
            batch_detections<a id="change"> = </a>non_max_suppression(detection, len(self.class_names),
                                                    conf_thres=self.confidence,
                                                    nms_thres=self.iou)
            &#47&#47--------------------------------------&#47&#47</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/bubbliiiing/retinanet-pytorch/commit/b891c38c3b4260fd7958c83ab9cc473c0f5dbb8f#diff-be24762c194cbd637f6d4ac2d7d7dd057ed69fd3777c63feddb563d10d634078L97' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 32509986</div><div id='project'> Project Name: bubbliiiing/retinanet-pytorch</div><div id='commit'> Commit Name: b891c38c3b4260fd7958c83ab9cc473c0f5dbb8f</div><div id='time'> Time: 2021-01-19</div><div id='author'> Author: 47347516+bubbliiiing@users.noreply.github.com</div><div id='file'> File Name: retinanet.py</div><div id='m_class'> M Class Name: RetinaNet</div><div id='n_method'> N Class Name: RetinaNet</div><div id='m_method'> M Method Name: detect_image(2)</div><div id='n_method'> N Method Name: detect_image(2)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: retinanet.py</div><div id='n_file'> N File Name: retinanet.py</div><div id='m_start'> M Start Line: 100</div><div id='m_end'> M End Line: 134</div><div id='n_start'> N Start Line: 112</div><div id='n_end'> N End Line: 180</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        crop_img = np.array(letterbox_image(image, (image_sizes[self.phi],image_sizes[self.phi])))
        photo = np.array(crop_img,dtype = np.float32)
        photo = np.transpose(preprocess_input(photo), (2, 0, 1))
        <a id="change">images</a><a id="change"> = </a><a id="change">[]</a>
        <a id="change">images.append(</a>photo<a id="change">)</a>
        images<a id="change"> = </a><a id="change">np.asarray(</a>images<a id="change">)</a>

        <a id="change">with torch</a><a id="change">.no_grad():
            </a>images<a id="change"> = </a>torch.from_numpy(images)
            <a id="change">if </a>self.cuda:
                images = images.cuda()
            _<a id="change">, regression, classification, anchors = </a>self.net(images)
            
            regression<a id="change"> = </a>decodebox(regression, anchors, images)
            detection<a id="change"> = </a>torch.cat([regression,classification],axis=-1)
            batch_detections<a id="change"> = </a>non_max_suppression(detection, len(self.class_names),
                                                    conf_thres=self.confidence,
                                                    nms_thres=self.iou)
        try:</code></pre><h3>After Change</h3><pre><code class='java'>
        photo = np.array(crop_img,dtype = np.float32)
        photo = np.transpose(preprocess_input(photo), (2, 0, 1))

        <a id="change">with torch</a><a id="change">.no_grad():
            </a>images<a id="change"> = </a>torch.from_numpy(<a id="change">np.asarray([</a>photo<a id="change"></a>]<a id="change">)</a>)
            <a id="change">if </a>self.cuda:
                images = images.cuda()

            &#47&#47---------------------------------------------------------&#47&#47
            &#47&#47   传入网络当中进行预测
            &#47&#47---------------------------------------------------------&#47&#47
            _<a id="change">, regression, classification, anchors = </a>self.net(images)
            
            &#47&#47-----------------------------------------------------------&#47&#47
            &#47&#47   将预测结果进行解码
            &#47&#47-----------------------------------------------------------&#47&#47
            regression<a id="change"> = </a>decodebox(regression, anchors, images)
            detection<a id="change"> = </a>torch.cat([regression,classification],axis=-1)
            batch_detections<a id="change"> = </a>non_max_suppression(detection, len(self.class_names),
                                                    conf_thres=self.confidence,
                                                    nms_thres=self.iou)
            &#47&#47--------------------------------------&#47&#47</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/bubbliiiing/efficientdet-pytorch/commit/dcf23456863be9f58dd6fdd33a34d777e9dd2b46#diff-2017cebeb16bd4cb4bd48238ade7e0a1c929224180b6955df9417fec7c67b56fL34' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 32509972</div><div id='project'> Project Name: bubbliiiing/efficientdet-pytorch</div><div id='commit'> Commit Name: dcf23456863be9f58dd6fdd33a34d777e9dd2b46</div><div id='time'> Time: 2021-01-18</div><div id='author'> Author: 47347516+bubbliiiing@users.noreply.github.com</div><div id='file'> File Name: get_dr_txt.py</div><div id='m_class'> M Class Name: mAP_EfficientDet</div><div id='n_method'> N Class Name: mAP_EfficientDet</div><div id='m_method'> M Method Name: detect_image(3)</div><div id='n_method'> N Method Name: detect_image(3)</div><div id='m_parent_class'> M Parent Class: EfficientDet</div><div id='n_parent_class'> N Parent Class: EfficientDet</div><div id='m_file'> M File Name: get_dr_txt.py</div><div id='n_file'> N File Name: get_dr_txt.py</div><div id='m_start'> M Start Line: 42</div><div id='m_end'> M End Line: 80</div><div id='n_start'> N Start Line: 47</div><div id='n_end'> N End Line: 97</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        crop_img = np.array(letterbox_image(image, self.image_size))
        photo = np.array(crop_img,dtype = np.float32)
        photo = np.transpose(preprocess_input(photo), (2, 0, 1))
        <a id="change">images</a><a id="change"> = </a><a id="change">[]</a>
        <a id="change">images.append(</a>photo<a id="change">)</a>
        images<a id="change"> = </a><a id="change">np.asarray(</a>images<a id="change">)</a>

        <a id="change">with torch</a><a id="change">.no_grad():
            </a>images<a id="change"> = </a>torch.from_numpy(images)
            <a id="change">if </a>self.cuda:
                images = images.cuda()
            _<a id="change">, regression, classification, anchors = </a>self.net(images)
            
            regression<a id="change"> = </a>decodebox(regression, anchors, images)
            detection<a id="change"> = </a>torch.cat([regression,classification],axis=-1)
            batch_detections<a id="change"> = </a>non_max_suppression(detection, len(self.class_names),
                                                    conf_thres=self.confidence,
                                                    nms_thres=0.3)
        try:</code></pre><h3>After Change</h3><pre><code class='java'>
        photo = np.array(crop_img,dtype = np.float32)
        photo = np.transpose(preprocess_input(photo), (2, 0, 1))

        <a id="change">with torch</a><a id="change">.no_grad():
            </a>images<a id="change"> = </a>torch.from_numpy(<a id="change">np.asarray([</a>photo<a id="change"></a>]<a id="change">)</a>)
            <a id="change">if </a>self.cuda:
                images = images.cuda()

            &#47&#47---------------------------------------------------------&#47&#47
            &#47&#47   传入网络当中进行预测
            &#47&#47---------------------------------------------------------&#47&#47
            _<a id="change">, regression, classification, anchors = </a>self.net(images)
            
            &#47&#47-----------------------------------------------------------&#47&#47
            &#47&#47   将预测结果进行解码
            &#47&#47-----------------------------------------------------------&#47&#47
            regression<a id="change"> = </a>decodebox(regression, anchors, images)
            detection<a id="change"> = </a>torch.cat([regression,classification],axis=-1)
            batch_detections<a id="change"> = </a>non_max_suppression(detection, len(self.class_names),
                                                    conf_thres=self.confidence,
                                                    nms_thres=self.iou)
            &#47&#47--------------------------------------&#47&#47</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/bubbliiiing/retinanet-pytorch/commit/b891c38c3b4260fd7958c83ab9cc473c0f5dbb8f#diff-2017cebeb16bd4cb4bd48238ade7e0a1c929224180b6955df9417fec7c67b56fL33' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 32509974</div><div id='project'> Project Name: bubbliiiing/retinanet-pytorch</div><div id='commit'> Commit Name: b891c38c3b4260fd7958c83ab9cc473c0f5dbb8f</div><div id='time'> Time: 2021-01-19</div><div id='author'> Author: 47347516+bubbliiiing@users.noreply.github.com</div><div id='file'> File Name: get_dr_txt.py</div><div id='m_class'> M Class Name: mAP_RetinaNet</div><div id='n_method'> N Class Name: mAP_RetinaNet</div><div id='m_method'> M Method Name: detect_image(3)</div><div id='n_method'> N Method Name: detect_image(3)</div><div id='m_parent_class'> M Parent Class: RetinaNet</div><div id='n_parent_class'> N Parent Class: RetinaNet</div><div id='m_file'> M File Name: get_dr_txt.py</div><div id='n_file'> N File Name: get_dr_txt.py</div><div id='m_start'> M Start Line: 39</div><div id='m_end'> M End Line: 79</div><div id='n_start'> N Start Line: 42</div><div id='n_end'> N End Line: 94</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        crop_img = np.array(letterbox_image(image, (image_sizes[self.phi],image_sizes[self.phi])))
        photo = np.array(crop_img,dtype = np.float32)
        photo = np.transpose(preprocess_input(photo), (2, 0, 1))
        <a id="change">images</a><a id="change"> = </a><a id="change">[]</a>
        <a id="change">images.append(</a>photo<a id="change">)</a>
        images<a id="change"> = </a><a id="change">np.asarray(</a>images<a id="change">)</a>

        <a id="change">with torch</a><a id="change">.no_grad():
            </a>images<a id="change"> = </a>torch.from_numpy(images)
            <a id="change">if </a>self.cuda:
                images = images.cuda()
            _<a id="change">, regression, classification, anchors = </a>self.net(images)
            
            regression<a id="change"> = </a>decodebox(regression, anchors, images)
            detection<a id="change"> = </a>torch.cat([regression,classification],axis=-1)
            batch_detections<a id="change"> = </a>non_max_suppression(detection, len(self.class_names),
                                                    conf_thres=self.confidence,
                                                    nms_thres=self.iou)
        try:</code></pre><h3>After Change</h3><pre><code class='java'>
        photo = np.array(crop_img,dtype = np.float32)
        photo = np.transpose(preprocess_input(photo), (2, 0, 1))

        <a id="change">with torch</a><a id="change">.no_grad():
            </a>images<a id="change"> = </a>torch.from_numpy(<a id="change">np.asarray([</a>photo<a id="change"></a>]<a id="change">)</a>)
            <a id="change">if </a>self.cuda:
                images = images.cuda()

            &#47&#47---------------------------------------------------------&#47&#47
            &#47&#47   传入网络当中进行预测
            &#47&#47---------------------------------------------------------&#47&#47
            _<a id="change">, regression, classification, anchors = </a>self.net(images)
            
            &#47&#47-----------------------------------------------------------&#47&#47
            &#47&#47   将预测结果进行解码
            &#47&#47-----------------------------------------------------------&#47&#47
            regression<a id="change"> = </a>decodebox(regression, anchors, images)
            detection<a id="change"> = </a>torch.cat([regression,classification],axis=-1)
            batch_detections<a id="change"> = </a>non_max_suppression(detection, len(self.class_names),
                                                    conf_thres=self.confidence,
                                                    nms_thres=self.iou)
            &#47&#47--------------------------------------&#47&#47</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/bubbliiiing/efficientdet-pytorch/commit/dcf23456863be9f58dd6fdd33a34d777e9dd2b46#diff-567ef7e5070869e637aeba7471621b907fce9ecd180f20e4e2cda565f99f703eL93' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 32509979</div><div id='project'> Project Name: bubbliiiing/efficientdet-pytorch</div><div id='commit'> Commit Name: dcf23456863be9f58dd6fdd33a34d777e9dd2b46</div><div id='time'> Time: 2021-01-18</div><div id='author'> Author: 47347516+bubbliiiing@users.noreply.github.com</div><div id='file'> File Name: efficientdet.py</div><div id='m_class'> M Class Name: EfficientDet</div><div id='n_method'> N Class Name: EfficientDet</div><div id='m_method'> M Method Name: detect_image(2)</div><div id='n_method'> N Method Name: detect_image(2)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: efficientdet.py</div><div id='n_file'> N File Name: efficientdet.py</div><div id='m_start'> M Start Line: 98</div><div id='m_end'> M End Line: 152</div><div id='n_start'> N Start Line: 107</div><div id='n_end'> N End Line: 173</div><BR>