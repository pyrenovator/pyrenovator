<html><h3>Pattern ID :31744
</h3><img src='92723206.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        for i, graph in zip(repeats, graphs):
            true_graphs += [graph] * i
        true_graph = data.Graph.pack(true_graphs)
        adj_result<a id="change"> = </a><a id="change">repeat_graph.adjacency.to_dense()</a>
        adj_truth<a id="change"> = </a><a id="change">true_graph.adjacency.to_dense()</a>
        node_feat_result<a id="change"> = </a>repeat_graph.node_feature
        node_feat_truth<a id="change"> = </a>true_graph.node_feature
        edge_feat_result<a id="change"> = </a>repeat_graph.edge_feature
        edge_feat_truth<a id="change"> = </a>true_graph.edge_feature
        <a id="change">self.assertTrue(torch</a><a id="change">.equal(</a>adj_result, adj_truth<a id="change">)</a>, <a id="change">"Incorrect index in repeat_interleave"</a><a id="change">)</a>
        <a id="change">self.assertTrue(torch</a><a id="change">.equal(</a>node_feat_result, node_feat_truth<a id="change">)</a>, <a id="change">"Incorrect feature in repeat_interleave"</a><a id="change">)</a>
        <a id="change">self.assertTrue(torch.equal(</a>edge_feat_result, edge_feat_truth<a id="change">)</a>, <a id="change">"Incorrect feature in repeat_interleave"</a><a id="change">)</a>

    def test_split(self):
        graph = data.Graph(self.edge_list, self.edge_weight, self.num_node)
        node2graph = torch.randint(3, (10,))</code></pre><h3>After Change</h3><pre><code class='java'>
        for i, graph in zip(repeats, graphs):
            true_graphs += [graph] * i
        true_graph = data.Graph.pack(true_graphs)
        <a id="change">self.assert_equal(</a>repeat_graph, true_graph, <a id="change">"repeat interleave"</a><a id="change">)</a>

    def test_repeated_index(self):
        graph = data.Graph(self.edge_list, self.edge_weight, self.num_node)
        graphs = []</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 15</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/deepgraphlearning/torchdrug/commit/98c855a3b81929bfc2567d382b8e9a9ad44a89a3#diff-db79008d0bcf7afb13ce64bbce0e7bef47cb66ed430f1eb1eab787a0a01396f2L224' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 92723206</div><div id='project'> Project Name: deepgraphlearning/torchdrug</div><div id='commit'> Commit Name: 98c855a3b81929bfc2567d382b8e9a9ad44a89a3</div><div id='time'> Time: 2021-10-14</div><div id='author'> Author: healmysoul@163.com</div><div id='file'> File Name: test/data/test_graph.py</div><div id='m_class'> M Class Name: GraphTest</div><div id='n_method'> N Class Name: GraphTest</div><div id='m_method'> M Method Name: test_repeat_interleave(1)</div><div id='n_method'> N Method Name: test_repeat_interleave(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: test/data/test_graph.py</div><div id='n_file'> N File Name: test/data/test_graph.py</div><div id='m_start'> M Start Line: 273</div><div id='m_end'> M End Line: 286</div><div id='n_start'> N Start Line: 224</div><div id='n_end'> N End Line: 229</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        for i, graph in zip(repeats, graphs):
            true_graphs += [graph] * i
        true_graph = data.Graph.pack(true_graphs)
        adj_result<a id="change"> = </a><a id="change">repeat_graph.adjacency.to_dense()</a>
        adj_truth<a id="change"> = </a><a id="change">true_graph.adjacency.to_dense()</a>
        node_feat_result<a id="change"> = </a>repeat_graph.node_feature
        node_feat_truth<a id="change"> = </a>true_graph.node_feature
        edge_feat_result<a id="change"> = </a>repeat_graph.edge_feature
        edge_feat_truth<a id="change"> = </a>true_graph.edge_feature
        <a id="change">self.assertTrue(</a><a id="change">torch.equal(</a>adj_result, adj_truth<a id="change">)</a>, <a id="change">"Incorrect index in repeat_interleave"</a><a id="change">)</a>
        <a id="change">self.assertTrue(</a><a id="change">torch.equal(</a>node_feat_result, node_feat_truth<a id="change">)</a>, <a id="change">"Incorrect feature in repeat_interleave"</a><a id="change">)</a>
        <a id="change">self.assertTrue(torch.equal(</a>edge_feat_result, edge_feat_truth<a id="change">)</a>, <a id="change">"Incorrect feature in repeat_interleave"</a><a id="change">)</a>

    def test_split(self):
        graph = data.Graph(self.edge_list, self.edge_weight, self.num_node)
        node2graph = torch.randint(3, (10,))</code></pre><h3>After Change</h3><pre><code class='java'>
        for i, graph in zip(repeats, graphs):
            true_graphs += [graph] * i
        true_graph = data.Graph.pack(true_graphs)
        <a id="change">self.assert_equal(</a>repeat_graph, true_graph, <a id="change">"repeat interleave"</a><a id="change">)</a>

    def test_repeated_index(self):
        graph = data.Graph(self.edge_list, self.edge_weight, self.num_node)
        graphs = []</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/deepgraphlearning/torchdrug/commit/98c855a3b81929bfc2567d382b8e9a9ad44a89a3#diff-db79008d0bcf7afb13ce64bbce0e7bef47cb66ed430f1eb1eab787a0a01396f2L262' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 92723204</div><div id='project'> Project Name: deepgraphlearning/torchdrug</div><div id='commit'> Commit Name: 98c855a3b81929bfc2567d382b8e9a9ad44a89a3</div><div id='time'> Time: 2021-10-14</div><div id='author'> Author: healmysoul@163.com</div><div id='file'> File Name: test/data/test_graph.py</div><div id='m_class'> M Class Name: GraphTest</div><div id='n_method'> N Class Name: GraphTest</div><div id='m_method'> M Method Name: test_repeat_interleave(1)</div><div id='n_method'> N Method Name: test_repeat_interleave(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: test/data/test_graph.py</div><div id='n_file'> N File Name: test/data/test_graph.py</div><div id='m_start'> M Start Line: 273</div><div id='m_end'> M End Line: 286</div><div id='n_start'> N Start Line: 224</div><div id='n_end'> N End Line: 229</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        order = torch.randperm(4)
        packed_graph = packed_graph.subbatch(order)
        packed_graph2 = data.Graph.pack([graphs[i] for i in order])
        adj_result<a id="change"> = </a><a id="change">packed_graph.adjacency.to_dense()</a>
        adj_truth<a id="change"> = </a><a id="change">packed_graph2.adjacency.to_dense()</a>
        node_feat_result<a id="change"> = </a>packed_graph.node_feature
        node_feat_truth<a id="change"> = </a>packed_graph2.node_feature
        edge_feat_result<a id="change"> = </a>packed_graph.edge_feature
        edge_feat_truth<a id="change"> = </a>packed_graph2.edge_feature
        <a id="change">self.assertTrue(</a><a id="change">torch.equal(</a>adj_result, adj_truth<a id="change">)</a>, <a id="change">"Incorrect graph reorder"</a><a id="change">)</a>
        <a id="change">self.assertTrue(torch.equal(</a>node_feat_result, node_feat_truth<a id="change">)</a>, <a id="change">"Incorrect graph reorder"</a><a id="change">)</a>
        <a id="change">self.assertTrue(</a><a id="change">torch.equal(</a>edge_feat_result, edge_feat_truth<a id="change">)</a>, <a id="change">"Incorrect graph reorder"</a><a id="change">)</a>

    def test_repeat(self):
        graph = data.Graph(self.edge_list, self.edge_weight, self.num_node,
                           node_feature=self.node_feature, edge_feature=self.edge_feature)</code></pre><h3>After Change</h3><pre><code class='java'>
        order = torch.randperm(4)
        packed_graph = packed_graph.subbatch(order)
        packed_graph2 = data.Graph.pack([graphs[i] for i in order])
        <a id="change">self.assert_equal(</a>packed_graph, packed_graph2, <a id="change">"graph reorder"</a><a id="change">)</a>

    def test_repeat(self):
        graph = data.Graph(self.edge_list, self.edge_weight, self.num_node,
                           node_feature=self.node_feature, edge_feature=self.edge_feature)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/deepgraphlearning/torchdrug/commit/98c855a3b81929bfc2567d382b8e9a9ad44a89a3#diff-db79008d0bcf7afb13ce64bbce0e7bef47cb66ed430f1eb1eab787a0a01396f2L184' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 92723205</div><div id='project'> Project Name: deepgraphlearning/torchdrug</div><div id='commit'> Commit Name: 98c855a3b81929bfc2567d382b8e9a9ad44a89a3</div><div id='time'> Time: 2021-10-14</div><div id='author'> Author: healmysoul@163.com</div><div id='file'> File Name: test/data/test_graph.py</div><div id='m_class'> M Class Name: GraphTest</div><div id='n_method'> N Class Name: GraphTest</div><div id='m_method'> M Method Name: test_reorder(1)</div><div id='n_method'> N Method Name: test_reorder(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: test/data/test_graph.py</div><div id='n_file'> N File Name: test/data/test_graph.py</div><div id='m_start'> M Start Line: 217</div><div id='m_end'> M End Line: 227</div><div id='n_start'> N Start Line: 192</div><div id='n_end'> N End Line: 194</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                           node_feature=self.node_feature, edge_feature=self.edge_feature)
        repeat_graph = graph.repeat(5)
        true_graph = data.Graph.pack([graph] * 5)
        adj_result<a id="change"> = </a>repeat_graph.adjacency.to_dense()
        adj_truth<a id="change"> = </a>true_graph.adjacency.to_dense()
        node_feat_result = repeat_graph.node_feature
        node_feat_truth = true_graph.node_feature
        edge_feat_result = repeat_graph.edge_feature
        edge_feat_truth = true_graph.edge_feature
        self.assertTrue(torch.equal(adj_result, adj_truth), "Incorrect index in repeat")
        <a id="change">self.assertTrue(</a><a id="change">torch.equal(</a>node_feat_result, node_feat_truth<a id="change">)</a>, <a id="change">"Incorrect feature in repeat"</a><a id="change">)</a>
        self.assertTrue(torch.equal(edge_feat_result, edge_feat_truth), "Incorrect feature in repeat")

        &#47&#47 special case: graphs with no edges
        graphs = [graph.edge_mask([]), graph.edge_mask([])]
        for start in range(4):
            index = torch.arange(start, self.num_node)
            graphs.append(graph.subgraph(index))
        packed_graph = data.Graph.pack(graphs)
        repeat_graph = packed_graph.repeat(5)
        true_graph = data.Graph.pack(graphs * 5)
        adj_result<a id="change"> = </a><a id="change">repeat_graph.adjacency.to_dense()</a>
        adj_truth<a id="change"> = </a><a id="change">true_graph.adjacency.to_dense()</a>
        node_feat_result<a id="change"> = </a>repeat_graph.node_feature
        node_feat_truth<a id="change"> = </a>true_graph.node_feature
        edge_feat_result = repeat_graph.edge_feature
        edge_feat_truth = true_graph.edge_feature
        <a id="change">self.assertTrue(</a><a id="change">torch.equal(</a>adj_result, adj_truth<a id="change">)</a>, <a id="change">"Incorrect index in repeat"</a><a id="change">)</a>
        <a id="change">self.assertTrue(torch.equal(</a>node_feat_result, node_feat_truth<a id="change">)</a>, <a id="change">"Incorrect feature in repeat"</a><a id="change">)</a>
        self.assertTrue(torch.equal(edge_feat_result, edge_feat_truth), "Incorrect feature in repeat")

    def test_repeat_interleave(self):
        graph = data.Graph(self.edge_list, self.edge_weight, self.num_node,</code></pre><h3>After Change</h3><pre><code class='java'>
                           node_feature=self.node_feature, edge_feature=self.edge_feature)
        repeat_graph = graph.repeat(5)
        true_graph = data.Graph.pack([graph] * 5)
        <a id="change">self.assert_equal(</a>repeat_graph, true_graph, <a id="change">"repeat"</a><a id="change">)</a>

        &#47&#47 special case: graphs with no edges
        graphs = [graph.edge_mask([]), graph.edge_mask([])]
        for start in range(4):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/deepgraphlearning/torchdrug/commit/98c855a3b81929bfc2567d382b8e9a9ad44a89a3#diff-db79008d0bcf7afb13ce64bbce0e7bef47cb66ed430f1eb1eab787a0a01396f2L229' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 92723151</div><div id='project'> Project Name: deepgraphlearning/torchdrug</div><div id='commit'> Commit Name: 98c855a3b81929bfc2567d382b8e9a9ad44a89a3</div><div id='time'> Time: 2021-10-14</div><div id='author'> Author: healmysoul@163.com</div><div id='file'> File Name: test/data/test_graph.py</div><div id='m_class'> M Class Name: GraphTest</div><div id='n_method'> N Class Name: GraphTest</div><div id='m_method'> M Method Name: test_repeat(1)</div><div id='n_method'> N Method Name: test_repeat(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: test/data/test_graph.py</div><div id='n_file'> N File Name: test/data/test_graph.py</div><div id='m_start'> M Start Line: 232</div><div id='m_end'> M End Line: 260</div><div id='n_start'> N Start Line: 199</div><div id='n_end'> N End Line: 211</div><BR>