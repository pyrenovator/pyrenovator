<html><h3>Pattern ID :11736
</h3><img src='39555867.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        for epoch in range(self.poison_iteration):
            optimizer.zero_grad()
            l2_loss = 0.0
            <a id="change">for </a>ind in self.ynt_sub_inds<a id="change">:
                </a>ynt_img = self.ynt_imgs[ind].cuda()
                ynt_img = ynt_img * (1-self.mask) + self.mask * torch.sigmoid(self.mark)
                ynt_img<a id="change"> = </a>ynt_img.unsqueeze(0)
                ynt_featmap = self.model.get_fm_before_outlayer(ynt_img)
                l2_loss<a id="change"> += </a>criterion(ynt_featmap, yt_avg_featmap)
            
            l2_loss = torch.div(l2_loss, len(self.ynt_sub_inds))
            print("Epoch {} | MSE Loss {}".format(epoch, l2_loss))</code></pre><h3>After Change</h3><pre><code class='java'>
            ynt_img = self.ynt_imgs[self.ynt_sub_inds].cuda()
            ynt_img = ynt_img * (1-self.mask) + self.mask * torch.sigmoid(self.mark)
            ynt_featmap = self.model.get_fm_before_outlayer(ynt_img)
            l2_loss<a id="change"> = </a>criterion(ynt_featmap, <a id="change">yt_avg_featmap.clone()</a>.detach())
            
            print("Epoch {} | MSE Loss {}".format(epoch, l2_loss))
            l2_loss.backward()</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/ain-soph/trojanzoo/commit/ab9477e1b0e41c6abe9e11d7345b20233d61b9d9#diff-1e9f08cdcf107dac703ba6ade89c7699ee84615bf2b5cdd4e776168a691df4dfL138' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 39555867</div><div id='project'> Project Name: ain-soph/trojanzoo</div><div id='commit'> Commit Name: ab9477e1b0e41c6abe9e11d7345b20233d61b9d9</div><div id='time'> Time: 2020-07-01</div><div id='author'> Author: zxx5113@lrs-twang01.ist.psu.edu</div><div id='file'> File Name: trojanzoo/attack/backdoor/latent_backdoor.py</div><div id='m_class'> M Class Name: Latent_Backdoor</div><div id='n_method'> N Class Name: Latent_Backdoor</div><div id='m_method'> M Method Name: generate_trigger(1)</div><div id='n_method'> N Method Name: generate_trigger(1)</div><div id='m_parent_class'> M Parent Class: BadNet</div><div id='n_parent_class'> N Parent Class: BadNet</div><div id='m_file'> M File Name: trojanzoo/attack/backdoor/latent_backdoor.py</div><div id='n_file'> N File Name: trojanzoo/attack/backdoor/latent_backdoor.py</div><div id='m_start'> M Start Line: 183</div><div id='m_end'> M End Line: 256</div><div id='n_start'> N Start Line: 138</div><div id='n_end'> N End Line: 204</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        for epoch in range(self.poison_iteration):
            optimizer.zero_grad()
            l2_loss = 0.0
            <a id="change">for ind</a> in self.ynt_sub_inds<a id="change">:
                </a>ynt_img<a id="change"> = </a>self.ynt_imgs[ind].cuda()
                ynt_img = ynt_img * (1-self.mask) + self.mask * torch.sigmoid(self.mark)
                ynt_img<a id="change"> = </a>ynt_img.unsqueeze(0)
                ynt_featmap = self.model.get_fm_before_outlayer(ynt_img)
                l2_loss += criterion(ynt_featmap, yt_avg_featmap)
            </code></pre><h3>After Change</h3><pre><code class='java'>
            ynt_img = self.ynt_imgs[self.ynt_sub_inds].cuda()
            ynt_img = ynt_img * (1-self.mask) + self.mask * torch.sigmoid(self.mark)
            ynt_featmap = self.model.get_fm_before_outlayer(ynt_img)
            l2_loss<a id="change"> = </a>criterion(ynt_featmap, <a id="change">yt_avg_featmap.clone()</a>.detach())
            
            print("Epoch {} | MSE Loss {}".format(epoch, l2_loss))
            l2_loss.backward()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ain-soph/trojanzoo/commit/ab9477e1b0e41c6abe9e11d7345b20233d61b9d9#diff-1e9f08cdcf107dac703ba6ade89c7699ee84615bf2b5cdd4e776168a691df4dfL150' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 39555899</div><div id='project'> Project Name: ain-soph/trojanzoo</div><div id='commit'> Commit Name: ab9477e1b0e41c6abe9e11d7345b20233d61b9d9</div><div id='time'> Time: 2020-07-01</div><div id='author'> Author: zxx5113@lrs-twang01.ist.psu.edu</div><div id='file'> File Name: trojanzoo/attack/backdoor/latent_backdoor.py</div><div id='m_class'> M Class Name: Latent_Backdoor</div><div id='n_method'> N Class Name: Latent_Backdoor</div><div id='m_method'> M Method Name: generate_trigger(1)</div><div id='n_method'> N Method Name: generate_trigger(1)</div><div id='m_parent_class'> M Parent Class: BadNet</div><div id='n_parent_class'> N Parent Class: BadNet</div><div id='m_file'> M File Name: trojanzoo/attack/backdoor/latent_backdoor.py</div><div id='n_file'> N File Name: trojanzoo/attack/backdoor/latent_backdoor.py</div><div id='m_start'> M Start Line: 183</div><div id='m_end'> M End Line: 256</div><div id='n_start'> N Start Line: 138</div><div id='n_end'> N End Line: 204</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    mrr, hits = [], []

    <a id="change">for i</a>, (s, p, o) in enumerate(test_spo)<a id="change">:
        </a>row<a id="change"> = </a>scores[i]  &#47&#47 corresponding predictions
        idx = o if direction == "o" else s
        true_score = row[idx]

        &#47&#47 remove current label from scores
        row<a id="change"> = </a>row.clone()
        row[idx] = float("-Inf")

        &#47&#47 follow LibKGE protocol for ranking and ties</code></pre><h3>After Change</h3><pre><code class='java'>
    true_scores = scores[arange, targets].view(-1, 1)

    &#47&#47 remove the true subjects/objects from the scores so they don&quott factor in rankings
    scores<a id="change"> = </a><a id="change">scores.clone()</a>
    scores[arange, targets] = float("-Inf")

    &#47&#47 follow LibKGE protocol by taking the mean rank among all entities with same score
    ranks = torch.sum(scores &gt; true_scores, dim=1, dtype=torch.double)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tsafavi/codex/commit/3dddca246e4fb616cef251bafb32dac648e8eedb#diff-7473d3c6ae8fdca415f05877da582b17af17f591a0a1312717bb10fd4da4b992L119' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 39555897</div><div id='project'> Project Name: tsafavi/codex</div><div id='commit'> Commit Name: 3dddca246e4fb616cef251bafb32dac648e8eedb</div><div id='time'> Time: 2020-07-08</div><div id='author'> Author: tsafavi@umich.edu</div><div id='file'> File Name: scripts/baseline.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: evaluate_rankings(5)</div><div id='n_method'> N Method Name: evaluate_rankings(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: scripts/baseline.py</div><div id='n_file'> N File Name: scripts/baseline.py</div><div id='m_start'> M Start Line: 129</div><div id='m_end'> M End Line: 151</div><div id='n_start'> N Start Line: 129</div><div id='n_end'> N End Line: 148</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    if num &gt; 1:
        pieces = []

        <a id="change">for i</a> in range(1, num + 1)<a id="change">:

            </a>start<a id="change"> = </a>piece_length * (i - 1)
            end = piece_length * i
            piece = spec[:, start:end]

            if i == num:
                piece<a id="change"> = </a>spec[:, start:]

            freq(piece)
            time(piece)</code></pre><h3>After Change</h3><pre><code class='java'>

def augment(in_spec, chunk_size=30, freq_mask_param=10, time_mask_param=6):

    spec<a id="change"> = </a><a id="change">torch.clone(</a>in_spec<a id="change">)</a>

    freq_mask = torchaudio.transforms.FrequencyMasking(freq_mask_param=freq_mask_param, iid_masks=True)
    time_mask = torchaudio.transforms.TimeMasking(time_mask_param=time_mask_param, iid_masks=True)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ivankunyankin/quartznet-asr/commit/28f999e7cfbefb66c9545f32e76a7454a7432aac#diff-09d0cbaf891d623ac245ccf84485a687b554217349ca55557c60b33234b969aeL55' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 39555922</div><div id='project'> Project Name: ivankunyankin/quartznet-asr</div><div id='commit'> Commit Name: 28f999e7cfbefb66c9545f32e76a7454a7432aac</div><div id='time'> Time: 2021-07-01</div><div id='author'> Author: IKunyankin@gmail.com</div><div id='file'> File Name: utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: augment(4)</div><div id='n_method'> N Method Name: augment(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: utils.py</div><div id='n_file'> N File Name: utils.py</div><div id='m_start'> M Start Line: 57</div><div id='m_end'> M End Line: 82</div><div id='n_start'> N Start Line: 57</div><div id='n_end'> N End Line: 74</div><BR>