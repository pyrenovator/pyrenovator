<html><h3>Pattern ID :37358
</h3><img src='107500425.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                                "_x" + str(upscale_factor) + 
                                ".png")
            else:
                result_path<a id="change"> = </a>(<a id="change">img.replace(".png"</a>,<a id="change">""</a><a id="change">)</a> + 
                            "_"  + AI_model +
                            "_x" + str(upscale_factor) + 
                            ".png")</code></pre><h3>After Change</h3><pre><code class='java'>
        ErrorMessage(error_root,  "upscale_problem")

def torch_AI_upscale_video_frames(video_frames_list, AI_model, upscale_factor, device):
    <a id="change">try:
        &#47&#47 0) define the model
        </a>model = prepare_torch_model(AI_model, device)
        optimize_torch(device)

        &#47&#47 1) resize all images
        downscaled_images = []
        for image in video_frames_list:
            img_downscaled = resize_image(image, upscale_factor)
            downscaled_images.append(img_downscaled)

        for img in downscaled_images:
            result_path = (img.replace("_resized.png","").replace(".png","") + 
                            "_"  + AI_model +
                            "_x" + str(upscale_factor) + 
                            ".png")

            &#47&#47 2) calculating best slice number
            img_tmp = cv2.imread(img)
            val = min(img_tmp.shape[1], img_tmp.shape[0])
            num_tiles = round(val/cut_image_factor)
            if (num_tiles % 2) != 0:
                num_tiles += 1

            &#47&#47 3) divide the image in tiles
            tiles<a id="change"> = </a>slice_image(img, num_tiles)

            &#47&#47 4) upscale each tiles
            with torch.no_grad():</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/djdefrag/qualityscaler/commit/66cef0855cfbe41b27938a88cd316575f61f5507#diff-84f2858c19a17bc7224331c82c8eb4a2050df894e2e6f84183ecec96e1e47024L416' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107500425</div><div id='project'> Project Name: djdefrag/qualityscaler</div><div id='commit'> Commit Name: 66cef0855cfbe41b27938a88cd316575f61f5507</div><div id='time'> Time: 2022-05-04</div><div id='author'> Author: jjluca96@gmail.com</div><div id='file'> File Name: QualityScaler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: torch_AI_upscale_video_frames(4)</div><div id='n_method'> N Method Name: torch_AI_upscale_video_frames(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: QualityScaler.py</div><div id='n_file'> N File Name: QualityScaler.py</div><div id='m_start'> M Start Line: 620</div><div id='m_end'> M End Line: 673</div><div id='n_start'> N Start Line: 416</div><div id='n_end'> N End Line: 465</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                                "_x" + str(upscale_factor) + 
                                ".png")
            else:
                result_path<a id="change"> = </a>(<a id="change">img.replace(".png"</a>,<a id="change">""</a><a id="change">)</a> + 
                            "_"  + AI_model +
                            "_x" + str(upscale_factor) + 
                            ".png")</code></pre><h3>After Change</h3><pre><code class='java'>
    return model.to(backend, non_blocking=True)

def torch_AI_upscale_multiple_images(image_list, AI_model, upscale_factor, device):
    <a id="change">try:
        &#47&#47 0) define the model
        </a>model = prepare_torch_model(AI_model, device)
        optimize_torch(device)

        &#47&#47 1) resize all images
        downscaled_images = []
        for image in image_list:
            img_downscaled = resize_image(image, upscale_factor)
            downscaled_images.append(img_downscaled)

        
        for img in downscaled_images:
            result_path = (img.replace("_resized.png","").replace(".png","") + 
                            "_"  + AI_model +
                            "_x" + str(upscale_factor) + 
                            ".png")

            &#47&#47 2) calculating best slice number
            img_tmp = cv2.imread(img)
            val = min(img_tmp.shape[1], img_tmp.shape[0])
            num_tiles = round(val/cut_image_factor)
            if (num_tiles % 2) != 0:
                num_tiles<a id="change"> += </a>1

            &#47&#47 3) divide the image in tiles
            tiles = slice_image(img, num_tiles)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/djdefrag/qualityscaler/commit/66cef0855cfbe41b27938a88cd316575f61f5507#diff-84f2858c19a17bc7224331c82c8eb4a2050df894e2e6f84183ecec96e1e47024L560' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107500428</div><div id='project'> Project Name: djdefrag/qualityscaler</div><div id='commit'> Commit Name: 66cef0855cfbe41b27938a88cd316575f61f5507</div><div id='time'> Time: 2022-05-04</div><div id='author'> Author: jjluca96@gmail.com</div><div id='file'> File Name: QualityScaler.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: torch_AI_upscale_multiple_images(4)</div><div id='n_method'> N Method Name: torch_AI_upscale_multiple_images(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: QualityScaler.py</div><div id='n_file'> N File Name: QualityScaler.py</div><div id='m_start'> M Start Line: 563</div><div id='m_end'> M End Line: 616</div><div id='n_start'> N Start Line: 364</div><div id='n_end'> N End Line: 414</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if char.startswith(&quotuni&quot):
            char = char.replace(&quotuni&quot, &quot\\u&quot)
        elif char.startswith(&quotuF&quot):
            char = <a id="change">char.replace(&quotuF&quot</a>, <a id="change">&quot\\u&quot</a><a id="change">)</a>
        else:
            continue
        char_utf8<a id="change"> = </a>char.encode(&quotutf-8&quot)
        try:
            char_escape = char_utf8.decode(&quotunicode_escape&quot)
        except UnicodeDecodeError:</code></pre><h3>After Change</h3><pre><code class='java'>
                char_int = int(char, base=16)
            except ValueError:
                continue
            <a id="change">try:
                </a>char<a id="change"> = </a>chr(char_int)
            except ValueError:
                continue
            res.add(char)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/euphoriayan/zi2zi-pytorch/commit/c756543761d62051dfb45c1c0a887ddb2656eba7#diff-52df0cdfe2583b3177226c3a4ff06ed5df0702c28d39c4cc1e988cf5b6aefdc2L77' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 107500430</div><div id='project'> Project Name: euphoriayan/zi2zi-pytorch</div><div id='commit'> Commit Name: c756543761d62051dfb45c1c0a887ddb2656eba7</div><div id='time'> Time: 2020-09-28</div><div id='author'> Author: ysq58000@foxmail.com</div><div id='file'> File Name: massive_font2img.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: processGlyphNames(1)</div><div id='n_method'> N Method Name: processGlyphNames(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: massive_font2img.py</div><div id='n_file'> N File Name: massive_font2img.py</div><div id='m_start'> M Start Line: 79</div><div id='m_end'> M End Line: 91</div><div id='n_start'> N Start Line: 79</div><div id='n_end'> N End Line: 96</div><BR>