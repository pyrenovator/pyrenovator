<html><h3>Pattern ID :13842
</h3><img src='46113841.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            output_dir (`Union[str, os.PathLike]`):
                The output directory where the quantized model will be saved.
        
        output_dir = output_dir<a id="change"> if </a>isinstance(output_dir, Path)<a id="change"> else </a>Path(output_dir)
        output_dir.mkdir(parents=True, exist_ok=True)
        model_path = output_dir.joinpath("model.onnx")
        quant_model_path = generate_identified_filename(model_path, "-quantized")</code></pre><h3>After Change</h3><pre><code class='java'>
            model_path = output_dir.joinpath("model.onnx")
            self.export(model_name_or_path, model_path, feature=feature, **kwargs)
        elif self.onnx_config is None and self.quantization_approach == ORTQuantizationMode.STATIC:
            <a id="change">if </a>config is None:
                raise ValueError(
                    "A configuration `config` associated to the model must be provided when applying static "
                    "quantization on a pre-existing ONNX model."
                )
            if not isinstance(config, PretrainedConfig):
                <a id="change">raise </a><a id="change">TypeError(
                    f"The configuration `config` associated to the pre-existing ONNX model is of type {type(config)}, "
                    f"which is not an instance of `PretrainedConfig`."</a><a id="change">
                )</a>
            model_onnx_config = FeaturesManager._SUPPORTED_MODEL_TYPE[config.model_type][feature]
            self.onnx_config<a id="change"> = </a>model_onnx_config(config)

        q_model_path = generate_identified_filename(model_path, "-quantized")
        if self.quantization_approach == ORTQuantizationMode.DYNAMIC:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/huggingface/optimum/commit/4e571292cac85460b01916bd434c5f1d9f972fcd#diff-3688cadccda29282df1b90910924f7a353b8e9cf4d2e50369484c95ee8e17172L163' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 46113841</div><div id='project'> Project Name: huggingface/optimum</div><div id='commit'> Commit Name: 4e571292cac85460b01916bd434c5f1d9f972fcd</div><div id='time'> Time: 2022-01-20</div><div id='author'> Author: 80481427+echarlaix@users.noreply.github.com</div><div id='file'> File Name: optimum/onnxruntime/quantization.py</div><div id='m_class'> M Class Name: ORTQuantizer</div><div id='n_method'> N Class Name: ORTQuantizer</div><div id='m_method'> M Method Name: fit(5)</div><div id='n_method'> N Method Name: fit(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: optimum/onnxruntime/quantization.py</div><div id='n_file'> N File Name: optimum/onnxruntime/quantization.py</div><div id='m_start'> M Start Line: 163</div><div id='m_end'> M End Line: 177</div><div id='n_start'> N Start Line: 190</div><div id='n_end'> N End Line: 232</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
      The block string
    
    collapse = len(content) &lt;= 1
    trailing = &quot&quot<a id="change"> if </a>collapse<a id="change"> else </a>&quot,&quot

    if isinstance(braces, str):
      braces = _BRACE_TO_BRACES[braces]</code></pre><h3>After Change</h3><pre><code class='java'>

    if isinstance(content, dict):
      parts = [f&quot{k}{equal}{v}&quot for k, v in content.items()]
    elif <a id="change"></a>isinstance(content, (list, tuple)):
      parts<a id="change"> = </a>[f&quot{v}&quot for v in content]
    else:
      <a id="change">raise </a><a id="change">TypeError(f&quotInvalid fields {type(content)}&quot</a><a id="change">)</a>

    collapse = len(parts) &lt;= 1
    if any(&quot\n&quot in p for p in parts):
      collapse = False</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/google/etils/commit/89d6729b6216f79edd2b5132085e6ad048ed2e21#diff-9f3af60edc980e0b3490d157cc8cda185a9318c4c502d31a37287bdd71255097L131' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 46113833</div><div id='project'> Project Name: google/etils</div><div id='commit'> Commit Name: 89d6729b6216f79edd2b5132085e6ad048ed2e21</div><div id='time'> Time: 2023-04-04</div><div id='author'> Author: epot@google.com</div><div id='file'> File Name: etils/epy/text_utils.py</div><div id='m_class'> M Class Name: Lines</div><div id='n_method'> N Class Name: Lines</div><div id='m_method'> M Method Name: make_block(0)</div><div id='n_method'> N Method Name: make_block(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: etils/epy/text_utils.py</div><div id='n_file'> N File Name: etils/epy/text_utils.py</div><div id='m_start'> M Start Line: 169</div><div id='m_end'> M End Line: 181</div><div id='n_start'> N Start Line: 177</div><div id='n_end'> N End Line: 202</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    assert &quotfeature&quot in config, &quotNo feature to test provided&quot
    feature = config[&quotfeature&quot]
    provided_range = config[&quotrange&quot]<a id="change"> if </a>&quotrange&quot in config<a id="change"> else </a>[]
    edited_outputs = {}
    for pred_key in pred_keys:
      edited_outputs[pred_key] = {}</code></pre><h3>After Change</h3><pre><code class='java'>
      TypeError: `config` is missing
    

    <a id="change">if </a>not config:
      <a id="change">raise </a><a id="change">TypeError(&quotconfig must be provided&quot</a><a id="change">)</a>

    feature<a id="change"> = </a>config.get(&quotfeature&quot)
    if not feature:
      raise KeyError(&quotConfig must have a "feature" field&quot)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/pair-code/lit/commit/ecd3a6623f2a0d45ae26c74d0d72fb68b7bcb9aa#diff-26a2d0bb6984647fb4fb11221c11cda0ecac26288cf83c2e609688b308256dacL55' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 46113830</div><div id='project'> Project Name: pair-code/lit</div><div id='commit'> Commit Name: ecd3a6623f2a0d45ae26c74d0d72fb68b7bcb9aa</div><div id='time'> Time: 2022-11-03</div><div id='author'> Author: ryanmullins@google.com</div><div id='file'> File Name: lit_nlp/components/pdp.py</div><div id='m_class'> M Class Name: PdpInterpreter</div><div id='n_method'> N Class Name: PdpInterpreter</div><div id='m_method'> M Method Name: run(6)</div><div id='n_method'> N Method Name: run(6)</div><div id='m_parent_class'> M Parent Class: lit_components.Interpreter</div><div id='n_parent_class'> N Parent Class: lit_components.Interpreter</div><div id='m_file'> M File Name: lit_nlp/components/pdp.py</div><div id='n_file'> N File Name: lit_nlp/components/pdp.py</div><div id='m_start'> M Start Line: 76</div><div id='m_end'> M End Line: 114</div><div id='n_start'> N Start Line: 87</div><div id='n_end'> N End Line: 126</div><BR>