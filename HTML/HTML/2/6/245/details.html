<html><h3>Pattern ID :245
</h3><img src='1920797.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        in_channels = 3
        out_channels = 64

        <a id="change">for </a>_ in <a id="change">range(</a>num_conv_block<a id="change">):
            </a>block += [nn.ReflectionPad2d(1),
                      nn.Conv2d(in_channels, out_channels, 3),
                      nn.LeakyReLU(),
                      nn.BatchNorm2d(out_channels)]</code></pre><h3>After Change</h3><pre><code class='java'>
    def __init__(self):
        super(Discriminator, self).__init__()

        self.features<a id="change"> = </a>nn.Sequential(
            &#47&#47 Conv0
            nn.Conv2d(3, 64, kernel_size=3, stride=1, padding=1, bias=False),
            nn.LeakyReLU(negative_slope=0.2, inplace=True),
            nn.Conv2d(64, 64, kernel_size=4, stride=2, padding=1, bias=False),
            nn.BatchNorm2d(64),
            nn.LeakyReLU(negative_slope=0.2, inplace=True),

            &#47&#47 Conv1
            nn.Conv2d(64, 128, kernel_size=3, stride=1, padding=1, bias=False),
            nn.BatchNorm2d(128),
            nn.LeakyReLU(negative_slope=0.2, inplace=True),
            nn.Conv2d(128, 128, kernel_size=4, stride=2, padding=1, bias=False),
            nn.BatchNorm2d(128),
            nn.LeakyReLU(negative_slope=0.2, inplace=True),

            &#47&#47 Conv2
            nn.Conv2d(128, 256, kernel_size=3, stride=1, padding=1, bias=False),
            nn.BatchNorm2d(256),
            nn.LeakyReLU(negative_slope=0.2, inplace=True),
            <a id="change">nn.Conv2d(256</a>, <a id="change">256</a><a id="change">, kernel_size=4, stride=2, padding=1, bias=False)</a>,
            nn.BatchNorm2d(256),
            nn.LeakyReLU(negative_slope=0.2, inplace=True),
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/lornatang/esrgan-pytorch/commit/8ef58f0f8458d618a99fffa07433927c9b9ef70f#diff-922d5955c025c76c1ff83c159f3370bb61503752c2b24aa0d2bb20c38bd37596L26' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 1920797</div><div id='project'> Project Name: lornatang/esrgan-pytorch</div><div id='commit'> Commit Name: 8ef58f0f8458d618a99fffa07433927c9b9ef70f</div><div id='time'> Time: 2020-10-12</div><div id='author'> Author: liuchangyu1111@gmail.com</div><div id='file'> File Name: esrgan_pytorch/model.py</div><div id='m_class'> M Class Name: Discriminator</div><div id='n_method'> N Class Name: Discriminator</div><div id='m_method'> M Method Name: __init__(1)</div><div id='n_method'> N Method Name: __init__(2)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: esrgan_pytorch/model.py</div><div id='n_file'> N File Name: esrgan_pytorch/model.py</div><div id='m_start'> M Start Line: 140</div><div id='m_end'> M End Line: 177</div><div id='n_start'> N Start Line: 26</div><div id='n_end'> N End Line: 74</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        self.conv1 = nn.Conv2d(3, 64, kernel_size=9, stride=1, padding=4)

        <a id="change">for </a>i in <a id="change">range(</a>self.n_residual_blocks<a id="change">):
            </a>self.add_module("residual_block_" + str(i + 1), ResidualBlock())

        self.conv2 = nn.Conv2d(64, 64, kernel_size=3, stride=1, padding=1)
        self.bn = nn.BatchNorm2d(64)</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 Upsampling layers
        upsampling = []
        for out_features in range(upsample_block_num):
            upsampling<a id="change"> += </a>[
                <a id="change">nn.Conv2d(64</a>, 256, 3, 1, <a id="change">1</a><a id="change">)</a>,
                nn.BatchNorm2d(256),
                nn.PixelShuffle(upscale_factor=2),
                nn.PReLU(),</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/lornatang/srgan-pytorch/commit/acd467b89c7ccd5ca556b43a505b5745feda6b21#diff-a953b33cee07c104980e771037f7c50ac9861f73e6e07e04b2990ed8b8585403L78' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 1920793</div><div id='project'> Project Name: lornatang/srgan-pytorch</div><div id='commit'> Commit Name: acd467b89c7ccd5ca556b43a505b5745feda6b21</div><div id='time'> Time: 2020-09-21</div><div id='author'> Author: liuchangyu1111@gmail.com</div><div id='file'> File Name: srgan_pytorch/model.py</div><div id='m_class'> M Class Name: Generator</div><div id='n_method'> N Class Name: Generator</div><div id='m_method'> M Method Name: __init__(2)</div><div id='n_method'> N Method Name: __init__(3)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: srgan_pytorch/model.py</div><div id='n_file'> N File Name: srgan_pytorch/model.py</div><div id='m_start'> M Start Line: 78</div><div id='m_end'> M End Line: 100</div><div id='n_start'> N Start Line: 24</div><div id='n_end'> N End Line: 60</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        &#47&#47 Upscale block
        upsampling = []
        <a id="change">for </a>_ in <a id="change">range(</a>2<a id="change">):
            </a>upsampling.append(UpsampleBlock(64))
        self.upsampling = nn.Sequential(*upsampling)

        &#47&#47 Output layer.</code></pre><h3>After Change</h3><pre><code class='java'>
        )

        &#47&#47 Output layer.
        self.conv4<a id="change"> = </a><a id="change">nn.Conv2d(64</a>, <a id="change">3</a>, (3, 3), (1, 1), (1, 1)<a id="change">)</a>

    &#47&#47 The model should be defined in the Torch.script method.
    def _forward_impl(self, x: torch.Tensor) -&gt; torch.Tensor:
        out1 = self.conv1(x)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/lornatang/esrgan-pytorch/commit/46b948d8f86c7b83fe328e4572704b1755f98e68#diff-fada037ad086638e65c7ae77e3d223963e9afaa26326aab0ea718f4013176e43L117' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 1920761</div><div id='project'> Project Name: lornatang/esrgan-pytorch</div><div id='commit'> Commit Name: 46b948d8f86c7b83fe328e4572704b1755f98e68</div><div id='time'> Time: 2022-04-18</div><div id='author'> Author: liuchangyu1111@gmail.com</div><div id='file'> File Name: model.py</div><div id='m_class'> M Class Name: Generator</div><div id='n_method'> N Class Name: Generator</div><div id='m_method'> M Method Name: __init__(1)</div><div id='n_method'> N Method Name: __init__(1)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: model.py</div><div id='n_file'> N File Name: model.py</div><div id='m_start'> M Start Line: 120</div><div id='m_end'> M End Line: 147</div><div id='n_start'> N Start Line: 147</div><div id='n_end'> N End Line: 171</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        stem_layers = []
        in_c, out_c = 3, embed_dim // 8
        <a id="change">for </a>_ in <a id="change">range(</a>4<a id="change">):
            &#47&#47 original code uses bias=False even though there is no norm layer
            </a>stem_layers.append(nn.Conv2d(in_c, out_c, 3, stride=2, padding=1))
            stem_layers.append(nn.GELU())
            in_c, out_c = out_c, out_c * 2
        self.stem = nn.Sequential(*stem_layers)</code></pre><h3>After Change</h3><pre><code class='java'>
        super().__init__()
        self.norm_type = norm_type
        self.out_channels = (embed_dim,)
        self.stem<a id="change"> = </a>nn.Sequential(
            <a id="change">nn.Conv2d(3</a>, embed_dim // 8, <a id="change">3</a><a id="change">, stride=2, padding=1)</a>,
            nn.GELU(),
            nn.Conv2d(embed_dim//8, embed_dim // 4, 3, stride=2, padding=1),
            nn.GELU(),</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/gau-nernst/vision-toolbox/commit/9c33936b15da329b7d51d981196aca20d5e00077#diff-06aa870b4857860e20e31864ed75afe923611be3298c7662abf5065cbc7d651aL136' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 1920805</div><div id='project'> Project Name: gau-nernst/vision-toolbox</div><div id='commit'> Commit Name: 9c33936b15da329b7d51d981196aca20d5e00077</div><div id='time'> Time: 2022-03-04</div><div id='author'> Author: gau.nernst@yahoo.com.sg</div><div id='file'> File Name: vision_toolbox/backbones/patchconvnet.py</div><div id='m_class'> M Class Name: PatchConvNet</div><div id='n_method'> N Class Name: PatchConvNet</div><div id='m_method'> M Method Name: __init__(7)</div><div id='n_method'> N Method Name: __init__(5)</div><div id='m_parent_class'> M Parent Class: BaseBackbone</div><div id='n_parent_class'> N Parent Class: BaseBackbone</div><div id='m_file'> M File Name: vision_toolbox/backbones/patchconvnet.py</div><div id='n_file'> N File Name: vision_toolbox/backbones/patchconvnet.py</div><div id='m_start'> M Start Line: 140</div><div id='m_end'> M End Line: 150</div><div id='n_start'> N Start Line: 155</div><div id='n_end'> N End Line: 172</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        basic_block_layer = []

        <a id="change">for </a>_ in <a id="change">range(</a>n_basic_block<a id="change">):
            </a>basic_block_layer += [ResidualInResidualDenseBlock(num_init_features, growth_rate)]

        self.basic_block = nn.Sequential(*basic_block_layer)
</code></pre><h3>After Change</h3><pre><code class='java'>
        self.conv2 = nn.Conv2d(64, 64, kernel_size=3, stride=1, padding=1, bias=False)

        &#47&#47 Upsampling layers
        self.upsampling<a id="change"> = </a><a id="change">nn.Conv2d(64</a>, <a id="change">64</a><a id="change">, kernel_size=3, stride=1, padding=1, bias=False)</a>

        &#47&#47 Final output layer
        self.conv3 = nn.Sequential(
            nn.Conv2d(64, 64, kernel_size=3, stride=1, padding=1, bias=False),</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/lornatang/esrgan-pytorch/commit/8ef58f0f8458d618a99fffa07433927c9b9ef70f#diff-922d5955c025c76c1ff83c159f3370bb61503752c2b24aa0d2bb20c38bd37596L99' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 1920769</div><div id='project'> Project Name: lornatang/esrgan-pytorch</div><div id='commit'> Commit Name: 8ef58f0f8458d618a99fffa07433927c9b9ef70f</div><div id='time'> Time: 2020-10-12</div><div id='author'> Author: liuchangyu1111@gmail.com</div><div id='file'> File Name: esrgan_pytorch/model.py</div><div id='m_class'> M Class Name: Generator</div><div id='n_method'> N Class Name: Generator</div><div id='m_method'> M Method Name: __init__(2)</div><div id='n_method'> N Method Name: __init__(7)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: esrgan_pytorch/model.py</div><div id='n_file'> N File Name: esrgan_pytorch/model.py</div><div id='m_start'> M Start Line: 99</div><div id='m_end'> M End Line: 125</div><div id='n_start'> N Start Line: 181</div><div id='n_end'> N End Line: 210</div><BR>