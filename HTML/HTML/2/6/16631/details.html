<html><h3>Pattern ID :16631
</h3><img src='55834243.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            last_heartbeat_time = resource_message.get(&quotlast_heartbeat_time&quot)
            &#47&#47 Generate node type config based on reported node list.

            <a id="change">if </a><a id="change">(hasattr(resource_message, "cluster_full")
                    and resource_message.get(&quotcluster_full&quot))</a>:
                &#47&#47 Aggregate this flag across all batches.
                cluster_full = True
            &#47&#47 FIXME: implement the dynamic adjustment</code></pre><h3>After Change</h3><pre><code class='java'>
            &#47&#47 reset if there is a success
            self.load_metrics_failures = 0
        except Exception as e:
            if <a id="change">self.load_metrics_failures == 0 or self.load_metrics_failures == MAX_FAILURES_FOR_LOGGING</a>:
                &#47&#47 detailed form
                error = traceback.format_exc()
                logger.exception(f"Load metrics update failed with the following error:\n{error}")
            elif <a id="change"></a>self.load_metrics_failures &lt; MAX_FAILURES_FOR_LOGGING:
                &#47&#47 short form
                logger.exception(f"Load metrics update failed with the following error:{str(e)}")
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/oap-project/cloudtik/commit/e78c1c90a42471343f81b183643dd2a8bb977d19#diff-68026e3934fb197c61e99bd80d1b5ec63df71a7942f4f825a3c985a834963c71L142' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 55834243</div><div id='project'> Project Name: oap-project/cloudtik</div><div id='commit'> Commit Name: e78c1c90a42471343f81b183643dd2a8bb977d19</div><div id='time'> Time: 2022-03-29</div><div id='author'> Author: haifeng.chen@intel.com</div><div id='file'> File Name: python/cloudtik/core/_private/service/cloudtik_cluster_controller.py</div><div id='m_class'> M Class Name: ClusterController</div><div id='n_method'> N Class Name: ClusterController</div><div id='m_method'> M Method Name: update_load_metrics(1)</div><div id='n_method'> N Method Name: update_load_metrics(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: python/cloudtik/core/_private/service/cloudtik_cluster_controller.py</div><div id='n_file'> N File Name: python/cloudtik/core/_private/service/cloudtik_cluster_controller.py</div><div id='m_start'> M Start Line: 142</div><div id='m_end'> M End Line: 185</div><div id='n_start'> N Start Line: 143</div><div id='n_end'> N End Line: 162</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            elif tgt_lang[:2] in CONVERTER_CLASSES:
                converter = CONVERTER_CLASSES[tgt_lang[:2]]

            <a id="change">if </a><a id="change">converter and hasattr(converter, &quotstr_to_number&quot)</a>:
                expanded_matches.append([num2words(cur_match[0], lang=tgt_lang, to=&quotcardinal&quot)])

        for match in expanded_matches:</code></pre><h3>After Change</h3><pre><code class='java'>
        if (
            len(cur_match) == 1
            and cur_match[0].isdigit()
            and <a id="change">(tgt_lang in CONVERTER_CLASSES or tgt_lang[:2] in CONVERTER_CLASSES)</a>
        ):
            match = int(cur_match[0])
            expanded_matches.append([num2words(match, lang=tgt_lang, to=&quotcardinal&quot)])

        &#47&#47 find translation of dates
        elif <a id="change"></a>date_parser:
            expanded_matches.append(date_parser.translate(&quot &quot.join(cur_match), settings=Settings()).split(&quot &quot))

        for match in expanded_matches:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/stanford-oval/genienlp/commit/3e9f34d9ff9141846d6b575ae090f2dba8bfa3a8#diff-de5478b32694942df912b12112660fcc9c7f9d51959d2102be2269d954af92adL88' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 55834241</div><div id='project'> Project Name: stanford-oval/genienlp</div><div id='commit'> Commit Name: 3e9f34d9ff9141846d6b575ae090f2dba8bfa3a8</div><div id='time'> Time: 2021-09-29</div><div id='author'> Author: mehrad@stanford.edu</div><div id='file'> File Name: genienlp/model_utils/translation.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: align_and_replace(8)</div><div id='n_method'> N Method Name: align_and_replace(7)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: genienlp/model_utils/translation.py</div><div id='n_file'> N File Name: genienlp/model_utils/translation.py</div><div id='m_start'> M Start Line: 89</div><div id='m_end'> M End Line: 136</div><div id='n_start'> N Start Line: 92</div><div id='n_end'> N End Line: 144</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            elif tgt_lang[:2] in CONVERTER_CLASSES:
                converter = CONVERTER_CLASSES[tgt_lang[:2]]

            <a id="change">if </a><a id="change">converter and hasattr(converter, &quotstr_to_number&quot)</a>:
                expanded_matches.append([num2words(cur_match[0], lang=tgt_lang, to=&quotcardinal&quot)])

        for match in expanded_matches:</code></pre><h3>After Change</h3><pre><code class='java'>
        if (
            len(cur_match) == 1
            and cur_match[0].isdigit()
            and <a id="change">(tgt_lang in CONVERTER_CLASSES or tgt_lang[:2] in CONVERTER_CLASSES)</a>
        ):
            match = int(cur_match[0])
            expanded_matches.append([num2words(match, lang=tgt_lang, to=&quotcardinal&quot)])

        &#47&#47 find translation of dates
        elif <a id="change"></a>date_parser:
            expanded_matches.append(date_parser.translate(&quot &quot.join(cur_match), settings=Settings()).split(&quot &quot))

        for match in expanded_matches:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/stanford-oval/genienlp/commit/9265b3ecb8797992a68d92aa72944c78e99f1552#diff-de5478b32694942df912b12112660fcc9c7f9d51959d2102be2269d954af92adL88' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 55834244</div><div id='project'> Project Name: stanford-oval/genienlp</div><div id='commit'> Commit Name: 9265b3ecb8797992a68d92aa72944c78e99f1552</div><div id='time'> Time: 2021-09-24</div><div id='author'> Author: mehrad@stanford.edu</div><div id='file'> File Name: genienlp/model_utils/translation.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: align_and_replace(8)</div><div id='n_method'> N Method Name: align_and_replace(7)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: genienlp/model_utils/translation.py</div><div id='n_file'> N File Name: genienlp/model_utils/translation.py</div><div id='m_start'> M Start Line: 89</div><div id='m_end'> M End Line: 136</div><div id='n_start'> N Start Line: 92</div><div id='n_end'> N End Line: 144</div><BR>