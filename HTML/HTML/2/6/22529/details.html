<html><h3>Pattern ID :22529
</h3><img src='71199624.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

    &#47&#47 unigrams
    if ngrams == 1:
        seqs += <a id="change">[str(x) for x in tokenizer_ngrams(sentence)]</a>

    &#47&#47 all ngrams in loop
    else:
        unigrams_list = [str(x) for x in tokenizer_ngrams(sentence)]</code></pre><h3>After Change</h3><pre><code class='java'>
            if &quot &quot in chunk.text
        ]

    if <a id="change">pad_starting_ngrams</a>:
        assert all_ngrams is False, "pad_starting_ngrams only works when all_ngrams=False"
        seqs_init<a id="change"> = </a>[<a id="change">&quot &quot.join(</a>unigrams_list[:ngram_length]<a id="change">)</a> for ngram_length in range(1, ngrams)]
        seqs = seqs_init + seqs

    return seqs</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/csinva/imodelsx/commit/b4246aeb047c14343b10c40f0ffc14a5791f1b2d#diff-09af265b5e85eb1949a15eef2efe13c7bf676005bebf1e0ccd6f7f8f68c88787L18' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 71199624</div><div id='project'> Project Name: csinva/imodelsx</div><div id='commit'> Commit Name: b4246aeb047c14343b10c40f0ffc14a5791f1b2d</div><div id='time'> Time: 2023-03-19</div><div id='author'> Author: chandan_singh@berkeley.edu</div><div id='file'> File Name: imodelsx/util.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: generate_ngrams_list(7)</div><div id='n_method'> N Method Name: generate_ngrams_list(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: imodelsx/util.py</div><div id='n_file'> N File Name: imodelsx/util.py</div><div id='m_start'> M Start Line: 37</div><div id='m_end'> M End Line: 41</div><div id='n_start'> N Start Line: 18</div><div id='n_end'> N End Line: 74</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        &#47&#47 Tokenize outputs into text results
        captions = self.tokenizer.batch_decode(outputs, skip_special_tokens=True)
        captions = <a id="change">[caption.strip() for caption in captions]</a>

        &#47&#47 Return single element if single element passed in
        return captions[0] if not isinstance(images, list) else captions
</code></pre><h3>After Change</h3><pre><code class='java'>

        &#47&#47 Get and clean captions
        captions = []
        for <a id="change">result</a> in self.pipeline(values):
            text<a id="change"> = " "</a><a id="change">.join(</a>[r["generated_text"] for r in result]<a id="change">)</a>.strip()
            captions.append(text)

        &#47&#47 Return single element if single element passed in</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/neuml/txtai/commit/f3a185c33967d3568f2a072b65be7bf97e16e60b#diff-c3bd1bc09c0adb76c8ed69252592ee6402b13799c0bd470ffba1a9156ade1f85L51' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 71199620</div><div id='project'> Project Name: neuml/txtai</div><div id='commit'> Commit Name: f3a185c33967d3568f2a072b65be7bf97e16e60b</div><div id='time'> Time: 2022-10-16</div><div id='author'> Author: 561939+davidmezzetti@users.noreply.github.com</div><div id='file'> File Name: src/python/txtai/pipeline/image/caption.py</div><div id='m_class'> M Class Name: Caption</div><div id='n_method'> N Class Name: Caption</div><div id='m_method'> M Method Name: __call__(2)</div><div id='n_method'> N Method Name: __call__(2)</div><div id='m_parent_class'> M Parent Class: HFPipeline</div><div id='n_parent_class'> N Parent Class: HFModel</div><div id='m_file'> M File Name: src/python/txtai/pipeline/image/caption.py</div><div id='n_file'> N File Name: src/python/txtai/pipeline/image/caption.py</div><div id='m_start'> M Start Line: 72</div><div id='m_end'> M End Line: 81</div><div id='n_start'> N Start Line: 46</div><div id='n_end'> N End Line: 55</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        else:
            label_name = "label"

        spark_nlp_data = <a id="change">[
            [record.id, record.text, record.annotation]
            for record in records
            if record.annotation is not None
        ]</a>

        return pd.DataFrame(spark_nlp_data, columns=["id", "text", label_name])

    def __all_labels__(self):</code></pre><h3>After Change</h3><pre><code class='java'>
            label_name = "label"

        spark_nlp_data = []
        for <a id="change">record</a> in records:
            if record.annotation is None:
                continue
            if record.id is None:
                record.id = str(uuid.uuid4())
            if record.text is None:
                text<a id="change"> = ". "</a><a id="change">.join(</a>record.inputs.values()<a id="change">)</a>
            else:
                text = record.text

            spark_nlp_data.append([record.id, text, record.annotation])</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/recognai/rubrix/commit/547d0806af0febd1cceafa1af7d81c6f0df90b76#diff-83f0009037439b7a240507426685acd4ee90c3d5d6d1c5baa89c1c1284eae373L879' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 71199619</div><div id='project'> Project Name: recognai/rubrix</div><div id='commit'> Commit Name: 547d0806af0febd1cceafa1af7d81c6f0df90b76</div><div id='time'> Time: 2023-02-08</div><div id='author'> Author: david.m.berenstein@gmail.com</div><div id='file'> File Name: src/argilla/client/datasets.py</div><div id='m_class'> M Class Name: DatasetForTextClassification</div><div id='n_method'> N Class Name: DatasetForTextClassification</div><div id='m_method'> M Method Name: _prepare_for_training_with_spark_nlp(2)</div><div id='n_method'> N Method Name: _prepare_for_training_with_spark_nlp(2)</div><div id='m_parent_class'> M Parent Class: DatasetBase</div><div id='n_parent_class'> N Parent Class: DatasetBase</div><div id='m_file'> M File Name: src/argilla/client/datasets.py</div><div id='n_file'> N File Name: src/argilla/client/datasets.py</div><div id='m_start'> M Start Line: 888</div><div id='m_end'> M End Line: 891</div><div id='n_start'> N Start Line: 895</div><div id='n_end'> N End Line: 908</div><BR>