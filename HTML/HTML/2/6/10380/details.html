<html><h3>Pattern ID :10380
</h3><img src='36322202.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    with f:
        print(f&quotIndexing {os.environ["JINA_DATA_FILE_1"]}&quot)
        data_path = os.path.join(os.path.dirname(__file__), os.environ.get(&quotJINA_DATA_FILE_1&quot, None))
        <a id="change">f.index_lines(filepath=data_path, request_size=16, read_mode=&quotr&quot, size=num_docs)</a>

    with f:
        print(f&quotIndexing {os.environ["JINA_DATA_FILE_2"]}&quot)
        data_path = os.path.join(os.path.dirname(__file__), os.environ.get(&quotJINA_DATA_FILE_2&quot, None))</code></pre><h3>After Change</h3><pre><code class='java'>
        f.logger.info(f&quotIndexing {os.environ["JINA_DATA_FILE_1"]}&quot)
        data_path = os.path.join(os.path.dirname(__file__), os.environ.get(&quotJINA_DATA_FILE_1&quot, None))
        num_docs = min(num_docs, len(open(data_path).readlines()))
        <a id="change">with </a><a id="change">TimeContext(f&quotQPS: indexing {num_docs} (1)&quot, logger=f.logger):
            </a><a id="change">f.index_lines(filepath=data_path, request_size=16, read_mode=&quotr&quot, size=num_docs)</a>

    with f:
        f.logger.info(f&quotIndexing {os.environ["JINA_DATA_FILE_2"]}&quot)
        data_path = os.path.join(os.path.dirname(__file__), os.environ.get(&quotJINA_DATA_FILE_2&quot, None))</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/jina-ai/examples/commit/dc36fee6c43ef11c33354b58c79af6ce11fae6ff#diff-44b0c66c8c1caaf228c1371a0d640c09059dcdf9e6d941ae255663a68cf81626L38' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 36322202</div><div id='project'> Project Name: jina-ai/examples</div><div id='commit'> Commit Name: dc36fee6c43ef11c33354b58c79af6ce11fae6ff</div><div id='time'> Time: 2021-05-10</div><div id='author'> Author: 51201318+slettner@users.noreply.github.com</div><div id='file'> File Name: wikipedia-sentences-incremental/app.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: index(1)</div><div id='n_method'> N Method Name: index(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: wikipedia-sentences-incremental/app.py</div><div id='n_file'> N File Name: wikipedia-sentences-incremental/app.py</div><div id='m_start'> M Start Line: 41</div><div id='m_end'> M End Line: 46</div><div id='n_start'> N Start Line: 38</div><div id='n_end'> N End Line: 54</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    with f:
        data_path = os.path.join(os.path.dirname(__file__), os.environ.get(&quotJINA_DATA_FILE&quot, None))
        <a id="change">f.index_lines(filepath=data_path, batch_size=16, read_mode=&quotr&quot, size=num_docs)</a>


def query(top_k):
    f = Flow().load_config("flows/query.yml")</code></pre><h3>After Change</h3><pre><code class='java'>
    with f:
        data_path = os.path.join(os.path.dirname(__file__), os.environ.get(&quotJINA_DATA_FILE&quot, None))
        num_docs = min(num_docs, len(open(data_path).readlines()))
        <a id="change">with </a><a id="change">TimeContext(f&quotQPS: indexing {num_docs}&quot, logger=f.logger):
            </a><a id="change">f.index_lines(filepath=data_path, batch_size=16, read_mode=&quotr&quot, size=num_docs)</a>


def query(top_k):
    f = Flow().load_config(&quotflows/query.yml&quot)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/examples/commit/dc36fee6c43ef11c33354b58c79af6ce11fae6ff#diff-def4447edc2667e78227e0f5fee5b0c63664208309581a18e50eb887dee324b7L55' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 36322200</div><div id='project'> Project Name: jina-ai/examples</div><div id='commit'> Commit Name: dc36fee6c43ef11c33354b58c79af6ce11fae6ff</div><div id='time'> Time: 2021-05-10</div><div id='author'> Author: 51201318+slettner@users.noreply.github.com</div><div id='file'> File Name: wikipedia-sentences/app.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: index(1)</div><div id='n_method'> N Method Name: index(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: wikipedia-sentences/app.py</div><div id='n_file'> N File Name: wikipedia-sentences/app.py</div><div id='m_start'> M Start Line: 60</div><div id='m_end'> M End Line: 60</div><div id='n_start'> N Start Line: 60</div><div id='n_end'> N End Line: 65</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    with f:
        data_path = os.path.join(os.path.dirname(__file__), os.environ.get(&quotJINA_DATA_FILE&quot, None))
        <a id="change">f.index_lines(filepath=data_path, batch_size=16, read_mode=&quotr&quot, size=num_docs)</a>

def index_restful(num_docs):
    f = Flow().load_config(&quotflows/index.yml&quot)
</code></pre><h3>After Change</h3><pre><code class='java'>

    with f:
        data_path = os.path.join(os.path.dirname(__file__), os.environ.get(&quotJINA_DATA_FILE&quot, None))
        <a id="change">with </a><a id="change">TimeContext(f&quotQPS: indexing {num_docs}&quot, logger=f.logger):
            </a><a id="change">f.index_lines(filepath=data_path, batch_size=16, read_mode=&quotr&quot, size=num_docs)</a>

def index_restful(num_docs):
    f = Flow().load_config(&quotflows/index.yml&quot)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/examples/commit/460a2d0da44fe733db094cfa0f4abb8cdbc52a34#diff-ed63f73b16558b812e1b39f90f1cf3754c75f1c1218f005ef925b0830a93548aL34' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 36322201</div><div id='project'> Project Name: jina-ai/examples</div><div id='commit'> Commit Name: 460a2d0da44fe733db094cfa0f4abb8cdbc52a34</div><div id='time'> Time: 2021-05-06</div><div id='author'> Author: tobias.jacobowitz@jina.ai</div><div id='file'> File Name: chinese-text-search/app.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: index(1)</div><div id='n_method'> N Method Name: index(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: chinese-text-search/app.py</div><div id='n_file'> N File Name: chinese-text-search/app.py</div><div id='m_start'> M Start Line: 39</div><div id='m_end'> M End Line: 39</div><div id='n_start'> N Start Line: 40</div><div id='n_end'> N End Line: 42</div><BR>