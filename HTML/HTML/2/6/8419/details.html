<html><h3>Pattern ID :8419
</h3><img src='29411888.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 The `key` is here for legacy reason (tfds) and is not important in itself.

        with open(filepath, encoding="utf-8") as f:
            for id_, row in <a id="change">enumerate(</a>f<a id="change">)</a>:
                data = row.strip().split(" ", 1)
                speaker_id = data[0].split("_")[0]
                yield id_, {</code></pre><h3>After Change</h3><pre><code class='java'>
            if path.startswith(path_to_clips):
                inside_clips_dir = True
                if path in examples:
                    audio<a id="change"> = </a>{"path": path, "bytes": f.read()}
                    yield id_<a id="change">, {**examples[path], "audio": audio}</a>
                    id_ += 1
            elif <a id="change"></a>inside_clips_dir:
                <a id="change">break</a>
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/huggingface/datasets/commit/0534a87f60fb9a589138f0773e057c2429f482b7#diff-c295913fcdcb50b7231589824a0b3d3ee249ad9d3eb173ea507466db03447729L113' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 29411888</div><div id='project'> Project Name: huggingface/datasets</div><div id='commit'> Commit Name: 0534a87f60fb9a589138f0773e057c2429f482b7</div><div id='time'> Time: 2021-11-19</div><div id='author'> Author: 42851186+lhoestq@users.noreply.github.com</div><div id='file'> File Name: datasets/vivos/vivos.py</div><div id='m_class'> M Class Name: VivosDataset</div><div id='n_method'> N Class Name: VivosDataset</div><div id='m_method'> M Method Name: _generate_examples(4)</div><div id='n_method'> N Method Name: _generate_examples(3)</div><div id='m_parent_class'> M Parent Class: datasets.GeneratorBasedBuilder</div><div id='n_parent_class'> N Parent Class: datasets.GeneratorBasedBuilder</div><div id='m_file'> M File Name: datasets/vivos/vivos.py</div><div id='n_file'> N File Name: datasets/vivos/vivos.py</div><div id='m_start'> M Start Line: 116</div><div id='m_end'> M End Line: 125</div><div id='n_start'> N Start Line: 113</div><div id='n_end'> N End Line: 138</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 The `key` is here for legacy reason (tfds) and is not important in itself.

        with open(filepath, encoding="utf-8") as f:
            for id_, row in <a id="change">enumerate(</a>f<a id="change">)</a>:
                data = row.strip().split(" ", 1)
                speaker_id = data[0].split("_")[0]
                yield id_, {</code></pre><h3>After Change</h3><pre><code class='java'>
                }
        inside_clips_dir = False
        id_ = 0
        for path, <a id="change">f</a> in audio_files:
            if path.startswith(path_to_clips):
                inside_clips_dir<a id="change"> = </a>True
                if path in examples:
                    audio = {"path": path, "bytes": f.read()}
                    yield id_<a id="change">, {**examples[path], "audio": audio}</a>
                    id_ += 1
            elif <a id="change"></a>inside_clips_dir:
                <a id="change">break</a>
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/datasets/commit/0534a87f60fb9a589138f0773e057c2429f482b7#diff-c295913fcdcb50b7231589824a0b3d3ee249ad9d3eb173ea507466db03447729L107' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 29411880</div><div id='project'> Project Name: huggingface/datasets</div><div id='commit'> Commit Name: 0534a87f60fb9a589138f0773e057c2429f482b7</div><div id='time'> Time: 2021-11-19</div><div id='author'> Author: 42851186+lhoestq@users.noreply.github.com</div><div id='file'> File Name: datasets/vivos/vivos.py</div><div id='m_class'> M Class Name: VivosDataset</div><div id='n_method'> N Class Name: VivosDataset</div><div id='m_method'> M Method Name: _generate_examples(4)</div><div id='n_method'> N Method Name: _generate_examples(3)</div><div id='m_parent_class'> M Parent Class: datasets.GeneratorBasedBuilder</div><div id='n_parent_class'> N Parent Class: datasets.GeneratorBasedBuilder</div><div id='m_file'> M File Name: datasets/vivos/vivos.py</div><div id='n_file'> N File Name: datasets/vivos/vivos.py</div><div id='m_start'> M Start Line: 116</div><div id='m_end'> M End Line: 125</div><div id='n_start'> N Start Line: 113</div><div id='n_end'> N End Line: 138</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        mkdir_if_missing(qdir)
        _cp_img_to(qimg_path, qdir, rank=0, prefix=&quotquery&quot)

        for rank_idx, g_idx in <a id="change">enumerate(</a>indices[q_idx,:topk]<a id="change">)</a>:
            gimg_path = dataset.gallery[g_idx][0]
            _cp_img_to(gimg_path, qdir, rank=rank_idx + 1, prefix=&quotgallery&quot)</code></pre><h3>After Change</h3><pre><code class='java'>
        _cp_img_to(qimg_path, qdir, rank=0, prefix=&quotquery&quot)

        rank_idx = 1
        for <a id="change">g_idx</a> in indices[q_idx,:]:
            gimg_path<a id="change">, gpid, gcamid</a> = dataset.gallery[g_idx]
            invalid = (qpid == gpid) & (qcamid == gcamid)
            if not invalid:
                _cp_img_to(gimg_path, qdir, rank=rank_idx, prefix=&quotgallery&quot)
                rank_idx<a id="change"> += </a>1
                <a id="change">if </a>rank_idx &gt; topk:
                    <a id="change">break</a></code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/vlsomers/bpbreid/commit/ac67ecf15c12c5466a4b7c44cb67bc2e9eb741c0#diff-2c001321c1cbf55aa039115b347d0f63f3ebbc358a1ba047e079ba57c5859d3aL12' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 29411896</div><div id='project'> Project Name: vlsomers/bpbreid</div><div id='commit'> Commit Name: ac67ecf15c12c5466a4b7c44cb67bc2e9eb741c0</div><div id='time'> Time: 2018-08-01</div><div id='author'> Author: k.zhou@qmul.ac.uk</div><div id='file'> File Name: utils/reidtools.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: visualize_ranked_results(4)</div><div id='n_method'> N Method Name: visualize_ranked_results(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: utils/reidtools.py</div><div id='n_file'> N File Name: utils/reidtools.py</div><div id='m_start'> M Start Line: 34</div><div id='m_end'> M End Line: 61</div><div id='n_start'> N Start Line: 28</div><div id='n_end'> N End Line: 67</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            if num_free_ellipsis &lt;= 1:
                reversed_shape = reversed(shape)
                &#47&#47 These aren&quott all necessarily of the same size.
                for reverse_dim_index, dim in <a id="change">enumerate(</a>reversed(detail.dims)<a id="change">)</a>:
                    try:
                        size = next(reversed_shape)
                    except StopIteration:</code></pre><h3>After Change</h3><pre><code class='java'>
            if num_free_ellipsis &lt;= 1:
                reversed_shape = enumerate(reversed(shape))
                &#47&#47 These aren&quott all necessarily of the same size.
                for <a id="change">dim</a> in reversed(detail.dims):
                    try:
                        reverse_dim_index, size = next(reversed_shape)
                    except StopIteration:
                        if dim.size is ...:
                            if dim.name not in (None, _no_name):
                                try:
                                    lookup_shape<a id="change"> = </a>memo.name_to_shape[dim.name]
                                except KeyError:
                                    memo.name_to_shape[dim.name] = <a id="change">()</a>
                                else:
                                    if lookup_shape != ():
                                        raise TypeError(
                                            f"Dimension group &quot{name}&quot of inconsistent shape. Got "
                                            f"both () and {lookup_shape}."
                                        )
                        else:
                            raise TypeError(
                                f"{argname} has {len(shape)} dimensions but type "
                                "requires more than this."
                            )

                    if dim.name not in (None, _no_name):
                        if dim.size == -1:
                            try:
                                lookup_size = memo.name_to_size[dim.name]
                            except KeyError:
                                memo.name_to_size[dim.name] = size
                            else:
                                &#47&#47 Technically not necessary, as one of the
                                &#47&#47 sizes will override the other, and then the
                                &#47&#47 instance check will fail.
                                &#47&#47 This gives a nicer error message though.
                                if lookup_size != size:
                                    raise TypeError(
                                        f"Dimension &quot{dim.name}&quot of inconsistent"
                                        f" size. Got both {size} and "
                                        f"{lookup_size}."
                                    )
                        elif <a id="change"></a>dim.size is ...:
                            try:
                                lookup_shape = memo.name_to_shape[dim.name]
                            except KeyError:
                                &#47&#47 Can only get here if we&quotre the single free
                                &#47&#47 ellipsis.
                                &#47&#47 Therefore the number of dimensions the ellipsis
                                &#47&#47 corresponds to, is the number of dimensions
                                &#47&#47 remaining.
                                if reverse_dim_index == 0:
                                    &#47&#47 since [:-0] doesn&quott work
                                    clip_shape = shape
                                else:
                                    clip_shape = shape[:-reverse_dim_index]
                                memo.name_to_shape[dim.name] = tuple(clip_shape)
                                <a id="change">break</a>
                            else:
                                reversed_shape_piece = [size]
                                for _ in range(len(lookup_shape) - 1):
                                    try:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/patrick-kidger/torchtyping/commit/f0cb73ea8bd3d680fc4e16658c894f8343a49821#diff-e89a3d62adccfcb96bba07b1d2f8ecfc9f5c32c41b20d66267e9e234f70f2d9cL67' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 29411899</div><div id='project'> Project Name: patrick-kidger/torchtyping</div><div id='commit'> Commit Name: f0cb73ea8bd3d680fc4e16658c894f8343a49821</div><div id='time'> Time: 2021-03-31</div><div id='author'> Author: 33688385+patrick-kidger@users.noreply.github.com</div><div id='file'> File Name: torchtyping/typechecker.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _check_memo(1)</div><div id='n_method'> N Method Name: _check_memo(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: torchtyping/typechecker.py</div><div id='n_file'> N File Name: torchtyping/typechecker.py</div><div id='m_start'> M Start Line: 75</div><div id='m_end'> M End Line: 167</div><div id='n_start'> N Start Line: 60</div><div id='n_end'> N End Line: 176</div><BR>