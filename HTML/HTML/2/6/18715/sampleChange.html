<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        :param batch_idx: the index of the batch
        :return loss: (1,); the train_loss for this batch
        
        <a id="change">raise </a>NotImplementedError

    def forward(self, X: torch.Tensor) -&gt; torch.Tensor:
        </code></pre><h3>After Change</h3><pre><code class='java'>

    def training_step(self, batch: Tuple[torch.Tensor, torch.Tensor], batch_idx: int) -&gt; dict:
        X, y = batch
        H_all<a id="change"> = </a><a id="change">self.forward(</a>X<a id="change">)</a>  &#47&#47 (N, 3, L) -&gt; (N, L, H)
        S_wisdom<a id="change"> = </a>self.S_wisdom(H_all)  &#47&#47 (N, L, H) -&gt; (N, |W|)
        loss<a id="change"> = </a>F.cross_entropy(S_wisdom, y)  &#47&#47 (N, |W|), (N,) -&gt; (N,)
        loss<a id="change"> = </a>loss.sum()  &#47&#47 (N,) -&gt; (1,)
        P_wisdom = F.softmax(S_wisdom, dim=1)  &#47&#47 (N, |W|) -&gt; (N, |W|)
        self.rd_metric.update(preds=P_wisdom, targets=y)
        median, var, top1, top10, top100 = self.rd_metric.compute()</code></pre>