<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                         size=(num_user, num_hidden),
                         requires_grad=True,
                         dtype=torch.float32))
        <a id="change">self.register_parameter(&quotembed_user&quot</a>, self.embed_user<a id="change">)</a>
        self.embed_item = Parameter(
            torch.normal(mean=0,
                         std=0.1,
                         size=(num_item, num_hidden),
                         requires_grad=True,
                         dtype=torch.float32))
        <a id="change">self.register_parameter(&quotembed_item&quot</a>, self.embed_item<a id="change">)</a>

    def forward(self, indices, ratings):
        indices = np.array(indices)
</code></pre><h3>After Change</h3><pre><code class='java'>
    
    def __init__(self, num_user, num_item, num_hidden):
        super(BasicMFNet, self).__init__()
        self.num_user<a id="change">, self.num_item</a> = num_user, num_item
        self.embed_user = torch.nn.Embedding(num_user, num_hidden, sparse=True)
        self.embed_item = torch.nn.Embedding(num_item, num_hidden, sparse=True)
</code></pre>