<html><h3>Pattern ID :24979
</h3><img src='76811333.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    pool.close()
    pool.join()

    pesq_scores<a id="change"> = </a><a id="change">[]</a>
    <a id="change">for </a>process in processes<a id="change">:
        </a>pesq_score = process.get()
        <a id="change">pesq_scores.append(</a>pesq_score<a id="change">)</a>

    return pesq_scores
</code></pre><h3>After Change</h3><pre><code class='java'>

def multiprocess_evaluation(pred_wavs, target_wavs, lengths):
    pesq_scores = Parallel(n_jobs=30)(
        <a id="change">delayed(pesq)(
            fs=params.Sample_rate,
            ref=clean[: int(length)],
            deg=enhanced[: int(length)],
            mode="wb",
        )</a>
        for enhanced, clean, length in zip(pred_wavs, target_wavs, lengths)
    )
    return pesq_scores</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/speechbrain/speechbrain/commit/50b529065d073e548241c714fe621d76a6ab9117#diff-16ccfd41957095302a3e648d64a50fff56c3f348df107dc5bdc53f1def7cea4cL47' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 76811333</div><div id='project'> Project Name: speechbrain/speechbrain</div><div id='commit'> Commit Name: 50b529065d073e548241c714fe621d76a6ab9117</div><div id='time'> Time: 2020-08-06</div><div id='author'> Author: plantinga.peter@protonmail.com</div><div id='file'> File Name: recipes/Voicebank/enhance_waveform_map/experiment.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: multiprocess_evaluation(3)</div><div id='n_method'> N Method Name: multiprocess_evaluation(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: recipes/Voicebank/enhance_waveform_map/experiment.py</div><div id='n_file'> N File Name: recipes/Voicebank/enhance_waveform_map/experiment.py</div><div id='m_start'> M Start Line: 53</div><div id='m_end'> M End Line: 70</div><div id='n_start'> N Start Line: 47</div><div id='n_end'> N End Line: 55</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    pool.close()
    pool.join()

    pesq_scores<a id="change"> = </a><a id="change">[]</a>
    <a id="change">for process</a> in processes<a id="change">:
        </a>pesq_score = process.get()
        <a id="change">pesq_scores.append(</a>pesq_score<a id="change">)</a>

    return pesq_scores
</code></pre><h3>After Change</h3><pre><code class='java'>


def multiprocess_evaluation(pred_wavs, target_wavs, lengths):
    pesq_scores = <a id="change">Parallel(n_jobs=30)(
        </a>delayed<a id="change">(pesq)(
            fs=params.Sample_rate,
            ref=clean[: int(length)],
            deg=enhanced[: int(length)],
            mode="wb",
        )
        for enhanced, clean, length in zip(pred_wavs, target_wavs, lengths)
    )</a>
    return pesq_scores

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/speechbrain/speechbrain/commit/50b529065d073e548241c714fe621d76a6ab9117#diff-16ccfd41957095302a3e648d64a50fff56c3f348df107dc5bdc53f1def7cea4cL53' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 76811334</div><div id='project'> Project Name: speechbrain/speechbrain</div><div id='commit'> Commit Name: 50b529065d073e548241c714fe621d76a6ab9117</div><div id='time'> Time: 2020-08-06</div><div id='author'> Author: plantinga.peter@protonmail.com</div><div id='file'> File Name: recipes/Voicebank/enhance_waveform_map/experiment.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: multiprocess_evaluation(3)</div><div id='n_method'> N Method Name: multiprocess_evaluation(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: recipes/Voicebank/enhance_waveform_map/experiment.py</div><div id='n_file'> N File Name: recipes/Voicebank/enhance_waveform_map/experiment.py</div><div id='m_start'> M Start Line: 53</div><div id='m_end'> M End Line: 70</div><div id='n_start'> N Start Line: 47</div><div id='n_end'> N End Line: 55</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    pool.close()
    pool.join()

    pesq_scores<a id="change"> = </a><a id="change">[]</a>
    <a id="change">for process</a> in processes<a id="change">:
        </a>pesq_score = process.get()
        <a id="change">pesq_scores.append(</a>pesq_score<a id="change">)</a>

    return pesq_scores

</code></pre><h3>After Change</h3><pre><code class='java'>


def multiprocess_evaluation(pred_wavs, target_wavs, lengths):
    pesq_scores = <a id="change">Parallel(n_jobs=30)(
        </a>delayed<a id="change">(pesq)(
            fs=params.Sample_rate,
            ref=clean[: int(length)],
            deg=enhanced[: int(length)],
            mode="wb",
        )
        for enhanced, clean, length in zip(pred_wavs, target_wavs, lengths)
    )</a>
    return pesq_scores


class SEBrain(sb.core.Brain):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/speechbrain/speechbrain/commit/50b529065d073e548241c714fe621d76a6ab9117#diff-bf3ac247aef3a6f9adf9acb6744921413bd7504a5065d3d83294cfda719284ebL47' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 76811335</div><div id='project'> Project Name: speechbrain/speechbrain</div><div id='commit'> Commit Name: 50b529065d073e548241c714fe621d76a6ab9117</div><div id='time'> Time: 2020-08-06</div><div id='author'> Author: plantinga.peter@protonmail.com</div><div id='file'> File Name: recipes/Voicebank/enhance_spectral_mask/experiment.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: multiprocess_evaluation(3)</div><div id='n_method'> N Method Name: multiprocess_evaluation(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: recipes/Voicebank/enhance_spectral_mask/experiment.py</div><div id='n_file'> N File Name: recipes/Voicebank/enhance_spectral_mask/experiment.py</div><div id='m_start'> M Start Line: 47</div><div id='m_end'> M End Line: 64</div><div id='n_start'> N Start Line: 41</div><div id='n_end'> N End Line: 49</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
		reservoir.forward = self.eprop._decorate_hidden_forward(reservoir.forward, reservoir.name)
		output_layer.forward = self.eprop._decorate_forward(output_layer.forward, output_layer.name)
		for _ in progress_bar:
			x_pred<a id="change"> = </a><a id="change">[]</a>
			x_pred.append(self.true_time_series[:, 0, :].clone())
			forward_tensor = self.true_time_series[:, 0, :].clone().to(reservoir.device)
			hh = None
			<a id="change">for t</a> in range(1, self.true_time_series.shape[-2])<a id="change">:
				</a>forward_tensor, hh = unpack_out_hh(reservoir(forward_tensor, hh, t=t-1))
				forward_tensor, _ = unpack_out_hh(output_layer(forward_tensor, None, t=t-1))
				<a id="change">x_pred.append(</a>forward_tensor<a id="change">)</a>
				&#47&#47 eligibility_traces = dy_dw_local(y=forward_tensor, params=self.params)
				&#47&#47 self.eprop.eligibility_traces = eligibility_traces
				&#47&#47 batch_loss = self.eprop.apply_criterion(forward_tensor, self.true_time_series[:, t].to(forward_tensor.device))
				&#47&#47 learning_signals = self.compute_learning_signals(loss_at_t)</code></pre><h3>After Change</h3><pre><code class='java'>
		inputs = self.raw_time_series[:, 0, :].clone().unsqueeze(1).to(self.model.device)
		for _ in range(100):
			val_x_pred = self.model.get_prediction_trace(inputs)
			pvar = <a id="change">PVarianceLoss()(</a>val_x_pred, self.raw_time_series.to(val_x_pred.device)<a id="change">)</a>
			val_pvars.append(to_numpy(pvar).item())
		print(f"Validation PVariance: {np.mean(val_pvars):.3f}")
		return x_pred, self.raw_time_series
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/neurotorch/neurotorch/commit/da8d4065502c761ccf6e28e47dd189e3b5488140#diff-bfbe6bfd7f09fee9a898ae4ce6ce338f6bfc05e7db28469ba6540dfae09a766dL109' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 76811337</div><div id='project'> Project Name: neurotorch/neurotorch</div><div id='commit'> Commit Name: da8d4065502c761ccf6e28e47dd189e3b5488140</div><div id='time'> Time: 2023-01-31</div><div id='author'> Author: 50332514+JeremieGince@users.noreply.github.com</div><div id='file'> File Name: src/neurotorch/learning_algorithms/debug_e_prop_v5.py</div><div id='m_class'> M Class Name: SimplifiedEpropFinal</div><div id='n_method'> N Class Name: SimplifiedEpropFinal</div><div id='m_method'> M Method Name: train(4)</div><div id='n_method'> N Method Name: train(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/neurotorch/learning_algorithms/debug_e_prop_v5.py</div><div id='n_file'> N File Name: src/neurotorch/learning_algorithms/debug_e_prop_v5.py</div><div id='m_start'> M Start Line: 120</div><div id='m_end'> M End Line: 153</div><div id='n_start'> N Start Line: 115</div><div id='n_end'> N End Line: 144</div><BR>