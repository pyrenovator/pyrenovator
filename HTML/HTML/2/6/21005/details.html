<html><h3>Pattern ID :21005
</h3><img src='67600359.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    img_stack = img_stack.mean(axis=0)

    &#47&#47 Normalize back to 0-255
    img_stack<a id="change"> = </a>img_stack * 255

    <a id="change">Image.fromarray(img_stack).convert("L").save(</a>f"{data_dir}{dir_name}/merged/{new_filename}"<a id="change">)</a>



if __name__ == "__main__":</code></pre><h3>After Change</h3><pre><code class='java'>
    for i in range(len(filenames)):
        img = load_image(paths[i] + "/" + filenames[i])
        img = img/img.max()
        <a id="change">if type(img_stack) == type(None)</a>:
            img_stack<a id="change"> = </a>img
        else:
            img_stack = np.vstack([img_stack, img])
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/stan-hua/cytoimagenet/commit/8fd9a8300cb96673368487f145a26d96c4a49d22#diff-81a83041685f9e414a39d7c1eabd3b0fc0ea51670a319fedf89a8a83615763daL42' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 67600359</div><div id='project'> Project Name: stan-hua/cytoimagenet</div><div id='commit'> Commit Name: 8fd9a8300cb96673368487f145a26d96c4a49d22</div><div id='time'> Time: 2021-06-16</div><div id='author'> Author: stanley.hua@mail.utoronto.ca</div><div id='file'> File Name: scripts/preprocessor.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: merger(3)</div><div id='n_method'> N Method Name: merger(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: scripts/preprocessor.py</div><div id='n_file'> N File Name: scripts/preprocessor.py</div><div id='m_start'> M Start Line: 42</div><div id='m_end'> M End Line: 60</div><div id='n_start'> N Start Line: 50</div><div id='n_end'> N End Line: 62</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    img_stack = None
    for i in range(len(filenames)):
        if img_stack is None:
            img_stack<a id="change"> = </a>bf.load_image(paths[i] + "/" + filenames[i])
            &#47&#47 Normalize Intensity
            img_stack = img_stack/img_stack.max()
        else:
            img = bf.load_image(paths[i] + "/" + filenames[i])
            &#47&#47 Normalize Intensity by dividing by max
            img = img/img.max()
            img_stack = np.vstack([img_stack, img])

    &#47&#47 Average along stack
    img_stack = img_stack.mean(axis=0)

    &#47&#47 Normalize back to 0-255
    img_stack = img_stack * 255

    <a id="change">Image.fromarray(img_stack).convert("L").save(</a>f"{data_dir}{dir_name}/merged/{new_filename}"<a id="change">)</a>



if __name__ == "__main__":</code></pre><h3>After Change</h3><pre><code class='java'>
    for i in range(len(filenames)):
        img = load_image(paths[i] + "/" + filenames[i])
        img = img/img.max()
        <a id="change">if type(img_stack) == type(None)</a>:
            img_stack<a id="change"> = </a>img
        else:
            img_stack = np.vstack([img_stack, img])
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/stan-hua/cytoimagenet/commit/8fd9a8300cb96673368487f145a26d96c4a49d22#diff-896e98671bc646f9b29c2b534b62d4d3b4c3604b3ae1f3de0ac0886643177d5fL35' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 67600356</div><div id='project'> Project Name: stan-hua/cytoimagenet</div><div id='commit'> Commit Name: 8fd9a8300cb96673368487f145a26d96c4a49d22</div><div id='time'> Time: 2021-06-16</div><div id='author'> Author: stanley.hua@mail.utoronto.ca</div><div id='file'> File Name: scripts/preprocessor_2.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: merger(3)</div><div id='n_method'> N Method Name: merger(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: scripts/preprocessor_2.py</div><div id='n_file'> N File Name: scripts/preprocessor_2.py</div><div id='m_start'> M Start Line: 42</div><div id='m_end'> M End Line: 60</div><div id='n_start'> N Start Line: 49</div><div id='n_end'> N End Line: 61</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            mask = m_img == 0
            mask_inv = m_img == 255

            s_img_inv[mask_inv]<a id="change"> = </a>c_img[mask_inv]
            s_img[mask] = c_img[mask]

            out_path = os.path.join(dump_path_bkg_masked, &quotcombined_&quot + str(cnt).zfill(4) + format)
            out_path_inv = os.path.join(dump_path_person_masked, &quotcombined_&quot + str(cnt).zfill(4) + format)
            &#47&#47 print(out_path)
            img = Image.fromarray(s_img)
            img.save(out_path)

            img_inv = <a id="change">Image.fromarray(</a>s_img_inv<a id="change">)</a>
            <a id="change">img_inv.save(</a>out_path_inv<a id="change">)</a>

            &#47&#47 plt.imshow(s_img)
            &#47&#47 plt.show()
        print(&quotDone making background pics.&quot)</code></pre><h3>After Change</h3><pre><code class='java'>
    os.makedirs(dump_path_person_masked, exist_ok=True)

    &#47&#47 if other_stylized_frames_path exists overlay frames are differently styled frames and not original frames
    <a id="change">if other_stylized_frames_dir is not None</a>:
        overlay_frames_dir = other_stylized_frames_dir
    else:
        overlay_frames_dir<a id="change"> = </a>frames_dir

    if len(os.listdir(dump_path_bkg_masked)) == 0 and len(os.listdir(dump_path_person_masked)) == 0:
        for cnt, (name1, name2, name3) in enumerate(zip(os.listdir(stylized_frames_dir), os.listdir(mask_frames_dir), os.listdir(overlay_frames_dir))):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/gordicaleksa/pytorch-naive-video-neural-style-transfer/commit/eb258a320653c1198a40fb422c98f1f37212c8cc#diff-18d7056e8caf3b212693d1befdc8190da58ab6dad574ab5496d98ca47f8927f4L105' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 67600353</div><div id='project'> Project Name: gordicaleksa/pytorch-naive-video-neural-style-transfer</div><div id='commit'> Commit Name: eb258a320653c1198a40fb422c98f1f37212c8cc</div><div id='time'> Time: 2020-08-03</div><div id='author'> Author: gordicaleksa@gmail.com</div><div id='file'> File Name: segmentation.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: stylized_frames_mask_combiner(3)</div><div id='n_method'> N Method Name: stylized_frames_mask_combiner(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: segmentation.py</div><div id='n_file'> N File Name: segmentation.py</div><div id='m_start'> M Start Line: 108</div><div id='m_end'> M End Line: 150</div><div id='n_start'> N Start Line: 109</div><div id='n_end'> N End Line: 156</div><BR>