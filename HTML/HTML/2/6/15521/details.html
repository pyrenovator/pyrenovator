<html><h3>Pattern ID :15521
</h3><img src='52569010.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    else:
        if len(df_dict) == 1:
            for df_name, df_i in df_dict.items():
                df_train[df_name], <a id="change">df_val[df_name]</a> = _split_df(df_i, n_lags, n_forecasts, valid_p, inputs_overbleed)
        else:
            &#47&#47 Split data according to time threshold defined by the valid_p
            threshold_time_stamp = find_time_threshold(df_dict, n_lags, n_forecasts, valid_p, inputs_overbleed)</code></pre><h3>After Change</h3><pre><code class='java'>
            df_train = pd.concat((df_train, df_t.copy(deep=True)), ignore_index=True)
            df_val = pd.concat((df_val, df_v.copy(deep=True)), ignore_index=True)
    else:
        if len(<a id="change">df["ID"]</a>.unique()) == 1:
            for df_name, df_i in <a id="change">df.groupby("ID"</a><a id="change">)</a>:
                df_train, df_val = _split_df(df_i, n_lags, n_forecasts, valid_p, inputs_overbleed)
        else:
            &#47&#47 Split data according to time threshold defined by the valid_p</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/ourownstory/neural_prophet/commit/7fcf23557cb5b30885a8a07387d411c61a50a05e#diff-cb8ae2d50e5d5d245ed6fcc8cadf2baf7294fa9ac5c63e819fbfe34f0e4c2552L913' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 52569010</div><div id='project'> Project Name: ourownstory/neural_prophet</div><div id='commit'> Commit Name: 7fcf23557cb5b30885a8a07387d411c61a50a05e</div><div id='time'> Time: 2022-06-21</div><div id='author'> Author: mgheorghecr@gmail.com</div><div id='file'> File Name: neuralprophet/df_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: split_df(6)</div><div id='n_method'> N Method Name: split_df(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: neuralprophet/df_utils.py</div><div id='n_file'> N File Name: neuralprophet/df_utils.py</div><div id='m_start'> M Start Line: 924</div><div id='m_end'> M End Line: 949</div><div id='n_start'> N Start Line: 913</div><div id='n_end'> N End Line: 930</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    else:
        if len(df_dict) == 1:
            for df_name, df_i in df_dict.items():
                <a id="change">df_train[df_name]</a>, df_val[df_name] = _split_df(df_i, n_lags, n_forecasts, valid_p, inputs_overbleed)
        else:
            &#47&#47 Split data according to time threshold defined by the valid_p
            threshold_time_stamp = find_time_threshold(df_dict, n_lags, n_forecasts, valid_p, inputs_overbleed)</code></pre><h3>After Change</h3><pre><code class='java'>
            df_train = pd.concat((df_train, df_t.copy(deep=True)), ignore_index=True)
            df_val = pd.concat((df_val, df_v.copy(deep=True)), ignore_index=True)
    else:
        if len(<a id="change">df["ID"]</a>.unique()) == 1:
            for df_name, df_i in <a id="change">df.groupby("ID"</a><a id="change">)</a>:
                df_train, df_val = _split_df(df_i, n_lags, n_forecasts, valid_p, inputs_overbleed)
        else:
            &#47&#47 Split data according to time threshold defined by the valid_p</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ourownstory/neural_prophet/commit/7fcf23557cb5b30885a8a07387d411c61a50a05e#diff-cb8ae2d50e5d5d245ed6fcc8cadf2baf7294fa9ac5c63e819fbfe34f0e4c2552L896' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 52569011</div><div id='project'> Project Name: ourownstory/neural_prophet</div><div id='commit'> Commit Name: 7fcf23557cb5b30885a8a07387d411c61a50a05e</div><div id='time'> Time: 2022-06-21</div><div id='author'> Author: mgheorghecr@gmail.com</div><div id='file'> File Name: neuralprophet/df_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: split_df(6)</div><div id='n_method'> N Method Name: split_df(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: neuralprophet/df_utils.py</div><div id='n_file'> N File Name: neuralprophet/df_utils.py</div><div id='m_start'> M Start Line: 924</div><div id='m_end'> M End Line: 949</div><div id='n_start'> N Start Line: 913</div><div id='n_end'> N End Line: 930</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    df_val = {}
    for key in df_dict:
        if df_dict[key]["ds"].max() &lt; threshold_time_stamp:
            df_train[key] = <a id="change">df_dict[key]</a>.copy(deep=True).reset_index(drop=True)
        elif df_dict[key]["ds"].min() &gt; threshold_time_stamp:
            df_val[key] = df_dict[key].copy(deep=True).reset_index(drop=True)
        else:</code></pre><h3>After Change</h3><pre><code class='java'>
    
    df_train = pd.DataFrame()
    df_val = pd.DataFrame()
    for df_name, df_i in <a id="change">df.groupby("ID"</a><a id="change">)</a>:
        if df[<a id="change">df["ID"]</a> == df_name]["ds"].max() &lt; threshold_time_stamp:
            df_train = pd.concat((df_train, df_i.copy(deep=True)), ignore_index=True)
        elif df[df["ID"] == df_name]["ds"].min() &gt; threshold_time_stamp:
            df_val = pd.concat((df_val, df_i.copy(deep=True)), ignore_index=True)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ourownstory/neural_prophet/commit/7fcf23557cb5b30885a8a07387d411c61a50a05e#diff-cb8ae2d50e5d5d245ed6fcc8cadf2baf7294fa9ac5c63e819fbfe34f0e4c2552L856' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 52569009</div><div id='project'> Project Name: ourownstory/neural_prophet</div><div id='commit'> Commit Name: 7fcf23557cb5b30885a8a07387d411c61a50a05e</div><div id='time'> Time: 2022-06-21</div><div id='author'> Author: mgheorghecr@gmail.com</div><div id='file'> File Name: neuralprophet/df_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: split_considering_timestamp(5)</div><div id='n_method'> N Method Name: split_considering_timestamp(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: neuralprophet/df_utils.py</div><div id='n_file'> N File Name: neuralprophet/df_utils.py</div><div id='m_start'> M Start Line: 879</div><div id='m_end'> M End Line: 892</div><div id='n_start'> N Start Line: 868</div><div id='n_end'> N End Line: 881</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    &#47&#47 Creates first time interval based on data from first key
    time_interval_intersection = df_dict[list(df_dict.keys())[0]][["ds"]]
    for key in df_dict:
        time_interval_intersection = pd.merge(time_interval_intersection, <a id="change">df_dict[key]</a>, how="inner", on=["ds"])
        time_interval_intersection = time_interval_intersection[["ds"]]
    start_date = time_interval_intersection["ds"].iloc[0]
    end_date = time_interval_intersection["ds"].iloc[-1]</code></pre><h3>After Change</h3><pre><code class='java'>
            time interval end
    
    &#47&#47 Creates first time interval based on data from first key
    time_interval_intersection = df[df["ID"] == <a id="change">df["ID"]</a>.iloc[0]]["ds"]
    for df_name, df_i in <a id="change">df.groupby("ID"</a><a id="change">)</a>:
        time_interval_intersection = pd.merge(time_interval_intersection, df_i, how="inner", on=["ds"])
        time_interval_intersection = time_interval_intersection[["ds"]]
    start_date = time_interval_intersection["ds"].iloc[0]</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ourownstory/neural_prophet/commit/7fcf23557cb5b30885a8a07387d411c61a50a05e#diff-cb8ae2d50e5d5d245ed6fcc8cadf2baf7294fa9ac5c63e819fbfe34f0e4c2552L560' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 52569018</div><div id='project'> Project Name: ourownstory/neural_prophet</div><div id='commit'> Commit Name: 7fcf23557cb5b30885a8a07387d411c61a50a05e</div><div id='time'> Time: 2022-06-21</div><div id='author'> Author: mgheorghecr@gmail.com</div><div id='file'> File Name: neuralprophet/df_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: find_valid_time_interval_for_cv(1)</div><div id='n_method'> N Method Name: find_valid_time_interval_for_cv(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: neuralprophet/df_utils.py</div><div id='n_file'> N File Name: neuralprophet/df_utils.py</div><div id='m_start'> M Start Line: 576</div><div id='m_end'> M End Line: 578</div><div id='n_start'> N Start Line: 567</div><div id='n_end'> N End Line: 569</div><BR>