<html><h3>Pattern ID :26053
</h3><img src='78646896.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        x_test = dataset.prepare("test", col_set="feature")
        index = x_test.index
        x_test = <a id="change">torch.from_numpy(x_test.values).float()</a>

        x_test = x_test.to(self.device)
        self.sfm_model.eval()
</code></pre><h3>After Change</h3><pre><code class='java'>

        for begin in range(sample_num)[::self.batch_size]:
            if sample_num-begin&lt;self.batch_size:
                end<a id="change"> = </a>sample_num
            else:
                end = begin + self.batch_size

            x_batch = <a id="change">torch.from_numpy(x_values[begin:end]).float()</a>

            if self.device != &quotcpu&quot:
                x_batch<a id="change"> = </a>x_batch.to(self.device)
            
            with torch.no_grad():
                if self.device != &quotcpu&quot:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/64b7748033326b0aaa3c4c907ccd9b2d353d553d#diff-3deabc1688cc58d788c967fe2bfc6d160a2a8933cec2071c8cb62c5cc80b31ccL415' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 78646896</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: 64b7748033326b0aaa3c4c907ccd9b2d353d553d</div><div id='time'> Time: 2020-11-25</div><div id='author'> Author: haouyw2@gmail.com</div><div id='file'> File Name: qlib/contrib/model/pytorch_sfm.py</div><div id='m_class'> M Class Name: SFM</div><div id='n_method'> N Class Name: SFM</div><div id='m_method'> M Method Name: predict(2)</div><div id='n_method'> N Method Name: predict(2)</div><div id='m_parent_class'> M Parent Class: Model</div><div id='n_parent_class'> N Parent Class: Model</div><div id='m_file'> M File Name: qlib/contrib/model/pytorch_sfm.py</div><div id='n_file'> N File Name: qlib/contrib/model/pytorch_sfm.py</div><div id='m_start'> M Start Line: 415</div><div id='m_end'> M End Line: 427</div><div id='n_start'> N Start Line: 420</div><div id='n_end'> N End Line: 445</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        x_test = dataset.prepare("test", col_set="feature")
        index = x_test.index
        x_test = <a id="change">torch.from_numpy(x_test.values).float()</a>

        x_test = x_test.to(self.device)
        self.sfm_model.eval()
</code></pre><h3>After Change</h3><pre><code class='java'>
        sample_num = x_values.shape[0]
        preds = []

        for <a id="change">begin</a> in range(sample_num)[::self.batch_size]:
            if sample_num-begin&lt;self.batch_size:
                end = sample_num
            else:
                end<a id="change"> = </a>begin + self.batch_size

            x_batch = <a id="change">torch.from_numpy(x_values[begin:end]).float()</a>

            if self.device != &quotcpu&quot:
                x_batch<a id="change"> = </a>x_batch.to(self.device)
            
            with torch.no_grad():
                if self.device != &quotcpu&quot:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/64b7748033326b0aaa3c4c907ccd9b2d353d553d#diff-3deabc1688cc58d788c967fe2bfc6d160a2a8933cec2071c8cb62c5cc80b31ccL411' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 78646899</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: 64b7748033326b0aaa3c4c907ccd9b2d353d553d</div><div id='time'> Time: 2020-11-25</div><div id='author'> Author: haouyw2@gmail.com</div><div id='file'> File Name: qlib/contrib/model/pytorch_sfm.py</div><div id='m_class'> M Class Name: SFM</div><div id='n_method'> N Class Name: SFM</div><div id='m_method'> M Method Name: predict(2)</div><div id='n_method'> N Method Name: predict(2)</div><div id='m_parent_class'> M Parent Class: Model</div><div id='n_parent_class'> N Parent Class: Model</div><div id='m_file'> M File Name: qlib/contrib/model/pytorch_sfm.py</div><div id='n_file'> N File Name: qlib/contrib/model/pytorch_sfm.py</div><div id='m_start'> M Start Line: 415</div><div id='m_end'> M End Line: 427</div><div id='n_start'> N Start Line: 420</div><div id='n_end'> N End Line: 445</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        x_test = dataset.prepare("test", col_set="feature")
        index = x_test.index
        x_test = <a id="change">torch.from_numpy(x_test.values).float()</a>

        if self.use_gpu:
            x_test = x_test.cuda()
        self.gru_model.eval()</code></pre><h3>After Change</h3><pre><code class='java'>
        sample_num = x_values.shape[0]
        preds = []

        for <a id="change">begin</a> in range(sample_num)[::self.batch_size]:

            if sample_num-begin &lt; self.batch_size:
                end = sample_num
            else:
                end<a id="change"> = </a>begin+self.batch_size

            x_batch<a id="change"> = </a><a id="change">torch.from_numpy(x_values[begin:end]).float()</a>


            if self.use_gpu:
                x_batch = x_batch.cuda()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/0afe57f2fe2cac385951ad7cce1fc0066b7720f5#diff-c97875df07622cf74cacd52427569a97a609af897a5a57053d9fdd4a8222fbcaL277' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 78646889</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: 0afe57f2fe2cac385951ad7cce1fc0066b7720f5</div><div id='time'> Time: 2020-11-16</div><div id='author'> Author: Lewen.Wang@microsoft.com</div><div id='file'> File Name: qlib/contrib/model/pytorch_gru.py</div><div id='m_class'> M Class Name: GRU</div><div id='n_method'> N Class Name: GRU</div><div id='m_method'> M Method Name: predict(2)</div><div id='n_method'> N Method Name: predict(2)</div><div id='m_parent_class'> M Parent Class: Model</div><div id='n_parent_class'> N Parent Class: Model</div><div id='m_file'> M File Name: qlib/contrib/model/pytorch_gru.py</div><div id='n_file'> N File Name: qlib/contrib/model/pytorch_gru.py</div><div id='m_start'> M Start Line: 281</div><div id='m_end'> M End Line: 294</div><div id='n_start'> N Start Line: 295</div><div id='n_end'> N End Line: 323</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        reproTool = reproTools[dataset_name]
        num_cameras = imgs_orig.shape[0]

        imgs = <a id="change">torch.from_numpy(imgs_orig).cuda().float()</a>.permute(0,3,1,2)

        points3D_net = jarvisPredictor(imgs, reproTool.cameraMatrices.cuda(), reproTool.intrinsicMatrices.cuda(), reproTool.distortionCoefficients.cuda())
</code></pre><h3>After Change</h3><pre><code class='java'>
                pin_memory = True)


    for item, <a id="change">sample</a> in enumerate(tqdm(data_generator)):
        if progress_bar != None:
            progress_bar.progress(float(item+1)/len(dataset.image_ids))

        keypoints3D = sample[1][0].numpy()
        imgs_orig = sample[0][0]
        img_size = imgs_orig[0].shape
        num_cameras = imgs_orig.shape[0]
        dataset_name<a id="change"> = </a>sample[-2][0]
        reproTool = reproTools[dataset_name]
        file_name = sample[-1][0]

        imgs<a id="change"> = </a><a id="change">imgs_orig.cuda().float()</a>.permute(0,3,1,2)

        points3D_net = jarvisPredictor(imgs,
                    reproTool.cameraMatrices.cuda(),</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jarvis-mocap/jarvis-hybridnet/commit/327b43a36cc8aa4995c6e50842b02f3577a1e241#diff-769b6466744cecdc87ace0d46622975c1c612d93b95416dd15345c5193a92404L16' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 78646892</div><div id='project'> Project Name: jarvis-mocap/jarvis-hybridnet</div><div id='commit'> Commit Name: 327b43a36cc8aa4995c6e50842b02f3577a1e241</div><div id='time'> Time: 2022-04-28</div><div id='author'> Author: jarvismocap@gmail.com</div><div id='file'> File Name: jarvis/analysis/analyze.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: analyze_validation_data(5)</div><div id='n_method'> N Method Name: analyze_validation_data(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: jarvis/analysis/analyze.py</div><div id='n_file'> N File Name: jarvis/analysis/analyze.py</div><div id='m_start'> M Start Line: 28</div><div id='m_end'> M End Line: 52</div><div id='n_start'> N Start Line: 22</div><div id='n_end'> N End Line: 82</div><BR>