<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    model_device = get_device(model)
    batch_size = sample.shape[0]
    for _ in tqdm(range(num_runs), desc=f"Warming up with batch_size={batch_size}"):
        <a id="change">model(sample.to(device=model_device)</a><a id="change">)</a>.to(device="cpu")


def measure_detailed_inference_timing(model, sample):</code></pre><h3>After Change</h3><pre><code class='java'>
    batch_size: int = None,
):
    for _ in tqdm(range(num_runs), desc=f"Warming up with batch_size={batch_size}"):
        <a id="change">transfer_to_device_fn(
            model(transfer_to_device_fn(</a>sample, model_device<a id="change">)</a><a id="change">)</a>,
            <a id="change">"cpu"</a><a id="change">,
        )</a>


def measure_detailed_inference_timing(
    model, sample, model_device, transfer_to_device_fn=torch.Tensor.to</code></pre>