<html><h3>Pattern ID :4258
</h3><img src='15508076.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            quantiles = self.quantiles

        samples = y_pred.size(-1)
        quantiles<a id="change"> = </a><a id="change">torch.stack(
            </a>[torch.kthvalue(y_pred, int(samples * q), dim=-1)[0] if samples &gt; 1 else y_pred[..., 0] for q in quantiles]<a id="change">,
            dim=-1,
        )</a>
        return quantiles


class NormalDistributionLoss(DistributionLoss):</code></pre><h3>After Change</h3><pre><code class='java'>
            quantiles = [distribution.icdf(quantile) for quantile in quantiles]
        except NotImplementedError:  &#47&#47 resort to derive quantiles empirically
            samples = torch.sort(self.sample(y_pred, 1000), -1).values
            quantiles = <a id="change">torch.quantile(samples, torch.tensor(quantiles), dim=2).permute(1</a>, <a id="change">2</a>, <a id="change">0</a><a id="change">)</a>
        return quantiles


class NormalDistributionLoss(DistributionLoss):</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/jdb78/pytorch-forecasting/commit/d96465c514b8bf280fae33f0def40fffb62467dd#diff-b33317714bfa742fe554f4cce1ee1221e7d5182714f10cfd995f89f71ab1dac1L944' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 15508076</div><div id='project'> Project Name: jdb78/pytorch-forecasting</div><div id='commit'> Commit Name: d96465c514b8bf280fae33f0def40fffb62467dd</div><div id='time'> Time: 2021-04-11</div><div id='author'> Author: beitner.jan@bcg.com</div><div id='file'> File Name: pytorch_forecasting/metrics.py</div><div id='m_class'> M Class Name: DistributionLoss</div><div id='n_method'> N Class Name: DistributionLoss</div><div id='m_method'> M Method Name: to_quantiles(3)</div><div id='n_method'> N Method Name: to_quantiles(3)</div><div id='m_parent_class'> M Parent Class: MultiHorizonMetric</div><div id='n_parent_class'> N Parent Class: MultiHorizonMetric</div><div id='m_file'> M File Name: pytorch_forecasting/metrics.py</div><div id='n_file'> N File Name: pytorch_forecasting/metrics.py</div><div id='m_start'> M Start Line: 944</div><div id='m_end'> M End Line: 950</div><div id='n_start'> N Start Line: 945</div><div id='n_end'> N End Line: 953</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    for i in x:
        ss_space.append(cosine_sim(i.t(),i.t()))
        ss_channel.append(cosine_sim(i,i))
    ss_space<a id="change"> = </a><a id="change">torch.stack(</a>ss_space,0<a id="change">)</a>
    ss_space = ss_space.view(ss_space.size(0),ss_space.size(1),height,width) &#47&#47 N, H*W, H, W
    ss_channel = torch.stack(ss_channel,0) &#47&#47 N, C, C
    &#47&#47 height = x.size(2)
    &#47&#47 width = x.size(3)</code></pre><h3>After Change</h3><pre><code class='java'>
    width = x.size(3)
    x = x.view(x.size(0), x.size(1),-1) &#47&#47 N, C, H*W

    ss_space = cosine_sim(x.permute(0,2,1),<a id="change">x.permute(0</a>,<a id="change">2</a>,<a id="change">1</a><a id="change">)</a>)
    ss_channel = cosine_sim(x,x)

    ss_space = ss_space.view(ss_space.size(0),ss_space.size(1),height,width) &#47&#47 N, H*W, H, W</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/haoosz/ffr-net/commit/0698fd1ed99a6ddfeac8298de736c5ac7421e0b2#diff-7fdc9cdd613ec93c2879399ebc12d30d272a04ddc61c9ff7553232ce10567486L217' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 15508072</div><div id='project'> Project Name: haoosz/ffr-net</div><div id='commit'> Commit Name: 0698fd1ed99a6ddfeac8298de736c5ac7421e0b2</div><div id='time'> Time: 2020-08-29</div><div id='author'> Author: haoshaozhe@outlook.com</div><div id='file'> File Name: models/recnet.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: selfSimilarity(1)</div><div id='n_method'> N Method Name: selfSimilarity(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: models/recnet.py</div><div id='n_file'> N File Name: models/recnet.py</div><div id='m_start'> M Start Line: 220</div><div id='m_end'> M End Line: 228</div><div id='n_start'> N Start Line: 220</div><div id='n_end'> N End Line: 223</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            p.append(pt)
            Mv.append(Mvt)

        p<a id="change"> = </a><a id="change">torch.stack(</a>p<a id="change">, dim=1)</a>
        Mv = torch.stack(Mv, dim=1)

        return p, Mv
</code></pre><h3>After Change</h3><pre><code class='java'>
        a = torch.tanh(self.a_layer(v))

        for et, at, wt in zip(
            e.permute(1, 0, 2), a.permute(1, 0, 2), <a id="change">w.permute(1</a>, <a id="change">0</a>, <a id="change">2</a><a id="change">)</a>
        ):
            Mvt = Mvt * (1 - (wt.unsqueeze(-1) * et.unsqueeze(1))) + \
                (wt.unsqueeze(-1) * at.unsqueeze(1))
            Mv.append(Mvt)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hcnoh/knowledge-tracing-collection-pytorch/commit/c42b01b83dbe54e94f4294009fbfe8bd910e3638#diff-f2ab9795149528e0325dcc207d9bb2ee66e3cdd4dff09817a550ab5174cc8763L39' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 15508088</div><div id='project'> Project Name: hcnoh/knowledge-tracing-collection-pytorch</div><div id='commit'> Commit Name: c42b01b83dbe54e94f4294009fbfe8bd910e3638</div><div id='time'> Time: 2021-10-06</div><div id='author'> Author: rhc0624@gmail.com</div><div id='file'> File Name: models/dkvmn.py</div><div id='m_class'> M Class Name: DKVMN</div><div id='n_method'> N Class Name: DKVMN</div><div id='m_method'> M Method Name: forward(3)</div><div id='n_method'> N Method Name: forward(3)</div><div id='m_parent_class'> M Parent Class: Module</div><div id='n_parent_class'> N Parent Class: Module</div><div id='m_file'> M File Name: models/dkvmn.py</div><div id='n_file'> N File Name: models/dkvmn.py</div><div id='m_start'> M Start Line: 40</div><div id='m_end'> M End Line: 66</div><div id='n_start'> N Start Line: 50</div><div id='n_end'> N End Line: 87</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            for channel in channel_paths:
                channel_clip = self.kp_loader(channel, frame_indices)
                channel_clip = [self.spatial_transform(img) for img in channel_clip]
                channel_clip = <a id="change">torch.stack(</a>channel_clip, 0<a id="change">)</a>
                clip = torch.cat((clip, channel_clip), dim=1)
        clip<a id="change"> = </a>clip.permute(1, 0, 2, 3) &#47&#47change to (C, D, H, W)
        return clip

</code></pre><h3>After Change</h3><pre><code class='java'>
                clip = [torch.cat((clip[i], channel_clip[i]), dim=0) for i in range(len(clip))]

        clip = [self.normalize(img) for img in clip]
        clip = <a id="change">torch.stack(clip, 0).permute(</a>1, <a id="change">0</a>, <a id="change">2</a>, <a id="change">3</a><a id="change">)</a> &#47&#47change to (C, D, H, W)
        return clip

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/rvl-lab-utoronto/video_similarity_search/commit/788acf793c6f96886239d558a25a8e84efcb14f9#diff-141ca3c0e7091a2a7a3351986189c89b27d73158c0754a921a731b5e12abefcdL64' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 15508064</div><div id='project'> Project Name: rvl-lab-utoronto/video_similarity_search</div><div id='commit'> Commit Name: 788acf793c6f96886239d558a25a8e84efcb14f9</div><div id='time'> Time: 2020-08-17</div><div id='author'> Author: sherrychen127@gmail.com</div><div id='file'> File Name: datasets/triplets_loader.py</div><div id='m_class'> M Class Name: TripletsData</div><div id='n_method'> N Class Name: TripletsData</div><div id='m_method'> M Method Name: __loading(4)</div><div id='n_method'> N Method Name: __loading(4)</div><div id='m_parent_class'> M Parent Class: data.Dataset</div><div id='n_parent_class'> N Parent Class: data.Dataset</div><div id='m_file'> M File Name: datasets/triplets_loader.py</div><div id='n_file'> N File Name: datasets/triplets_loader.py</div><div id='m_start'> M Start Line: 65</div><div id='m_end'> M End Line: 76</div><div id='n_start'> N Start Line: 67</div><div id='n_end'> N End Line: 80</div><BR>