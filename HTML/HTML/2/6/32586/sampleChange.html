<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        state_dict = lora_model.state_dict()
        for weight_name in state_dict:
            is_target_module = False
            <a id="change">for </a>target_module in lora_config.target_modules<a id="change">:
                </a>if re.fullmatch(target_module, weight_name):
                    is_target_module = True
            &#47&#47 if this is a target module, lora weights are trainable, non-lora weights are not
            if is_target_module:</code></pre><h3>After Change</h3><pre><code class='java'>
        )
        lora_model = get_lora_model(model, lora_config)
        mark_only_lora_as_trainable(lora_model, bias)
        <a id="change">for </a>name, weight in lora_model.state_dict().items()<a id="change">:
            </a><a id="change">if </a><a id="change">any(</a>[re.fullmatch(target_module, name) <a id="change">for</a> target_module in lora_config.target_modules]<a id="change">)</a>:
                if "lora" in name:
                    self.assertFalse(weight.stop_gradient)
                elif "bias" in name and bias in ["lora", "all"]:</code></pre>