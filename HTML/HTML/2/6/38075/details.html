<html><h3>Pattern ID :38075
</h3><img src='109151795.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    def fuse(self):  &#47&#47 fuse model Conv2d() + BatchNorm2d() layers
        print(&quotFusing layers... &quot)
        for m in self.model.modules():
            if <a id="change">type(m) is Conv</a> and hasattr(m, &quotbn&quot):
                m.conv = fuse_conv_and_bn(m.conv, m.bn)  &#47&#47 update conv
                delattr(m, &quotbn&quot)  &#47&#47 remove batchnorm
                m.forward = m.fuseforward  &#47&#47 update forward</code></pre><h3>After Change</h3><pre><code class='java'>

    def fuse(self):  &#47&#47 fuse model Conv2d() + BatchNorm2d() layers
        LOGGER.info(&quotFusing layers... &quot)
        for <a id="change">m</a> in self.model.modules():
            if <a id="change">isinstance(m</a>, (Conv<a id="change">, DWConv</a>)<a id="change">)</a> and hasattr(m, &quotbn&quot):
                m.conv = fuse_conv_and_bn(m.conv, m.bn)  &#47&#47 update conv
                delattr(m, &quotbn&quot)  &#47&#47 remove batchnorm
                m.forward = m.forward_fuse  &#47&#47 update forward</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 6</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/pooya-mohammadi/deep_utils/commit/7d442fe6eef7ccd63661e0463e87358ff795d709#diff-49eab6b0c60ac05fb492f015910f89eb7e7700e4f19ef20b92bf2a7483df7ec3L169' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 109151795</div><div id='project'> Project Name: pooya-mohammadi/deep_utils</div><div id='commit'> Commit Name: 7d442fe6eef7ccd63661e0463e87358ff795d709</div><div id='time'> Time: 2021-11-26</div><div id='author'> Author: practical.ai.programming@gmail.com</div><div id='file'> File Name: deep_utils/vision/object_detection/yolo/v5/torch/models/yolo.py</div><div id='m_class'> M Class Name: Model</div><div id='n_method'> N Class Name: Model</div><div id='m_method'> M Method Name: fuse(1)</div><div id='n_method'> N Method Name: fuse(1)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: deep_utils/vision/object_detection/yolo/v5/torch/models/yolo.py</div><div id='n_file'> N File Name: deep_utils/vision/object_detection/yolo/v5/torch/models/yolo.py</div><div id='m_start'> M Start Line: 169</div><div id='m_end'> M End Line: 170</div><div id='n_start'> N Start Line: 219</div><div id='n_end'> N End Line: 221</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>def generate_exp_name(exp_name, params):
    for k, <a id="change">v</a> in params.items():
        if <a id="change">type(v) == int</a>:
            pass
        elif type(v) == list:
            v = [str(iv) for iv in v]</code></pre><h3>After Change</h3><pre><code class='java'>def generate_exp_name(exp_name, params):
    for k, <a id="change">v</a> in params.items():
        if <a id="change">isinstance(</a>v, (int<a id="change">, str, bool</a>)<a id="change">)</a>:
            pass
        elif type(v) == list:
            v = [str(iv) for iv in v]</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ryanxingql/powerqe/commit/4b41d2b60407bbbc2a25dfcaba1edade8ff9dc53#diff-8e5697a172b576be93a1cceca3883c4dad6bb68ad9faa508c5fe75d695b5c1f8L1' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 109151794</div><div id='project'> Project Name: ryanxingql/powerqe</div><div id='commit'> Commit Name: 4b41d2b60407bbbc2a25dfcaba1edade8ff9dc53</div><div id='time'> Time: 2023-04-28</div><div id='author'> Author: ryanxingql@gmail.com</div><div id='file'> File Name: configs/script.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: generate_exp_name(2)</div><div id='n_method'> N Method Name: generate_exp_name(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: configs/script.py</div><div id='n_file'> N File Name: configs/script.py</div><div id='m_start'> M Start Line: 2</div><div id='m_end'> M End Line: 9</div><div id='n_start'> N Start Line: 2</div><div id='n_end'> N End Line: 10</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    def fuse(self):  &#47&#47 fuse model Conv2d() + BatchNorm2d() layers
        LOGGER.info(&quotFusing layers... &quot)
        for <a id="change">m</a> in self.model.modules():
            if <a id="change">type(m) is Conv</a> and hasattr(m, &quotbn&quot):
                m.conv = fuse_conv_and_bn(m.conv, m.bn)  &#47&#47 update conv
                delattr(m, &quotbn&quot)  &#47&#47 remove batchnorm
                m.forward = m.fuseforward  &#47&#47 update forward</code></pre><h3>After Change</h3><pre><code class='java'>

    def fuse(self):  &#47&#47 fuse model Conv2d() + BatchNorm2d() layers
        LOGGER.info(&quotFusing layers... &quot)
        for <a id="change">m</a> in self.model.modules():
            if <a id="change">isinstance(</a>m, (Conv<a id="change">, DWConvClass</a>)<a id="change">)</a> and hasattr(m, &quotbn&quot):
                m.conv = fuse_conv_and_bn(m.conv, m.bn)  &#47&#47 update conv
                delattr(m, &quotbn&quot)  &#47&#47 remove batchnorm
                m.forward = m.forward_fuse  &#47&#47 update forward</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/wmcnally/kapao/commit/587c4b4b81fb4e9423e33a2a235731742386d03c#diff-2cd118cbb69c9ca7b5544f4187b11335fc3addbaf2c3c5bb45435cac648c957bL202' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 109151798</div><div id='project'> Project Name: wmcnally/kapao</div><div id='commit'> Commit Name: 587c4b4b81fb4e9423e33a2a235731742386d03c</div><div id='time'> Time: 2021-08-02</div><div id='author'> Author: glenn.jocher@ultralytics.com</div><div id='file'> File Name: models/yolo.py</div><div id='m_class'> M Class Name: Model</div><div id='n_method'> N Class Name: Model</div><div id='m_method'> M Method Name: fuse(1)</div><div id='n_method'> N Method Name: fuse(1)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: models/yolo.py</div><div id='n_file'> N File Name: models/yolo.py</div><div id='m_start'> M Start Line: 204</div><div id='m_end'> M End Line: 205</div><div id='n_start'> N Start Line: 204</div><div id='n_end'> N End Line: 205</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            mi.bias = torch.nn.Parameter(b.view(-1), requires_grad=True)

    def _initialize_weights(self):
        for <a id="change">m</a> in self.modules():
            t = <a id="change">type(</a>m<a id="change">)</a>
            if <a id="change">t is nn.Conv2d</a>:
                pass  &#47&#47 nn.init.kaiming_normal_(m.weight, mode=&quotfan_out&quot, nonlinearity=&quotrelu&quot)
            elif t is nn.BatchNorm2d:
                m.eps = 1e-3</code></pre><h3>After Change</h3><pre><code class='java'>
                conv.bias = torch.nn.Parameter(bias.view(-1), requires_grad=True)

    def _initialize_weights(self):
        for <a id="change">m</a> in self.modules():
            if isinstance(m, nn.BatchNorm2d):
                m.eps = 1e-3
                m.momentum = 0.03
            elif <a id="change">isinstance(</a>m, (nn.LeakyReLU<a id="change">, nn.ReLU, nn.ReLU6, nn.Hardswish, nn.SiLU</a>)<a id="change">)</a>:
                m.inplace = True

    def initialize_param_groups(self, lr: float, training_params: HpmStruct) -&gt; list:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/deci-ai/super-gradients/commit/d4df44b403556cb548016d1403323d79aafe24ee#diff-e310e97fb677b6f383fa988ce9e3fc1d4159a48968aef0b53160241b3b96ec3dL408' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 109151789</div><div id='project'> Project Name: deci-ai/super-gradients</div><div id='commit'> Commit Name: d4df44b403556cb548016d1403323d79aafe24ee</div><div id='time'> Time: 2022-06-22</div><div id='author'> Author: 80472096+shaydeci@users.noreply.github.com</div><div id='file'> File Name: src/super_gradients/training/models/detection_models/yolov5_base.py</div><div id='m_class'> M Class Name: YoLoV5Base</div><div id='n_method'> N Class Name: YoLoV5Base</div><div id='m_method'> M Method Name: _initialize_weights(1)</div><div id='n_method'> N Method Name: _initialize_weights(1)</div><div id='m_parent_class'> M Parent Class: SgModule</div><div id='n_parent_class'> N Parent Class: SgModule</div><div id='m_file'> M File Name: src/super_gradients/training/models/detection_models/yolov5_base.py</div><div id='n_file'> N File Name: src/super_gradients/training/models/detection_models/yolov5_base.py</div><div id='m_start'> M Start Line: 409</div><div id='m_end'> M End Line: 419</div><div id='n_start'> N Start Line: 428</div><div id='n_end'> N End Line: 435</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    def fuse(self):  &#47&#47 fuse model Conv2d() + BatchNorm2d() layers
        LOGGER.info(&quotFusing layers... &quot)
        for <a id="change">m</a> in self.model.modules():
            if <a id="change">type(m) is Conv</a> and hasattr(m, &quotbn&quot):
                m.conv = fuse_conv_and_bn(m.conv, m.bn)  &#47&#47 update conv
                delattr(m, &quotbn&quot)  &#47&#47 remove batchnorm
                m.forward = m.fuseforward  &#47&#47 update forward</code></pre><h3>After Change</h3><pre><code class='java'>

    def fuse(self):  &#47&#47 fuse model Conv2d() + BatchNorm2d() layers
        LOGGER.info(&quotFusing layers... &quot)
        for <a id="change">m</a> in self.model.modules():
            if <a id="change">isinstance(</a>m, (Conv<a id="change">, DWConv</a>)<a id="change">)</a> and hasattr(m, &quotbn&quot):
                m.conv = fuse_conv_and_bn(m.conv, m.bn)  &#47&#47 update conv
                delattr(m, &quotbn&quot)  &#47&#47 remove batchnorm
                m.forward = m.forward_fuse  &#47&#47 update forward</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/positive666/yolov5_research/commit/dd05956165521871db879b745d20e71a48e3569f#diff-2cd118cbb69c9ca7b5544f4187b11335fc3addbaf2c3c5bb45435cac648c957bL263' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 109151791</div><div id='project'> Project Name: positive666/yolov5_research</div><div id='commit'> Commit Name: dd05956165521871db879b745d20e71a48e3569f</div><div id='time'> Time: 2021-10-24</div><div id='author'> Author: 286040359@qq.com</div><div id='file'> File Name: models/yolo.py</div><div id='m_class'> M Class Name: Model</div><div id='n_method'> N Class Name: Model</div><div id='m_method'> M Method Name: fuse(1)</div><div id='n_method'> N Method Name: fuse(1)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: models/yolo.py</div><div id='n_file'> N File Name: models/yolo.py</div><div id='m_start'> M Start Line: 265</div><div id='m_end'> M End Line: 266</div><div id='n_start'> N Start Line: 277</div><div id='n_end'> N End Line: 278</div><BR>