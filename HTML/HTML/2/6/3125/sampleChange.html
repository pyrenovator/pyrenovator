<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        
        

        <a id="change">return {
            </a>&quotinput_ids&quot: torch.randint(0, self.config[&quotn_token&quot], (BATCH_SIZE, SEQ_LEN)),
            &quotpast_key_values&quot: tuple([torch.zeros(self.config[&quotpast_key_values&quot], BATCH_SIZE, self.config[&quotn_head&quot], SEQ_LEN, self.config[&quotd_head&quot]) for _ in range(self.config[&quotn_layer&quot])])<a id="change">
        }</a>


class MemTransformerLMOnnxModel(OnnxModel):
    MemTransformerLM that enables addtiional ONNX optimizations.</code></pre><h3>After Change</h3><pre><code class='java'>
        input_ids = torch.randint(0, self.config.n_token, (self.batch_size, self.seq_len))
        past_key_values =  tuple([torch.zeros(self.config.past_key_values, self.batch_size, self.config.n_head, self.seq_len, self.config.d_head) for _ in range(self.config.n_layer)])

        common_mockups<a id="change"> = </a><a id="change">OrderedDict({</a>&quotinput_ids&quot: input_ids, &quotpast_key_values&quot: past_key_values<a id="change">}</a><a id="change">)</a>
        
        <a id="change">return </a>common_mockups

    
class MemTransformerLMOnnxModel(OnnxModel):</code></pre>