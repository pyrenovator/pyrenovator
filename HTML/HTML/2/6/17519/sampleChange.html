<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        model = tf.keras.Model(inputs=inputs, outputs=outputs)
        mock_input = np.random.randn(1, 32, 32, 3)
        output_before_batchnorm_folding = model(mock_input)
        <a id="change">fold_all_batch_norms(model</a><a id="change">)</a>
        output_after_batchnorm_folding = model(mock_input)

        assert np.allclose(output_before_batchnorm_folding, output_after_batchnorm_folding, rtol=1e-2)
</code></pre><h3>After Change</h3><pre><code class='java'>
        model = tf.keras.Model(inputs=inputs, outputs=outputs)
        mock_input = np.random.randn(1, 32, 32, 3)
        output_before_batchnorm_folding = model(mock_input)
        _<a id="change">, model = </a><a id="change">fold_all_batch_norms(model</a><a id="change">)</a>
        output_after_batchnorm_folding = model(mock_input)

        assert np.allclose(output_before_batchnorm_folding, output_after_batchnorm_folding, rtol=1e-2)
</code></pre>