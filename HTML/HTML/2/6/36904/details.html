<html><h3>Pattern ID :36904
</h3><img src='105056771.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        update_dict(self.train_lines)
        &#47&#47 update_dict(self.valid_lines)
        self.index2word = {v:k for k,v in self.word2index.items()}
        self.index2char = {v:k for k,v in <a id="change">self.char2index.items()</a>}

        self.flag_constructed_dict = True
        vocab_file = {"word2index": self.word2index, "char2index": self.char2index}</code></pre><h3>After Change</h3><pre><code class='java'>
        self.special_tokens = {self.PAD_token:self.PAD_idx, self.BOS_token:self.BOS_idx, 
                               self.EOS_token:self.EOS_idx, self.OOV_token:self.OOV_idx}

        word_indexer = list({word.strip() <a id="change">for</a> line in self.train_lines for word in line[0]+line[1] if <a id="change">len(word.strip()) &gt;1</a>})
        char_indexer<a id="change"> = </a>list(<a id="change">set(</a>"".join(word_indexer)<a id="change">)</a>)

        for token, index in self.special_tokens.items():
            word_indexer.insert(index, token)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/xiaolongjean/multi-source-pointer-network/commit/4ff78a03256eb5578038c83d0eb424b84e437c4f#diff-eded5a7097c195f47aa041a7a39926fac051a99eb721d4eb3173833312df6646L103' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 105056771</div><div id='project'> Project Name: xiaolongjean/multi-source-pointer-network</div><div id='commit'> Commit Name: 4ff78a03256eb5578038c83d0eb424b84e437c4f</div><div id='time'> Time: 2020-10-17</div><div id='author'> Author: 771651685@qq.com</div><div id='file'> File Name: src/data.py</div><div id='m_class'> M Class Name: DataUtils</div><div id='n_method'> N Class Name: DataUtils</div><div id='m_method'> M Method Name: construct_dict(1)</div><div id='n_method'> N Method Name: construct_dict(1)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: src/data.py</div><div id='n_file'> N File Name: src/data.py</div><div id='m_start'> M Start Line: 103</div><div id='m_end'> M End Line: 134</div><div id='n_start'> N Start Line: 104</div><div id='n_end'> N End Line: 126</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        
        update_dict(self.train_lines)
        &#47&#47 update_dict(self.valid_lines)
        self.index2word = {v:k for k,v in <a id="change">self.word2index.items()</a>}
        self.index2char = {v:k for k,v in self.char2index.items()}

        self.flag_constructed_dict = True</code></pre><h3>After Change</h3><pre><code class='java'>
        self.special_tokens = {self.PAD_token:self.PAD_idx, self.BOS_token:self.BOS_idx, 
                               self.EOS_token:self.EOS_idx, self.OOV_token:self.OOV_idx}

        word_indexer = list({word.strip() <a id="change">for</a> <a id="change">line</a> in self.train_lines for word in line[0]+line[1] if <a id="change">len(word.strip()) &gt;1</a>})
        char_indexer<a id="change"> = </a>list(<a id="change">set(</a>"".join(word_indexer)<a id="change">)</a>)

        for token, index in self.special_tokens.items():
            word_indexer.insert(index, token)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/xiaolongjean/multi-source-pointer-network/commit/4ff78a03256eb5578038c83d0eb424b84e437c4f#diff-eded5a7097c195f47aa041a7a39926fac051a99eb721d4eb3173833312df6646L100' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 105056755</div><div id='project'> Project Name: xiaolongjean/multi-source-pointer-network</div><div id='commit'> Commit Name: 4ff78a03256eb5578038c83d0eb424b84e437c4f</div><div id='time'> Time: 2020-10-17</div><div id='author'> Author: 771651685@qq.com</div><div id='file'> File Name: src/data.py</div><div id='m_class'> M Class Name: DataUtils</div><div id='n_method'> N Class Name: DataUtils</div><div id='m_method'> M Method Name: construct_dict(1)</div><div id='n_method'> N Method Name: construct_dict(1)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: src/data.py</div><div id='n_file'> N File Name: src/data.py</div><div id='m_start'> M Start Line: 103</div><div id='m_end'> M End Line: 134</div><div id='n_start'> N Start Line: 104</div><div id='n_end'> N End Line: 126</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    ) -&gt; Dict[str, Set[EquivalentIdSet]]:

        result: Dict[str, Set[EquivalentIdSet]] = {}
        for synonym, metadata in <a id="change">syn_dict.items()</a>:
            metadata_copy = copy.copy(metadata)
            generated_syn_dict: Optional[Dict[str, Set[EquivalentIdSet]]] = self.call(
                synonym, metadata_copy</code></pre><h3>After Change</h3><pre><code class='java'>

    def __call__(self, synonyms: Set[SynonymTerm]) -&gt; Set[SynonymTerm]:

        existing_terms = set(term <a id="change">for</a> <a id="change">synonym</a> in synonyms for term in synonym.terms)

        result<a id="change">: Set[SynonymTerm] = </a><a id="change">set()</a>
        for synonym in synonyms:
            generated_synonym_terms: Optional[SynonymTerm] = self.call(synonym)
            <a id="change">if </a>generated_synonym_terms:
                new_terms = set()
                for generated_syn in generated_synonym_terms.terms:
                    if generated_syn in existing_terms:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/astrazeneca/kazu/commit/683f1a89d2af77a6ee6da2dd1366301f164fe570#diff-751bb7f59aafebac9b4f4138467d359c0ae4ebe38cf605fa0818172e94918799L23' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 105056769</div><div id='project'> Project Name: astrazeneca/kazu</div><div id='commit'> Commit Name: 683f1a89d2af77a6ee6da2dd1366301f164fe570</div><div id='time'> Time: 2022-11-30</div><div id='author'> Author: richard.jackson4@astrazeneca.com</div><div id='file'> File Name: kazu/modelling/ontology_preprocessing/synonym_generation.py</div><div id='m_class'> M Class Name: SynonymGenerator</div><div id='n_method'> N Class Name: SynonymGenerator</div><div id='m_method'> M Method Name: __call__(2)</div><div id='n_method'> N Method Name: __call__(2)</div><div id='m_parent_class'> M Parent Class: ABC</div><div id='n_parent_class'> N Parent Class: ABC</div><div id='m_file'> M File Name: kazu/modelling/ontology_preprocessing/synonym_generation.py</div><div id='n_file'> N File Name: kazu/modelling/ontology_preprocessing/synonym_generation.py</div><div id='m_start'> M Start Line: 27</div><div id='m_end'> M End Line: 45</div><div id='n_start'> N Start Line: 33</div><div id='n_end'> N End Line: 57</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            for generator in permutation_list:
                &#47&#47 run the generator
                new_syns = generator(all_syns)
                for new_syn, syn_data in <a id="change">new_syns.items()</a>:
                    &#47&#47 don&quott add if it maps to a clean syn
                    if new_syn not in syn_dict:
                        results[new_syn].update(syn_data)</code></pre><h3>After Change</h3><pre><code class='java'>
        :param synonym_data:
        :return:
        
        existing_terms = set(term <a id="change">for</a> <a id="change">synonym</a> in synonyms for term in synonym.terms)
        synonym_gen_permutations = itertools.permutations(self.synonym_generators)
        results<a id="change"> = </a><a id="change">set()</a>
        for i, permutation_list in enumerate(synonym_gen_permutations):
            &#47&#47 make a copy of the original synonyms
            all_syns = copy.deepcopy(synonyms)
            logger.info(f"running permutation set {i}. Permutations: {permutation_list}")
            for generator in permutation_list:
                &#47&#47 run the generator
                new_syns: Set[SynonymTerm] = generator(all_syns)
                for new_syn_term in new_syns:
                    &#47&#47 don&quott add if it maps to a clean syn
                    new_terms_this_generator = new_syn_term.terms.difference(existing_terms)
                    <a id="change">if </a>len(new_terms_this_generator) &gt; 0:
                        synonym_term_with_unique_new_terms = make_synonym_term(
                            new_terms_this_generator, new_syn_term
                        )</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/astrazeneca/kazu/commit/683f1a89d2af77a6ee6da2dd1366301f164fe570#diff-751bb7f59aafebac9b4f4138467d359c0ae4ebe38cf605fa0818172e94918799L52' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 105056753</div><div id='project'> Project Name: astrazeneca/kazu</div><div id='commit'> Commit Name: 683f1a89d2af77a6ee6da2dd1366301f164fe570</div><div id='time'> Time: 2022-11-30</div><div id='author'> Author: richard.jackson4@astrazeneca.com</div><div id='file'> File Name: kazu/modelling/ontology_preprocessing/synonym_generation.py</div><div id='m_class'> M Class Name: CombinatorialSynonymGenerator</div><div id='n_method'> N Class Name: CombinatorialSynonymGenerator</div><div id='m_method'> M Method Name: __call__(2)</div><div id='n_method'> N Method Name: __call__(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: kazu/modelling/ontology_preprocessing/synonym_generation.py</div><div id='n_file'> N File Name: kazu/modelling/ontology_preprocessing/synonym_generation.py</div><div id='m_start'> M Start Line: 60</div><div id='m_end'> M End Line: 81</div><div id='n_start'> N Start Line: 70</div><div id='n_end'> N End Line: 93</div><BR>