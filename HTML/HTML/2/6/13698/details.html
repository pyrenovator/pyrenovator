<html><h3>Pattern ID :13698
</h3><img src='45822747.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        batch_loss = []
        for batch_idx, (x, target) in enumerate(test_data):
            &#47&#47 start_time = time.time_ns()
            <a id="change">with device</a><a id="change">:
                </a>x = x.numpy()
                target<a id="change"> = </a><a id="change">target.numpy()</a>

            output = self.model(x)
            self.mx_metric.update([target], [output])
            loss_func = self.mx_loss(output, target)</code></pre><h3>After Change</h3><pre><code class='java'>
        for batch_idx, (x, target) in enumerate(test_data):
            &#47&#47 start_time = time.time_ns()
            x = x.to_device(device)
            target<a id="change"> = </a><a id="change">target.to_device(</a>device<a id="change">)</a>

            output = self.model(x)
            self.mx_metric.update(target, output)
            loss_func = self.mx_loss(output, target)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/fedml-ai/fedml/commit/72a21aaec343f0fa94efaa99c7c77ea0ec4b3c49#diff-5c7073f3f9b325ba2ec669fcbb6b0838d2cd96e2e73ee883f01872677e17cac1L51' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 45822747</div><div id='project'> Project Name: fedml-ai/fedml</div><div id='commit'> Commit Name: 72a21aaec343f0fa94efaa99c7c77ea0ec4b3c49</div><div id='time'> Time: 2022-08-23</div><div id='author'> Author: alexliang.kh@gmail.com</div><div id='file'> File Name: python/examples/cross_silo/mxnet_mqtt_s3_fedavg_mnist_lr_example/mxnet_model_aggregator.py</div><div id='m_class'> M Class Name: MxServerAggregator</div><div id='n_method'> N Class Name: MxServerAggregator</div><div id='m_method'> M Method Name: _test(4)</div><div id='n_method'> N Method Name: _test(4)</div><div id='m_parent_class'> M Parent Class: ServerAggregator</div><div id='n_parent_class'> N Parent Class: ServerAggregator</div><div id='m_file'> M File Name: python/examples/cross_silo/mxnet_mqtt_s3_fedavg_mnist_lr_example/mxnet_model_aggregator.py</div><div id='n_file'> N File Name: python/examples/cross_silo/mxnet_mqtt_s3_fedavg_mnist_lr_example/mxnet_model_aggregator.py</div><div id='m_start'> M Start Line: 51</div><div id='m_end'> M End Line: 59</div><div id='n_start'> N Start Line: 65</div><div id='n_end'> N End Line: 73</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            self.mx_metric.reset()
            for batch_idx, (x, labels) in enumerate(train_data):
                &#47&#47 Do SGD on a batch of training samples.
                <a id="change">with device</a><a id="change">:
                    </a>x = x.numpy()
                    labels<a id="change"> = </a><a id="change">labels.numpy()</a>

                with autograd.record():
                    output = self.model(x)
                    loss_func = self.mx_loss(output, labels)</code></pre><h3>After Change</h3><pre><code class='java'>
            for batch_idx, (x, labels) in enumerate(train_data):
                &#47&#47 Do SGD on a batch of training samples.
                x = x.to_device(device)
                labels<a id="change"> = </a><a id="change">labels.to_device(</a>device<a id="change">)</a>

                with autograd.record():
                    output = self.model(x)
                    loss_func = self.mx_loss(output, labels)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/fedml-ai/fedml/commit/460e1c98dbb68f8ad0a90ef40c03240e34d7600c#diff-872799116e4fdeb43cc30203ff944b83ae7ac05e129279ddec99c640fbc85ab9L36' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 45822746</div><div id='project'> Project Name: fedml-ai/fedml</div><div id='commit'> Commit Name: 460e1c98dbb68f8ad0a90ef40c03240e34d7600c</div><div id='time'> Time: 2022-08-23</div><div id='author'> Author: alex.gpt.llm@gmail.com</div><div id='file'> File Name: python/examples/cross_silo/mxnet_mqtt_s3_fedavg_mnist_lr_example/mxnet_model_trainer_classification.py</div><div id='m_class'> M Class Name: MxModelTrainerCLS</div><div id='n_method'> N Class Name: MxModelTrainerCLS</div><div id='m_method'> M Method Name: train(4)</div><div id='n_method'> N Method Name: train(4)</div><div id='m_parent_class'> M Parent Class: ClientTrainer</div><div id='n_parent_class'> N Parent Class: ClientTrainer</div><div id='m_file'> M File Name: python/examples/cross_silo/mxnet_mqtt_s3_fedavg_mnist_lr_example/mxnet_model_trainer_classification.py</div><div id='n_file'> N File Name: python/examples/cross_silo/mxnet_mqtt_s3_fedavg_mnist_lr_example/mxnet_model_trainer_classification.py</div><div id='m_start'> M Start Line: 47</div><div id='m_end'> M End Line: 60</div><div id='n_start'> N Start Line: 91</div><div id='n_end'> N End Line: 103</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            self.mx_metric.reset()
            for batch_idx, (x, labels) in enumerate(train_data):
                &#47&#47 Do SGD on a batch of training samples.
                <a id="change">with device</a><a id="change">:
                    </a>x = x.numpy()
                    labels<a id="change"> = </a><a id="change">labels.numpy()</a>

                with autograd.record():
                    output = self.model(x)
                    loss_func = self.mx_loss(output, labels)</code></pre><h3>After Change</h3><pre><code class='java'>
            for batch_idx, (x, labels) in enumerate(train_data):
                &#47&#47 Do SGD on a batch of training samples.
                x = x.to_device(device)
                labels<a id="change"> = </a><a id="change">labels.to_device(</a>device<a id="change">)</a>

                with autograd.record():
                    output = self.model(x)
                    loss_func = self.mx_loss(output, labels)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/fedml-ai/fedml/commit/72a21aaec343f0fa94efaa99c7c77ea0ec4b3c49#diff-872799116e4fdeb43cc30203ff944b83ae7ac05e129279ddec99c640fbc85ab9L36' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 45822745</div><div id='project'> Project Name: fedml-ai/fedml</div><div id='commit'> Commit Name: 72a21aaec343f0fa94efaa99c7c77ea0ec4b3c49</div><div id='time'> Time: 2022-08-23</div><div id='author'> Author: alexliang.kh@gmail.com</div><div id='file'> File Name: python/examples/cross_silo/mxnet_mqtt_s3_fedavg_mnist_lr_example/mxnet_model_trainer_classification.py</div><div id='m_class'> M Class Name: MxModelTrainerCLS</div><div id='n_method'> N Class Name: MxModelTrainerCLS</div><div id='m_method'> M Method Name: train(4)</div><div id='n_method'> N Method Name: train(4)</div><div id='m_parent_class'> M Parent Class: ClientTrainer</div><div id='n_parent_class'> N Parent Class: ClientTrainer</div><div id='m_file'> M File Name: python/examples/cross_silo/mxnet_mqtt_s3_fedavg_mnist_lr_example/mxnet_model_trainer_classification.py</div><div id='n_file'> N File Name: python/examples/cross_silo/mxnet_mqtt_s3_fedavg_mnist_lr_example/mxnet_model_trainer_classification.py</div><div id='m_start'> M Start Line: 47</div><div id='m_end'> M End Line: 60</div><div id='n_start'> N Start Line: 91</div><div id='n_end'> N End Line: 103</div><BR>