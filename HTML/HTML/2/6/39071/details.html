<html><h3>Pattern ID :39071
</h3><img src='111257890.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    exclude: List[str] = []
    current_dir = os.path.dirname(os.path.abspath(__file__))
    files = sorted(map(lambda x: x.relative_to(current_dir), Path.cwd().rglob(&quot*.py&quot)))
    files = list(<a id="change">filter(</a>lambda x: not any([str(Path(ele)) in str(x) for ele in exclude]), files<a id="change">)</a>)

    return_codes<a id="change"> = </a>Parallel(n_jobs=os.cpu_count())(delayed(run_mypy)(file) for file in files)
    if all(v == 0 for v in return_codes):
        return 0
    else:</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 otherwise report.
        submodule_name = "innereye-deeplearning"
        files = set(current_dir.glob(&quot*.py&quot))
        <a id="change">for </a>path in current_dir.glob(&quot*&quot)<a id="change">:
            if path.name != submodule_name</a>:
                files.update(path.rglob(&quot*.py&quot))
        file_list = list(files)
    return run_mypy(sorted(str(file) for file in file_list))</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/microsoft/innereye-deeplearning/commit/1136e23352ac8b4e93705b96bdac9f08120f8399#diff-344abec58e93ca8213cf166ae9214a8c5e073b5fd2e8e6811a95832c1011e646L19' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111257890</div><div id='project'> Project Name: microsoft/innereye-deeplearning</div><div id='commit'> Commit Name: 1136e23352ac8b4e93705b96bdac9f08120f8399</div><div id='time'> Time: 2020-08-14</div><div id='author'> Author: dacart@microsoft.com</div><div id='file'> File Name: mypy_runner.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: mypy_runner.py</div><div id='n_file'> N File Name: mypy_runner.py</div><div id='m_start'> M Start Line: 19</div><div id='m_end'> M End Line: 31</div><div id='n_start'> N Start Line: 52</div><div id='n_end'> N End Line: 65</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        try:
            entities = pydash.flatten([x.get_entities() for x in docs])
            &#47&#47 filter entities that have no mapping in cache manager
            entities<a id="change"> = </a><a id="change">filter(
                </a>lambda x: x.entity_class in self.index_group.entity_class_to_indices.keys(),
                entities<a id="change">,
            )</a>
            self.process_entities(entities)
        except Exception:
            affected_doc_ids = [doc.idx for doc in docs]
            for doc in docs:</code></pre><h3>After Change</h3><pre><code class='java'>
        failed_docs = []
        try:
            entities_to_process = []
            <a id="change">for ent</a> in pydash.flatten([x.get_entities() for x in docs])<a id="change">:
                </a>if ent.entity_class not in self.index_group.entity_class_to_indices.keys():
                    continue
                <a id="change">if </a>self.ignore_high_conf and any(
                    <a id="change">hit.confidence == LinkRanks.HIGH_CONFIDENCE</a> for hit in ent.hits
                ):
                    continue
                entities_to_process.append(ent)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/astrazeneca/kazu/commit/2bd98607ab27ff8d921feeba61bb8cc64ff2ff2e#diff-5d0b0ded5b343b5692f05ff69dc8f3b4f8d860427b9eb29f6b3cbe52194fa86cL88' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111257893</div><div id='project'> Project Name: astrazeneca/kazu</div><div id='commit'> Commit Name: 2bd98607ab27ff8d921feeba61bb8cc64ff2ff2e</div><div id='time'> Time: 2022-11-30</div><div id='author'> Author: richard.jackson4@astrazeneca.com</div><div id='file'> File Name: kazu/steps/linking/sapbert.py</div><div id='m_class'> M Class Name: SapBertForEntityLinkingStep</div><div id='n_method'> N Class Name: SapBertForEntityLinkingStep</div><div id='m_method'> M Method Name: _run(2)</div><div id='n_method'> N Method Name: _run(2)</div><div id='m_parent_class'> M Parent Class: BaseStep</div><div id='n_parent_class'> N Parent Class: BaseStep</div><div id='m_file'> M File Name: kazu/steps/linking/sapbert.py</div><div id='n_file'> N File Name: kazu/steps/linking/sapbert.py</div><div id='m_start'> M Start Line: 102</div><div id='m_end'> M End Line: 107</div><div id='n_start'> N Start Line: 106</div><div id='n_end'> N End Line: 116</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    exclude: List[str] = []
    current_dir = os.path.dirname(os.path.abspath(__file__))
    files = sorted(map(lambda x: x.relative_to(current_dir), Path.cwd().rglob(&quot*.py&quot)))
    files<a id="change"> = </a>list(<a id="change">filter(</a>lambda x: not any([str(Path(ele)) in str(x) for ele in exclude]), files<a id="change">)</a>)

    return_codes = Parallel(n_jobs=os.cpu_count())(delayed(run_mypy)(file) for file in files)
    if all(v == 0 for v in return_codes):</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 otherwise report.
        submodule_name = "innereye-deeplearning"
        files = set(current_dir.glob(&quot*.py&quot))
        <a id="change">for path</a> in current_dir.glob(&quot*&quot)<a id="change">:
            if path.name != submodule_name</a>:
                files.update(path.rglob(&quot*.py&quot))
        file_list = list(files)
    return run_mypy(sorted(str(file) for file in file_list))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/innereye-deeplearning/commit/1136e23352ac8b4e93705b96bdac9f08120f8399#diff-344abec58e93ca8213cf166ae9214a8c5e073b5fd2e8e6811a95832c1011e646L18' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111257892</div><div id='project'> Project Name: microsoft/innereye-deeplearning</div><div id='commit'> Commit Name: 1136e23352ac8b4e93705b96bdac9f08120f8399</div><div id='time'> Time: 2020-08-14</div><div id='author'> Author: dacart@microsoft.com</div><div id='file'> File Name: mypy_runner.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: mypy_runner.py</div><div id='n_file'> N File Name: mypy_runner.py</div><div id='m_start'> M Start Line: 19</div><div id='m_end'> M End Line: 31</div><div id='n_start'> N Start Line: 52</div><div id='n_end'> N End Line: 65</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

            long_to_short_candidates.extend(filter_matches(section, matches_no_brackets, spacy_doc))
            section_to_spacy_doc[section] = spacy_doc
            section_to_ents_by_char_index[section]<a id="change"> = </a>{
                k: set(v)
                for k, v in sort_then_group(
                    <a id="change">filter(</a>lambda x: len(x.spans) == 1, section.entities<a id="change">)</a>,
                    key_func=lambda x: (
                        x.start,
                        x.end,</code></pre><h3>After Change</h3><pre><code class='java'>

            long_to_short_candidates.extend(filter_matches(section, matches_no_brackets, spacy_doc))
            section_to_spacy_doc[section] = spacy_doc
            <a id="change">for ent</a> in section.entities<a id="change">:
                if len(ent.spans) == 1</a>:
                    section_to_ents_by_char_index[section][(ent.start, ent.end)].add(ent)

        return long_to_short_candidates, section_to_ents_by_char_index, section_to_spacy_doc</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/astrazeneca/kazu/commit/a8708b46d96e0a5f6010356e62e67981b3de0d06#diff-94e6d7dd9cd21cb360499fb8f7a0aff1e05b347371147ce1f0f5c2e91f670800L345' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111257894</div><div id='project'> Project Name: astrazeneca/kazu</div><div id='commit'> Commit Name: a8708b46d96e0a5f6010356e62e67981b3de0d06</div><div id='time'> Time: 2022-11-30</div><div id='author'> Author: richard.jackson4@astrazeneca.com</div><div id='file'> File Name: kazu/utils/abbreviation_detector.py</div><div id='m_class'> M Class Name: KazuAbbreviationDetector</div><div id='n_method'> N Class Name: KazuAbbreviationDetector</div><div id='m_method'> M Method Name: _find_candidates_and_index_sections(2)</div><div id='n_method'> N Method Name: _find_candidates_and_index_sections(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: kazu/utils/abbreviation_detector.py</div><div id='n_file'> N File Name: kazu/utils/abbreviation_detector.py</div><div id='m_start'> M Start Line: 352</div><div id='m_end'> M End Line: 369</div><div id='n_start'> N Start Line: 352</div><div id='n_end'> N End Line: 366</div><BR>