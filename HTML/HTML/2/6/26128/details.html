<html><h3>Pattern ID :26128
</h3><img src='78721136.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                                  M[0:2, :], (input_res * 2, input_res * 2),
                                  flags=cv2.INTER_CUBIC)

    <a id="change">if </a>det is not None:

        &#47&#47 detection for bbox
        bbox<a id="change"> = </a>get_bbox(img_for_crop, det)

        width = bbox[2] - bbox[0]
        height = bbox[3] - bbox[1]
        center = np.array([(bbox[0] + bbox[2]) / 2.0,
                           (bbox[1] + bbox[3]) / 2.0])

    else:
        &#47&#47 Assume that the person is centerered in the image
        height = img_for_crop.shape[0]
        width<a id="change"> = </a>img_for_crop.shape[1]
        center<a id="change"> = </a>np.array([width // 2, height // 2])

    scale = max(height, width) / 180
</code></pre><h3>After Change</h3><pre><code class='java'>
    detector = detection.maskrcnn_resnet50_fpn(pretrained=True)
    detector.eval()
    predictions = detector(
        [<a id="change">torch.from_numpy(</a>img_for_crop<a id="change">)</a>.permute(2, 0, 1) / 255.])[0]
    human_ids = torch.logical_and(
        predictions["labels"] == 1,
        predictions["scores"] == predictions["scores"].max()).nonzero().squeeze(1)
    bbox<a id="change"> = </a>predictions["boxes"][human_ids, :].flatten().detach().cpu().numpy()
    
    width = bbox[2] - bbox[0]
    height = bbox[3] - bbox[1]</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/yuliangxiu/icon/commit/2117636e701293c457554812067b272fcf3f8252#diff-47fac0c4f0072fc394bfbbb063b11a379cc14499565395b91fcf17a47b9746a0L91' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 78721136</div><div id='project'> Project Name: yuliangxiu/icon</div><div id='commit'> Commit Name: 2117636e701293c457554812067b272fcf3f8252</div><div id='time'> Time: 2022-10-10</div><div id='author'> Author: yuliang.xiu@tuebingen.mpg.de</div><div id='file'> File Name: lib/pymaf/utils/imutils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: process_image(5)</div><div id='n_method'> N Method Name: process_image(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: lib/pymaf/utils/imutils.py</div><div id='n_file'> N File Name: lib/pymaf/utils/imutils.py</div><div id='m_start'> M Start Line: 91</div><div id='m_end'> M End Line: 132</div><div id='n_start'> N Start Line: 111</div><div id='n_end'> N End Line: 128</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        img = np.array(Image.open(os.path.join(config.ROOT_DIR, self.fname, img_name)).convert("RGB"))

        <a id="change">if </a>self.rect_training:
            bboxes<a id="change"> = </a>[ann[1:] for ann in annotations if (ann[2] &gt; 0 and ann[3] &gt; 0)]
            bboxes<a id="change"> = </a>torch.tensor(bboxes)
            classes<a id="change"> = </a>torch.tensor([ann[0] for ann in annotations])
            labels = torch.cat([classes.unsqueeze(1), bboxes], dim=-1)
            sh, sw = img.shape[0:2]
            img, ratio, pad = letterbox(img, (tg_height, tg_width), auto=False, scaleup=False)</code></pre><h3>After Change</h3><pre><code class='java'>
            &#47&#47 bboxes = torch.tensor(bboxes).roll(dims=1, shifts=1)
            &#47&#47 yolo_xywh = coco_to_yolo_tensors(bboxes[..., 1:5], w0=tg_width, h0=tg_height)
            &#47&#47 bboxes[..., 1:] = yolo_xywh
            labels<a id="change"> = </a><a id="change">torch.from_numpy(</a>labels<a id="change">)</a>
            out_bboxes = torch.zeros((labels.shape[0], 6))
            out_bboxes[..., 1:] = labels
        else:
            out_bboxes = torch.zeros((1, 6))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/alessandromondin/yolov5m/commit/6b474e8468a32129b9cc3499a6c96ef9cad8fbc3#diff-3c75bbc5e19f6e327e6c16638ad2413dc0d3200a9db147adecb096c4f05994faL84' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 78721104</div><div id='project'> Project Name: alessandromondin/yolov5m</div><div id='commit'> Commit Name: 6b474e8468a32129b9cc3499a6c96ef9cad8fbc3</div><div id='time'> Time: 2022-11-25</div><div id='author'> Author: alessandromondin00@gmail.com</div><div id='file'> File Name: dataset_ultra.py</div><div id='m_class'> M Class Name: MS_COCO_2017</div><div id='n_method'> N Class Name: MS_COCO_2017</div><div id='m_method'> M Method Name: __getitem__(2)</div><div id='n_method'> N Method Name: __getitem__(2)</div><div id='m_parent_class'> M Parent Class: Dataset</div><div id='n_parent_class'> N Parent Class: Dataset</div><div id='m_file'> M File Name: dataset_ultra.py</div><div id='n_file'> N File Name: dataset_ultra.py</div><div id='m_start'> M Start Line: 94</div><div id='m_end'> M End Line: 118</div><div id='n_start'> N Start Line: 99</div><div id='n_end'> N End Line: 128</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    print(&quotNode\&quots feature shape:{}&quot.format(node_feat.shape))
    
    
    <a id="change">if </a>norm_feature:
        node_feat<a id="change"> = </a>th.nn.functional.normalize(node_feat, p=2.0, dim=-1)
        
        degs<a id="change"> = </a>graph.out_degrees().float().clamp(min=1)
        norm<a id="change"> = </a>th.pow(degs, -0.5)
        shp = norm.shape + (1,) * (node_feat.dim() - 1)
        norm = th.reshape(norm, shp)
        node_feat = node_feat * norm</code></pre><h3>After Change</h3><pre><code class='java'>
    print(&quot                   Test label number: {}&quot.format(test_label_idx.shape[0]))

    node_feat = th.from_numpy(np.load(os.path.join(base_path, &quotfeatures.npy&quot))).float()
    walk_feat = <a id="change">th.from_numpy(</a>np.load(os.path.join(base_path, &quotdeepwalk.npy&quot))<a id="change">)</a>.float()
    
    features<a id="change"> = </a>th.cat((node_feat, walk_feat, edge_feat), dim=1)
    
    print(&quot&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47 Feature info: &#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&quot)
    print(&quotNode\&quots feature shape:{}&quot.format(node_feat.shape))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/langgege-cqu/maxp_dgl/commit/5f428bb0d6bfb9dad16f32ca3d65785469b69c00#diff-92c9897b4d19041ed9f91c038758158776764ac7247e3546223d85e551a3241cL8' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 78721106</div><div id='project'> Project Name: langgege-cqu/maxp_dgl</div><div id='commit'> Commit Name: 5f428bb0d6bfb9dad16f32ca3d65785469b69c00</div><div id='time'> Time: 2021-12-11</div><div id='author'> Author: 8747734+bugczw@user.noreply.gitee.com</div><div id='file'> File Name: maxp_model_czw/unimp/util.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: load_dgl_graph(1)</div><div id='n_method'> N Method Name: load_dgl_graph(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: maxp_model_czw/unimp/util.py</div><div id='n_file'> N File Name: maxp_model_czw/unimp/util.py</div><div id='m_start'> M Start Line: 8</div><div id='m_end'> M End Line: 52</div><div id='n_start'> N Start Line: 13</div><div id='n_end'> N End Line: 47</div><BR>