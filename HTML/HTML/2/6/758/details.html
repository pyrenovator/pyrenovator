<html><h3>Pattern ID :758
</h3><img src='3626742.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                    "labels": ins["labels"][0],
                }
                ds.append(Instance(**example))
        <a id="change">ds.set_input(</a>"input_ids", "attention_mask", "mask_pos"<a id="change">)</a>
        ds.set_target("labels")
        return ds

    def my_load(self, splits) -&gt; DataBundle:</code></pre><h3>After Change</h3><pre><code class='java'>
                    "input_ids": ins["input_ids"],
                    "attention_mask": ins["attention_mask"],
                    "decoder_input_ids": ins["decoder_input_ids"],
                    "decoder_attention_mask": <a id="change">ins["decoder_attention_mask"]</a>,
                    "labels": ins["decoder_input_ids"][2],
                }
                ds.append(Instance(**example))
            <a id="change">ds.set_input(</a>"input_ids", "attention_mask", "decoder_input_ids", <a id="change">"decoder_attention_mask"</a><a id="change">)</a>
        ds.set_target("labels")
        return ds

    def my_load(self, splits) -&gt; DataBundle:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/txsun1997/black-box-tuning/commit/99af535fec4babdc8583e69689cf20146d455c3d#diff-2ef5c88a6a8b05c490c8609bbd194e9dd2508d51497d67a3d8446039330aa1baL107' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 3626742</div><div id='project'> Project Name: txsun1997/black-box-tuning</div><div id='commit'> Commit Name: 99af535fec4babdc8583e69689cf20146d455c3d</div><div id='time'> Time: 2022-06-05</div><div id='author'> Author: txsun19@fudan.edu.cn</div><div id='file'> File Name: dataloader_t5.py</div><div id='m_class'> M Class Name: YelpPLoader</div><div id='n_method'> N Class Name: YelpPLoader</div><div id='m_method'> M Method Name: _load(2)</div><div id='n_method'> N Method Name: _load(2)</div><div id='m_parent_class'> M Parent Class: Loader</div><div id='n_parent_class'> N Parent Class: Loader</div><div id='m_file'> M File Name: dataloader_t5.py</div><div id='n_file'> N File Name: dataloader_t5.py</div><div id='m_start'> M Start Line: 116</div><div id='m_end'> M End Line: 116</div><div id='n_start'> N Start Line: 107</div><div id='n_end'> N End Line: 117</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                    "labels": ins["labels"][0],
                }
                ds.append(Instance(**example))
        <a id="change">ds.set_input(</a>"input_ids", "attention_mask", "mask_pos"<a id="change">)</a>
        ds.set_target("labels")
        return ds

    def my_load(self, splits) -&gt; DataBundle:</code></pre><h3>After Change</h3><pre><code class='java'>
        dataset = dataset.map(partial(convert_to_features, tokenizer=self.tokenizer), batched=True, load_from_cache_file=False)
        &#47&#47 Convert to fastNLP.DataSet
        ds = DataSet()
        for <a id="change">ins</a> in dataset:
            if len(ins["input_ids"]) &lt;= 512:
                example = {
                    "input_ids": ins["input_ids"],
                    "attention_mask": ins["attention_mask"],
                    "decoder_input_ids": ins["decoder_input_ids"],
                    "decoder_attention_mask": <a id="change">ins["decoder_attention_mask"]</a>,
                    "labels": ins["decoder_input_ids"][2],
                }
                ds.append(Instance(**example))
            <a id="change">ds.set_input(</a>"input_ids", "attention_mask", "decoder_input_ids", <a id="change">"decoder_attention_mask"</a><a id="change">)</a>
        ds.set_target("labels")
        return ds

    def my_load(self, splits) -&gt; DataBundle:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/txsun1997/black-box-tuning/commit/99af535fec4babdc8583e69689cf20146d455c3d#diff-2ef5c88a6a8b05c490c8609bbd194e9dd2508d51497d67a3d8446039330aa1baL319' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 3626741</div><div id='project'> Project Name: txsun1997/black-box-tuning</div><div id='commit'> Commit Name: 99af535fec4babdc8583e69689cf20146d455c3d</div><div id='time'> Time: 2022-06-05</div><div id='author'> Author: txsun19@fudan.edu.cn</div><div id='file'> File Name: dataloader_t5.py</div><div id='m_class'> M Class Name: RTELoader</div><div id='n_method'> N Class Name: RTELoader</div><div id='m_method'> M Method Name: _load(2)</div><div id='n_method'> N Method Name: _load(2)</div><div id='m_parent_class'> M Parent Class: Loader</div><div id='n_parent_class'> N Parent Class: Loader</div><div id='m_file'> M File Name: dataloader_t5.py</div><div id='n_file'> N File Name: dataloader_t5.py</div><div id='m_start'> M Start Line: 336</div><div id='m_end'> M End Line: 336</div><div id='n_start'> N Start Line: 335</div><div id='n_end'> N End Line: 345</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                    "labels": ins["labels"][0],
                }
                ds.append(Instance(**example))
        <a id="change">ds.set_input(</a>"input_ids", "attention_mask", "mask_pos"<a id="change">)</a>
        ds.set_target("labels")
        return ds

    def my_load(self, splits) -&gt; DataBundle:</code></pre><h3>After Change</h3><pre><code class='java'>
        dataset = dataset.map(partial(convert_to_features, tokenizer=self.tokenizer), batched=True, load_from_cache_file=False)
        &#47&#47 Convert to fastNLP.DataSet
        ds = DataSet()
        for <a id="change">ins</a> in dataset:
            if len(ins["input_ids"]) &lt;= 512:
                example = {
                    "input_ids": ins["input_ids"],
                    "attention_mask": ins["attention_mask"],
                    "decoder_input_ids": ins["decoder_input_ids"],
                    "decoder_attention_mask": <a id="change">ins["decoder_attention_mask"]</a>,
                    "labels": ins["decoder_input_ids"][2],
                }
                ds.append(Instance(**example))
            <a id="change">ds.set_input(</a>"input_ids", "attention_mask", "decoder_input_ids", <a id="change">"decoder_attention_mask"</a><a id="change">)</a>
        ds.set_target("labels")
        return ds

    def my_load(self, splits) -&gt; DataBundle:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/txsun1997/black-box-tuning/commit/99af535fec4babdc8583e69689cf20146d455c3d#diff-2ef5c88a6a8b05c490c8609bbd194e9dd2508d51497d67a3d8446039330aa1baL268' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 3626740</div><div id='project'> Project Name: txsun1997/black-box-tuning</div><div id='commit'> Commit Name: 99af535fec4babdc8583e69689cf20146d455c3d</div><div id='time'> Time: 2022-06-05</div><div id='author'> Author: txsun19@fudan.edu.cn</div><div id='file'> File Name: dataloader_t5.py</div><div id='m_class'> M Class Name: MRPCLoader</div><div id='n_method'> N Class Name: MRPCLoader</div><div id='m_method'> M Method Name: _load(2)</div><div id='n_method'> N Method Name: _load(2)</div><div id='m_parent_class'> M Parent Class: Loader</div><div id='n_parent_class'> N Parent Class: Loader</div><div id='m_file'> M File Name: dataloader_t5.py</div><div id='n_file'> N File Name: dataloader_t5.py</div><div id='m_start'> M Start Line: 285</div><div id='m_end'> M End Line: 285</div><div id='n_start'> N Start Line: 281</div><div id='n_end'> N End Line: 291</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                    "labels": ins["labels"][0],
                }
                ds.append(Instance(**example))
        <a id="change">ds.set_input(</a>"input_ids", "attention_mask", "mask_pos"<a id="change">)</a>
        ds.set_target("labels")
        return ds

    def my_load(self, splits) -&gt; DataBundle:</code></pre><h3>After Change</h3><pre><code class='java'>
        dataset = dataset.map(partial(convert_to_features, tokenizer=self.tokenizer), batched=True, load_from_cache_file=False)
        &#47&#47 Convert to fastNLP.DataSet
        ds = DataSet()
        for <a id="change">ins</a> in dataset:
            if len(ins["input_ids"]) &lt;= 512:
                example = {
                    "input_ids": ins["input_ids"],
                    "attention_mask": ins["attention_mask"],
                    "decoder_input_ids": ins["decoder_input_ids"],
                    "decoder_attention_mask": <a id="change">ins["decoder_attention_mask"]</a>,
                    "labels": ins["decoder_input_ids"][2],
                }
                ds.append(Instance(**example))
            <a id="change">ds.set_input(</a>"input_ids", "attention_mask", "decoder_input_ids", <a id="change">"decoder_attention_mask"</a><a id="change">)</a>
        ds.set_target("labels")
        return ds

    def my_load(self, splits) -&gt; DataBundle:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/txsun1997/black-box-tuning/commit/99af535fec4babdc8583e69689cf20146d455c3d#diff-2ef5c88a6a8b05c490c8609bbd194e9dd2508d51497d67a3d8446039330aa1baL372' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 3626739</div><div id='project'> Project Name: txsun1997/black-box-tuning</div><div id='commit'> Commit Name: 99af535fec4babdc8583e69689cf20146d455c3d</div><div id='time'> Time: 2022-06-05</div><div id='author'> Author: txsun19@fudan.edu.cn</div><div id='file'> File Name: dataloader_t5.py</div><div id='m_class'> M Class Name: SNLILoader</div><div id='n_method'> N Class Name: SNLILoader</div><div id='m_method'> M Method Name: _load(2)</div><div id='n_method'> N Method Name: _load(2)</div><div id='m_parent_class'> M Parent Class: Loader</div><div id='n_parent_class'> N Parent Class: Loader</div><div id='m_file'> M File Name: dataloader_t5.py</div><div id='n_file'> N File Name: dataloader_t5.py</div><div id='m_start'> M Start Line: 390</div><div id='m_end'> M End Line: 390</div><div id='n_start'> N Start Line: 391</div><div id='n_end'> N End Line: 401</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                    "labels": ins["labels"][0],
                }
                ds.append(Instance(**example))
        <a id="change">ds.set_input(</a>"input_ids", "attention_mask", "mask_pos"<a id="change">)</a>
        ds.set_target("labels")
        return ds

    def my_load(self, splits) -&gt; DataBundle:</code></pre><h3>After Change</h3><pre><code class='java'>
        dataset = dataset.map(partial(convert_to_features, tokenizer=self.tokenizer), batched=True, load_from_cache_file=False)
        &#47&#47 Convert to fastNLP.DataSet
        ds = DataSet()
        for <a id="change">ins</a> in dataset:
            if len(ins["input_ids"]) &lt;= 512:
                example = {
                    "input_ids": ins["input_ids"],
                    "attention_mask": ins["attention_mask"],
                    "decoder_input_ids": ins["decoder_input_ids"],
                    "decoder_attention_mask": <a id="change">ins["decoder_attention_mask"]</a>,
                    "labels": ins["decoder_input_ids"][2],
                }
                ds.append(Instance(**example))
            <a id="change">ds.set_input(</a>"input_ids", "attention_mask", "decoder_input_ids", <a id="change">"decoder_attention_mask"</a><a id="change">)</a>
        ds.set_target("labels")
        return ds

    def my_load(self, splits) -&gt; DataBundle:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/txsun1997/black-box-tuning/commit/99af535fec4babdc8583e69689cf20146d455c3d#diff-2ef5c88a6a8b05c490c8609bbd194e9dd2508d51497d67a3d8446039330aa1baL217' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 3626738</div><div id='project'> Project Name: txsun1997/black-box-tuning</div><div id='commit'> Commit Name: 99af535fec4babdc8583e69689cf20146d455c3d</div><div id='time'> Time: 2022-06-05</div><div id='author'> Author: txsun19@fudan.edu.cn</div><div id='file'> File Name: dataloader_t5.py</div><div id='m_class'> M Class Name: DBPediaLoader</div><div id='n_method'> N Class Name: DBPediaLoader</div><div id='m_method'> M Method Name: _load(2)</div><div id='n_method'> N Method Name: _load(2)</div><div id='m_parent_class'> M Parent Class: Loader</div><div id='n_parent_class'> N Parent Class: Loader</div><div id='m_file'> M File Name: dataloader_t5.py</div><div id='n_file'> N File Name: dataloader_t5.py</div><div id='m_start'> M Start Line: 234</div><div id='m_end'> M End Line: 234</div><div id='n_start'> N Start Line: 227</div><div id='n_end'> N End Line: 237</div><BR>