<html><h3>Pattern ID :36640
</h3><img src='104226839.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
class AugmentContextAndTarget(Augmenter):
    def __call__(self, contexts, targets):
        shape = contexts.shape
        contexts<a id="change"> = </a><a id="change">torch.reshape(</a>contexts, (shape[0]*shape[1]<a id="change">, shape[2], shape[3]</a>)<a id="change">)</a>
        targets = torch.reshape(targets, (shape[0]*shape[1], shape[2], shape[3]))
        import pdb; pdb.set_trace()
        contexts, targets = self.augment_op(contexts), self.augment_op(targets)
        import pdb; pdb.set_trace()
        contexts, targets = torch.reshape(contexts, shape), torch.reshape(targets, shape)
        import pdb; pdb.set_trace()
        <a id="change">return </a>contexts, targets

class AugmentContextOnly(Augmenter):
    def __call__(self, contexts, targets):</code></pre><h3>After Change</h3><pre><code class='java'>

class AugmentContextAndTarget(Augmenter):
    def __call__(self, contexts, targets):
        return [np.array(self.augment_op(el)) for el in contexts], <a id="change">[np.array(self.augment_op(el)) for el in targets]</a>


class AugmentContextOnly(Augmenter):
    def __call__(self, contexts, targets):</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/humancompatibleai/eirli/commit/8c09e76b5f02ad929e3742ba56e7a5caa78dd0ee#diff-ee5ab27d08ddab6427c8d60644dc08cbaa5813e26ef8e6a81c1cb6d1198f2d08L31' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 104226839</div><div id='project'> Project Name: humancompatibleai/eirli</div><div id='commit'> Commit Name: 8c09e76b5f02ad929e3742ba56e7a5caa78dd0ee</div><div id='time'> Time: 2020-07-31</div><div id='author'> Author: codywild@berkeley.edu</div><div id='file'> File Name: algos/augmenters.py</div><div id='m_class'> M Class Name: AugmentContextAndTarget</div><div id='n_method'> N Class Name: AugmentContextAndTarget</div><div id='m_method'> M Method Name: __call__(3)</div><div id='n_method'> N Method Name: __call__(3)</div><div id='m_parent_class'> M Parent Class: Augmenter</div><div id='n_parent_class'> N Parent Class: Augmenter</div><div id='m_file'> M File Name: algos/augmenters.py</div><div id='n_file'> N File Name: algos/augmenters.py</div><div id='m_start'> M Start Line: 32</div><div id='m_end'> M End Line: 40</div><div id='n_start'> N Start Line: 31</div><div id='n_end'> N End Line: 31</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    def __call__(self, contexts, targets):
        shape = contexts.shape
        contexts = torch.reshape(contexts, (shape[0]*shape[1], shape[2], shape[3]))
        targets<a id="change"> = </a><a id="change">torch.reshape(</a>targets, (shape[0]*shape[1]<a id="change">, shape[2], shape[3]</a>)<a id="change">)</a>
        import pdb; pdb.set_trace()
        contexts, targets = self.augment_op(contexts), self.augment_op(targets)
        import pdb; pdb.set_trace()
        contexts, targets = torch.reshape(contexts, shape), torch.reshape(targets, shape)
        import pdb; pdb.set_trace()
        <a id="change">return </a>contexts, targets

class AugmentContextOnly(Augmenter):
    def __call__(self, contexts, targets):</code></pre><h3>After Change</h3><pre><code class='java'>

class AugmentContextAndTarget(Augmenter):
    def __call__(self, contexts, targets):
        return <a id="change">[np.array(self.augment_op(el)) for el in contexts]</a>, [np.array(self.augment_op(el)) for el in targets]


class AugmentContextOnly(Augmenter):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/humancompatibleai/eirli/commit/61402dc3c10802be2b5a2be597955203e3ddd16f#diff-ee5ab27d08ddab6427c8d60644dc08cbaa5813e26ef8e6a81c1cb6d1198f2d08L31' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 104226837</div><div id='project'> Project Name: humancompatibleai/eirli</div><div id='commit'> Commit Name: 61402dc3c10802be2b5a2be597955203e3ddd16f</div><div id='time'> Time: 2020-07-31</div><div id='author'> Author: codywild@berkeley.edu</div><div id='file'> File Name: algos/augmenters.py</div><div id='m_class'> M Class Name: AugmentContextAndTarget</div><div id='n_method'> N Class Name: AugmentContextAndTarget</div><div id='m_method'> M Method Name: __call__(3)</div><div id='n_method'> N Method Name: __call__(3)</div><div id='m_parent_class'> M Parent Class: Augmenter</div><div id='n_parent_class'> N Parent Class: Augmenter</div><div id='m_file'> M File Name: algos/augmenters.py</div><div id='n_file'> N File Name: algos/augmenters.py</div><div id='m_start'> M Start Line: 32</div><div id='m_end'> M End Line: 40</div><div id='n_start'> N Start Line: 31</div><div id='n_end'> N End Line: 31</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            print(f&quotEmbedded {i_sentence} with {num_errors} errors&quot)

    all_embeddings = np.array(all_embeddings)
    all_ids = <a id="change">np.array(all_ids).reshape(</a>(-1<a id="change">, 1</a>)<a id="change">)</a>
    final_embeddings<a id="change"> = </a>np.concatenate((all_ids, all_embeddings), axis=1)

    <a id="change">return </a>final_embeddings
</code></pre><h3>After Change</h3><pre><code class='java'>
        1D array of sentence_ids that we managed to embed. Note that the order corresponds
        exactly to the rows in `final_embeddings`.
    
    indices_str = ", ".join(<a id="change">[str(x) for x in indices]</a>)

    query = f"SELECT sentence_id, text FROM sentences WHERE sentence_id IN ({indices_str})"
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/bluebrain/search/commit/cc7283c8f8440aeec4d04d6b259ab898c78a3cc1#diff-6a370a606e89902d9cea7c7edf876b91c643d1c115291d5912b04e3bd88cf446L266' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 104226827</div><div id='project'> Project Name: bluebrain/search</div><div id='commit'> Commit Name: cc7283c8f8440aeec4d04d6b259ab898c78a3cc1</div><div id='time'> Time: 2020-07-29</div><div id='author'> Author: jankrepl@yahoo.com</div><div id='file'> File Name: src/bbsearch/embedding_models.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: compute_database_embeddings(3)</div><div id='n_method'> N Method Name: compute_database_embeddings(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/bbsearch/embedding_models.py</div><div id='n_file'> N File Name: src/bbsearch/embedding_models.py</div><div id='m_start'> M Start Line: 283</div><div id='m_end'> M End Line: 317</div><div id='n_start'> N Start Line: 266</div><div id='n_end'> N End Line: 321</div><BR>