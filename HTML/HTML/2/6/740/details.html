<html><h3>Pattern ID :740
</h3><img src='3616116.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        scale = (encoding_max - encoding_min) / (2 ** bitwidth.data - 1)
        offset = torch.round(-encoding_min / scale)

        <a id="change">if </a><a id="change">len(scale) &gt; 1</a> and len(tensor.shape) &gt; 1:
            scale<a id="change"> = </a>broadcast_to_tensor(tensor, scale, channel_axis)

        if len(offset) &gt; 1 and len(tensor.shape) &gt; 1:
            offset = broadcast_to_tensor(tensor, offset, channel_axis)</code></pre><h3>After Change</h3><pre><code class='java'>

        dim = list(range(len(tensor.shape)))
        if len(delta) &gt; 1 and len(tensor.shape) &gt; 1:
            <a id="change">dim.pop(</a>channel_axis<a id="change">)</a>

        intermediate_term1 = scale_grad.sum(dim=dim) / steps
        intermediate_term2 = steps / (encoding_max - encoding_min) ** 2 * offset_grad.sum(dim=dim)
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/quic/aimet/commit/f98b3ba87548a733ad92ba19cc888d87a58197ed#diff-53af21caaa602b295954c0afcf0271342e22c2c3e5f1386f293cd465e08e53d2L731' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 3616116</div><div id='project'> Project Name: quic/aimet</div><div id='commit'> Commit Name: f98b3ba87548a733ad92ba19cc888d87a58197ed</div><div id='time'> Time: 2022-08-08</div><div id='author'> Author: quic_geunlee@quicinc.com</div><div id='file'> File Name: TrainingExtensions/torch/src/python/aimet_torch/tensor_quantizer.py</div><div id='m_class'> M Class Name: QuantizeDequantizeFunc</div><div id='n_method'> N Class Name: QuantizeDequantizeFunc</div><div id='m_method'> M Method Name: backward(2)</div><div id='n_method'> N Method Name: backward(2)</div><div id='m_parent_class'> M Parent Class: torch.autograd.Function</div><div id='n_parent_class'> N Parent Class: torch.autograd.Function</div><div id='m_file'> M File Name: TrainingExtensions/torch/src/python/aimet_torch/tensor_quantizer.py</div><div id='n_file'> N File Name: TrainingExtensions/torch/src/python/aimet_torch/tensor_quantizer.py</div><div id='m_start'> M Start Line: 731</div><div id='m_end'> M End Line: 750</div><div id='n_start'> N Start Line: 741</div><div id='n_end'> N End Line: 759</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            edge_type_idx = random.randint(0, len(remaining_edge_types)-1)
            new_edge_type = remaining_edge_types[edge_type_idx]
            new_edge_type_tuple = EdgeTypeStr2Tuple(new_edge_type)
            <a id="change">if </a><a id="change">len(set(new_edge_type_tuple) & explored_node_type_set) == 0</a>:
                continue
            chosen_edge_types_list.append(new_edge_type)
            explored_node_type_set<a id="change"> |= </a>set(new_edge_type_tuple)
            remaining_edge_types.pop(edge_type_idx)
            break
    return tuple(sorted(chosen_edge_types_list))</code></pre><h3>After Change</h3><pre><code class='java'>
        new_edge_type_idx = random.randint(0, len(candidate_edge_types_list)-1)
        new_edge_type = candidate_edge_types_list[new_edge_type_idx]
        chosen_edge_types_list.append(new_edge_type)
        <a id="change">candidate_edge_types_list.pop(</a>new_edge_type_idx<a id="change">)</a>
        explored_node_type_set |= set(EdgeTypeStr2Tuple(new_edge_type))

    return tuple(sorted(chosen_edge_types_list))
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/pku-dair/sgl/commit/93e7aac75c7a5fe5266c08615e4e5c0de463a86d#diff-a42813c7bb6f36db6c7dc4df3f1fb029e01d435597a169b5c1ae027c2d0ae0e3L27' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 3616098</div><div id='project'> Project Name: pku-dair/sgl</div><div id='commit'> Commit Name: 93e7aac75c7a5fe5266c08615e4e5c0de463a86d</div><div id='time'> Time: 2022-04-21</div><div id='author'> Author: 82886739+ZhenbangYou@users.noreply.github.com</div><div id='file'> File Name: dataset/choose_edge_type.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: ChooseEdgeType(3)</div><div id='n_method'> N Method Name: ChooseEdgeType(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: dataset/choose_edge_type.py</div><div id='n_file'> N File Name: dataset/choose_edge_type.py</div><div id='m_start'> M Start Line: 29</div><div id='m_end'> M End Line: 56</div><div id='n_start'> N Start Line: 31</div><div id='n_end'> N End Line: 62</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                raise ValueError(f&quot{metric_with_utils.log_name} must compute number value, &quot
                                 f&quotnot numpy array with shape {metric_value.shape}.&quot)
            &#47&#47 If it numpy array with one element but wrong dtype
            <a id="change">if </a>isinstance(metric_value, np.ndarray) and <a id="change">len(metric_value.shape) == 0</a> and\
                    np.issubdtype(metric_value.dtype, np.number):
                raise ValueError(f&quot{metric_with_utils.log_name} must compute number value, &quot
                                 f&quotnot numpy array element with dtype {metric_value.dtype}.&quot)

            is_number<a id="change"> = </a>isinstance(metric_value, numbers.Number)
            &#47&#47 If not numeric type.
            if not (is_number or isinstance(metric_value, Tensor) or isinstance(metric_value, np.ndarray)):
                raise ValueError(f&quot{metric_with_utils.log_name} must compute number value, &quot</code></pre><h3>After Change</h3><pre><code class='java'>
            if isinstance(metric_value, dict):
                metric_keys = list(metric_value.keys())
                for metric_name_d in metric_keys:
                    metric_value_d = <a id="change">metric_value.pop(</a>metric_name_d<a id="change">)</a>
                    if self.is_number(metric_value_d):
                        metric_value[f&quot{phase.value}/{metric_with_utils.log_name}_{metric_name_d}&quot] = metric_value_d
                &#47&#47 If there is no numeric value
                if len(metric_value) == 0:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/eora-ai/torchok/commit/c2fc24fbea4374c237f2164b01b38d617ba7b685#diff-1e414ece74f1d86149bd7914491e9ee38f9de42b30af9d90d2014826477d3087L110' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 3616111</div><div id='project'> Project Name: eora-ai/torchok</div><div id='commit'> Commit Name: c2fc24fbea4374c237f2164b01b38d617ba7b685</div><div id='time'> Time: 2022-09-01</div><div id='author'> Author: Sitcebelly</div><div id='file'> File Name: torchok/metrics/metrics_manager.py</div><div id='m_class'> M Class Name: MetricsManager</div><div id='n_method'> N Class Name: MetricsManager</div><div id='m_method'> M Method Name: on_epoch_end(2)</div><div id='n_method'> N Method Name: on_epoch_end(2)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: torchok/metrics/metrics_manager.py</div><div id='n_file'> N File Name: torchok/metrics/metrics_manager.py</div><div id='m_start'> M Start Line: 125</div><div id='m_end'> M End Line: 147</div><div id='n_start'> N Start Line: 132</div><div id='n_end'> N End Line: 151</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            if nms_style == &quotOR&quot:  &#47&#47 default
                while dc.shape[0]:
                    det_max.append(dc[:1])  &#47&#47 save highest conf detection
                    <a id="change">if </a><a id="change">len(dc) == 1</a>:  &#47&#47 Stop if we&quotre at the last detection
                        break
                    iou = bbox_iou(det_max[-1], dc[1:])  &#47&#47 iou with other boxes
                    dc<a id="change"> = </a>dc[1:][iou &lt; nms_thres]  &#47&#47 remove ious &gt; threshold

                &#47&#47 Image      Total          P          R        mAP
                &#47&#47  4964       5000      0.629      0.594      0.586</code></pre><h3>After Change</h3><pre><code class='java'>
                    di = dc[ind[0]:ind[0] + 1]
                    det_max.append(di)  &#47&#47 save highest conf detection
                    reject = bbox_iou(di, dc[ind]) &gt; nms_thres
                    [<a id="change">ind.pop(</a>i<a id="change">)</a> for i in reversed(reject.nonzero())]
                &#47&#47 while dc.shape[0]:  &#47&#47 SLOWER
                &#47&#47     det_max.append(dc[:1])  &#47&#47 save highest conf detection
                &#47&#47     if len(dc) == 1:  &#47&#47 Stop if we&quotre at the last detection</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/nightsnack/yolobile/commit/2df8d7e9f6fd3a3e0233029bf39d4db66807a229#diff-9653b8c2ce917a6134298b00c8b3f7d4b7c4dc473a752303f37a870392742127L304' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 3616104</div><div id='project'> Project Name: nightsnack/yolobile</div><div id='commit'> Commit Name: 2df8d7e9f6fd3a3e0233029bf39d4db66807a229</div><div id='time'> Time: 2019-03-15</div><div id='author'> Author: glenn.jocher@ultralytics.com</div><div id='file'> File Name: utils/utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: non_max_suppression(3)</div><div id='n_method'> N Method Name: non_max_suppression(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: utils/utils.py</div><div id='n_file'> N File Name: utils/utils.py</div><div id='m_start'> M Start Line: 388</div><div id='m_end'> M End Line: 398</div><div id='n_start'> N Start Line: 389</div><div id='n_end'> N End Line: 399</div><BR>