<html><h3>Pattern ID :12457
</h3><img src='42377733.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        n_bytes = fh_xml.write(xml_content)
    logger.info("Wrote %d bytes to %s", n_bytes, output_xml_path.resolve().as_uri())

    <a id="change">logger.info("PDF conversion done"</a><a id="change">)</a>

    return 0
</code></pre><h3>After Change</h3><pre><code class='java'>
        input_dir = input_path

    &#47&#47 Set default output_dir as the same directory of input files
    output_dir<a id="change"> = </a>output_dir or input_dir

    path_map<a id="change"> = </a>_prepare_output_paths(input_paths, output_dir, force)

    if len(path_map) == 0:
        <a id="change">logger.warning("No files to process, stopping"</a><a id="change">)</a>
        return 0

    output_dir.mkdir(exist_ok=True)
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/bluebrain/search/commit/7dae95ebd57973adba75efbce55342e295b223bd#diff-0c5672607dda9074162d3f7dd21fb7a0b9bdf0004d223f8e9e44d122c19882f8L131' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 42377733</div><div id='project'> Project Name: bluebrain/search</div><div id='commit'> Commit Name: 7dae95ebd57973adba75efbce55342e295b223bd</div><div id='time'> Time: 2021-12-17</div><div id='author'> Author: Stannislav@users.noreply.github.com</div><div id='file'> File Name: src/bluesearch/entrypoint/database/convert_pdf.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: run(0)</div><div id='n_method'> N Method Name: run(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/bluesearch/entrypoint/database/convert_pdf.py</div><div id='n_file'> N File Name: src/bluesearch/entrypoint/database/convert_pdf.py</div><div id='m_start'> M Start Line: 131</div><div id='m_end'> M End Line: 162</div><div id='n_start'> N Start Line: 158</div><div id='n_end'> N End Line: 221</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    results = []
    for index in indices:
        <a id="change">logger.info(
            f"solved_pred={solved_pred[index]:.1%}, "
            f"angle={np.rad2deg(angles[index]):.1f} [deg]"</a><a id="change">
        )</a>
        ee_to_obj = grasp_poses[index, :3], grasp_poses[index, 3:]
        ee_to_world = pp.multiply(obj_to_world, ee_to_obj)
        obj_af_to_world = reorient_poses[index, :3], reorient_poses[index, 3:]
</code></pre><h3>After Change</h3><pre><code class='java'>
    reorient_poses = reorient_poses[keep]
    angles = angles[keep]
    solved_pred = solved_pred[keep]
    length_pred<a id="change"> = </a>length_pred[keep]

    bins = np.linspace(angles.min(), angles.max(), num=9)
    binned = np.digitize(angles, bins)

    keep = binned &lt;= 1

    grasp_poses = grasp_poses[keep]
    reorient_poses = reorient_poses[keep]
    angles = angles[keep]
    solved_pred = solved_pred[keep]
    length_pred<a id="change"> = </a>length_pred[keep]

    indices = np.argsort(length_pred)

    t_start = time.time()

    results = []
    for index in indices:
        ee_to_obj = grasp_poses[index, :3], grasp_poses[index, 3:]
        ee_to_world = pp.multiply(obj_to_world, ee_to_obj)
        obj_af_to_world = reorient_poses[index, :3], reorient_poses[index, 3:]

        if visualize:
            obj_af = mercury.pybullet.duplicate(
                env.fg_object_id,
                collision=False,
                rgba_color=(0, 1, 0, 0.5),
                position=obj_af_to_world[0],
                quaternion=obj_af_to_world[1],
            )
        else:
            lock_renderer = pp.LockRenderer()

        result = plan_reorient(
            env,
            mercury.geometry.Coordinate(*ee_to_world),
            mercury.geometry.Coordinate(*obj_af_to_world),
        )

        if visualize:
            pp.remove_body(obj_af)
        else:
            lock_renderer.restore()

        if "js_place_length" in result:
            logger.success(
                f"angle={np.rad2deg(angles[index]):.1f} [deg], "
                f"solved_pred={solved_pred[index]:.1%}, "
                f"length_pred={length_pred[index]:.2g}, "
                f"length_true={result[&quotjs_place_length&quot]:.2g}"
            )
            results.append(result)
        else:
            <a id="change">logger.warning(
                f"angle={np.rad2deg(angles[index]):.1f} [deg], "
                f"solved_pred={solved_pred[index]:.1%}, "
                f"length_pred={length_pred[index]:.2g}, "
                f"length_true={np.nan}"</a><a id="change">
            )</a>

        if (time.time() - t_start) &gt; timeout:
            break
    if not results:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/wkentaro/reorientbot/commit/99e714efa337d5c39a48a90e0f70e3197bc593a2#diff-3755888d9f65827df523334c3436d07328a743cc66a21fe8ff8d7085b51b25fdL26' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 42377742</div><div id='project'> Project Name: wkentaro/reorientbot</div><div id='commit'> Commit Name: 99e714efa337d5c39a48a90e0f70e3197bc593a2</div><div id='time'> Time: 2021-07-02</div><div id='author'> Author: www.kentaro.wada@gmail.com</div><div id='file'> File Name: examples/reorient/learned.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: plan_and_execute_reorient(4)</div><div id='n_method'> N Method Name: plan_and_execute_reorient(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: examples/reorient/learned.py</div><div id='n_file'> N File Name: examples/reorient/learned.py</div><div id='m_start'> M Start Line: 72</div><div id='m_end'> M End Line: 98</div><div id='n_start'> N Start Line: 73</div><div id='n_end'> N End Line: 149</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            seq_length = torch.unique(actions, dim=1).shape[1]  &#47&#47 Compute windows_size
            demo_task_counter += Counter(task_info)
            logger.info(f"Tasks Objective: {num_samples}")
            <a id="change">logger.info(f"Tasks Annotations Progress: {demo_task_counter}"</a><a id="change">)</a>
            collected_data = label_seq(collected_data, dataloader, seq_length, idx, task_info, tasks_lang)
    return collected_data, demo_task_counter

</code></pre><h3>After Change</h3><pre><code class='java'>
            continue
        if "slide_" in task:
            env.reset(reset_info, i, seq_length // 2)
            inter_info<a id="change"> = </a>env.get_info()
            &#47&#47 check if task was achieved in sequence
            task_info<a id="change"> = </a>tasks.get_task_info(start_info, inter_info)
            if len(task_info) &gt; 0:
                inter_task = task_info.pop()
                if inter_task != task:
                    <a id="change">logger.warning(f"Conflict sub task {inter_task} of {task}"</a><a id="change">)</a>
                    continue

        if demo_task_counter[task] &lt; num_samples:
            seq_length = torch.unique(actions[i], dim=0).shape[0]</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/mees/calvin/commit/3dafb1d021299e9fccc0c298baff9f08717a79e6#diff-9aca857713ce13d8e8d86196abe99ff25d1fc227f2a77b98f280a24e1f70a1aaL27' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 42377739</div><div id='project'> Project Name: mees/calvin</div><div id='commit'> Commit Name: 3dafb1d021299e9fccc0c298baff9f08717a79e6</div><div id='time'> Time: 2021-08-26</div><div id='author'> Author: oier.mees@gmail.com</div><div id='file'> File Name: calvin/utils/automatic_lang_annotator.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: annotator(8)</div><div id='n_method'> N Method Name: annotator(8)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: calvin/utils/automatic_lang_annotator.py</div><div id='n_file'> N File Name: calvin/utils/automatic_lang_annotator.py</div><div id='m_start'> M Start Line: 29</div><div id='m_end'> M End Line: 46</div><div id='n_start'> N Start Line: 30</div><div id='n_end'> N End Line: 59</div><BR>