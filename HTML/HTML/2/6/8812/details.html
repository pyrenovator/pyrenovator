<html><h3>Pattern ID :8812
</h3><img src='32485679.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        x = self.conv1(x)
        x = self.bn1(x)
        x = self.relu(x)
        x<a id="change"> = </a>self.maxpool(x)

        x = self.layer1(x)
        x = self.layer2(x)
        x = self.layer3(x)
        x = self.layer4(x)

        x = self.avgpool(x)
        x = x.view(x.size(0), -1)
        x = self.fc(x)

        <a id="change">return </a>x


def ResNet18(pretrained=False, **kwargs):</code></pre><h3>After Change</h3><pre><code class='java'>
        out = self.layer3(out)
        out = self.layer4(out)
        out = F.avg_pool2d(out, 4)
        out<a id="change"> = </a>out.view(out.size(0), -1)
        out<a id="change"> = </a><a id="change">self.linear(</a>out<a id="change">)</a>
        <a id="change">return </a>out

    def _reset_prams(self):
        for m in self.modules():</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/hanxunh/active-passive-losses/commit/fdd52a214292b7ad777e5811cf8ac313152709cf#diff-fada037ad086638e65c7ae77e3d223963e9afaa26326aab0ea718f4013176e43L161' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 32485679</div><div id='project'> Project Name: hanxunh/active-passive-losses</div><div id='commit'> Commit Name: fdd52a214292b7ad777e5811cf8ac313152709cf</div><div id='time'> Time: 2020-02-09</div><div id='author'> Author: curtishuang@foxmail.com</div><div id='file'> File Name: model.py</div><div id='m_class'> M Class Name: ResNet</div><div id='n_method'> N Class Name: ResNet</div><div id='m_method'> M Method Name: forward(2)</div><div id='n_method'> N Method Name: forward(2)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: model.py</div><div id='n_file'> N File Name: model.py</div><div id='m_start'> M Start Line: 203</div><div id='m_end'> M End Line: 217</div><div id='n_start'> N Start Line: 161</div><div id='n_end'> N End Line: 169</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    def forward(self, a, b):
        output_a = self.model_a(**a)
        output_b = self.model_b(**b)
        outputs<a id="change"> = </a>[]
        for i in range(len(output_a)):
            outputs.append(output_a[i] + output_b[i])

        <a id="change">return </a>outputs
</code></pre><h3>After Change</h3><pre><code class='java'>
        b.pop(&quotlabels&quot)
        output_a = self.model_a(**a)[1]  &#47&#47 [bs, seq_len, 768]
        output_b = self.model_b(**b)[1]
        output<a id="change"> = </a>torch.cat([output_a, output_b, output_a-output_b], dim=1)
        logits = <a id="change">self.linear(</a>output<a id="change">)</a>
        loss<a id="change"> = </a>self.loss_fct(logits, labels)
        <a id="change">return </a>loss, logits


class SiameseTransformerAdd(nn.Module):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/prajjwal1/fluence/commit/384e5722f994d3a39d54cf057a0a48a996206bbf#diff-9b5227bea9875a2faa1f5803fb8bdaa8a1891793820bda7ba792e31c87a9e25fL21' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 32485644</div><div id='project'> Project Name: prajjwal1/fluence</div><div id='commit'> Commit Name: 384e5722f994d3a39d54cf057a0a48a996206bbf</div><div id='time'> Time: 2020-08-03</div><div id='author'> Author: prajjwalin@protonmail.com</div><div id='file'> File Name: fluence/models/siamese_model.py</div><div id='m_class'> M Class Name: SiameseTransformer</div><div id='n_method'> N Class Name: SiameseTransformer</div><div id='m_method'> M Method Name: forward(3)</div><div id='n_method'> N Method Name: forward(3)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: fluence/models/siamese_model.py</div><div id='n_file'> N File Name: fluence/models/siamese_model.py</div><div id='m_start'> M Start Line: 22</div><div id='m_end'> M End Line: 28</div><div id='n_start'> N Start Line: 24</div><div id='n_end'> N End Line: 32</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        self.u_graph_neighbor_messages = None

    def forward(self, node_features: Any, adjacency_matrix: Any, batch_size: int) -&gt; Any:
        <a id="change">return </a>self.encode(node_features, adjacency_matrix, batch_size)

    def encode(self, node_features: Any, adjacency_matrix: Any, batch_size: int) -&gt; Any:
        messages = self._send_messages(node_features, adjacency_matrix, batch_size)</code></pre><h3>After Change</h3><pre><code class='java'>
        self.sigmoid = to.nn.Sigmoid()

    def forward(self, node_features: Any, adjacency_matrix: Any, batch_size: int) -&gt; Any:
        outputs<a id="change"> = </a>to.zeros(batch_size, self.fully_connected_layer_output_size)
        for batch in range(batch_size):
            raw_outputs<a id="change"> = </a>self.encode(node_features[batch], adjacency_matrix[batch])
            outputs[batch]<a id="change"> = </a>self.sigmoid(<a id="change">self.linear(</a>DataPreprocessor.flatten(raw_outputs)<a id="change">)</a>)
        <a id="change">return </a>outputs

    def encode(self, node_features: Any, adjacency_matrix: Any) -&gt; Any:
        messages = self._send_messages(node_features, adjacency_matrix)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/kovanostra/message-passing-neural-network/commit/a2f3bf3246cea04886b7f8f676402f9de1a00871#diff-f75ee49d09dfbc2352dbcb88ab5214e4f079fdf5049d0cd539109fe6cc6ef335L30' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 32485738</div><div id='project'> Project Name: kovanostra/message-passing-neural-network</div><div id='commit'> Commit Name: a2f3bf3246cea04886b7f8f676402f9de1a00871</div><div id='time'> Time: 2020-04-26</div><div id='author'> Author: kovanostra@gmail.com</div><div id='file'> File Name: src/domain/graph_encoder.py</div><div id='m_class'> M Class Name: GraphEncoder</div><div id='n_method'> N Class Name: GraphEncoder</div><div id='m_method'> M Method Name: forward(4)</div><div id='n_method'> N Method Name: forward(4)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: src/domain/graph_encoder.py</div><div id='n_file'> N File Name: src/domain/graph_encoder.py</div><div id='m_start'> M Start Line: 31</div><div id='m_end'> M End Line: 31</div><div id='n_start'> N Start Line: 40</div><div id='n_end'> N End Line: 44</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47    x = layer(x)

        &#47&#47 Need to be normalized
        x<a id="change"> = </a>torch.sigmoid(self.test(x))
        &#47&#47 x = F.linear(F.normalize(x.squeeze(1)), F.normalize(self.weight))
        <a id="change">return </a>x
</code></pre><h3>After Change</h3><pre><code class='java'>
            Torch tensor.
        
        for layer in self.blocks:
            x<a id="change"> = </a>layer(x)

        &#47&#47 Need to be normalized
        x<a id="change"> = </a><a id="change">F.linear(</a>F.normalize(x.squeeze(1)), F.normalize(self.weight)<a id="change">)</a>
        <a id="change">return </a>x.unsqueeze(1)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/speechbrain/speechbrain/commit/43c5cdfb196744371a877e85a82f8b5b975ca93f#diff-a3b1adfbc8531aa48322a40ed3bd855006e8dc6c1051f97a8fef1151a7f83b05L555' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 32485828</div><div id='project'> Project Name: speechbrain/speechbrain</div><div id='commit'> Commit Name: 43c5cdfb196744371a877e85a82f8b5b975ca93f</div><div id='time'> Time: 2021-11-07</div><div id='author'> Author: parcollet.titouan@gmail.com</div><div id='file'> File Name: speechbrain/lobes/models/ECAPA_TDNN.py</div><div id='m_class'> M Class Name: Classifier</div><div id='n_method'> N Class Name: Classifier</div><div id='m_method'> M Method Name: forward(2)</div><div id='n_method'> N Method Name: forward(2)</div><div id='m_parent_class'> M Parent Class: torch.nn.Module</div><div id='n_parent_class'> N Parent Class: torch.nn.Module</div><div id='m_file'> M File Name: speechbrain/lobes/models/ECAPA_TDNN.py</div><div id='n_file'> N File Name: speechbrain/lobes/models/ECAPA_TDNN.py</div><div id='m_start'> M Start Line: 567</div><div id='m_end'> M End Line: 569</div><div id='n_start'> N Start Line: 561</div><div id='n_end'> N End Line: 566</div><BR>