<html><h3>Pattern ID :11284
</h3><img src='38401499.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                continue
            for gpu in cuda.gpus:
                cpu_only = False
                <a id="change">if </a><a id="change">gpu.id in measurement.gpus_used(
                ) and gpu.id not in seen_gpus</a>:
                    seen_gpus.add(gpu.id)
                    gpu_names.append((gpu.name).decode(&quotascii&quot))
                    with gpu:
                        mems<a id="change"> = </a>cuda.current_context().get_memory_info()
                        &#47&#47 convert bytes to GB
                        max_memories.append(round(mems.total / (2**30), 1))
</code></pre><h3>After Change</h3><pre><code class='java'>

        gpu_dict = {}
        for measurement in measurements:
            for gpu_uuid, gpu_info in <a id="change">self._gpu_info.items()</a>:
                if gpu_uuid in measurement.gpus_used():
                    gpu_name = (gpu_info[&quotname&quot]).decode(&quotascii&quot)
                    max_memory = round(gpu_info[&quottotal_memory&quot] / (2**30), 1)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/triton-inference-server/model_analyzer/commit/50f878682c545b5bbb3cb1abceda327d9872d800#diff-e1e671f5efb3fce4c537ae741fff3a1b5ae9cbc21ac5a6be4ed5a705742a97cbL506' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 38401499</div><div id='project'> Project Name: triton-inference-server/model_analyzer</div><div id='commit'> Commit Name: 50f878682c545b5bbb3cb1abceda327d9872d800</div><div id='time'> Time: 2021-06-10</div><div id='author'> Author: asramesh@nvidia.com</div><div id='file'> File Name: model_analyzer/reports/report_manager.py</div><div id='m_class'> M Class Name: ReportManager</div><div id='n_method'> N Class Name: ReportManager</div><div id='m_method'> M Method Name: _get_gpu_stats(2)</div><div id='n_method'> N Method Name: _get_gpu_stats(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: model_analyzer/reports/report_manager.py</div><div id='n_file'> N File Name: model_analyzer/reports/report_manager.py</div><div id='m_start'> M Start Line: 506</div><div id='m_end'> M End Line: 526</div><div id='n_start'> N Start Line: 588</div><div id='n_end'> N End Line: 596</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        new_sample = transform(**new_sample)
        &#47&#47 inverse mapping
        for source, <a id="change">target</a> in self.transform_targets.items():
            <a id="change">if </a><a id="change">target in new_sample and (source == &quotinput&quot or source == &quottarget&quot)</a>:
                sample[source] = new_sample[target]
            elif source in new_sample:
                sample[source]<a id="change"> = </a>new_sample[source]
        return sample

    def _read_image(self, image_path: str) -&gt; np.ndarray:</code></pre><h3>After Change</h3><pre><code class='java'>
        if transform is None:
            return sample

        valid_sample = {key: value for (key, value) in <a id="change">sample.items()</a> if key in self.__valid_transform_params}
        new_sample = transform(**valid_sample)
        return new_sample
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/eora-ai/torchok/commit/8eed040a824ef97af24c29a4106f0457205bc490#diff-e3dde24584ad502d0a08c11f07439f277b82e9744617d00b4d4da23b13f3852bL53' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 38401498</div><div id='project'> Project Name: eora-ai/torchok</div><div id='commit'> Commit Name: 8eed040a824ef97af24c29a4106f0457205bc490</div><div id='time'> Time: 2022-04-11</div><div id='author'> Author: patr982@gmail.com</div><div id='file'> File Name: src/data/datasets/base.py</div><div id='m_class'> M Class Name: ImageDataset</div><div id='n_method'> N Class Name: ImageDataset</div><div id='m_method'> M Method Name: _apply_transform(3)</div><div id='n_method'> N Method Name: _apply_transform(3)</div><div id='m_parent_class'> M Parent Class: ABC,Dataset</div><div id='n_parent_class'> N Parent Class: ABC,Dataset</div><div id='m_file'> M File Name: src/data/datasets/base.py</div><div id='n_file'> N File Name: src/data/datasets/base.py</div><div id='m_start'> M Start Line: 67</div><div id='m_end'> M End Line: 83</div><div id='n_start'> N Start Line: 59</div><div id='n_end'> N End Line: 61</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        seen_gpus = set()
        cpu_only = True

        for model_config, <a id="change">measurement</a> in self._summary_data[report_key]:
            if model_config.cpu_only():
                continue
            for gpu in cuda.gpus:
                cpu_only = False
                <a id="change">if </a><a id="change">gpu.id in measurement.gpus_used(
                ) and gpu.id not in seen_gpus</a>:
                    seen_gpus.add(gpu.id)
                    gpu_names.append((gpu.name).decode(&quotascii&quot))
                    with gpu:
                        mems<a id="change"> = </a>cuda.current_context().get_memory_info()
                        &#47&#47 convert bytes to GB
                        max_memories.append(round(mems.total / (2**30), 1))
</code></pre><h3>After Change</h3><pre><code class='java'>

        gpu_dict = {}
        for measurement in measurements:
            for gpu_uuid, gpu_info in <a id="change">self._gpu_info.items()</a>:
                if gpu_uuid in measurement.gpus_used():
                    gpu_name = (gpu_info[&quotname&quot]).decode(&quotascii&quot)
                    max_memory = round(gpu_info[&quottotal_memory&quot] / (2**30), 1)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/triton-inference-server/model_analyzer/commit/50f878682c545b5bbb3cb1abceda327d9872d800#diff-e1e671f5efb3fce4c537ae741fff3a1b5ae9cbc21ac5a6be4ed5a705742a97cbL501' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 38401500</div><div id='project'> Project Name: triton-inference-server/model_analyzer</div><div id='commit'> Commit Name: 50f878682c545b5bbb3cb1abceda327d9872d800</div><div id='time'> Time: 2021-06-10</div><div id='author'> Author: asramesh@nvidia.com</div><div id='file'> File Name: model_analyzer/reports/report_manager.py</div><div id='m_class'> M Class Name: ReportManager</div><div id='n_method'> N Class Name: ReportManager</div><div id='m_method'> M Method Name: _get_gpu_stats(2)</div><div id='n_method'> N Method Name: _get_gpu_stats(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: model_analyzer/reports/report_manager.py</div><div id='n_file'> N File Name: model_analyzer/reports/report_manager.py</div><div id='m_start'> M Start Line: 506</div><div id='m_end'> M End Line: 526</div><div id='n_start'> N Start Line: 588</div><div id='n_end'> N End Line: 596</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        
        self.attrs = attrs
        self.data = tensors
        for <a id="change">key</a> in self.data:
            if key in attrs:
                irreps = attrs[key][1]
                if (
                    isinstance(irreps, int)
                    or isinstance(irreps, str)
                    and irreps.isdigit()
                ):
                    dim = int(irreps)
                elif isinstance(irreps, str) or isinstance(irreps, e3nn.o3.Irreps):
                    dim = e3nn.o3.Irreps(irreps).dim
                else:
                    continue
                <a id="change">if </a><a id="change">not len(self.data[key].shape)==2 and self.data[key].shape[-1] == dim</a>:
                    self.data[key]<a id="change"> = </a>self.data[key].view(-1, dim)
        self.computeSums()

    def computeSums(self):</code></pre><h3>After Change</h3><pre><code class='java'>
        
        self.attrs = attrs
        self.data = tensors
        for key, value in <a id="change">tensors.items()</a>:
            self[key] = value

    def computeSums(self):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/20171130/equivariant-nn-zoo/commit/9cf4461ae3ea2f2449b4232865d396acf87caa0d#diff-04896a7859a44464e2e556423db7f372720a557bb3b344f19b3fe0319ca7ce89L34' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 38401486</div><div id='project'> Project Name: 20171130/equivariant-nn-zoo</div><div id='commit'> Commit Name: 9cf4461ae3ea2f2449b4232865d396acf87caa0d</div><div id='time'> Time: 2022-06-27</div><div id='author'> Author: hangruibi@outlook.com</div><div id='file'> File Name: e3_layers/data/data.py</div><div id='m_class'> M Class Name: Data</div><div id='n_method'> N Class Name: Data</div><div id='m_method'> M Method Name: __init__(2)</div><div id='n_method'> N Method Name: __init__(2)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: e3_layers/data/data.py</div><div id='n_file'> N File Name: e3_layers/data/data.py</div><div id='m_start'> M Start Line: 50</div><div id='m_end'> M End Line: 66</div><div id='n_start'> N Start Line: 51</div><div id='n_end'> N End Line: 52</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                 **kwargs):
        self.model = model

        for a, <a id="change">b</a> in permutations((&quotval&quot, &quottest&quot)):
            <a id="change">if </a><a id="change">a in data_loaders and b not in data_loaders</a>:
                data_loaders[b]<a id="change"> = </a>data_loaders[a]
        self.data_loaders = data_loaders

        if isinstance(stages, (list, tuple)):</code></pre><h3>After Change</h3><pre><code class='java'>

        self.data_loaders = {
            k: build_dataloader(v, seed=seed)
            for k, v in <a id="change">data_loader.items()</a>
        }

        if isinstance(stages, dict):
            self.stages = [stages]</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/yeliudev/nncore/commit/591ba982d2f81385c91f619f48fc1fa6068f0d9a#diff-f301e71f1b206fb014cc7b05cf40d35bbf2feac02ca56ff77c6fbc81583978acL137' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 38401493</div><div id='project'> Project Name: yeliudev/nncore</div><div id='commit'> Commit Name: 591ba982d2f81385c91f619f48fc1fa6068f0d9a</div><div id='time'> Time: 2021-11-05</div><div id='author'> Author: yeliudev@outlook.com</div><div id='file'> File Name: nncore/engine/engine.py</div><div id='m_class'> M Class Name: Engine</div><div id='n_method'> N Class Name: Engine</div><div id='m_method'> M Method Name: __init__(9)</div><div id='n_method'> N Method Name: __init__(8)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: nncore/engine/engine.py</div><div id='n_file'> N File Name: nncore/engine/engine.py</div><div id='m_start'> M Start Line: 146</div><div id='m_end'> M End Line: 161</div><div id='n_start'> N Start Line: 147</div><div id='n_end'> N End Line: 171</div><BR>