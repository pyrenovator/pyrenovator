<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

    def on_epoch_end(self, steps, epoch, logs=None):
        just_show()
        metrics = self.evaluate(<a id="change">valid_dataset.data[:valid_len]</a>)  &#47&#47 评测模型
        if metrics[&quotbleu&quot] &gt; self.best_bleu:
            self.best_bleu = metrics[&quotbleu&quot]
            &#47&#47 model.save_weights(&quot./best_model.pt&quot)  &#47&#47 保存模型</code></pre><h3>After Change</h3><pre><code class='java'>
    def on_epoch_end(self, steps, epoch, logs=None):
        just_show()
        metrics = self.evaluate(valid_dataset.data)  &#47&#47 评测模型
        metrics_test<a id="change"> = </a><a id="change">self.evaluate(</a>test_dataset.data<a id="change">)</a>  &#47&#47 评测模型
        if metrics[&quotbleu&quot] &gt; self.best_bleu:
            self.best_bleu = metrics[&quotbleu&quot]
            &#47&#47 model.save_weights(&quot./best_model.pt&quot)  &#47&#47 保存模型
        metrics[&quotbest_bleu&quot] = self.best_bleu
        print(&quotvalid_data:&quot, metrics)
        <a id="change">print(&quottest_data:&quot</a>, metrics_test<a id="change">)</a>
    
    def evaluate(self, data, topk=1):
        total = 0
        rouge_1, rouge_2, rouge_l, bleu = 0, 0, 0, 0</code></pre>