<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    

    w, h = hr.size
    <a id="change">left</a> = <a id="change">torch.randint(0, w - image_size + 1, size=(1,)).item()</a>
    <a id="change">top</a> = <a id="change">torch.randint(0, h - image_size + 1, size=(1,)).item()</a>
    <a id="change">right = left</a><a id="change"> + image_size</a>
    <a id="change">bottom</a> = <a id="change">top</a><a id="change"> + image_size</a>

    lr<a id="change"> = </a><a id="change">lr.crop(</a>(<a id="change">left</a><a id="change"> // upscale_factor</a><a id="change">,
                  top // upscale_factor,
                  right // upscale_factor,
                  bottom // upscale_factor</a>)<a id="change">)</a>
    hr<a id="change"> = </a><a id="change">hr.crop(</a>(<a id="change">left</a><a id="change">, top, right, bottom</a>)<a id="change">)</a>

    <a id="change">return </a>lr<a id="change">, hr</a>


def random_rotate(lr: Any, hr: Any, degrees: list) -&gt; [Any, Any]:
    Will ``PIL.Image`` randomly rotate the image.</code></pre><h3>After Change</h3><pre><code class='java'>
    image_height, image_width = image.shape[:2]

    &#47&#47 Just need to find the top and left coordinates of the image
    <a id="change">top</a> = <a id="change">random.randint(0</a>, image_height<a id="change"> - image_size</a><a id="change">)</a>
    <a id="change">left</a> = <a id="change">random.randint(0</a>, image_width<a id="change"> - image_size</a><a id="change">)</a>

    &#47&#47 Crop image patch
    <a id="change">patch_image</a> = <a id="change">image[top:top + image_size, left:left + image_size, ...]</a>

    <a id="change">return patch_image</a>


def random_rotate(image: np.ndarray, angles: list, center=None, scale_factor: float = 1.0) -&gt; np.ndarray:
    Rotate an image randomly by a specified angle.</code></pre>