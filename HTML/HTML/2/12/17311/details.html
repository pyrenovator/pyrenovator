<html><h3>Pattern ID :17311
</h3><img src='57509353.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        if self.use_jastrow:

            jast = self.jastrow(x)
            grad_jast = <a id="change">self.jastrow(</a>x<a id="change">, derivative=1, jacobian=False)</a>
            djast = grad_jast.transpose(1, 2)<a id="change"> / jast.unsqueeze(-1</a><a id="change">)</a>

            bgrad = bgrad + djast.unsqueeze(2)*mo.unsqueeze(-1)

        return bgrad</code></pre><h3>After Change</h3><pre><code class='java'>

        if self.use_jastrow:

            jast = <a id="change">self.jastrow(x).transpose(0</a>, <a id="change">1</a><a id="change">)</a>
            grad_jast = <a id="change">self.jastrow(</a>x<a id="change">,
                                     derivative=1,
                                     jacobian=False)</a>.transpose(1, 2)
            grad_jast = <a id="change">grad_jast.flatten(start_dim=1).transpose(0</a>, <a id="change">1</a><a id="change">)</a>

            grad_jast = grad_jast<a id="change"> / </a>jast
            grad_jast = grad_jast.unsqueeze(2).unsqueeze(3)
            bgrad = bgrad + grad_jast*mo.unsqueeze(0)
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 7</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/nlesc-jcer/qmctorch/commit/768d611456931e6ab5349bbe77fa45f2dcd415fd#diff-45e01a4679a00946fdb660a1d038f367c96bedd8aa2dce3bbeb916e2b806045dL341' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 57509353</div><div id='project'> Project Name: nlesc-jcer/qmctorch</div><div id='commit'> Commit Name: 768d611456931e6ab5349bbe77fa45f2dcd415fd</div><div id='time'> Time: 2020-08-18</div><div id='author'> Author: nicolas.gm.renaud@gmail.com</div><div id='file'> File Name: qmctorch/wavefunction/wf_orbital.py</div><div id='m_class'> M Class Name: Orbital</div><div id='n_method'> N Class Name: Orbital</div><div id='m_method'> M Method Name: get_grad_operator(5)</div><div id='n_method'> N Method Name: get_grad_operator(5)</div><div id='m_parent_class'> M Parent Class: WaveFunction</div><div id='n_parent_class'> N Parent Class: WaveFunction</div><div id='m_file'> M File Name: qmctorch/wavefunction/wf_orbital.py</div><div id='n_file'> N File Name: qmctorch/wavefunction/wf_orbital.py</div><div id='m_start'> M Start Line: 349</div><div id='m_end'> M End Line: 353</div><div id='n_start'> N Start Line: 341</div><div id='n_end'> N End Line: 358</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        if self.use_jastrow:

            jast = <a id="change">self.jastrow(x).transpose(0</a>, <a id="change">1</a><a id="change">)</a>
            grad_jast = <a id="change">self.jastrow(</a>x<a id="change">,
                                     derivative=1,
                                     jacobian=False)</a>.transpose(1, 2)
            grad_jast = grad_jast.flatten(start_dim=1).transpose(0, 1)

            grad_jast = grad_jast<a id="change"> / </a>jast
            grad_jast = grad_jast.unsqueeze(2).unsqueeze(3)
            bgrad = bgrad + grad_jast*mo.unsqueeze(0)
</code></pre><h3>After Change</h3><pre><code class='java'>
        if self.use_jastrow:

            jast = self.jastrow(x)
            grad_jast = <a id="change">self.jastrow(</a>x<a id="change">,
                                     derivative=1,
                                     jacobian=False)</a>
            grad_jast = <a id="change">grad_jast.transpose(1</a>, <a id="change">2</a><a id="change">)</a><a id="change"> / jast.unsqueeze(-1</a><a id="change">)</a>

            grad_jast = grad_jast.flatten(start_dim=1)
            grad_jast = grad_jast.transpose(0, 1)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/nlesc-jcer/qmctorch/commit/d6a31fddd6e4d758f9f714e52ba34ff6727030d4#diff-45e01a4679a00946fdb660a1d038f367c96bedd8aa2dce3bbeb916e2b806045dL332' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 57509354</div><div id='project'> Project Name: nlesc-jcer/qmctorch</div><div id='commit'> Commit Name: d6a31fddd6e4d758f9f714e52ba34ff6727030d4</div><div id='time'> Time: 2020-08-18</div><div id='author'> Author: nicolas.gm.renaud@gmail.com</div><div id='file'> File Name: qmctorch/wavefunction/wf_orbital.py</div><div id='m_class'> M Class Name: Orbital</div><div id='n_method'> N Class Name: Orbital</div><div id='m_method'> M Method Name: get_grad_operator(5)</div><div id='n_method'> N Method Name: get_grad_operator(5)</div><div id='m_parent_class'> M Parent Class: WaveFunction</div><div id='n_parent_class'> N Parent Class: WaveFunction</div><div id='m_file'> M File Name: qmctorch/wavefunction/wf_orbital.py</div><div id='n_file'> N File Name: qmctorch/wavefunction/wf_orbital.py</div><div id='m_start'> M Start Line: 350</div><div id='m_end'> M End Line: 358</div><div id='n_start'> N Start Line: 350</div><div id='n_end'> N End Line: 361</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if self.use_jastrow:

            J = self.jastrow(x)
            dJ = <a id="change">self.jastrow(</a>x<a id="change">, derivative=1)</a> / J
            d2J = self.jastrow(x, derivative=2) / J

            dJdMO = dJ.unsqueeze(-1)<a id="change"> * </a>self.mo(self.ao(x, derivative=1))
            d2JMO = d2J.unsqueeze(-1) * MO

        return self.fc(self.kinpool(MO, d2MO, dJdMO, d2JMO,</code></pre><h3>After Change</h3><pre><code class='java'>
        if self.use_jastrow:

            J = self.jastrow(x)
            dJ = <a id="change">self.jastrow(
                x, derivative=1, jacobian=False).transpose(1</a>, <a id="change">2</a><a id="change">)</a> / <a id="change">J.unsqueeze(-1</a><a id="change">)</a>
            d2J = self.jastrow(x, derivative=2) / J

            dAO = self.ao(x, derivative=1, jacobian=False).transpose(2, 3)
            dMO = <a id="change">self.mo(dAO).transpose(2</a>, <a id="change">3</a><a id="change">)</a>

            dJdMO = (dJ.unsqueeze(2)<a id="change"> * </a>dMO).sum(-1)
            d2JMO = d2J.unsqueeze(-1) * MO

        return self.fc(self.kinpool(MO, d2MO, dJdMO, d2JMO,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/nlesc-jcer/qmctorch/commit/7006f7140f0d5376e776668ff36f80b57cb3e46d#diff-2eff29cd88648e718b571a70cbef5a1f18b80fec5db38987029a376d727f3b6eL113' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 57509349</div><div id='project'> Project Name: nlesc-jcer/qmctorch</div><div id='commit'> Commit Name: 7006f7140f0d5376e776668ff36f80b57cb3e46d</div><div id='time'> Time: 2019-12-27</div><div id='author'> Author: nicolas.gm.renaud@gmail.com</div><div id='file'> File Name: deepqmc/wavefunction/wf_orbital.py</div><div id='m_class'> M Class Name: Orbital</div><div id='n_method'> N Class Name: Orbital</div><div id='m_method'> M Method Name: kinetic_energy_jacobi(3)</div><div id='n_method'> N Method Name: kinetic_energy_jacobi(3)</div><div id='m_parent_class'> M Parent Class: WaveFunction</div><div id='n_parent_class'> N Parent Class: WaveFunction</div><div id='m_file'> M File Name: deepqmc/wavefunction/wf_orbital.py</div><div id='n_file'> N File Name: deepqmc/wavefunction/wf_orbital.py</div><div id='m_start'> M Start Line: 129</div><div id='m_end'> M End Line: 133</div><div id='n_start'> N Start Line: 130</div><div id='n_end'> N End Line: 138</div><BR>