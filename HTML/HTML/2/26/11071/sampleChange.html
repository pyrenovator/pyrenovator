<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        
        dataset = self.train_data if dataflag==&quottrain&quot else self.valid_data
        model.eval()
        loss<a id="change"> = 0</a>
        eval_metric<a id="change"> = 0</a>
        data_loader<a id="change"> = </a><a id="change">self.calculator.get_data_loader(</a>dataset<a id="change">, batch_size=64)</a>
        <a id="change">for </a>batch_id, <a id="change">batch_data</a> in <a id="change">enumerate(</a>data_loader<a id="change">):
            bmean_eval_metric</a><a id="change">, bmean_loss = </a><a id="change">self.calculator.test(</a>model, <a id="change">batch_data</a><a id="change">)</a>
            loss<a id="change"> += bmean_loss</a><a id="change"> * len(batch_data</a><a id="change">[0])</a>
            eval_metric<a id="change"> += bmean_eval_metric</a><a id="change"> * </a>len(<a id="change">batch_data[0]</a>)
        eval_metric =1.0 * eval_metric / len(dataset)
        loss = 1.0 * loss / len(dataset)
        return eval_metric<a id="change">, loss</a>

    def unpack(self, received_pkg):
        
        Unpack the package received from the server</code></pre><h3>After Change</h3><pre><code class='java'>
            metric: specified by the task during running time (e.g. metric = [mean_accuracy, mean_loss] when the task is classification)
        
        dataset = self.train_data if dataflag==&quottrain&quot else self.valid_data
        <a id="change">return self.calculator.test(</a>model, dataset<a id="change">)</a>

    def unpack(self, received_pkg):
        
        Unpack the package received from the server</code></pre>