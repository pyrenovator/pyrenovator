<html><h3>Pattern ID :28617
</h3><img src='84516303.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

    elapsed = round(time.time() - start_time)
    elapsed = str(datetime.timedelta(seconds=elapsed))
    <a id="change">print("Finished. Total elapsed time (h:m:s): {}".format(</a>elapsed<a id="change">)</a><a id="change">)</a>

def train(epoch, model, criterion_xent, criterion_htri, optimizer, trainloader, use_gpu):
    model.train()
    losses = AverageMeter()</code></pre><h3>After Change</h3><pre><code class='java'>
        return

    start_time = time.time()
    train_time<a id="change"> = 0</a>
    best_rank1 = -np.inf
    best_epoch = 0
    print("==&gt; Start training")

    for epoch in range(start_epoch, args.max_epoch):
        start_train_time<a id="change"> = time</a><a id="change">.time()</a>
        train(epoch, model, criterion_xent, criterion_htri, optimizer, trainloader, use_gpu)
        train_time<a id="change"> += </a><a id="change">round(time.time()</a><a id="change"> - </a>start_train_time<a id="change">)</a>
        
        if args.stepsize &gt; 0: scheduler.step()
        
        if args.eval_step &gt; 0 and (epoch+1) % args.eval_step == 0 or (epoch+1) == args.max_epoch:
            print("==&gt; Test")
            rank1 = test(model, queryloader, galleryloader, use_gpu)
            is_best = rank1 &gt; best_rank1
            if is_best:
                best_rank1 = rank1
                best_epoch = epoch + 1

            if use_gpu:
                state_dict = model.module.state_dict()
            else:
                state_dict = model.state_dict()
            save_checkpoint({
                &quotstate_dict&quot: state_dict,
                &quotrank1&quot: rank1,
                &quotepoch&quot: epoch,
            }, is_best, osp.join(args.save_dir, &quotcheckpoint_ep&quot + str(epoch+1) + &quot.pth.tar&quot))

    print("==&gt; Best Rank-1 {:.1%}, achieved at epoch {}".format(best_rank1, best_epoch))

    elapsed = round(time.time() - start_time)
    elapsed = str(datetime.timedelta(seconds=elapsed))
    train_time<a id="change"> = </a><a id="change">str(datetime.timedelta(seconds=train_time)</a><a id="change">)</a>
    <a id="change">print("Finished. Total elapsed time (h:m:s): {}. Training time (h:m:s): {}.".format(</a>elapsed, train_time<a id="change">)</a><a id="change">)</a>

def train(epoch, model, criterion_xent, criterion_htri, optimizer, trainloader, use_gpu):
    model.train()
    losses = AverageMeter()</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 14</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/vlsomers/bpbreid/commit/ef8ede34f8d898b0acf740fab79e56e77e200069#diff-ad4d6ecf77a271cc94b647b2dde5c9957df2832560b2b1b68c1d482bda81eb63L167' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 84516303</div><div id='project'> Project Name: vlsomers/bpbreid</div><div id='commit'> Commit Name: ef8ede34f8d898b0acf740fab79e56e77e200069</div><div id='time'> Time: 2018-04-30</div><div id='author'> Author: k.zhou@qmul.ac.uk</div><div id='file'> File Name: train_img_model_xent_htri.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: train_img_model_xent_htri.py</div><div id='n_file'> N File Name: train_img_model_xent_htri.py</div><div id='m_start'> M Start Line: 197</div><div id='m_end'> M End Line: 198</div><div id='n_start'> N Start Line: 167</div><div id='n_end'> N End Line: 202</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    elapsed = round(time.time() - start_time)
    elapsed = str(datetime.timedelta(seconds=elapsed))
    <a id="change">print("Finished. Total elapsed time (h:m:s): {}".format(</a>elapsed<a id="change">)</a><a id="change">)</a>

def train(epoch, model, criterion_xent, criterion_htri, optimizer, trainloader, use_gpu):
    model.train()
    losses = AverageMeter()</code></pre><h3>After Change</h3><pre><code class='java'>
        return

    start_time = time.time()
    train_time<a id="change"> = 0</a>
    best_rank1 = -np.inf
    best_epoch = 0
    print("==&gt; Start training")

    for epoch in range(start_epoch, args.max_epoch):
        start_train_time<a id="change"> = </a><a id="change">time.time()</a>
        train(epoch, model, criterion_xent, criterion_htri, optimizer, trainloader, use_gpu)
        train_time<a id="change"> += </a><a id="change">round(time.time()</a><a id="change"> - </a>start_train_time<a id="change">)</a>
        
        if args.stepsize &gt; 0: scheduler.step()
        
        if args.eval_step &gt; 0 and (epoch+1) % args.eval_step == 0 or (epoch+1) == args.max_epoch:
            print("==&gt; Test")
            rank1 = test(model, queryloader, galleryloader, use_gpu)
            is_best = rank1 &gt; best_rank1
            if is_best:
                best_rank1 = rank1
                best_epoch = epoch + 1

            if use_gpu:
                state_dict = model.module.state_dict()
            else:
                state_dict = model.state_dict()
            save_checkpoint({
                &quotstate_dict&quot: state_dict,
                &quotrank1&quot: rank1,
                &quotepoch&quot: epoch,
            }, is_best, osp.join(args.save_dir, &quotcheckpoint_ep&quot + str(epoch+1) + &quot.pth.tar&quot))

    print("==&gt; Best Rank-1 {:.1%}, achieved at epoch {}".format(best_rank1, best_epoch))

    elapsed = round(time.time() - start_time)
    elapsed = str(datetime.timedelta(seconds=elapsed))
    train_time<a id="change"> = </a><a id="change">str(datetime.timedelta(seconds=train_time)</a><a id="change">)</a>
    <a id="change">print("Finished. Total elapsed time (h:m:s): {}. Training time (h:m:s): {}.".format(</a>elapsed, train_time<a id="change">)</a><a id="change">)</a>

def train(epoch, model, criterion_xent, criterion_htri, optimizer, trainloader, use_gpu):
    model.train()
    losses = AverageMeter()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/vlsomers/bpbreid/commit/ef8ede34f8d898b0acf740fab79e56e77e200069#diff-ad4d6ecf77a271cc94b647b2dde5c9957df2832560b2b1b68c1d482bda81eb63L81' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 84516305</div><div id='project'> Project Name: vlsomers/bpbreid</div><div id='commit'> Commit Name: ef8ede34f8d898b0acf740fab79e56e77e200069</div><div id='time'> Time: 2018-04-30</div><div id='author'> Author: k.zhou@qmul.ac.uk</div><div id='file'> File Name: train_img_model_xent_htri.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: train_img_model_xent_htri.py</div><div id='n_file'> N File Name: train_img_model_xent_htri.py</div><div id='m_start'> M Start Line: 197</div><div id='m_end'> M End Line: 198</div><div id='n_start'> N Start Line: 167</div><div id='n_end'> N End Line: 202</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    elapsed = round(time.time() - start_time)
    elapsed = str(datetime.timedelta(seconds=elapsed))
    <a id="change">print("Finished. Total elapsed time (h:m:s): {}".format(</a>elapsed<a id="change">)</a><a id="change">)</a>

def train(epoch, model, criterion, optimizer, trainloader, use_gpu):
    model.train()
    losses = AverageMeter()</code></pre><h3>After Change</h3><pre><code class='java'>
        return

    start_time = time.time()
    train_time<a id="change"> = 0</a>
    best_rank1 = -np.inf
    best_epoch = 0
    print("==&gt; Start training")

    for epoch in range(start_epoch, args.max_epoch):
        start_train_time<a id="change"> = </a><a id="change">time.time()</a>
        train(epoch, model, criterion, optimizer, trainloader, use_gpu)
        train_time<a id="change"> += </a><a id="change">round(time.time()</a><a id="change"> - </a>start_train_time<a id="change">)</a>
        
        if args.stepsize &gt; 0: scheduler.step()
        
        if args.eval_step &gt; 0 and (epoch+1) % args.eval_step == 0 or (epoch+1) == args.max_epoch:
            print("==&gt; Test")
            rank1 = test(model, queryloader, galleryloader, args.pool, use_gpu)
            is_best = rank1 &gt; best_rank1
            if is_best:
                best_rank1 = rank1
                best_epoch = epoch + 1

            if use_gpu:
                state_dict = model.module.state_dict()
            else:
                state_dict = model.state_dict()
            save_checkpoint({
                &quotstate_dict&quot: state_dict,
                &quotrank1&quot: rank1,
                &quotepoch&quot: epoch,
            }, is_best, osp.join(args.save_dir, &quotcheckpoint_ep&quot + str(epoch+1) + &quot.pth.tar&quot))

    print("==&gt; Best Rank-1 {:.1%}, achieved at epoch {}".format(best_rank1, best_epoch))

    elapsed = round(time.time() - start_time)
    elapsed = str(datetime.timedelta(seconds=elapsed))
    train_time<a id="change"> = </a><a id="change">str(datetime.timedelta(seconds=train_time)</a><a id="change">)</a>
    <a id="change">print("Finished. Total elapsed time (h:m:s): {}. Training time (h:m:s): {}.".format(</a>elapsed, train_time<a id="change">)</a><a id="change">)</a>

def train(epoch, model, criterion, optimizer, trainloader, use_gpu):
    model.train()
    losses = AverageMeter()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/vlsomers/bpbreid/commit/ef8ede34f8d898b0acf740fab79e56e77e200069#diff-a70466c8977c5fecf87d4a4c2d9bf26612fb55d12ceb469a246ae65cefbd0885L69' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 84516304</div><div id='project'> Project Name: vlsomers/bpbreid</div><div id='commit'> Commit Name: ef8ede34f8d898b0acf740fab79e56e77e200069</div><div id='time'> Time: 2018-04-30</div><div id='author'> Author: k.zhou@qmul.ac.uk</div><div id='file'> File Name: train_vid_model_xent.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: train_vid_model_xent.py</div><div id='n_file'> N File Name: train_vid_model_xent.py</div><div id='m_start'> M Start Line: 185</div><div id='m_end'> M End Line: 186</div><div id='n_start'> N Start Line: 155</div><div id='n_end'> N End Line: 190</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    elapsed = round(time.time() - start_time)
    elapsed = str(datetime.timedelta(seconds=elapsed))
    <a id="change">print("Finished. Total elapsed time (h:m:s): {}".format(</a>elapsed<a id="change">)</a><a id="change">)</a>

def train(epoch, model, criterion, optimizer, trainloader, use_gpu):
    model.train()
    losses = AverageMeter()</code></pre><h3>After Change</h3><pre><code class='java'>
        return

    start_time = time.time()
    train_time<a id="change"> = 0</a>
    best_rank1 = -np.inf
    best_epoch = 0
    print("==&gt; Start training")

    for epoch in range(start_epoch, args.max_epoch):
        start_train_time<a id="change"> = </a><a id="change">time.time()</a>
        train(epoch, model, criterion, optimizer, trainloader, use_gpu)
        train_time<a id="change"> += </a><a id="change">round(time.time()</a><a id="change"> - </a>start_train_time<a id="change">)</a>
        
        if args.stepsize &gt; 0: scheduler.step()
        
        if args.eval_step &gt; 0 and (epoch+1) % args.eval_step == 0 or (epoch+1) == args.max_epoch:
            print("==&gt; Test")
            rank1 = test(model, queryloader, galleryloader, use_gpu)
            is_best = rank1 &gt; best_rank1
            if is_best:
                best_rank1 = rank1
                best_epoch = epoch + 1

            if use_gpu:
                state_dict = model.module.state_dict()
            else:
                state_dict = model.state_dict()
            save_checkpoint({
                &quotstate_dict&quot: state_dict,
                &quotrank1&quot: rank1,
                &quotepoch&quot: epoch,
            }, is_best, osp.join(args.save_dir, &quotcheckpoint_ep&quot + str(epoch+1) + &quot.pth.tar&quot))

    print("==&gt; Best Rank-1 {:.1%}, achieved at epoch {}".format(best_rank1, best_epoch))

    elapsed = round(time.time() - start_time)
    elapsed = str(datetime.timedelta(seconds=elapsed))
    train_time<a id="change"> = </a><a id="change">str(datetime.timedelta(seconds=train_time)</a><a id="change">)</a>
    <a id="change">print("Finished. Total elapsed time (h:m:s): {}. Training time (h:m:s): {}.".format(</a>elapsed, train_time<a id="change">)</a><a id="change">)</a>

def train(epoch, model, criterion, optimizer, trainloader, use_gpu):
    model.train()
    losses = AverageMeter()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/vlsomers/bpbreid/commit/ef8ede34f8d898b0acf740fab79e56e77e200069#diff-bd658ed8b3a6087a99781489d4eb208b2740d88e2919bada3e8ebd250ba2b881L75' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 84516307</div><div id='project'> Project Name: vlsomers/bpbreid</div><div id='commit'> Commit Name: ef8ede34f8d898b0acf740fab79e56e77e200069</div><div id='time'> Time: 2018-04-30</div><div id='author'> Author: k.zhou@qmul.ac.uk</div><div id='file'> File Name: train_img_model_xent.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: train_img_model_xent.py</div><div id='n_file'> N File Name: train_img_model_xent.py</div><div id='m_start'> M Start Line: 188</div><div id='m_end'> M End Line: 189</div><div id='n_start'> N Start Line: 158</div><div id='n_end'> N End Line: 193</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    elapsed = round(time.time() - start_time)
    elapsed = str(datetime.timedelta(seconds=elapsed))
    <a id="change">print("Finished. Total elapsed time (h:m:s): {}".format(</a>elapsed<a id="change">)</a><a id="change">)</a>

def train(epoch, model, criterion_xent, criterion_cent, optimizer_model, optimizer_cent, trainloader, use_gpu):
    model.train()
    losses = AverageMeter()</code></pre><h3>After Change</h3><pre><code class='java'>
        return

    start_time = time.time()
    train_time<a id="change"> = 0</a>
    best_rank1 = -np.inf
    best_epoch = 0
    print("==&gt; Start training")

    for epoch in range(start_epoch, args.max_epoch):
        start_train_time<a id="change"> = </a><a id="change">time.time()</a>
        train(epoch, model, criterion_xent, criterion_cent, optimizer_model, optimizer_cent, trainloader, use_gpu)
        train_time<a id="change"> += </a><a id="change">round(time.time()</a><a id="change"> - </a>start_train_time<a id="change">)</a>
        
        if args.stepsize &gt; 0: scheduler.step()
        
        if args.eval_step &gt; 0 and (epoch+1) % args.eval_step == 0 or (epoch+1) == args.max_epoch:
            print("==&gt; Test")
            rank1 = test(model, queryloader, galleryloader, use_gpu)
            is_best = rank1 &gt; best_rank1
            if is_best:
                best_rank1 = rank1
                best_epoch = epoch + 1

            if use_gpu:
                state_dict = model.module.state_dict()
            else:
                state_dict = model.state_dict()
            save_checkpoint({
                &quotstate_dict&quot: state_dict,
                &quotrank1&quot: rank1,
                &quotepoch&quot: epoch,
            }, is_best, osp.join(args.save_dir, &quotcheckpoint_ep&quot + str(epoch+1) + &quot.pth.tar&quot))

    print("==&gt; Best Rank-1 {:.1%}, achieved at epoch {}".format(best_rank1, best_epoch))

    elapsed = round(time.time() - start_time)
    elapsed = str(datetime.timedelta(seconds=elapsed))
    train_time<a id="change"> = </a><a id="change">str(datetime.timedelta(seconds=train_time)</a><a id="change">)</a>
    <a id="change">print("Finished. Total elapsed time (h:m:s): {}. Training time (h:m:s): {}.".format(</a>elapsed, train_time<a id="change">)</a><a id="change">)</a>

def train(epoch, model, criterion_xent, criterion_cent, optimizer_model, optimizer_cent, trainloader, use_gpu):
    model.train()
    losses = AverageMeter()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/vlsomers/bpbreid/commit/ef8ede34f8d898b0acf740fab79e56e77e200069#diff-069f8765084422bb727f31fb63c2a3ef46debe00eb29de67bb97de45d462b33cL76' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 84516306</div><div id='project'> Project Name: vlsomers/bpbreid</div><div id='commit'> Commit Name: ef8ede34f8d898b0acf740fab79e56e77e200069</div><div id='time'> Time: 2018-04-30</div><div id='author'> Author: k.zhou@qmul.ac.uk</div><div id='file'> File Name: train_img_model_cent.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: train_img_model_cent.py</div><div id='n_file'> N File Name: train_img_model_cent.py</div><div id='m_start'> M Start Line: 193</div><div id='m_end'> M End Line: 194</div><div id='n_start'> N Start Line: 163</div><div id='n_end'> N End Line: 198</div><BR>