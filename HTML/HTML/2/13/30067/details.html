<html><h3>Pattern ID :30067
</h3><img src='89229585.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        if self.is_anomaly:
            mask_path = str(self.mask_paths[idx])
            mask = cv2.imread(mask_path)
            mask<a id="change"> = mask[150:900, :, :]</a>
            mask = cv2.cvtColor(mask, cv2.COLOR_BGR2RGB)
        else:
            mask = np.zeros(img.shape)
</code></pre><h3>After Change</h3><pre><code class='java'>
        
        mask_path = str(self.mask_paths[idx])
        mask = cv2.imread(mask_path)
        mask = <a id="change">mask[100:1050, :, :]</a>
        mask = cv2.cvtColor(mask, cv2.COLOR_BGR2RGB)
        
        if self.augs:
            sample = self.augs(image=img, mask=mask)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 8</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/taikiinoue/stad/commit/3c6c7523064dd4114333484a0f914e216cdfca09#diff-314d66f3e69d697ae9719c579ca1e07b262b09dd186a54d20abbf488f68f7b75L34' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 89229585</div><div id='project'> Project Name: taikiinoue/stad</div><div id='commit'> Commit Name: 3c6c7523064dd4114333484a0f914e216cdfca09</div><div id='time'> Time: 2020-07-14</div><div id='author'> Author: taikiinoue45@gmail.com</div><div id='file'> File Name: stad/datasets/somic.py</div><div id='m_class'> M Class Name: SomicDataset</div><div id='n_method'> N Class Name: SomicDataset</div><div id='m_method'> M Method Name: __getitem__(2)</div><div id='n_method'> N Method Name: __getitem__(2)</div><div id='m_parent_class'> M Parent Class: Dataset</div><div id='n_parent_class'> N Parent Class: Dataset</div><div id='m_file'> M File Name: stad/datasets/somic.py</div><div id='n_file'> N File Name: stad/datasets/somic.py</div><div id='m_start'> M Start Line: 35</div><div id='m_end'> M End Line: 46</div><div id='n_start'> N Start Line: 34</div><div id='n_end'> N End Line: 42</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            p_frame = p[i, 0, ix].view(-1)
            f_frame = features[i, :, ix]
            &#47&#47 flatten samples and put them in the first dim
            <a id="change">f_frame</a> = f_frame.reshape(f_frame.size(0), -1).permute(1, 0)
            if self.match_dims == 2:
                coord = f_frame[:, 2:4]
            elif self.match_dims == 3:
                coord<a id="change"> = </a><a id="change">f_frame[:, 2:5]</a>
            else:
                raise ValueError("Match dims must be 2 or 3.")

            self.clusterer.fit(coord.cpu().numpy())</code></pre><h3>After Change</h3><pre><code class='java'>
            p_frame = p[i, 0, ix].view(-1)
            f_frame = features[i, :, ix]
            &#47&#47 flatten samples and put them in the first dim
            <a id="change">f_frame</a> = f_frame.reshape(f_frame.size(0), -1).permute(1, 0)
            if self.match_dims == 2:
                coord = f_frame[:, 1:3]
                dist_mat_lat = scipy.spatial.distance.pdist(coord.cpu().numpy())
                dist_mat_lat = scipy.spatial.distance.squareform(dist_mat_lat)
            elif self.match_dims == 3:
                coord_lat = <a id="change">f_frame[:, 1:3]</a>
                dist_mat_lat = scipy.spatial.distance.pdist(coord_lat.cpu().numpy())
                dist_mat_lat = scipy.spatial.distance.squareform(dist_mat_lat)

                coord_ax = f_frame[:, [3]]</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/turagalab/decode/commit/0e5761c7b77ba95abc1eca3a0ab82f346056cc26#diff-63f00a6429878da59333cfbdc4bbe5321829eca14dc36376f4d5baca1c407be1L322' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 89229569</div><div id='project'> Project Name: turagalab/decode</div><div id='commit'> Commit Name: 0e5761c7b77ba95abc1eca3a0ab82f346056cc26</div><div id='time'> Time: 2019-09-04</div><div id='author'> Author: gitdev@LRM.photo</div><div id='file'> File Name: deepsmlm/neuralfitter/post_processing.py</div><div id='m_class'> M Class Name: ConsistencyPostprocessing</div><div id='n_method'> N Class Name: ConsistencyPostprocessing</div><div id='m_method'> M Method Name: _cluster(3)</div><div id='n_method'> N Method Name: _cluster(3)</div><div id='m_parent_class'> M Parent Class: PostProcessing</div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: deepsmlm/neuralfitter/post_processing.py</div><div id='n_file'> N File Name: deepsmlm/neuralfitter/post_processing.py</div><div id='m_start'> M Start Line: 338</div><div id='m_end'> M End Line: 365</div><div id='n_start'> N Start Line: 391</div><div id='n_end'> N End Line: 430</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        
        if self.is_anomaly:
            mask_path = str(self.mask_paths[idx])
            <a id="change">mask</a> = cv2.imread(mask_path)
            mask<a id="change"> = </a><a id="change">mask[150:900, :, :]</a>
            mask = cv2.cvtColor(mask, cv2.COLOR_BGR2RGB)
        else:
            mask = np.zeros(img.shape)
</code></pre><h3>After Change</h3><pre><code class='java'>
        img = cv2.cvtColor(raw_img, cv2.COLOR_BGR2RGB)
        
        mask_path = str(self.mask_paths[idx])
        <a id="change">mask</a> = cv2.imread(mask_path)
        mask = <a id="change">mask[100:1050, :, :]</a>
        mask = cv2.cvtColor(mask, cv2.COLOR_BGR2RGB)
        
        if self.augs:
            sample = self.augs(image=img, mask=mask)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/taikiinoue/stad/commit/3c6c7523064dd4114333484a0f914e216cdfca09#diff-314d66f3e69d697ae9719c579ca1e07b262b09dd186a54d20abbf488f68f7b75L29' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 89229587</div><div id='project'> Project Name: taikiinoue/stad</div><div id='commit'> Commit Name: 3c6c7523064dd4114333484a0f914e216cdfca09</div><div id='time'> Time: 2020-07-14</div><div id='author'> Author: taikiinoue45@gmail.com</div><div id='file'> File Name: stad/datasets/somic.py</div><div id='m_class'> M Class Name: SomicDataset</div><div id='n_method'> N Class Name: SomicDataset</div><div id='m_method'> M Method Name: __getitem__(2)</div><div id='n_method'> N Method Name: __getitem__(2)</div><div id='m_parent_class'> M Parent Class: Dataset</div><div id='n_parent_class'> N Parent Class: Dataset</div><div id='m_file'> M File Name: stad/datasets/somic.py</div><div id='n_file'> N File Name: stad/datasets/somic.py</div><div id='m_start'> M Start Line: 35</div><div id='m_end'> M End Line: 46</div><div id='n_start'> N Start Line: 34</div><div id='n_end'> N End Line: 42</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    np.random.seed(seed=seed)
    indices = np.arange(pos_triples.shape[0])
    np.random.shuffle(indices)
    <a id="change">pos_triples</a> = pos_triples[indices]

    &#47&#47 Create labels
    subject_relation_pairs = pos_triples[:, 0:2]
    entities = np.arange(kg_embedding_model.num_entities)
    labels = []

    for tuple in subject_relation_pairs:
        indices_duplicates = (subject_relation_pairs == tuple).all(axis=1).nonzero()
        objects<a id="change"> = </a><a id="change">pos_triples[indices_duplicates, 2:3]</a>
        objects = np.unique(np.ndarray.flatten(objects))
        label_vec = np.in1d(entities, objects) * 1
        labels.append(label_vec)
</code></pre><h3>After Change</h3><pre><code class='java'>
    np.random.seed(seed=seed)
    indices = np.arange(pos_triples.shape[0])
    np.random.shuffle(indices)
    <a id="change">pos_triples</a> = pos_triples[indices]
    num_pos_triples = pos_triples.shape[0]

    &#47&#47 Create labels
    subject_relation_pairs = pos_triples[:, 0:2]
    entities = np.arange(kg_embedding_model.num_entities)
    labels = []

    for subj_rel in subject_relation_pairs:
        subj_rel_rep = np.repeat(subj_rel,axis=0)
        label = (<a id="change">pos_triples[:,0:2]</a> == subj_rel).all(axis=1)
        &#47&#47 objects = pos_triples[mat, 2:3]
        &#47&#47 objects = np.unique(np.ndarray.flatten(objects))
        &#47&#47 label_vec = np.in1d(entities, objects) * 1</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/pykeen/pykeen/commit/c9302b9f07967d1d474435e53355e3bd308cfd45#diff-ff4432cf8281f238da64dab17f2b4f7fc2b0bd639f3c043c019d1896b3cc04a1L104' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 89229588</div><div id='project'> Project Name: pykeen/pykeen</div><div id='commit'> Commit Name: c9302b9f07967d1d474435e53355e3bd308cfd45</div><div id='time'> Time: 2018-09-12</div><div id='author'> Author: ali-mehdi@live.de</div><div id='file'> File Name: src/utilities/train_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train_conv_e_model(7)</div><div id='n_method'> N Method Name: train_conv_e_model(7)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/utilities/train_utils.py</div><div id='n_file'> N File Name: src/utilities/train_utils.py</div><div id='m_start'> M Start Line: 108</div><div id='m_end'> M End Line: 140</div><div id='n_start'> N Start Line: 100</div><div id='n_end'> N End Line: 128</div><BR>