<html><h3>Pattern ID :1104
</h3><img src='5588757.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    log_dir = il_train_ex.observers[0].dir
    imitation_logger.configure(log_dir, ["stdout", "tensorboard"])

    <a id="change">if benchmark[&quotbenchmark_name&quot] == &quotmagical&quot</a>:
        <a id="change">gym_env_name_chans_first</a><a id="change">, dataset_dict = </a><a id="change">load_dataset_magical()</a>
        venv_chans_first<a id="change"> = make_vec_env(gym_env_name_chans_first</a><a id="change">,
                                        n_envs=1,
                                        parallel=False)</a>
    elif <a id="change">benchmark[&quotbenchmark_name&quot] == &quotdm_control&quot</a>:
        <a id="change">gym_env_name_chans_first</a><a id="change">, dataset_dict = </a><a id="change">load_dataset_dm_control()</a>
        venv_chans_first<a id="change"> = </a><a id="change">make_vec_env(gym_env_name_chans_first</a><a id="change">,
                                        n_envs=1,
                                        parallel=False)</a>
    elif <a id="change">benchmark[&quotbenchmark_name&quot] == &quotatari&quot</a>:
        dataset_dict<a id="change"> = </a><a id="change">load_dataset_atari()</a>
        gym_env_name_chans_last<a id="change"> = benchmark</a><a id="change">[&quotatari_env_id&quot]</a>
        venv_nhwc = <a id="change">VecFrameStack(make_atari_env(</a>gym_env_name_chans_last<a id="change">)</a>, <a id="change">4</a><a id="change">)</a>
        venv_chans_first<a id="change"> = </a><a id="change">VecTransposeImage(</a>venv_nhwc<a id="change">)</a>
    else:
        <a id="change">raise </a><a id="change">NotImplementedError(
            f"this code does not yet support "
            f"benchmark_name={benchmark[&quotbenchmark_name&quot]!r}"</a><a id="change">)</a>

    dataset = TransitionsMinimalDataset(dataset_dict)

    if encoder_path:</code></pre><h3>After Change</h3><pre><code class='java'>
    log_dir = il_train_ex.observers[0].dir
    imitation_logger.configure(log_dir, ["stdout", "tensorboard"])

    venv = <a id="change">auto_env.load_vec_env()</a>
    dataset_dict<a id="change"> = auto_env</a><a id="change">.load_dataset()</a>
    dataset = TransitionsMinimalDataset(dataset_dict)

    if encoder_path:
        logging.info(f"Loading pretrained encoder from &quot{encoder_path}&quot")</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 32</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/humancompatibleai/eirli/commit/e27cbb99e7f7a03a80d5ff8063b3071bf534edda#diff-b8a30b79d4b477ae4ff3f89cb23e1e0d8475a5ef44d82945f1ab0d152531016cL158' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 5588757</div><div id='project'> Project Name: humancompatibleai/eirli</div><div id='commit'> Commit Name: e27cbb99e7f7a03a80d5ff8063b3071bf534edda</div><div id='time'> Time: 2020-08-13</div><div id='author'> Author: sam@qxcv.net</div><div id='file'> File Name: src/il_representations/scripts/il_train.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(5)</div><div id='n_method'> N Method Name: train(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/il_representations/scripts/il_train.py</div><div id='n_file'> N File Name: src/il_representations/scripts/il_train.py</div><div id='m_start'> M Start Line: 164</div><div id='m_end'> M End Line: 211</div><div id='n_start'> N Start Line: 158</div><div id='n_end'> N End Line: 187</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    log_dir = il_train_ex.observers[0].dir
    imitation_logger.configure(log_dir, ["stdout", "tensorboard"])

    <a id="change">if benchmark[&quotbenchmark_name&quot] == &quotmagical&quot</a>:
        gym_env_name_chans_first<a id="change">, dataset_dict = </a><a id="change">load_dataset_magical()</a>
        venv_chans_first<a id="change"> = make_vec_env(</a>gym_env_name_chans_first<a id="change">,
                                        n_envs=1,
                                        parallel=False)</a>
    elif <a id="change">benchmark[&quotbenchmark_name&quot] == &quotdm_control&quot</a>:
        gym_env_name_chans_first<a id="change">, dataset_dict = </a><a id="change">load_dataset_dm_control()</a>
        venv_chans_first<a id="change"> = </a><a id="change">make_vec_env(</a>gym_env_name_chans_first<a id="change">,
                                        n_envs=1,
                                        parallel=False)</a>
    elif <a id="change">benchmark[&quotbenchmark_name&quot] == &quotatari&quot</a>:
        dataset_dict<a id="change"> = </a><a id="change">load_dataset_atari()</a>
        gym_env_name_chans_last<a id="change"> = </a><a id="change">benchmark[&quotatari_env_id&quot]</a>
        venv_nhwc = <a id="change">VecFrameStack(make_atari_env(</a>gym_env_name_chans_last<a id="change">)</a>, <a id="change">4</a><a id="change">)</a>
        venv_chans_first<a id="change"> = </a><a id="change">VecTransposeImage(</a>venv_nhwc<a id="change">)</a>
    else:
        <a id="change">raise </a><a id="change">NotImplementedError(
            f"this code does not yet support "
            f"benchmark_name={benchmark[&quotbenchmark_name&quot]!r}"</a><a id="change">)</a>

    dataset = TransitionsMinimalDataset(dataset_dict)

    if encoder_path:</code></pre><h3>After Change</h3><pre><code class='java'>
    log_dir = il_train_ex.observers[0].dir
    imitation_logger.configure(log_dir, ["stdout", "tensorboard"])

    venv = <a id="change">auto_env.load_vec_env()</a>
    dataset_dict<a id="change"> = </a><a id="change">auto_env.load_dataset()</a>
    dataset = TransitionsMinimalDataset(dataset_dict)

    if encoder_path:
        logging.info(f"Loading pretrained encoder from &quot{encoder_path}&quot")</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/humancompatibleai/eirli/commit/4f43a9030853ed574d23f2e86f5253fc4ccd11de#diff-b8a30b79d4b477ae4ff3f89cb23e1e0d8475a5ef44d82945f1ab0d152531016cL155' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 5588756</div><div id='project'> Project Name: humancompatibleai/eirli</div><div id='commit'> Commit Name: 4f43a9030853ed574d23f2e86f5253fc4ccd11de</div><div id='time'> Time: 2020-08-13</div><div id='author'> Author: sam@qxcv.net</div><div id='file'> File Name: src/il_representations/scripts/il_train.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(5)</div><div id='n_method'> N Method Name: train(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/il_representations/scripts/il_train.py</div><div id='n_file'> N File Name: src/il_representations/scripts/il_train.py</div><div id='m_start'> M Start Line: 164</div><div id='m_end'> M End Line: 211</div><div id='n_start'> N Start Line: 158</div><div id='n_end'> N End Line: 187</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        algo = getattr(algos, algo)

    &#47&#47 setup environment
    <a id="change">if benchmark[&quotbenchmark_name&quot] == &quotmagical&quot</a>:
        assert not use_random_rollouts, \
            "use_random_rollouts not yet supported for MAGICAL"
        gym_env_name<a id="change">, dataset_dict = </a><a id="change">load_dataset_magical()</a>
        venv<a id="change"> = make_vec_env(</a>gym_env_name<a id="change">, n_envs=1, parallel=False)</a>
        color_space = ColorSpace.RGB
    elif <a id="change">benchmark[&quotbenchmark_name&quot] == &quotdm_control&quot</a>:
        assert not use_random_rollouts, \
            "use_random_rollouts not yet supported for dm_control"
        gym_env_name<a id="change">, dataset_dict = </a><a id="change">load_dataset_dm_control()</a>
        venv<a id="change"> = </a><a id="change">make_vec_env(</a>gym_env_name<a id="change">, n_envs=1, parallel=False)</a>
        color_space = ColorSpace.RGB
    elif <a id="change">benchmark[&quotbenchmark_name&quot] == &quotatari&quot</a>:
        if not use_random_rollouts:
            dataset_dict<a id="change"> = </a><a id="change">load_dataset_atari()</a>
        gym_env_name_hwc<a id="change"> = </a><a id="change">benchmark[&quotatari_env_id&quot]</a>
        venv<a id="change"> = </a><a id="change">VecTransposeImage(</a><a id="change">VecFrameStack(
            make_atari_env(</a>gym_env_name_hwc<a id="change">)</a>, <a id="change">4</a><a id="change">))</a>
        color_space = ColorSpace.GRAY
    else:
        <a id="change">raise </a><a id="change">NotImplementedError(
            f"no support for benchmark_name={benchmark[&quotbenchmark_name&quot]!r}"</a><a id="change">)</a>

    if use_random_rollouts:
        dataset_dict = get_random_traj(env=venv,
                                       timesteps=timesteps)</code></pre><h3>After Change</h3><pre><code class='java'>
        algo = getattr(algos, algo)

    &#47&#47 setup environment & dataset
    venv = <a id="change">auto_env.load_vec_env()</a>
    color_space = auto_env.load_color_space()
    if use_random_rollouts:
        dataset_dict = get_random_traj(env=venv,
                                       timesteps=timesteps)
    else:
        dataset_dict<a id="change"> = </a><a id="change">auto_env.load_dataset()</a>

    &#47&#47 FIXME(sam): this creates weird action-at-a-distance, and doesn&quott save us
    &#47&#47 from specifying parameters in the default config anyway (Sacred will
    &#47&#47 complain if we include a param that isn&quott in the default config). Should</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/humancompatibleai/eirli/commit/4f43a9030853ed574d23f2e86f5253fc4ccd11de#diff-85e6dfcecb4f7bb11eda0f3c08b89808cf7f28a3eaf145199d43441864816161L81' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 5588753</div><div id='project'> Project Name: humancompatibleai/eirli</div><div id='commit'> Commit Name: 4f43a9030853ed574d23f2e86f5253fc4ccd11de</div><div id='time'> Time: 2020-08-13</div><div id='author'> Author: sam@qxcv.net</div><div id='file'> File Name: src/il_representations/scripts/run_rep_learner.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: run(10)</div><div id='n_method'> N Method Name: run(10)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/il_representations/scripts/run_rep_learner.py</div><div id='n_file'> N File Name: src/il_representations/scripts/run_rep_learner.py</div><div id='m_start'> M Start Line: 92</div><div id='m_end'> M End Line: 115</div><div id='n_start'> N Start Line: 86</div><div id='n_end'> N End Line: 92</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        algo = getattr(algos, algo)

    &#47&#47 setup environment
    <a id="change">if benchmark[&quotbenchmark_name&quot] == &quotmagical&quot</a>:
        assert not use_random_rollouts, \
            "use_random_rollouts not yet supported for MAGICAL"
        gym_env_name<a id="change">, dataset_dict = </a><a id="change">load_dataset_magical()</a>
        venv<a id="change"> = make_vec_env(</a>gym_env_name<a id="change">, n_envs=1, parallel=False)</a>
        color_space = ColorSpace.RGB
    elif <a id="change">benchmark[&quotbenchmark_name&quot] == &quotdm_control&quot</a>:
        assert not use_random_rollouts, \
            "use_random_rollouts not yet supported for dm_control"
        gym_env_name<a id="change">, dataset_dict = </a><a id="change">load_dataset_dm_control()</a>
        venv<a id="change"> = </a><a id="change">make_vec_env(</a>gym_env_name<a id="change">, n_envs=1, parallel=False)</a>
        color_space = ColorSpace.RGB
    elif <a id="change">benchmark[&quotbenchmark_name&quot] == &quotatari&quot</a>:
        if not use_random_rollouts:
            dataset_dict<a id="change"> = </a><a id="change">load_dataset_atari()</a>
        gym_env_name_hwc<a id="change"> = </a><a id="change">benchmark[&quotatari_env_id&quot]</a>
        venv<a id="change"> = </a><a id="change">VecTransposeImage(</a><a id="change">VecFrameStack(
            make_atari_env(</a>gym_env_name_hwc<a id="change">)</a>, <a id="change">4</a><a id="change">))</a>
        color_space = ColorSpace.GRAY
    else:
        <a id="change">raise </a><a id="change">NotImplementedError(
            f"no support for benchmark_name={benchmark[&quotbenchmark_name&quot]!r}"</a><a id="change">)</a>

    if use_random_rollouts:
        dataset_dict = get_random_traj(env=venv,
                                       timesteps=timesteps)</code></pre><h3>After Change</h3><pre><code class='java'>
        algo = getattr(algos, algo)

    &#47&#47 setup environment & dataset
    venv = <a id="change">auto_env.load_vec_env()</a>
    color_space = auto_env.load_color_space()
    if use_random_rollouts:
        dataset_dict = get_random_traj(env=venv,
                                       timesteps=timesteps)
    else:
        dataset_dict<a id="change"> = </a><a id="change">auto_env.load_dataset()</a>

    &#47&#47 FIXME(sam): this creates weird action-at-a-distance, and doesn&quott save us
    &#47&#47 from specifying parameters in the default config anyway (Sacred will
    &#47&#47 complain if we include a param that isn&quott in the default config). Should</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/humancompatibleai/eirli/commit/e27cbb99e7f7a03a80d5ff8063b3071bf534edda#diff-85e6dfcecb4f7bb11eda0f3c08b89808cf7f28a3eaf145199d43441864816161L81' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 5588752</div><div id='project'> Project Name: humancompatibleai/eirli</div><div id='commit'> Commit Name: e27cbb99e7f7a03a80d5ff8063b3071bf534edda</div><div id='time'> Time: 2020-08-13</div><div id='author'> Author: sam@qxcv.net</div><div id='file'> File Name: src/il_representations/scripts/run_rep_learner.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: run(10)</div><div id='n_method'> N Method Name: run(10)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/il_representations/scripts/run_rep_learner.py</div><div id='n_file'> N File Name: src/il_representations/scripts/run_rep_learner.py</div><div id='m_start'> M Start Line: 92</div><div id='m_end'> M End Line: 115</div><div id='n_start'> N Start Line: 86</div><div id='n_end'> N End Line: 92</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    log_dir = il_train_ex.observers[0].dir
    imitation_logger.configure(log_dir, ["stdout", "tensorboard"])

    <a id="change">if benchmark[&quotbenchmark_name&quot] == &quotmagical&quot</a>:
        gym_env_name_chans_first<a id="change">, dataset_dict = </a><a id="change">load_dataset_magical()</a>
        venv_chans_first<a id="change"> = make_vec_env(</a>gym_env_name_chans_first<a id="change">,
                                        n_envs=1,
                                        parallel=False)</a>
    elif <a id="change">benchmark[&quotbenchmark_name&quot] == &quotdm_control&quot</a>:
        gym_env_name_chans_first<a id="change">, dataset_dict = </a><a id="change">load_dataset_dm_control()</a>
        venv_chans_first<a id="change"> = </a><a id="change">make_vec_env(</a>gym_env_name_chans_first<a id="change">,
                                        n_envs=1,
                                        parallel=False)</a>
    elif <a id="change">benchmark[&quotbenchmark_name&quot] == &quotatari&quot</a>:
        dataset_dict<a id="change"> = </a><a id="change">load_dataset_atari()</a>
        gym_env_name_chans_last<a id="change"> = </a><a id="change">benchmark[&quotatari_env_id&quot]</a>
        venv_nhwc = <a id="change">VecFrameStack(make_atari_env(</a>gym_env_name_chans_last<a id="change">)</a>, <a id="change">4</a><a id="change">)</a>
        venv_chans_first<a id="change"> = </a><a id="change">VecTransposeImage(</a>venv_nhwc<a id="change">)</a>
    else:
        <a id="change">raise </a><a id="change">NotImplementedError(
            f"this code does not yet support "
            f"benchmark_name={benchmark[&quotbenchmark_name&quot]!r}"</a><a id="change">)</a>

    dataset = TransitionsMinimalDataset(dataset_dict)

    if encoder_path:</code></pre><h3>After Change</h3><pre><code class='java'>
    log_dir = il_train_ex.observers[0].dir
    imitation_logger.configure(log_dir, ["stdout", "tensorboard"])

    venv = <a id="change">auto_env.load_vec_env()</a>
    dataset_dict<a id="change"> = </a><a id="change">auto_env.load_dataset()</a>
    dataset = TransitionsMinimalDataset(dataset_dict)

    if encoder_path:
        logging.info(f"Loading pretrained encoder from &quot{encoder_path}&quot")</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/humancompatibleai/eirli/commit/e27cbb99e7f7a03a80d5ff8063b3071bf534edda#diff-b8a30b79d4b477ae4ff3f89cb23e1e0d8475a5ef44d82945f1ab0d152531016cL155' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 5588767</div><div id='project'> Project Name: humancompatibleai/eirli</div><div id='commit'> Commit Name: e27cbb99e7f7a03a80d5ff8063b3071bf534edda</div><div id='time'> Time: 2020-08-13</div><div id='author'> Author: sam@qxcv.net</div><div id='file'> File Name: src/il_representations/scripts/il_train.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(5)</div><div id='n_method'> N Method Name: train(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/il_representations/scripts/il_train.py</div><div id='n_file'> N File Name: src/il_representations/scripts/il_train.py</div><div id='m_start'> M Start Line: 164</div><div id='m_end'> M End Line: 211</div><div id='n_start'> N Start Line: 158</div><div id='n_end'> N End Line: 187</div><BR>