<html><h3>Pattern ID :18487
</h3><img src='60365245.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        x0_h, x0_w = x[0].size(2), x[0].size(3)

        x1 = F.interpolate(x[1], size=(x0_h, x0_w), mode=&quotbilinear&quot, align_corners=True)
        x2 = <a id="change">F.interpolate(</a>x[2]<a id="change">, size=(x0_h, x0_w), mode=&quotbilinear&quot, align_corners=True)</a>
        x3 = F.interpolate(x[3], size=(x0_h, x0_w), mode=&quotbilinear&quot, align_corners=True)

        x = torch.cat([x[0], x1, x2, x3], 1)
</code></pre><h3>After Change</h3><pre><code class='java'>
    def forward(self, features: List[Tensor]) -&gt; Tensor:
        Forward method.
        input_image, *features = features
        interpolated_feat = <a id="change">[]</a>
        <a id="change">for </a>feature in features<a id="change">:
            </a>interpolated = F.interpolate(feature, size=input_image.shape[2:], mode=&quotbilinear&quot, align_corners=True)
            <a id="change">interpolated_feat.append(</a>interpolated<a id="change">)</a>

        feats = torch.cat(interpolated_feat, 1)
        x = self.last_layer(feats)
        return x</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/eora-ai/torchok/commit/e6da29ed18aec5b4ae83cc9f5bd7e8bebf1c204d#diff-92ff83e6270a98a48bdf020ca7928499e87eeba7b3e888fe2bdab89bbe38105dL31' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60365245</div><div id='project'> Project Name: eora-ai/torchok</div><div id='commit'> Commit Name: e6da29ed18aec5b4ae83cc9f5bd7e8bebf1c204d</div><div id='time'> Time: 2022-06-11</div><div id='author'> Author: patr982@gmail.com</div><div id='file'> File Name: src/models/necks/segmentation/hrnet_segmentation_neck.py</div><div id='m_class'> M Class Name: HRNetSegmentationNeck</div><div id='n_method'> N Class Name: HRNetSegmentationNeck</div><div id='m_method'> M Method Name: forward(2)</div><div id='n_method'> N Method Name: forward(2)</div><div id='m_parent_class'> M Parent Class: BaseModel</div><div id='n_parent_class'> N Parent Class: BaseModel</div><div id='m_file'> M File Name: src/models/necks/segmentation/hrnet_segmentation_neck.py</div><div id='n_file'> N File Name: src/models/necks/segmentation/hrnet_segmentation_neck.py</div><div id='m_start'> M Start Line: 31</div><div id='m_end'> M End Line: 39</div><div id='n_start'> N Start Line: 31</div><div id='n_end'> N End Line: 38</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    def forward(self, x: List[Tensor]) -&gt; Tensor:
        x0_h, x0_w = x[0].size(2), x[0].size(3)

        x1 = <a id="change">F.interpolate(</a>x[1]<a id="change">, size=(x0_h, x0_w), mode=&quotbilinear&quot, align_corners=True)</a>
        x2 = F.interpolate(x[2], size=(x0_h, x0_w), mode=&quotbilinear&quot, align_corners=True)
        x3 = F.interpolate(x[3], size=(x0_h, x0_w), mode=&quotbilinear&quot, align_corners=True)

        x = torch.cat([x[0], x1, x2, x3], 1)</code></pre><h3>After Change</h3><pre><code class='java'>
    def forward(self, features: List[Tensor]) -&gt; Tensor:
        Forward method.
        input_image, *features = features
        interpolated_feat = <a id="change">[]</a>
        <a id="change">for </a><a id="change">feature</a> in features<a id="change">:
            </a>interpolated = F.interpolate(feature, size=input_image.shape[2:], mode=&quotbilinear&quot, align_corners=True)
            <a id="change">interpolated_feat.append(</a>interpolated<a id="change">)</a>

        feats = torch.cat(interpolated_feat, 1)
        x = self.last_layer(feats)
        return x</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/eora-ai/torchok/commit/e6da29ed18aec5b4ae83cc9f5bd7e8bebf1c204d#diff-92ff83e6270a98a48bdf020ca7928499e87eeba7b3e888fe2bdab89bbe38105dL30' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60365247</div><div id='project'> Project Name: eora-ai/torchok</div><div id='commit'> Commit Name: e6da29ed18aec5b4ae83cc9f5bd7e8bebf1c204d</div><div id='time'> Time: 2022-06-11</div><div id='author'> Author: patr982@gmail.com</div><div id='file'> File Name: src/models/necks/segmentation/hrnet_segmentation_neck.py</div><div id='m_class'> M Class Name: HRNetSegmentationNeck</div><div id='n_method'> N Class Name: HRNetSegmentationNeck</div><div id='m_method'> M Method Name: forward(2)</div><div id='n_method'> N Method Name: forward(2)</div><div id='m_parent_class'> M Parent Class: BaseModel</div><div id='n_parent_class'> N Parent Class: BaseModel</div><div id='m_file'> M File Name: src/models/necks/segmentation/hrnet_segmentation_neck.py</div><div id='n_file'> N File Name: src/models/necks/segmentation/hrnet_segmentation_neck.py</div><div id='m_start'> M Start Line: 31</div><div id='m_end'> M End Line: 39</div><div id='n_start'> N Start Line: 31</div><div id='n_end'> N End Line: 38</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        gcam = torch.mul(fmaps, weights).sum(dim=1, keepdim=True)
        gcam = F.relu(gcam)

        gcam = <a id="change">F.interpolate(
            </a>gcam, self.image_shape<a id="change">, mode="bilinear", align_corners=False
        )</a>

        B, C, H, W = gcam.shape
        gcam = gcam.view(B, -1)
        gcam -= gcam.min(dim=1, keepdim=True)[0]</code></pre><h3>After Change</h3><pre><code class='java'>
            grads = self._find(self.grad_pool, target_layer)
            weights = self._compute_grad_weights(grads)
            gcam_tensor = self.generate_helper(fmaps, weights)
            gcam = <a id="change">[]</a>
            <a id="change">for </a><a id="change">i</a> in range(self.logits.shape[0])<a id="change">:
                </a><a id="change">gcam.append(</a>gcam_tensor[i]<a id="change">)</a>

        return gcam

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/karol-g/gcam/commit/4d3673129f7f35d0b6ea05944a037268b4da45b2#diff-978485ec7cfb0b80eb5a414e89c1afc3b49e03fb985bcad877ce02e5af9cfe59L207' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60365246</div><div id='project'> Project Name: karol-g/gcam</div><div id='commit'> Commit Name: 4d3673129f7f35d0b6ea05944a037268b4da45b2</div><div id='time'> Time: 2020-01-02</div><div id='author'> Author: KarolGotkowski@gmx.de</div><div id='file'> File Name: evaluation_models/grad_cam/grad_cam.py</div><div id='m_class'> M Class Name: GradCAM</div><div id='n_method'> N Class Name: GradCAM</div><div id='m_method'> M Method Name: generate(2)</div><div id='n_method'> N Method Name: generate(2)</div><div id='m_parent_class'> M Parent Class: _BaseWrapper</div><div id='n_parent_class'> N Parent Class: _BaseWrapper</div><div id='m_file'> M File Name: evaluation_models/grad_cam/grad_cam.py</div><div id='n_file'> N File Name: evaluation_models/grad_cam/grad_cam.py</div><div id='m_start'> M Start Line: 209</div><div id='m_end'> M End Line: 228</div><div id='n_start'> N Start Line: 231</div><div id='n_end'> N End Line: 244</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    assert inMask.dim() == 4, "mask must be 4 dimensions"
    inMask = inMask.float()
    ntimes = 2**nlayers
    inMask = <a id="change">F.interpolate(</a>inMask, (inMask.size(2)//ntimes, inMask.size(3)//ntimes)<a id="change">, mode=&quotnearest&quot)</a>
    inMask = inMask.detach().byte()

    return inMask
</code></pre><h3>After Change</h3><pre><code class='java'>
    assert inMask.dim() == 4, "mask must be 4 dimensions"
    assert inMask.size(0) == 1, "the first dimension must be 1 for mask"
    inMask = inMask.float()
    convs = <a id="change">[]</a>
    inMask = Variable(inMask, requires_grad = False)
    <a id="change">for </a><a id="change">id_net</a> in range(conv_layers)<a id="change">:
        </a>conv = nn.Conv2d(1,1,4,2,1, bias=False)
        conv.weight.data.fill_(1/16)
        <a id="change">convs.append(</a>conv<a id="change">)</a>
    lnet = nn.Sequential(*convs)
    if inMask.is_cuda:

        lnet = lnet.cuda()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/kumapowerliu/rethinking-inpainting-medfe/commit/17d04d208950c9c4e2e8bc5251cf06205ec15285#diff-d6757ab1e3ffa225bc5e10234856fffd764bbefcce478fc1c4baee1f4c7ef308L76' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60365249</div><div id='project'> Project Name: kumapowerliu/rethinking-inpainting-medfe</div><div id='commit'> Commit Name: 17d04d208950c9c4e2e8bc5251cf06205ec15285</div><div id='time'> Time: 2020-11-07</div><div id='author'> Author: 33801357+KumapowerLIU@users.noreply.github.com</div><div id='file'> File Name: util/util.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: cal_feat_mask(3)</div><div id='n_method'> N Method Name: cal_feat_mask(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: util/util.py</div><div id='n_file'> N File Name: util/util.py</div><div id='m_start'> M Start Line: 78</div><div id='m_end'> M End Line: 83</div><div id='n_start'> N Start Line: 76</div><div id='n_end'> N End Line: 93</div><BR>