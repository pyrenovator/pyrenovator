<html><h3>Pattern ID :3112
</h3><img src='11952039.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        tokenizer,
        output_data.transpose([1, 2, 0]).tolist()[0][0], bos_id, eos_id)
    print("Model input:", inputs)
    <a id="change">print("Result:"</a>, result<a id="change">)</a>


if __name__ == "__main__":
    args = setup_args()</code></pre><h3>After Change</h3><pre><code class='java'>
                                                                axis=0)

    &#47&#47 Forced bos token ids
    forced_bos_token<a id="change"> = </a><a id="change">np.ones(</a>[args.batch_size, 1]<a id="change">, dtype="int32") * </a>bos_id

    &#47&#47 Load FasterTransformer lib.
    load("FasterTransformer", verbose=True)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/paddlepaddle/paddlenlp/commit/521fd43191192a3a828b2ae2cd226e4264f99a91#diff-de114118d9425b8bcb85d62378ec66ff6233de45ee27b556a0626a20d8813432L56' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 11952039</div><div id='project'> Project Name: paddlepaddle/paddlenlp</div><div id='commit'> Commit Name: 521fd43191192a3a828b2ae2cd226e4264f99a91</div><div id='time'> Time: 2022-09-27</div><div id='author'> Author: 380185688@qq.com</div><div id='file'> File Name: paddlenlp/ops/faster_transformer/sample/mbart_inference.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: infer(1)</div><div id='n_method'> N Method Name: infer(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: paddlenlp/ops/faster_transformer/sample/mbart_inference.py</div><div id='n_file'> N File Name: paddlenlp/ops/faster_transformer/sample/mbart_inference.py</div><div id='m_start'> M Start Line: 56</div><div id='m_end'> M End Line: 90</div><div id='n_start'> N Start Line: 61</div><div id='n_end'> N End Line: 113</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        print("a:",a)
        print("b:",b)
        <a id="change">print("a+b:"</a>,c<a id="change">)</a>
        print("a-b:",d)

if __name__ == "__main__":
    unittest.main()</code></pre><h3>After Change</h3><pre><code class='java'>
        assert np.allclose(d.data,(a-b).data)
        dca, dcb = jt.grad(c,[a,b])
        dda, ddb = jt.grad(d,[a,b])
        one=<a id="change">np.ones(</a>a.shape<a id="change">)</a>
        mone<a id="change">=</a>one<a id="change">*-</a>1.0
        assert np.allclose(dca.data,one)
        assert np.allclose(dcb.data,one)
        assert np.allclose(dda.data,one)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jittor/jittor/commit/dfa1a4d999bdbcc6076face4e18e61ed8733fb1f#diff-3edbdfd85ef27006397098360826f1f3884d49ec245df2358534c544fa9581feL29' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 11952044</div><div id='project'> Project Name: jittor/jittor</div><div id='commit'> Commit Name: dfa1a4d999bdbcc6076face4e18e61ed8733fb1f</div><div id='time'> Time: 2020-07-06</div><div id='author'> Author: 471184555@qq.com</div><div id='file'> File Name: python/jittor/test/test_numpy_code_op.py</div><div id='m_class'> M Class Name: TestCodeOp</div><div id='n_method'> N Class Name: TestCodeOp</div><div id='m_method'> M Method Name: test(1)</div><div id='n_method'> N Method Name: test(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: python/jittor/test/test_numpy_code_op.py</div><div id='n_file'> N File Name: python/jittor/test/test_numpy_code_op.py</div><div id='m_start'> M Start Line: 30</div><div id='m_end'> M End Line: 44</div><div id='n_start'> N Start Line: 37</div><div id='n_end'> N End Line: 57</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        Renormalized message passing adj in `GCN`.
    
    &#47&#47 add self loop
    <a id="change">print("calculating the renormalized message passing adj, please ensure that self-loop has added to adj."</a><a id="change">)</a>
    adj         = sp.coo_matrix(adj)
    rowsum      = np.array(adj.sum(1))
    d_inv_sqrt  = np.power(rowsum, -0.5).flatten()
    d_inv_sqrt[np.isinf(d_inv_sqrt)] = 0.</code></pre><h3>After Change</h3><pre><code class='java'>
        Renormalized message passing adj in `GCN`.
    
    &#47&#47 add self loop
    adj<a id="change">         = </a>adj<a id="change"> + </a>np.diag(<a id="change">np.ones(</a>adj.shape[0]<a id="change">, dtype=np.float32)</a>)
    &#47&#47 print("calculating the renormalized message passing adj, please ensure that self-loop has added to adj.")
    adj         = sp.coo_matrix(adj)
    rowsum      = np.array(adj.sum(1))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/zezhishao/basicts/commit/e3e8cb23e964eebbd923558a975a1a09669379c7#diff-2a25514b9d2fc6eaba64246e5000c56d77ea6005a07e2055430b8474ded369caL67' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 11952041</div><div id='project'> Project Name: zezhishao/basicts</div><div id='commit'> Commit Name: e3e8cb23e964eebbd923558a975a1a09669379c7</div><div id='time'> Time: 2022-05-02</div><div id='author'> Author: 864453277@qq.com</div><div id='file'> File Name: basicts/utils/adjacent_matrix_norm.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: symmetric_message_passing_adj(1)</div><div id='n_method'> N Method Name: symmetric_message_passing_adj(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: basicts/utils/adjacent_matrix_norm.py</div><div id='n_file'> N File Name: basicts/utils/adjacent_matrix_norm.py</div><div id='m_start'> M Start Line: 84</div><div id='m_end'> M End Line: 90</div><div id='n_start'> N Start Line: 84</div><div id='n_end'> N End Line: 91</div><BR>