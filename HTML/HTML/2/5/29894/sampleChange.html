<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 \end{align}
        &#47&#47
        &#47&#47 for $i \in {1, 2, ..., \frac{d}{2}}$
        rx = (x * <a id="change">idx_theta2.cos()[:, None, None, :]</a>) + (neg_half_x * idx_theta2.sin()[:, None, None, :])

        &#47&#47
        return rx</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 \end{align}
        &#47&#47
        &#47&#47 for $i \in {1, 2, ..., \frac{d}{2}}$
        x_rope = (x_rope * self.cos_cached[:x.shape[0]]) + (neg_half_x * self.sin_cached[<a id="change">:x.shape[0]</a>])

        &#47&#47
        return torch.cat((x_rope, x_pass), dim=-1)</code></pre>