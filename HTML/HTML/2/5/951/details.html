<html><h3>Pattern ID :951
</h3><img src='4519244.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        for img_path in img_paths:
            new_train.append((img_path, pid, camid))

    trainloader<a id="change"> = </a><a id="change">DataLoader(
        </a>ImageDataset(new_train, transform=transform_train)<a id="change">,
        batch_size=args.train_batch, shuffle=True, num_workers=args.workers,
        pin_memory=pin_memory, drop_last=True,
    )</a>

    queryloader = DataLoader(
        VideoDataset(dataset.query, seq_len=args.seq_len, sample=&quotevenly&quot, transform=transform_test),
        batch_size=args.test_batch, shuffle=False, num_workers=args.workers,</code></pre><h3>After Change</h3><pre><code class='java'>
        print("Evaluate only")

        for name in args.target:
            <a id="change">print("Evaluating {} ...".format(</a>name<a id="change">)</a><a id="change">)</a>
            queryloader = testloader_dict[name][&quotquery&quot]
            galleryloader = testloader_dict[name][&quotgallery&quot]
            distmat = test(model, queryloader, galleryloader, args.pool, use_gpu, return_distmat=True)
        </code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/vlsomers/bpbreid/commit/2ecd8e57044c13adc4c105b2d58aa07697384590#diff-e6c0c833279ad43f0c76b2e4799c36ce85c9cbbcd1aeb2f6e0af3401a600792eL58' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4519244</div><div id='project'> Project Name: vlsomers/bpbreid</div><div id='commit'> Commit Name: 2ecd8e57044c13adc4c105b2d58aa07697384590</div><div id='time'> Time: 2018-11-07</div><div id='author'> Author: k.zhou@qmul.ac.uk</div><div id='file'> File Name: train_vidreid_xent.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: train_vidreid_xent.py</div><div id='n_file'> N File Name: train_vidreid_xent.py</div><div id='m_start'> M Start Line: 125</div><div id='m_end'> M End Line: 247</div><div id='n_start'> N Start Line: 58</div><div id='n_end'> N End Line: 163</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    train_labeled_loader = DataLoader(
        train_labeled_dataset, batch_size=args.batch_size[0], shuffle=(train_labeled_sampler is None),
        num_workers=args.workers, pin_memory=True, sampler=train_labeled_sampler)
    train_unlabeled_loader<a id="change"> = </a><a id="change">DataLoader(
        </a>train_unlabeled_dataset<a id="change">, batch_size=args.batch_size[0], shuffle=(train_unlabeled_sampler is None),
        num_workers=args.workers, pin_memory=True, sampler=train_unlabeled_sampler)</a>

    if args.phase == &quottest&quot:
        &#47&#47 resume from the latest checkpoint
        checkpoint = torch.load(logger.get_checkpoint_path(&quotbest&quot), map_location=&quotcpu&quot)</code></pre><h3>After Change</h3><pre><code class='java'>
                test_metric = tmp_test_metric
                shutil.copy(logger.get_checkpoint_path(&quotlatest&quot), logger.get_checkpoint_path(&quotbest&quot))
    print(&quotbest val performance: {:.3f}&quot.format(best_val_metric))
    <a id="change">print(&quottest performance: {:.3f}&quot.format(</a>test_metric<a id="change">)</a><a id="change">)</a>

    logger.close()
    writer.close()
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/thuml/transfer-learning-library/commit/a506d6956e5d8734b2bb14edda8df7eeac8d0896#diff-593fc8965d92066bfb4a87de6cf4bb1e1c1547ddc6f12e28e7673d1a6c320076L29' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4519253</div><div id='project'> Project Name: thuml/transfer-learning-library</div><div id='commit'> Commit Name: a506d6956e5d8734b2bb14edda8df7eeac8d0896</div><div id='time'> Time: 2022-03-17</div><div id='author'> Author: 3236488847@qq.com</div><div id='file'> File Name: examples/domain_adaptation/wilds_image_regression/erm.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(1)</div><div id='n_method'> N Method Name: main(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: examples/domain_adaptation/wilds_image_regression/erm.py</div><div id='n_file'> N File Name: examples/domain_adaptation/wilds_image_regression/erm.py</div><div id='m_start'> M Start Line: 84</div><div id='m_end'> M End Line: 177</div><div id='n_start'> N Start Line: 84</div><div id='n_end'> N End Line: 168</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        train_labeled_dataset, batch_size=args.batch_size[0], shuffle=(train_labeled_sampler is None),
        num_workers=args.workers, pin_memory=True, sampler=train_labeled_sampler
    )
    train_unlabeled_loader<a id="change"> = </a><a id="change">DataLoader(
        </a>train_unlabeled_dataset<a id="change">, batch_size=args.batch_size[1], shuffle=(train_labeled_sampler is None),
        num_workers=args.workers, pin_memory=True, sampler=train_unlabeled_sampler
    )</a>

    no_decay = [&quotbias&quot, &quotLayerNorm.weight&quot]
    params = [
        {&quotparams&quot: [p for n, p in model.named_parameters() if not any(nd in n for nd in no_decay)],</code></pre><h3>After Change</h3><pre><code class='java'>
            if is_best:
                test_metric = tmp_test_metric
                shutil.copy(logger.get_checkpoint_path(&quotlatest&quot), logger.get_checkpoint_path(&quotbest&quot))
    <a id="change">print(&quotbest val performance: {:.3f}&quot.format(</a>best_val_metric<a id="change">)</a><a id="change">)</a>
    print(&quottest performance: {:.3f}&quot.format(test_metric))

    logger.close()
    writer.close()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/thuml/transfer-learning-library/commit/a506d6956e5d8734b2bb14edda8df7eeac8d0896#diff-6f8e677bcd193ae95143866ab412fa3e530dcf76ed1ffee928046478d1be91c1L38' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4519245</div><div id='project'> Project Name: thuml/transfer-learning-library</div><div id='commit'> Commit Name: a506d6956e5d8734b2bb14edda8df7eeac8d0896</div><div id='time'> Time: 2022-03-17</div><div id='author'> Author: 3236488847@qq.com</div><div id='file'> File Name: examples/domain_adaptation/wilds_text/erm.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(1)</div><div id='n_method'> N Method Name: main(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: examples/domain_adaptation/wilds_text/erm.py</div><div id='n_file'> N File Name: examples/domain_adaptation/wilds_text/erm.py</div><div id='m_start'> M Start Line: 77</div><div id='m_end'> M End Line: 169</div><div id='n_start'> N Start Line: 34</div><div id='n_end'> N End Line: 162</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        pin_memory=pin_memory, drop_last=True,
    )

    queryloader<a id="change"> = </a><a id="change">DataLoader(
        </a>ImageDataset(dataset.query, transform=transform_test)<a id="change">,
        batch_size=args.test_batch, shuffle=False, num_workers=args.workers,
        pin_memory=pin_memory, drop_last=False,
    )</a>

    galleryloader = DataLoader(
        ImageDataset(dataset.gallery, transform=transform_test),
        batch_size=args.test_batch, shuffle=False, num_workers=args.workers,</code></pre><h3>After Change</h3><pre><code class='java'>
            print("==&gt; Test")
            
            for name in args.target:
                <a id="change">print("Evaluating {} ...".format(</a>name<a id="change">)</a><a id="change">)</a>
                queryloader = testloader_dict[name][&quotquery&quot]
                galleryloader = testloader_dict[name][&quotgallery&quot]
                rank1 = test(model, queryloader, galleryloader, use_gpu)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/vlsomers/bpbreid/commit/a96dd6b91631f43e3706a3e5ba6a090939f13036#diff-6ccf2248732c83e1d2f8243161a5b3c8d670eecf27610049e0d02319deb8eb69L116' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4519246</div><div id='project'> Project Name: vlsomers/bpbreid</div><div id='commit'> Commit Name: a96dd6b91631f43e3706a3e5ba6a090939f13036</div><div id='time'> Time: 2018-11-05</div><div id='author'> Author: k.zhou@qmul.ac.uk</div><div id='file'> File Name: train_imgreid_xent_htri.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: train_imgreid_xent_htri.py</div><div id='n_file'> N File Name: train_imgreid_xent_htri.py</div><div id='m_start'> M Start Line: 137</div><div id='m_end'> M End Line: 241</div><div id='n_start'> N Start Line: 134</div><div id='n_end'> N End Line: 224</div><BR>