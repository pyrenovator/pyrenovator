<html><h3>Pattern ID :7851
</h3><img src='28044841.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    inputs = generate_random_inputs(onnx_filepath, batch_size)
    input_names = get_input_names(onnx_filepath)
    output_names = get_output_names(onnx_filepath)
    inputs_dict = {name: value for name, value in <a id="change">zip(</a>input_names, inputs<a id="change">)</a>}

    &#47&#47 ONNXRuntime inference
    print("Executing model with ONNXRuntime...")</code></pre><h3>After Change</h3><pre><code class='java'>
    input_shapes = parse_input_shapes(args.input_shapes)

    if input_shapes:
        <a id="change">with </a><a id="change">override_onnx_input_shapes(onnx_filepath, input_shapes) as model_path:
            </a>inputs<a id="change"> = </a>generate_random_inputs(model_path, args.batch_size)
    else:
        inputs = generate_random_inputs(onnx_filepath, args.batch_size)
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 7</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/neuralmagic/deepsparse/commit/7ab2fe26872ac8846816c982500c13dd1c7b5aa1#diff-725a59cab66fa877a37d51328334acbdef453f8deb509127a8bf4d02017fce30L88' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28044841</div><div id='project'> Project Name: neuralmagic/deepsparse</div><div id='commit'> Commit Name: 7ab2fe26872ac8846816c982500c13dd1c7b5aa1</div><div id='time'> Time: 2022-04-06</div><div id='author'> Author: tyler@neuralmagic.com</div><div id='file'> File Name: examples/benchmark/check_correctness.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: examples/benchmark/check_correctness.py</div><div id='n_file'> N File Name: examples/benchmark/check_correctness.py</div><div id='m_start'> M Start Line: 88</div><div id='m_end'> M End Line: 106</div><div id='n_start'> N Start Line: 97</div><div id='n_end'> N End Line: 117</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    assert len(out_files) == len(json_files)

    for inp_file, out_file in <a id="change">zip(</a>json_files, out_files<a id="change">)</a>:
        assert out_file.name == inp_file.stem + ".json"

        serialized = out_file.read_text("utf-8")</code></pre><h3>After Change</h3><pre><code class='java'>

        assert len(out_files) == 1

        <a id="change">with </a><a id="change">out_files[0].open() as f:
            </a>data = json.load(f)
            uid<a id="change"> = </a>data["uid"]
            assert out_files[0].name == f"{uid}.json"

        serialized = out_files[0].read_text("utf-8")</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/bluebrain/search/commit/d6311d2b5721314c73b50113e8fa8b32d1071b84#diff-da91a8db5bd5aefc2816c4a998f575e8d23a63fb0133f0a30370518521469e79L23' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28044846</div><div id='project'> Project Name: bluebrain/search</div><div id='commit'> Commit Name: d6311d2b5721314c73b50113e8fa8b32d1071b84</div><div id='time'> Time: 2021-10-15</div><div id='author'> Author: pierre-alexandre.fonta@epfl.ch</div><div id='file'> File Name: tests/unit/entrypoint/database/test_parse.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_cord19_json(2)</div><div id='n_method'> N Method Name: test_cord19_json(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tests/unit/entrypoint/database/test_parse.py</div><div id='n_file'> N File Name: tests/unit/entrypoint/database/test_parse.py</div><div id='m_start'> M Start Line: 25</div><div id='m_end'> M End Line: 61</div><div id='n_start'> N Start Line: 77</div><div id='n_end'> N End Line: 109</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        self.vocab = list(set(concatenate_text.split()))

        for index, vocab in list(<a id="change">zip(</a>range(0, len(self.vocab)), self.vocab<a id="change">)</a>):
            self.vocab_dict[vocab] = index

        self.index_dd = np.array(list(map(lambda y: np.array(list(map(lambda x:</code></pre><h3>After Change</h3><pre><code class='java'>
        indices = []
        data = []
        vocabulary = {}
        <a id="change">with </a><a id="change">open(self.file_name, "r") as filino:
            </a>docs<a id="change"> = </a>filino.readlines()

        for d in docs:
            for term in d.split():</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/milanlproc/contextualized-topic-models/commit/06e8fbee8e3be72841f4aac15b1f43bd6821ffee#diff-813e19406d3b9c72a61d20ce9f3f2ed01d03dc520c0be9128b082189bd2fc617L47' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28044845</div><div id='project'> Project Name: milanlproc/contextualized-topic-models</div><div id='commit'> Commit Name: 06e8fbee8e3be72841f4aac15b1f43bd6821ffee</div><div id='time'> Time: 2020-07-30</div><div id='author'> Author: s.terragni4@campus.unimib.it</div><div id='file'> File Name: contextualized_topic_models/utils/data_preparation.py</div><div id='m_class'> M Class Name: TextHandler</div><div id='n_method'> N Class Name: TextHandler</div><div id='m_method'> M Method Name: prepare(1)</div><div id='n_method'> N Method Name: prepare(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: contextualized_topic_models/utils/data_preparation.py</div><div id='n_file'> N File Name: contextualized_topic_models/utils/data_preparation.py</div><div id='m_start'> M Start Line: 48</div><div id='m_end'> M End Line: 64</div><div id='n_start'> N Start Line: 51</div><div id='n_end'> N End Line: 68</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    inputs = generate_random_inputs(onnx_filepath, batch_size)
    input_names = get_input_names(onnx_filepath)
    output_names = get_output_names(onnx_filepath)
    inputs_dict = {name: value for name, value in <a id="change">zip(</a>input_names, inputs<a id="change">)</a>}

    &#47&#47 Benchmark ONNXRuntime
    print("Benchmarking model with ONNXRuntime...")</code></pre><h3>After Change</h3><pre><code class='java'>
    input_shapes = parse_input_shapes(args.input_shapes)

    if input_shapes:
        <a id="change">with </a><a id="change">override_onnx_input_shapes(onnx_filepath, input_shapes) as model_path:
            </a>inputs<a id="change"> = </a>generate_random_inputs(model_path, args.batch_size)
    else:
        inputs = generate_random_inputs(onnx_filepath, args.batch_size)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/neuralmagic/deepsparse/commit/00253f881a655c8b7d109bf4ccf9d91bd876f8ef#diff-008db714d9d1433cabaa5730af564166372a09dd7fe29d82db02f20b3c5c7fb2L111' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28044844</div><div id='project'> Project Name: neuralmagic/deepsparse</div><div id='commit'> Commit Name: 00253f881a655c8b7d109bf4ccf9d91bd876f8ef</div><div id='time'> Time: 2023-01-24</div><div id='author'> Author: michael@neuralmagic.com</div><div id='file'> File Name: examples/benchmark/run_benchmark.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: examples/benchmark/run_benchmark.py</div><div id='n_file'> N File Name: examples/benchmark/run_benchmark.py</div><div id='m_start'> M Start Line: 112</div><div id='m_end'> M End Line: 141</div><div id='n_start'> N Start Line: 125</div><div id='n_end'> N End Line: 159</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            pbar = tqdm.tqdm(unit=&quotimgs&quot, total=len(sample_ids))

        &#47&#47 download images
        for sample_id, filename in <a id="change">zip(</a>sample_ids, filenames<a id="change">)</a>:
            read_url = self._samples_api.get_sample_image_read_url_by_id(
                self.dataset_id, 
                sample_id,</code></pre><h3>After Change</h3><pre><code class='java'>
            &#47&#47 return whether the download was successful
            return success

        <a id="change">with </a><a id="change">ThreadPoolExecutor(max_workers=max_workers) as executor:
            </a>results<a id="change"> = </a>list(executor.map(
                lambda_, downloadables, chunksize=1))

        if not all(results):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/lightly-ai/lightly/commit/42a1a66d19d6f9962210e779d4114edef01d1767#diff-20cb7e92edbcbc524792c473cf5953f053759f900af1e1c1154405d0bde491ceL40' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28044834</div><div id='project'> Project Name: lightly-ai/lightly</div><div id='commit'> Commit Name: 42a1a66d19d6f9962210e779d4114edef01d1767</div><div id='time'> Time: 2022-07-27</div><div id='author'> Author: jeremy@lightly.ai</div><div id='file'> File Name: lightly/api/api_workflow_download_dataset.py</div><div id='m_class'> M Class Name: _DownloadDatasetMixin</div><div id='n_method'> N Class Name: _DownloadDatasetMixin</div><div id='m_method'> M Method Name: download_dataset(5)</div><div id='n_method'> N Method Name: download_dataset(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: lightly/api/api_workflow_download_dataset.py</div><div id='n_file'> N File Name: lightly/api/api_workflow_download_dataset.py</div><div id='m_start'> M Start Line: 86</div><div id='m_end'> M End Line: 108</div><div id='n_start'> N Start Line: 48</div><div id='n_end'> N End Line: 153</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    restored from the saved checkpoint.
  
  data = _read_file(path, pool_size=pool_size, buf_size=buf_size)
  keys, values = <a id="change">zip(
      </a>*<a id="change">list(np.load(io.BytesIO(data), allow_pickle=False).items()))</a>
  &#47&#47 NOTE: NumPy loses any bfloat16 dtypes when saving, so we recover them here.
  values = jax.tree_util.tree_map(_recover_bfloat16, values)
  if tree:
    treedef = jax.tree_util.tree_structure(tree)</code></pre><h3>After Change</h3><pre><code class='java'>
    file = io.BytesIO(_read_file(path, pool_size=pool_size, buf_size=buf_size))
  else:
    file = gfile.GFile(path, "rb")
  <a id="change">with </a><a id="change">np.load(file, allow_pickle=False) as data:
    </a>values<a id="change"> = </a>list(data.values())
    if not tree:
      keys = list(data.keys())
  file.close()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/google/uncertainty-baselines/commit/08b114c5fb473767ca9869e0aaca8625505b8199#diff-ee36af954e67262bbfeba3c29404a6cfa2c00d23c55ec31dde13ff067149c005L131' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28044833</div><div id='project'> Project Name: google/uncertainty-baselines</div><div id='commit'> Commit Name: 08b114c5fb473767ca9869e0aaca8625505b8199</div><div id='time'> Time: 2022-07-18</div><div id='author'> Author: dusenberrymw@google.com</div><div id='file'> File Name: baselines/jft/checkpoint_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: load_checkpoint(5)</div><div id='n_method'> N Method Name: load_checkpoint(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: baselines/jft/checkpoint_utils.py</div><div id='n_file'> N File Name: baselines/jft/checkpoint_utils.py</div><div id='m_start'> M Start Line: 150</div><div id='m_end'> M End Line: 152</div><div id='n_start'> N Start Line: 133</div><div id='n_end'> N End Line: 163</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    jejus = [jeju for _, jeju in seoul2jeju]
    X = InferInputsBuilder(tokenizer, config[&quotmax_length&quot])(srcs=jejus)
    tgt_ids = transformer.predict(X)
    for pred, ans in <a id="change">zip(</a>tgt_ids.tolist(), seouls<a id="change">)</a>:
        print(tokenizer.decode(pred), "|", ans)

</code></pre><h3>After Change</h3><pre><code class='java'>
    args = parser.parse_args()
    config = load_config()
    config.update(vars(args))
    <a id="change">with </a><a id="change">wandb.init(entity="eubinecto", project="dekorde") as run:
        </a>artifact<a id="change"> = </a>run.use_artifact("transformer:latest")
        artifact.checkout()
    transformer_ckpt, tokenizer_dir = transformer_paths()
    transformer = Transformer.load_from_checkpoint(transformer_ckpt)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/eubinecto/dekorde/commit/fd3b05ba0d98e727d7c58233ac0e8c0449890275#diff-239c9195f0b1188d5807fd9c603d9918e73ee42ade63e6f829ba093be9ee0f2fL8' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28044849</div><div id='project'> Project Name: eubinecto/dekorde</div><div id='commit'> Commit Name: fd3b05ba0d98e727d7c58233ac0e8c0449890275</div><div id='time'> Time: 2021-12-06</div><div id='author'> Author: eubinecto</div><div id='file'> File Name: main_predict.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: main_predict.py</div><div id='n_file'> N File Name: main_predict.py</div><div id='m_start'> M Start Line: 10</div><div id='m_end'> M End Line: 19</div><div id='n_start'> N Start Line: 11</div><div id='n_end'> N End Line: 27</div><BR>