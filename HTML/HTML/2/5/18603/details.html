<html><h3>Pattern ID :18603
</h3><img src='60756015.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        self._handler = server_handler

        self._LOGGER = <a id="change">logger(os.path.join("log"</a>, logger_path<a id="change">)</a>, logger_name<a id="change">)</a>
        self._LOGGER.info("Server initializes with ip address {}:{} and distributed backend {}".format(
            server_address[0], server_address[1], dist_backend))

        self.global_activate_epoch = 3  &#47&#47 global_round is global epochs in algorithm, for current test</code></pre><h3>After Change</h3><pre><code class='java'>
                             server_address=server_address,
                             dist_backend=dist_backend)

        self._LOGGER = logging<a id="change"> if logger is None</a><a id="change"> else </a>logger
        self._LOGGER.info(
            "Server initializes with ip address {}:{} and distributed backend {}"
            .format(server_address[0], server_address[1], dist_backend))</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/smilelab-fl/fedlab/commit/c902b4e340f47637f1ef8be07dd23c1d0cb1f22f#diff-846e3803606bd9e9a353f0a104d34ee2313532f2995f68e6fb0ead96e958f3ddL132' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60756015</div><div id='project'> Project Name: smilelab-fl/fedlab</div><div id='commit'> Commit Name: c902b4e340f47637f1ef8be07dd23c1d0cb1f22f</div><div id='time'> Time: 2021-06-11</div><div id='author'> Author: 928255708@qq.com</div><div id='file'> File Name: fedlab_core/server/topology.py</div><div id='m_class'> M Class Name: ServerAsynchronousTopology</div><div id='n_method'> N Class Name: ServerAsynchronousTopology</div><div id='m_method'> M Method Name: __init__(5)</div><div id='n_method'> N Method Name: __init__(6)</div><div id='m_parent_class'> M Parent Class: ServerBasicTopology</div><div id='n_parent_class'> N Parent Class: ServerBasicTopology</div><div id='m_file'> M File Name: fedlab_core/server/topology.py</div><div id='n_file'> N File Name: fedlab_core/server/topology.py</div><div id='m_start'> M Start Line: 132</div><div id='m_end'> M End Line: 139</div><div id='n_start'> N Start Line: 152</div><div id='n_end'> N End Line: 156</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 need a Queue to receive the updated model from each client, not useful?
        self.client_model_queue = Queue()

        self._LOGGER = <a id="change">logger(os.path.join("log"</a>, logger_path + ".txt"<a id="change">)</a>,
                              logger_name<a id="change">)</a>

    def on_receive(self, sender_rank, message_code, content_list):
        Define what parameter server does when receiving a single client&quots message
        </code></pre><h3>After Change</h3><pre><code class='java'>
    def __init__(self, model, client_num_in_total, cuda=False, logger=None):
        super(AsyncParameterServerHandler, self).__init__(model, cuda)

        self._LOGGER = logging<a id="change"> if logger is None</a><a id="change"> else </a>logger

        self.alpha = 0.5
        self.client_num_in_total = client_num_in_total</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/smilelab-fl/fedlab/commit/5a658dd01e8fe423d618603727b2c41d6fcd8957#diff-97e3982566422dfddf628d13c6e661cbece2e9ea3d31f29ac65c96c7e957b7e2L172' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60756014</div><div id='project'> Project Name: smilelab-fl/fedlab</div><div id='commit'> Commit Name: 5a658dd01e8fe423d618603727b2c41d6fcd8957</div><div id='time'> Time: 2021-06-14</div><div id='author'> Author: 928255708@qq.com</div><div id='file'> File Name: fedlab_core/server/handler.py</div><div id='m_class'> M Class Name: AsyncParameterServerHandler</div><div id='n_method'> N Class Name: AsyncParameterServerHandler</div><div id='m_method'> M Method Name: __init__(5)</div><div id='n_method'> N Method Name: __init__(6)</div><div id='m_parent_class'> M Parent Class: ParameterServerBackendHandler</div><div id='n_parent_class'> N Parent Class: ParameterServerBackendHandler</div><div id='m_file'> M File Name: fedlab_core/server/handler.py</div><div id='n_file'> N File Name: fedlab_core/server/handler.py</div><div id='m_start'> M Start Line: 177</div><div id='m_end'> M End Line: 192</div><div id='n_start'> N Start Line: 169</div><div id='n_end'> N End Line: 169</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        self._data_loader = data_loader

        self._LOGGER = <a id="change">logger(os.path.join("log"</a>, logger_file<a id="change">)</a>, logger_name<a id="change">)</a>

        if optimizer is None:
            self.optimizer = torch.optim.SGD(
                self._model.parameters(), lr=0.1, momentum=0.9)</code></pre><h3>After Change</h3><pre><code class='java'>

        self._data_loader = data_loader

        self._LOGGER = logging<a id="change"> if logger is not None</a><a id="change"> else </a>logger

        if optimizer is None:
            self.optimizer = torch.optim.SGD(</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/smilelab-fl/fedlab/commit/5a658dd01e8fe423d618603727b2c41d6fcd8957#diff-011240dfbaa7793da7c9f89f8e2b69ce5cc4a3c6a31847cecd5183d20cf9164fL57' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60756013</div><div id='project'> Project Name: smilelab-fl/fedlab</div><div id='commit'> Commit Name: 5a658dd01e8fe423d618603727b2c41d6fcd8957</div><div id='time'> Time: 2021-06-14</div><div id='author'> Author: 928255708@qq.com</div><div id='file'> File Name: fedlab_core/client/handler.py</div><div id='m_class'> M Class Name: ClientSGDHandler</div><div id='n_method'> N Class Name: ClientSGDHandler</div><div id='m_method'> M Method Name: __init__(7)</div><div id='n_method'> N Method Name: __init__(8)</div><div id='m_parent_class'> M Parent Class: ClientBackendHandler</div><div id='n_parent_class'> N Parent Class: ClientBackendHandler</div><div id='m_file'> M File Name: fedlab_core/client/handler.py</div><div id='n_file'> N File Name: fedlab_core/client/handler.py</div><div id='m_start'> M Start Line: 58</div><div id='m_end'> M End Line: 63</div><div id='n_start'> N Start Line: 63</div><div id='n_end'> N End Line: 63</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        self._handler = server_handler

        self._LOGGER = <a id="change">logger(os.path.join("log"</a>, logger_path<a id="change">)</a>, logger_name<a id="change">)</a>
        self._LOGGER.info("Server initializes with ip address {}:{} and distributed backend {}".format(
            server_address[0], server_address[1], dist_backend))

        self.global_round = 3  &#47&#47 for current test</code></pre><h3>After Change</h3><pre><code class='java'>
                             server_address=server_address,
                             dist_backend=dist_backend)
        
        self._LOGGER = logging<a id="change"> if logger is None</a><a id="change"> else </a>logger
        self._LOGGER.info(
            "Server initializes with ip address {}:{} and distributed backend {}"
            .format(server_address[0], server_address[1], dist_backend))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/smilelab-fl/fedlab/commit/c902b4e340f47637f1ef8be07dd23c1d0cb1f22f#diff-846e3803606bd9e9a353f0a104d34ee2313532f2995f68e6fb0ead96e958f3ddL65' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60756017</div><div id='project'> Project Name: smilelab-fl/fedlab</div><div id='commit'> Commit Name: c902b4e340f47637f1ef8be07dd23c1d0cb1f22f</div><div id='time'> Time: 2021-06-11</div><div id='author'> Author: 928255708@qq.com</div><div id='file'> File Name: fedlab_core/server/topology.py</div><div id='m_class'> M Class Name: ServerSynchronousTopology</div><div id='n_method'> N Class Name: ServerSynchronousTopology</div><div id='m_method'> M Method Name: __init__(5)</div><div id='n_method'> N Method Name: __init__(6)</div><div id='m_parent_class'> M Parent Class: ServerBasicTopology</div><div id='n_parent_class'> N Parent Class: ServerBasicTopology</div><div id='m_file'> M File Name: fedlab_core/server/topology.py</div><div id='n_file'> N File Name: fedlab_core/server/topology.py</div><div id='m_start'> M Start Line: 66</div><div id='m_end'> M End Line: 73</div><div id='n_start'> N Start Line: 77</div><div id='n_end'> N End Line: 77</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        self.client_num_per_round = max(
            1, int(self.select_ratio * self.client_num_in_total))

        self._LOGGER = <a id="change">logger(os.path.join("log"</a>, logger_path + ".txt"<a id="change">)</a>,
                              logger_name<a id="change">)</a>

        &#47&#47 client buffer
        self.client_buffer_cache = {}
        self.cache_cnt = 0</code></pre><h3>After Change</h3><pre><code class='java'>
                 logger=None):
        super(SyncParameterServerHandler, self).__init__(model, cuda)

        self._LOGGER = logging<a id="change"> if logger is None</a><a id="change"> else </a>logger

        if select_ratio &lt; 0.0 or select_ratio &gt; 1.0:
            raise ValueError("Invalid select ratio: {}".format(select_ratio))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/smilelab-fl/fedlab/commit/5a658dd01e8fe423d618603727b2c41d6fcd8957#diff-97e3982566422dfddf628d13c6e661cbece2e9ea3d31f29ac65c96c7e957b7e2L77' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60756016</div><div id='project'> Project Name: smilelab-fl/fedlab</div><div id='commit'> Commit Name: 5a658dd01e8fe423d618603727b2c41d6fcd8957</div><div id='time'> Time: 2021-06-14</div><div id='author'> Author: 928255708@qq.com</div><div id='file'> File Name: fedlab_core/server/handler.py</div><div id='m_class'> M Class Name: SyncParameterServerHandler</div><div id='n_method'> N Class Name: SyncParameterServerHandler</div><div id='m_method'> M Method Name: __init__(6)</div><div id='n_method'> N Method Name: __init__(7)</div><div id='m_parent_class'> M Parent Class: ParameterServerBackendHandler</div><div id='n_parent_class'> N Parent Class: ParameterServerBackendHandler</div><div id='m_file'> M File Name: fedlab_core/server/handler.py</div><div id='n_file'> N File Name: fedlab_core/server/handler.py</div><div id='m_start'> M Start Line: 83</div><div id='m_end'> M End Line: 99</div><div id='n_start'> N Start Line: 76</div><div id='n_end'> N End Line: 76</div><BR>