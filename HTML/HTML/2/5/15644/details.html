<html><h3>Pattern ID :15644
</h3><img src='52976424.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                order.remove(&quotnorm&quot)
            if not last_act and &quotact&quot in order:
                order.remove(&quotact&quot)
            order = <a id="change">tuple(</a>order<a id="change">)</a>

        module = LinearModule(dims[i], dims[i + 1], order=order, **_kwargs)
        layers.append(module)
</code></pre><h3>After Change</h3><pre><code class='java'>
        if i == len(dims) - 2:
            _kwargs[&quotorder&quot] = tuple(
                o for o in _kwargs.get(&quotorder&quot, (&quotlinear&quot, &quotnorm&quot, &quotact&quot))
                if <a id="change">(o == &quotlinear&quot or (o == &quotnorm&quot and last_norm) or (
                    o == &quotact&quot and last_act))</a>)

        module = LinearModule(dims[i], dims[i + 1], **_kwargs)
        layers.append(module)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/yeliudev/nncore/commit/645c00cf1a43c46adf5be83891f2fbe02aa509df#diff-cb0dd55027376f0ca9dbbcafbc558af7f25adc867f85e7310f64404fa7d4b5a8L82' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 52976424</div><div id='project'> Project Name: yeliudev/nncore</div><div id='commit'> Commit Name: 645c00cf1a43c46adf5be83891f2fbe02aa509df</div><div id='time'> Time: 2021-11-02</div><div id='author'> Author: yeliudev@outlook.com</div><div id='file'> File Name: nncore/nn/modules/linear.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: build_linear_modules(3)</div><div id='n_method'> N Method Name: build_linear_modules(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: nncore/nn/modules/linear.py</div><div id='n_file'> N File Name: nncore/nn/modules/linear.py</div><div id='m_start'> M Start Line: 82</div><div id='m_end'> M End Line: 120</div><div id='n_start'> N Start Line: 97</div><div id='n_end'> N End Line: 110</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    loo_scores = []
    for i in range(len(tokens)):
      cf = self._create_cf(example, input_spec, input_field, tokens,
                           <a id="change">tuple(</a>[i]<a id="change">)</a>)
      cf_output = list(model.predict([cf]))[0]
      loo_scores.append(cf_utils.prediction_difference(
          cf_output, orig_output, output_spec, pred_key))</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47 Returns a list of triples: field, token_idx and leave-one-out score.
    ret = []
    for field in input_spec.keys():
      <a id="change">if field not in example</a><a id="change"> or field not in fields_to_ablate</a>:
        continue
      tokens = self._get_tokens(example, input_spec, field)
      cfs = [self._create_cf(example, input_spec, [(field, i)])</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/pair-code/lit/commit/516b274b260c1c04df6094fb554352edaa3139c2#diff-4d936c3176400333a8e4615f751691d10bc26af10dd1c0df7a5bbec5638a50b0L149' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 52976427</div><div id='project'> Project Name: pair-code/lit</div><div id='commit'> Commit Name: 516b274b260c1c04df6094fb554352edaa3139c2</div><div id='time'> Time: 2021-07-12</div><div id='author'> Author: ataly@google.com</div><div id='file'> File Name: lit_nlp/components/ablation_flip.py</div><div id='m_class'> M Class Name: AblationFlip</div><div id='n_method'> N Class Name: AblationFlip</div><div id='m_method'> M Method Name: _generate_leave_one_out_ablation_score(8)</div><div id='n_method'> N Method Name: _generate_leave_one_out_ablation_score(9)</div><div id='m_parent_class'> M Parent Class: lit_components.Generator</div><div id='n_parent_class'> N Parent Class: lit_components.Generator</div><div id='m_file'> M File Name: lit_nlp/components/ablation_flip.py</div><div id='n_file'> N File Name: lit_nlp/components/ablation_flip.py</div><div id='m_start'> M Start Line: 157</div><div id='m_end'> M End Line: 167</div><div id='n_start'> N Start Line: 181</div><div id='n_end'> N End Line: 193</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                order.remove(&quotnorm&quot)
            if not last_act and &quotact&quot in order:
                order.remove(&quotact&quot)
            order = <a id="change">tuple(</a>order<a id="change">)</a>

            _cfg = _kwargs.get(&quotmsg_pass_cfg&quot)
            if _cfg is not None and _cfg[&quottype&quot] == &quotGAT&quot:
                _kwargs[&quotconcat&quot] = False</code></pre><h3>After Change</h3><pre><code class='java'>
        if i == len(dims) - 2:
            _kwargs[&quotorder&quot] = tuple(
                o for o in _kwargs.get(&quotorder&quot, (&quotlinear&quot, &quotnorm&quot, &quotact&quot))
                if <a id="change">(o == &quotlinear&quot or (o == &quotnorm&quot and last_norm) or (
                    o == &quotact&quot and last_act))</a>)

            _cfg = _kwargs.get(&quotmsg_pass_cfg&quot)
            if _cfg is not None and _cfg[&quottype&quot] == &quotGAT&quot:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/yeliudev/nncore/commit/645c00cf1a43c46adf5be83891f2fbe02aa509df#diff-efe9d6fcfc34d0969d4d4f8883a5dfd58bc9de208bb893c9d9b2993cddfe14f5L98' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 52976429</div><div id='project'> Project Name: yeliudev/nncore</div><div id='commit'> Commit Name: 645c00cf1a43c46adf5be83891f2fbe02aa509df</div><div id='time'> Time: 2021-11-02</div><div id='author'> Author: yeliudev@outlook.com</div><div id='file'> File Name: nncore/nn/modules/msg_pass.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: build_msg_pass_modules(3)</div><div id='n_method'> N Method Name: build_msg_pass_modules(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: nncore/nn/modules/msg_pass.py</div><div id='n_file'> N File Name: nncore/nn/modules/msg_pass.py</div><div id='m_start'> M Start Line: 101</div><div id='m_end'> M End Line: 137</div><div id='n_start'> N Start Line: 116</div><div id='n_end'> N End Line: 131</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            else:
                return None

        new_state = <a id="change">tuple(</a>map(reorder_state, cached_state)<a id="change">)</a>
        utils.set_incremental_state(self, incremental_state, &quotcached_state&quot, new_state)

    def max_positions(self):
        Maximum output length supported by the decoder.</code></pre><h3>After Change</h3><pre><code class='java'>
        return [state_i.index_select(0, new_order) for state_i in state]

    def reorder_incremental_state(self, incremental_state: Optional[Dict[str, Dict[str, Optional[Tensor]]]], new_order):
        <a id="change">if incremental_state is None</a><a id="change"> or len(incremental_state) == 0</a>:
            return
        prev_hiddens, prev_cells, input_feed = self.get_cached_state(incremental_state)
        cached_state = (prev_hiddens, prev_cells, [input_feed])</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/kssteven418/i-bert/commit/57526c63433c0b1c997fc91c0881867532567266#diff-6ce7c0d4f0fb1f8f34940039a8bb42a6d902a8894dd18517bee43dac3fc09971L498' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 52976420</div><div id='project'> Project Name: kssteven418/i-bert</div><div id='commit'> Commit Name: 57526c63433c0b1c997fc91c0881867532567266</div><div id='time'> Time: 2020-04-16</div><div id='author'> Author: xfrui@fb.com</div><div id='file'> File Name: fairseq/models/lstm.py</div><div id='m_class'> M Class Name: LSTMDecoder</div><div id='n_method'> N Class Name: LSTMDecoder</div><div id='m_method'> M Method Name: reorder_incremental_state(3)</div><div id='n_method'> N Method Name: reorder_incremental_state(3)</div><div id='m_parent_class'> M Parent Class: FairseqIncrementalDecoder</div><div id='n_parent_class'> N Parent Class: FairseqIncrementalDecoder</div><div id='m_file'> M File Name: fairseq/models/lstm.py</div><div id='n_file'> N File Name: fairseq/models/lstm.py</div><div id='m_start'> M Start Line: 498</div><div id='m_end'> M End Line: 513</div><div id='n_start'> N Start Line: 538</div><div id='n_end'> N End Line: 550</div><BR>