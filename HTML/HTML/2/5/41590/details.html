<html><h3>Pattern ID :41590
</h3><img src='116903956.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>


def rand_translation(x, ratio=(1, 8)):
    B<a id="change">, H, W</a> = tf.shape(x)[0], tf.shape(x)[1], tf.shape(x)[2]
    translation_x = tf.random.uniform([B, 1], -(W * ratio[0] // ratio[1]), (W * ratio[0] // ratio[1]) + 1, dtype=tf.int32)
    translation_y = tf.random.uniform([B, 1], -(H * ratio[0] // ratio[1]), (H * ratio[0] // ratio[1]) + 1, dtype=tf.int32)
    grid_x = tf.clip_by_value(tf.expand_dims(tf.range(W, dtype=tf.int32), 0) + translation_x + 1, 0, W + 1)</code></pre><h3>After Change</h3><pre><code class='java'>
def rand_translation(x, ratio=0.125):
    batch_size = tf.shape(x)[0]
    image_size = tf.shape(x)[1:3]
    shift<a id="change"> = </a>tf.cast(<a id="change">tf.cast(image_size, tf.float32) * ratio + 0.5</a>, tf.int32)
    translation_x = tf.random.uniform([batch_size, 1], -shift[0], shift[0] + 1, dtype=tf.int32)
    translation_y = tf.random.uniform([batch_size, 1], -shift[1], shift[1] + 1, dtype=tf.int32)
    grid_x = tf.clip_by_value(tf.expand_dims(tf.range(image_size[0], dtype=tf.int32), 0) + translation_x + 1, 0, image_size[0] + 1)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/mit-han-lab/data-efficient-gans/commit/96d6d871bf47d8dd3d280b77a5c3a01c674a7acd#diff-9b2f8ed36eb5d0b4386adda30a7118adc7bb2b244e6714cd6b9507f7761b04abL41' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 116903956</div><div id='project'> Project Name: mit-han-lab/data-efficient-gans</div><div id='commit'> Commit Name: 96d6d871bf47d8dd3d280b77a5c3a01c674a7acd</div><div id='time'> Time: 2020-07-01</div><div id='author'> Author: zsyzzsoft@gmail.com</div><div id='file'> File Name: DiffAugment-stylegan2/DiffAugment_tf.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: rand_translation(2)</div><div id='n_method'> N Method Name: rand_translation(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: DiffAugment-stylegan2/DiffAugment_tf.py</div><div id='n_file'> N File Name: DiffAugment-stylegan2/DiffAugment_tf.py</div><div id='m_start'> M Start Line: 41</div><div id='m_end'> M End Line: 47</div><div id='n_start'> N Start Line: 41</div><div id='n_end'> N End Line: 49</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            tmp = complex_mult(coef.unsqueeze(0), kdat, dim=1)
            for bind in range(griddat.shape[0]):
                for riind in range(griddat.shape[1]):
                    griddat[bind<a id="change">, riind</a>].index_put_(
                        tuple(arr_ind.unsqueeze(0)),
                        tmp[bind, riind],
                        accumulate=True</code></pre><h3>After Change</h3><pre><code class='java'>
    centers = tf.cast(tf.floor(numpoints * L / 2), int_type)

    &#47&#47 offset from k-space to first coef loc
    kofflist<a id="change"> = 1</a><a id="change"> + \
        </a><a id="change">tf.cast(</a>tf.floor(tm - numpoints[:, None] / 2.0), int_type<a id="change">)</a>

    &#47&#47 initialize output array
    griddat = tf.zeros(
        shape=(kdat.shape[0], 2, tf.reduce_prod(dims)),</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/zaccharieramzi/tfkbnufft/commit/e1123a8893ee7aeee9593a67d2151f8d860f384a#diff-9f6c80acef016f710c93669e2f4412dd11f8b0b6df0906e13e939992168a3b6dL146' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 116903954</div><div id='project'> Project Name: zaccharieramzi/tfkbnufft</div><div id='commit'> Commit Name: e1123a8893ee7aeee9593a67d2151f8d860f384a</div><div id='time'> Time: 2020-03-01</div><div id='author'> Author: zaccharie.ramzi@gmail.com</div><div id='file'> File Name: tfkbnufft/nufft/interp_functions.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: run_interp_back(3)</div><div id='n_method'> N Method Name: run_interp_back(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tfkbnufft/nufft/interp_functions.py</div><div id='n_file'> N File Name: tfkbnufft/nufft/interp_functions.py</div><div id='m_start'> M Start Line: 160</div><div id='m_end'> M End Line: 205</div><div id='n_start'> N Start Line: 161</div><div id='n_end'> N End Line: 190</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def rand_translation(x, ratio=(1, 8)):
    B<a id="change">, H, W</a> = tf.shape(x)[0], tf.shape(x)[1], tf.shape(x)[2]
    translation_x = tf.random.uniform([B, 1], -(W * ratio[0] // ratio[1]), (W * ratio[0] // ratio[1]) + 1, dtype=tf.int32)
    translation_y = tf.random.uniform([B, 1], -(H * ratio[0] // ratio[1]), (H * ratio[0] // ratio[1]) + 1, dtype=tf.int32)
    grid_x = tf.clip_by_value(tf.expand_dims(tf.range(W, dtype=tf.int32), 0) + translation_x + 1, 0, W + 1)</code></pre><h3>After Change</h3><pre><code class='java'>
def rand_translation(x, ratio=0.125):
    batch_size = tf.shape(x)[0]
    image_size = tf.shape(x)[1:3]
    shift<a id="change"> = </a>tf.cast(<a id="change">tf.cast(image_size, tf.float32) * ratio + 0.5</a>, tf.int32)
    translation_x = tf.random.uniform([batch_size, 1], -shift[0], shift[0] + 1, dtype=tf.int32)
    translation_y = tf.random.uniform([batch_size, 1], -shift[1], shift[1] + 1, dtype=tf.int32)
    grid_x = tf.clip_by_value(tf.expand_dims(tf.range(image_size[0], dtype=tf.int32), 0) + translation_x + 1, 0, image_size[0] + 1)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/mit-han-lab/data-efficient-gans/commit/96d6d871bf47d8dd3d280b77a5c3a01c674a7acd#diff-28ebcd161082c78a65acc309e5faccee2521dd684f1f97794d78a3fb29f2c891L40' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 116903953</div><div id='project'> Project Name: mit-han-lab/data-efficient-gans</div><div id='commit'> Commit Name: 96d6d871bf47d8dd3d280b77a5c3a01c674a7acd</div><div id='time'> Time: 2020-07-01</div><div id='author'> Author: zsyzzsoft@gmail.com</div><div id='file'> File Name: DiffAugment_tf.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: rand_translation(2)</div><div id='n_method'> N Method Name: rand_translation(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: DiffAugment_tf.py</div><div id='n_file'> N File Name: DiffAugment_tf.py</div><div id='m_start'> M Start Line: 41</div><div id='m_end'> M End Line: 47</div><div id='n_start'> N Start Line: 41</div><div id='n_end'> N End Line: 49</div><BR>