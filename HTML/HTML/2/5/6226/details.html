<html><h3>Pattern ID :6226
</h3><img src='21628536.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                    y_pred_test[current_rel] = predictions.view(-1).long()
                else:
                    num_skipped = len(test_spo_all[test_spo_all[:, 1] == r])
                    <a id="change">print(
                        </a>f"Relation {r} not in valid data;",
                        <a id="change">f"skipping {num_skipped} test instances"</a><a id="change">
                    )</a>

            &#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47
            &#47&#47                                end credits                               &#47&#47
            &#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47</code></pre><h3>After Change</h3><pre><code class='java'>
            &#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47
            REL_KEY = -1
            thresholds = {r: -float("inf") for r in range(dataset.num_relations())}
            thresholds[REL_KEY] = -<a id="change">float("inf"</a><a id="change">)</a>

            for r in valid_relations:  &#47&#47 set a threshold for each relation
                current_rel = valid_spo_all[:, 1] == r
                threshold = get_threshold(X_valid[current_rel], y_valid[current_rel])
                thresholds[r.item()] = threshold

                predictions = X_valid[current_rel] &gt;= threshold
                y_pred_valid[current_rel] = predictions.view(-1).long()

            &#47&#47 also set a global threshold for relations unseen in valid set
            thresholds[REL_KEY] = get_threshold(X_valid, y_valid)

            for r in test_relations:  &#47&#47 get predictions based on validation thresholds
                key = r.item() if r.item() in thresholds else REL_KEY
                threshold<a id="change"> = </a>thresholds[key]

                current_rel = test_spo_all[:, 1] == r
                predictions = X_test[current_rel] &gt;= threshold</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/tsafavi/codex/commit/c95e36e54a106a4920017ba8aeb86d8841170921#diff-63cb8341b2788ac17860a4b44bf2e5dfa952838e7a342922b0840c00a2e20ae7L170' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 21628536</div><div id='project'> Project Name: tsafavi/codex</div><div id='commit'> Commit Name: c95e36e54a106a4920017ba8aeb86d8841170921</div><div id='time'> Time: 2020-07-23</div><div id='author'> Author: tsafavi@umich.edu</div><div id='file'> File Name: scripts/tc.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: scripts/tc.py</div><div id='n_file'> N File Name: scripts/tc.py</div><div id='m_start'> M Start Line: 170</div><div id='m_end'> M End Line: 232</div><div id='n_start'> N Start Line: 200</div><div id='n_end'> N End Line: 235</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        correct, tot = eval(model, dev, device)

        <a id="change">print(f&quotEpoch &#47&#47{iteration} accuracy = {correct / tot}&quot</a><a id="change">)</a>


def eval(model, test, device):
    model.eval()</code></pre><h3>After Change</h3><pre><code class='java'>

    model.to(device)

    best_score<a id="change"> = </a><a id="change">float(&quot-inf&quot</a><a id="change">)</a>
    best_model = None

    for iteration in tqdm(range(max_iterations)):
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tiagomantunes/karen/commit/dab4820888f43a9709b142847544e65cdfeb7f56#diff-81b53beb0622f06b4d0bc961e5bb5bed36c5cb3828666638fe241d38d4ef5b00L6' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 21628528</div><div id='project'> Project Name: tiagomantunes/karen</div><div id='commit'> Commit Name: dab4820888f43a9709b142847544e65cdfeb7f56</div><div id='time'> Time: 2021-05-21</div><div id='author'> Author: tiago.melo.antunes@gmail.com</div><div id='file'> File Name: framework/training.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(8)</div><div id='n_method'> N Method Name: train(8)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: framework/training.py</div><div id='n_file'> N File Name: framework/training.py</div><div id='m_start'> M Start Line: 65</div><div id='m_end'> M End Line: 65</div><div id='n_start'> N Start Line: 25</div><div id='n_end'> N End Line: 84</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            LOG.debug(&quotNo param in pre-trained model %s. %s&quot, k, msg)
            state_dict[k] = model_state_dict[k]  &#47&#47 append missing params
    model.load_state_dict(state_dict, strict=False)
    <a id="change">print(&quotNetwork weights have been resumed from checkpoint.&quot</a><a id="change">)</a>

    &#47&#47 resume optimizer parameters
    if optimizer is not None and resume_optimizer:
        if &quotoptimizer_state_dict&quot in checkpoint:</code></pre><h3>After Change</h3><pre><code class='java'>
    

    start_epoch = 0
    start_loss<a id="change"> = </a><a id="change">float(&quotinf&quot</a><a id="change">)</a>
    if not os.path.isfile(ckpt_path):
        print(f&quotWARRRING!!! \t Current checkpoint file {ckpt_path} DOSE NOT exist!!&quot)
        print("&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47 No pre-trained parameters are loaded! &#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47\n"
              "&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47 Please make sure you initialize the model randomly! &#47&#47&#47&#47&#47&#47&#47&#47&#47&#47")</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hellojialee/offsetguided/commit/ed8f8bbd9d6c8fd755ab5313d84c8e395b7d5adc#diff-0b12045fcd8e12d17d1ed4983b2388873388d6b68c85aaca0218fa502d736c26L11' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 21628535</div><div id='project'> Project Name: hellojialee/offsetguided</div><div id='commit'> Commit Name: ed8f8bbd9d6c8fd755ab5313d84c8e395b7d5adc</div><div id='time'> Time: 2020-06-30</div><div id='author'> Author: ustclijia@gmail.com</div><div id='file'> File Name: models/networks.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: load_model(6)</div><div id='n_method'> N Method Name: load_model(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: models/networks.py</div><div id='n_file'> N File Name: models/networks.py</div><div id='m_start'> M Start Line: 74</div><div id='m_end'> M End Line: 96</div><div id='n_start'> N Start Line: 26</div><div id='n_end'> N End Line: 103</div><BR>