<html><h3>Pattern ID :39130
</h3><img src='111334450.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

    for n in [adata.n_obs] + [200_000, 400_000, 800_000, 1_600_000, 3_200_000, 6_400_000]:
        if n &gt; adata.n_obs:
            sampling_strategy<a id="change"> = </a><a id="change">dict(</a>Counter(np.random.choice(adata.obs.cell_type, n))<a id="change">)</a>
            sm = SMOTE(sampling_strategy=sampling_strategy, random_state=42)
            X, cell_type = sm.fit_resample(adata.X, adata.obs.cell_type.values)

            adata = AnnData(X=X, var=adata.var)</code></pre><h3>After Change</h3><pre><code class='java'>

    times, n_samples = [], []

    correction_mode<a id="change"> = </a><a id="change">config.project.get("batch_key"</a><a id="change">)</a> is not None

    for n in [adata.n_obs] + [200_000, 400_000, 800_000, 1_600_000, 3_200_000, 6_400_000]:
        if n &gt; adata.n_obs:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/mics-lab/scyan/commit/fbd842b4b023412f923e5eb152dc09b27d2f29e5#diff-d2c31b1d496055c234f94967ee0d283e63f44ca2768d1cba32028ef0142314b6L30' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111334450</div><div id='project'> Project Name: mics-lab/scyan</div><div id='commit'> Commit Name: fbd842b4b023412f923e5eb152dc09b27d2f29e5</div><div id='time'> Time: 2022-07-11</div><div id='author'> Author: quentin.blampey@student.ecp.fr</div><div id='file'> File Name: scripts/timing.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(1)</div><div id='n_method'> N Method Name: main(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: scripts/timing.py</div><div id='n_file'> N File Name: scripts/timing.py</div><div id='m_start'> M Start Line: 34</div><div id='m_end'> M End Line: 41</div><div id='n_start'> N Start Line: 30</div><div id='n_end'> N End Line: 34</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                    and resource_message.cluster_full):
                &#47&#47 Aggregate this flag across all batches.
                cluster_full = True
            resource_load<a id="change"> = </a><a id="change">dict(</a>resource_message.resource_load<a id="change">)</a>
            total_resources = dict(resource_message.resources_total)
            available_resources = dict(resource_message.resources_available)

            use_node_id_as_ip = (self.cluster_scaler is not None</code></pre><h3>After Change</h3><pre><code class='java'>
        cluster_full = False
        for resource_message in resources_usage_batch.batch:
            node_id = resource_message.get(&quotnode_id&quot)
            last_heartbeat_time<a id="change"> = </a><a id="change">resource_message.get(&quotlast_heartbeat_time&quot</a><a id="change">)</a>
            &#47&#47 Generate node type config based on reported node list.

            if (hasattr(resource_message, "cluster_full")
                    and resource_message.get(&quotcluster_full&quot)):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/oap-project/cloudtik/commit/a8a93be1b52b31f3678be933af79aa8ed00cce2a#diff-9eb09cc56fb27f7e9921ab61ebf206b2451029cd2e7142e91bf0a2f471262d0fL133' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111334451</div><div id='project'> Project Name: oap-project/cloudtik</div><div id='commit'> Commit Name: a8a93be1b52b31f3678be933af79aa8ed00cce2a</div><div id='time'> Time: 2022-02-20</div><div id='author'> Author: Qing.Yao@intel.com</div><div id='file'> File Name: python/cloudtik/core/_private/service/cloudtik_cluster_coordinator.py</div><div id='m_class'> M Class Name: ClusterCoordinator</div><div id='n_method'> N Class Name: ClusterCoordinator</div><div id='m_method'> M Method Name: update_load_metrics(1)</div><div id='n_method'> N Method Name: update_load_metrics(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: python/cloudtik/core/_private/service/cloudtik_cluster_coordinator.py</div><div id='n_file'> N File Name: python/cloudtik/core/_private/service/cloudtik_cluster_coordinator.py</div><div id='m_start'> M Start Line: 144</div><div id='m_end'> M End Line: 171</div><div id='n_start'> N Start Line: 145</div><div id='n_end'> N End Line: 176</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    BASE_DATASET_PATH: Optional[str] = None

    def __init__(self, **kwargs):
        builder_kwargs<a id="change"> = </a><a id="change">dict(</a>kwargs<a id="change">)</a>
        builder_kwargs.pop("hash", None)
        builder_kwargs.pop("base_path", None)
        builder_kwargs.pop("config_name", None)
</code></pre><h3>After Change</h3><pre><code class='java'>
            base_dataset_kwargs = base_dataset_kwargs or {}
            base_builder_kwargs: Dict[str, Any] = {}

            config_name<a id="change"> = </a><a id="change">kwargs.get("config_name"</a>, None<a id="change">)</a>

            &#47&#47 get base config kwargs from mapping
            if self.BASE_CONFIG_KWARGS_DICT is not None:
                if config_name in self.BASE_CONFIG_KWARGS_DICT:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/christophalt/pytorch-ie/commit/371e90c6638c85521d9d6ea84fff44883710932d#diff-917add69c9441cd1f7f79c984b5e66b6838ecaade7e8c1a577b914f3c86e97ddL16' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111334448</div><div id='project'> Project Name: christophalt/pytorch-ie</div><div id='commit'> Commit Name: 371e90c6638c85521d9d6ea84fff44883710932d</div><div id='time'> Time: 2022-08-21</div><div id='author'> Author: ArneBinder@users.noreply.github.com</div><div id='file'> File Name: src/pytorch_ie/data/builder.py</div><div id='m_class'> M Class Name: GeneratorBasedBuilder</div><div id='n_method'> N Class Name: GeneratorBasedBuilder</div><div id='m_method'> M Method Name: __init__(2)</div><div id='n_method'> N Method Name: __init__(1)</div><div id='m_parent_class'> M Parent Class: datasets.builder.GeneratorBasedBuilder</div><div id='n_parent_class'> N Parent Class: datasets.builder.GeneratorBasedBuilder</div><div id='m_file'> M File Name: src/pytorch_ie/data/builder.py</div><div id='n_file'> N File Name: src/pytorch_ie/data/builder.py</div><div id='m_start'> M Start Line: 16</div><div id='m_end'> M End Line: 29</div><div id='n_start'> N Start Line: 25</div><div id='n_end'> N End Line: 54</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            if with_metrics:
                &#47&#47 calculate metrics
                for name, opt_ in self.opt[&quotval&quot][&quotmetrics&quot].items():
                    metric_data<a id="change"> = </a><a id="change">dict(img1=sr_img, img2=gt_img)</a>
                    self.metric_results[name] += calculate_metric(metric_data, opt_)
            pbar.update(1)
            pbar.set_description(f&quotTest {img_name}&quot)
        pbar.close()</code></pre><h3>After Change</h3><pre><code class='java'>
    def nondist_validation(self, dataloader, current_iter, tb_logger, save_img):
        dataset_name = dataloader.dataset.opt[&quotname&quot]
        with_metrics = self.opt[&quotval&quot].get(&quotmetrics&quot) is not None
        use_pbar<a id="change"> = </a><a id="change">self.opt[&quotval&quot].get(&quotpbar&quot</a>, False<a id="change">)</a>

        if with_metrics:
            if not hasattr(self, &quotmetric_results&quot):  &#47&#47 only execute in the first run
                self.metric_results = {metric: 0 for metric in self.opt[&quotval&quot][&quotmetrics&quot].keys()}</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tencentarc/gfpgan/commit/be73d6d9a4d95e6a9684163a5e42bfda1990714e#diff-5daf7e98cd7f7390fdee4edef544bedb73a37e200951b07e5dbfde7f408911f0L485' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111334452</div><div id='project'> Project Name: tencentarc/gfpgan</div><div id='commit'> Commit Name: be73d6d9a4d95e6a9684163a5e42bfda1990714e</div><div id='time'> Time: 2021-11-27</div><div id='author'> Author: wxt1994@126.com</div><div id='file'> File Name: gfpgan/models/gfpgan_model.py</div><div id='m_class'> M Class Name: GFPGANModel</div><div id='n_method'> N Class Name: GFPGANModel</div><div id='m_method'> M Method Name: nondist_validation(5)</div><div id='n_method'> N Method Name: nondist_validation(5)</div><div id='m_parent_class'> M Parent Class: BaseModel</div><div id='n_parent_class'> N Parent Class: BaseModel</div><div id='m_file'> M File Name: gfpgan/models/gfpgan_model.py</div><div id='n_file'> N File Name: gfpgan/models/gfpgan_model.py</div><div id='m_start'> M Start Line: 487</div><div id='m_end'> M End Line: 529</div><div id='n_start'> N Start Line: 491</div><div id='n_end'> N End Line: 551</div><BR>