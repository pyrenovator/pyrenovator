<html><h3>Pattern ID :2478
</h3><img src='10460767.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

def test_s3_lifecycle(monkeypatch: monkeypatch.MonkeyPatch) -&gt; None:
    monkeypatch.setattr("boto3.client", s3.s3_client)
    manager = <a id="change">tensorboard.build(test_util.get_dummy_env()</a>, default_conf<a id="change">)</a>
    assert isinstance(manager, tensorboard.S3TensorboardManager)

    manager.sync()
    expected = (</code></pre><h3>After Change</h3><pre><code class='java'>

def test_s3_lifecycle(monkeypatch: monkeypatch.MonkeyPatch) -&gt; None:
    monkeypatch.setattr("boto3.client", s3.s3_client)
    env = <a id="change">test_util.get_dummy_env()</a>
    manager<a id="change"> = </a><a id="change">tensorboard.build(
        </a>env.det_cluster_id, env.det_experiment_id, env.det_trial_id, default_conf<a id="change">
    )</a>
    assert isinstance(manager, tensorboard.S3TensorboardManager)

    manager.sync()
    expected = (</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 7</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/determined-ai/determined/commit/aefd9e397b4d50a8fcef9c507582c78452d47865#diff-740f5b00df6a3aedb0124c94c644b65b571c3c8141d3a38a88a16e89da60aa83L39' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 10460767</div><div id='project'> Project Name: determined-ai/determined</div><div id='commit'> Commit Name: aefd9e397b4d50a8fcef9c507582c78452d47865</div><div id='time'> Time: 2021-03-18</div><div id='author'> Author: bradlaney@determined.ai</div><div id='file'> File Name: harness/tests/tensorboard/test_s3.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_s3_lifecycle(1)</div><div id='n_method'> N Method Name: test_s3_lifecycle(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: harness/tests/tensorboard/test_s3.py</div><div id='n_file'> N File Name: harness/tests/tensorboard/test_s3.py</div><div id='m_start'> M Start Line: 39</div><div id='m_end'> M End Line: 39</div><div id='n_start'> N Start Line: 43</div><div id='n_end'> N End Line: 46</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        "base_path": "test_value",
        "host_path": HOST_PATH,
    }
    manager = <a id="change">tensorboard.build(test_util.get_dummy_env()</a>, checkpoint_config<a id="change">)</a>
    assert isinstance(manager, tensorboard.SharedFSTensorboardManager)
    assert manager.base_path == pathlib.Path("test_value/tensorboard")

</code></pre><h3>After Change</h3><pre><code class='java'>
        "base_path": "test_value",
        "host_path": HOST_PATH,
    }
    env = <a id="change">test_util.get_dummy_env()</a>
    manager<a id="change"> = </a><a id="change">tensorboard.build(
        </a>env.det_cluster_id, env.det_experiment_id, env.det_trial_id, checkpoint_config<a id="change">
    )</a>
    assert isinstance(manager, tensorboard.SharedFSTensorboardManager)
    assert manager.base_path == pathlib.Path("test_value/tensorboard")

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/determined-ai/determined/commit/aefd9e397b4d50a8fcef9c507582c78452d47865#diff-3d432d601fdf38baecdb062fd785a1adf31df013e052380897da456122874b4dL19' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 10460766</div><div id='project'> Project Name: determined-ai/determined</div><div id='commit'> Commit Name: aefd9e397b4d50a8fcef9c507582c78452d47865</div><div id='time'> Time: 2021-03-18</div><div id='author'> Author: bradlaney@determined.ai</div><div id='file'> File Name: harness/tests/tensorboard/test_base.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_setting_optional_variable(1)</div><div id='n_method'> N Method Name: test_setting_optional_variable(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: harness/tests/tensorboard/test_base.py</div><div id='n_file'> N File Name: harness/tests/tensorboard/test_base.py</div><div id='m_start'> M Start Line: 20</div><div id='m_end'> M End Line: 25</div><div id='n_start'> N Start Line: 23</div><div id='n_end'> N End Line: 31</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        "host_path": str(HOST_PATH),
        "storage_path": str(STORAGE_PATH),
    }
    manager = <a id="change">tensorboard.build(test_util.get_dummy_env()</a>, checkpoint_config<a id="change">)</a>
    assert isinstance(manager, tensorboard.SharedFSTensorboardManager)
    assert manager.storage_path == STORAGE_PATH

</code></pre><h3>After Change</h3><pre><code class='java'>
        "host_path": str(HOST_PATH),
        "storage_path": str(STORAGE_PATH),
    }
    env = <a id="change">test_util.get_dummy_env()</a>
    manager<a id="change"> = </a><a id="change">tensorboard.build(
        </a>env.det_cluster_id, env.det_experiment_id, env.det_trial_id, checkpoint_config<a id="change">
    )</a>
    assert isinstance(manager, tensorboard.SharedFSTensorboardManager)
    assert manager.storage_path == STORAGE_PATH

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/determined-ai/determined/commit/aefd9e397b4d50a8fcef9c507582c78452d47865#diff-3d432d601fdf38baecdb062fd785a1adf31df013e052380897da456122874b4dL43' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 10460778</div><div id='project'> Project Name: determined-ai/determined</div><div id='commit'> Commit Name: aefd9e397b4d50a8fcef9c507582c78452d47865</div><div id='time'> Time: 2021-03-18</div><div id='author'> Author: bradlaney@determined.ai</div><div id='file'> File Name: harness/tests/tensorboard/test_base.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_setting_storage_path(1)</div><div id='n_method'> N Method Name: test_setting_storage_path(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: harness/tests/tensorboard/test_base.py</div><div id='n_file'> N File Name: harness/tests/tensorboard/test_base.py</div><div id='m_start'> M Start Line: 44</div><div id='m_end'> M End Line: 49</div><div id='n_start'> N Start Line: 55</div><div id='n_end'> N End Line: 63</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

def test_getting_manager_instance(tmp_path: pathlib.Path) -&gt; None:
    checkpoint_config = {"type": "shared_fs", "host_path": HOST_PATH}
    manager = <a id="change">tensorboard.build(test_util.get_dummy_env()</a>, checkpoint_config<a id="change">)</a>
    assert isinstance(manager, tensorboard.SharedFSTensorboardManager)


def test_setting_optional_variable(tmp_path: pathlib.Path) -&gt; None:</code></pre><h3>After Change</h3><pre><code class='java'>

def test_getting_manager_instance(tmp_path: pathlib.Path) -&gt; None:
    checkpoint_config = {"type": "shared_fs", "host_path": HOST_PATH}
    env = <a id="change">test_util.get_dummy_env()</a>
    manager<a id="change"> = </a><a id="change">tensorboard.build(
        </a>env.det_cluster_id, env.det_experiment_id, env.det_trial_id, checkpoint_config<a id="change">
    )</a>
    assert isinstance(manager, tensorboard.SharedFSTensorboardManager)


def test_setting_optional_variable(tmp_path: pathlib.Path) -&gt; None:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/determined-ai/determined/commit/aefd9e397b4d50a8fcef9c507582c78452d47865#diff-3d432d601fdf38baecdb062fd785a1adf31df013e052380897da456122874b4dL13' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 10460775</div><div id='project'> Project Name: determined-ai/determined</div><div id='commit'> Commit Name: aefd9e397b4d50a8fcef9c507582c78452d47865</div><div id='time'> Time: 2021-03-18</div><div id='author'> Author: bradlaney@determined.ai</div><div id='file'> File Name: harness/tests/tensorboard/test_base.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_getting_manager_instance(1)</div><div id='n_method'> N Method Name: test_getting_manager_instance(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: harness/tests/tensorboard/test_base.py</div><div id='n_file'> N File Name: harness/tests/tensorboard/test_base.py</div><div id='m_start'> M Start Line: 14</div><div id='m_end'> M End Line: 15</div><div id='n_start'> N Start Line: 14</div><div id='n_end'> N End Line: 18</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def test_s3_build() -&gt; None:
    manager = <a id="change">tensorboard.build(test_util.get_dummy_env()</a>, default_conf<a id="change">)</a>
    assert isinstance(manager, tensorboard.S3TensorboardManager)


def test_s3_build_missing_param() -&gt; None:</code></pre><h3>After Change</h3><pre><code class='java'>


def test_s3_build() -&gt; None:
    env = <a id="change">test_util.get_dummy_env()</a>
    manager<a id="change"> = </a><a id="change">tensorboard.build(
        </a>env.det_cluster_id, env.det_experiment_id, env.det_trial_id, default_conf<a id="change">
    )</a>
    assert isinstance(manager, tensorboard.S3TensorboardManager)


def test_s3_build_missing_param() -&gt; None:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/determined-ai/determined/commit/aefd9e397b4d50a8fcef9c507582c78452d47865#diff-740f5b00df6a3aedb0124c94c644b65b571c3c8141d3a38a88a16e89da60aa83L24' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 10460774</div><div id='project'> Project Name: determined-ai/determined</div><div id='commit'> Commit Name: aefd9e397b4d50a8fcef9c507582c78452d47865</div><div id='time'> Time: 2021-03-18</div><div id='author'> Author: bradlaney@determined.ai</div><div id='file'> File Name: harness/tests/tensorboard/test_s3.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_s3_build(0)</div><div id='n_method'> N Method Name: test_s3_build(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: harness/tests/tensorboard/test_s3.py</div><div id='n_file'> N File Name: harness/tests/tensorboard/test_s3.py</div><div id='m_start'> M Start Line: 25</div><div id='m_end'> M End Line: 25</div><div id='n_start'> N Start Line: 25</div><div id='n_end'> N End Line: 28</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

def test_s3_faulty_lifecycle(monkeypatch: monkeypatch.MonkeyPatch) -&gt; None:
    monkeypatch.setattr("boto3.client", s3.s3_faulty_client)
    manager = <a id="change">tensorboard.build(test_util.get_dummy_env()</a>, default_conf<a id="change">)</a>

    with pytest.raises(exceptions.S3UploadFailedError):
        manager.sync()
</code></pre><h3>After Change</h3><pre><code class='java'>

def test_s3_faulty_lifecycle(monkeypatch: monkeypatch.MonkeyPatch) -&gt; None:
    monkeypatch.setattr("boto3.client", s3.s3_faulty_client)
    env = <a id="change">test_util.get_dummy_env()</a>
    manager<a id="change"> = </a><a id="change">tensorboard.build(
        </a>env.det_cluster_id, env.det_experiment_id, env.det_trial_id, default_conf<a id="change">
    )</a>

    with pytest.raises(exceptions.S3UploadFailedError):
        manager.sync()
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/determined-ai/determined/commit/aefd9e397b4d50a8fcef9c507582c78452d47865#diff-740f5b00df6a3aedb0124c94c644b65b571c3c8141d3a38a88a16e89da60aa83L50' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 10460772</div><div id='project'> Project Name: determined-ai/determined</div><div id='commit'> Commit Name: aefd9e397b4d50a8fcef9c507582c78452d47865</div><div id='time'> Time: 2021-03-18</div><div id='author'> Author: bradlaney@determined.ai</div><div id='file'> File Name: harness/tests/tensorboard/test_s3.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_s3_faulty_lifecycle(1)</div><div id='n_method'> N Method Name: test_s3_faulty_lifecycle(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: harness/tests/tensorboard/test_s3.py</div><div id='n_file'> N File Name: harness/tests/tensorboard/test_s3.py</div><div id='m_start'> M Start Line: 52</div><div id='m_end'> M End Line: 52</div><div id='n_start'> N Start Line: 59</div><div id='n_end'> N End Line: 62</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        "host_path": str(HOST_PATH),
        "storage_path": str(STORAGE_PATH),
    }
    manager = <a id="change">tensorboard.build(
        test_util.get_dummy_env()</a>, checkpoint_config<a id="change">, container_path=str(tmp_path)
    )</a>
    assert isinstance(manager, tensorboard.SharedFSTensorboardManager)
    assert manager.storage_path == tmp_path.joinpath("test_storage_path")

</code></pre><h3>After Change</h3><pre><code class='java'>
        "host_path": str(HOST_PATH),
        "storage_path": str(STORAGE_PATH),
    }
    env = <a id="change">test_util.get_dummy_env()</a>
    manager<a id="change"> = </a><a id="change">tensorboard.build(
        </a>env.det_cluster_id,
        env.det_experiment_id,
        env.det_trial_id,
        checkpoint_config<a id="change">,
        container_path=str(tmp_path),
    )</a>
    assert isinstance(manager, tensorboard.SharedFSTensorboardManager)
    assert manager.storage_path == tmp_path.joinpath("test_storage_path")

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/determined-ai/determined/commit/aefd9e397b4d50a8fcef9c507582c78452d47865#diff-3d432d601fdf38baecdb062fd785a1adf31df013e052380897da456122874b4dL30' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 10460770</div><div id='project'> Project Name: determined-ai/determined</div><div id='commit'> Commit Name: aefd9e397b4d50a8fcef9c507582c78452d47865</div><div id='time'> Time: 2021-03-18</div><div id='author'> Author: bradlaney@determined.ai</div><div id='file'> File Name: harness/tests/tensorboard/test_base.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_build_with_container_path(1)</div><div id='n_method'> N Method Name: test_build_with_container_path(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: harness/tests/tensorboard/test_base.py</div><div id='n_file'> N File Name: harness/tests/tensorboard/test_base.py</div><div id='m_start'> M Start Line: 31</div><div id='m_end'> M End Line: 38</div><div id='n_start'> N Start Line: 37</div><div id='n_end'> N End Line: 49</div><BR>