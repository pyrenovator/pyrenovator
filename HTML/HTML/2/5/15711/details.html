<html><h3>Pattern ID :15711
</h3><img src='53046255.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    def upload(self, messages):
        if os.environ.get(&quotSCRIBE_INTERN&quot):
            return self._upload_intern(messages)
        logs = <a id="change">json.dumps(
            </a>[
                {
                    "category": self.category,
                    "message": json.dumps(message),
                    "line_escape": False,
                }
                for message in messages
            ]<a id="change">
        )</a>
        res<a id="change"> = </a>send_to_scribe(logs)
        print(res)

</code></pre><h3>After Change</h3><pre><code class='java'>
        if os.environ.get(&quotSCRIBE_INTERN&quot):
            return self._upload_intern(messages)
        access_token = os.environ.get("SCRIBE_GRAPHQL_ACCESS_TOKEN")
        <a id="change">if </a>not access_token:
            raise ValueError("Can&quott find access token from environment variable")
        url<a id="change"> = "https://graph.facebook.com/scribe_logs"</a>
        r = requests.post(
            url,
            data={
                "access_token": access_token,</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/pytorch/pytorch/commit/3624d758648c3df0fb86eb71fdde648dba8cbe5e#diff-0efe168d4a680ae77ed6a865ec91a486ccb2480e6274956dbf17456c78cb5138L46' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 53046255</div><div id='project'> Project Name: pytorch/pytorch</div><div id='commit'> Commit Name: 3624d758648c3df0fb86eb71fdde648dba8cbe5e</div><div id='time'> Time: 2021-07-16</div><div id='author'> Author: jw3468@fb.com</div><div id='file'> File Name: benchmarks/upload_scribe.py</div><div id='m_class'> M Class Name: ScribeUploader</div><div id='n_method'> N Class Name: ScribeUploader</div><div id='m_method'> M Method Name: upload(2)</div><div id='n_method'> N Method Name: upload(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: benchmarks/upload_scribe.py</div><div id='n_file'> N File Name: benchmarks/upload_scribe.py</div><div id='m_start'> M Start Line: 46</div><div id='m_end'> M End Line: 57</div><div id='n_start'> N Start Line: 47</div><div id='n_end'> N End Line: 68</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        script = os.path.realpath(os.path.join(base_dir, "scripts", script))

    request = task["request"]
    cmd<a id="change"> = </a>[
        script,
        settings.MONAI_LABEL_APP_DIR,
        settings.MONAI_LABEL_STUDIES,
        method,
        <a id="change">json.dumps(</a>request<a id="change">)</a>,
    ]

    logger.info(f"COMMAND:: {&quot &quot.join(cmd)}")</code></pre><h3>After Change</h3><pre><code class='java'>
        my_env["CUDA_VISIBLE_DEVICES"] = gpus
    request["gpus"] = "all"

    <a id="change">if </a>method == "train":
        my_env["MONAI_LABEL_DATASTORE_AUTO_RELOAD"]<a id="change"> = "false"</a>
        my_env["MASTER_ADDR"] = "127.0.0.1"
        my_env["MASTER_PORT"] = "1234"

    cmd = [</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/project-monai/monailabel/commit/62c4207eaf8efe94cd8123b6470f672206f8ece3#diff-64b8e175a1b972125eda543982f707a6d9f3b5d5d2f2bab08b2c5b2c85c8be27L35' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 53046254</div><div id='project'> Project Name: project-monai/monailabel</div><div id='commit'> Commit Name: 62c4207eaf8efe94cd8123b6470f672206f8ece3</div><div id='time'> Time: 2021-10-17</div><div id='author'> Author: sachidanand.alle@gmail.com</div><div id='file'> File Name: monailabel/utils/async_tasks/utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _task_func(3)</div><div id='n_method'> N Method Name: _task_func(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: monailabel/utils/async_tasks/utils.py</div><div id='n_file'> N File Name: monailabel/utils/async_tasks/utils.py</div><div id='m_start'> M Start Line: 36</div><div id='m_end'> M End Line: 48</div><div id='n_start'> N Start Line: 33</div><div id='n_end'> N End Line: 55</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    def upload(self, messages):
        if os.environ.get(&quotSCRIBE_INTERN&quot):
            return self._upload_intern(messages)
        logs = <a id="change">json.dumps(
            </a>[
                {
                    "category": self.category,
                    "message": json.dumps(message),
                    "line_escape": False,
                }
                for message in messages
            ]<a id="change">
        )</a>
        res<a id="change"> = </a>send_to_scribe(logs)
        print(res)

</code></pre><h3>After Change</h3><pre><code class='java'>
        if os.environ.get(&quotSCRIBE_INTERN&quot):
            return self._upload_intern(messages)
        access_token = os.environ.get("SCRIBE_GRAPHQL_ACCESS_TOKEN")
        <a id="change">if </a>not access_token:
            raise ValueError("Can&quott find access token from environment variable")
        url<a id="change"> = "https://graph.facebook.com/scribe_logs"</a>
        r = requests.post(
            url,
            data={
                "access_token": access_token,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/pytorch/pytorch/commit/ac5a40e068b0a1ce3c873ef1f681564376dbae52#diff-0efe168d4a680ae77ed6a865ec91a486ccb2480e6274956dbf17456c78cb5138L43' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 53046256</div><div id='project'> Project Name: pytorch/pytorch</div><div id='commit'> Commit Name: ac5a40e068b0a1ce3c873ef1f681564376dbae52</div><div id='time'> Time: 2021-07-19</div><div id='author'> Author: zhouzhuojie@gmail.com</div><div id='file'> File Name: benchmarks/upload_scribe.py</div><div id='m_class'> M Class Name: ScribeUploader</div><div id='n_method'> N Class Name: ScribeUploader</div><div id='m_method'> M Method Name: upload(2)</div><div id='n_method'> N Method Name: upload(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: benchmarks/upload_scribe.py</div><div id='n_file'> N File Name: benchmarks/upload_scribe.py</div><div id='m_start'> M Start Line: 46</div><div id='m_end'> M End Line: 57</div><div id='n_start'> N Start Line: 47</div><div id='n_end'> N End Line: 68</div><BR>