<html><h3>Pattern ID :19782
</h3><img src='64483191.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        mel_embs = []

        <a id="change">for </a>mel in mels<a id="change">:
            </a>mel = mel.unsqueeze(0)
            mel_emb<a id="change">, _ = </a>self.mel_rnn(mel)
            mel_emb<a id="change"> = </a>mel_emb.squeeze(0)
            mel_embs.append(mel_emb)

        mel_embs = pad_sequence(</code></pre><h3>After Change</h3><pre><code class='java'>
        max_mel_len = max(mel_lens)
        max_wav_len = max_mel_len * self.hop_len

        pad_mels = <a id="change">pad_sequence(</a>mels<a id="change">, batch_first=True)</a>
        pack_mels = pack_padded_sequence(
            pad_mels, torch.tensor(mel_lens), batch_first=True, enforce_sorted=False
        )
        pack_mel_embs, _ = self.mel_rnn(pack_mels)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/yistlin/universal-vocoder/commit/decd133f652564aab54717a4e8df0316421e35c0#diff-0b303f21197833211aecf17dfcb415a3d2172623cfededbfc805892f128cd01eL77' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 64483191</div><div id='project'> Project Name: yistlin/universal-vocoder</div><div id='commit'> Commit Name: decd133f652564aab54717a4e8df0316421e35c0</div><div id='time'> Time: 2020-10-07</div><div id='author'> Author: yishen992@gmail.com</div><div id='file'> File Name: models/universal_vocoder.py</div><div id='m_class'> M Class Name: UniversalVocoder</div><div id='n_method'> N Class Name: UniversalVocoder</div><div id='m_method'> M Method Name: generate(2)</div><div id='n_method'> N Method Name: generate(2)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: models/universal_vocoder.py</div><div id='n_file'> N File Name: models/universal_vocoder.py</div><div id='m_start'> M Start Line: 78</div><div id='m_end'> M End Line: 108</div><div id='n_start'> N Start Line: 77</div><div id='n_end'> N End Line: 106</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    features = torch.zeros((len(data), n_mels, max_inp_len))
    labels = torch.zeros((len(data), max_label_len))

    <a id="change">for i</a> in range(len(data))<a id="change">:
        </a>input_length = data[i][0].size(1)
        label_length = data[i][3]
        features[i]<a id="change"> = </a>torch.cat([data[i][0], torch.zeros((n_mels, max_inp_len - input_length))], dim=1)
        labels[i]<a id="change"> = </a>torch.cat([data[i][1], torch.zeros((max_label_len - label_length))])

    return features, labels, torch.tensor(input_lengths), torch.tensor(label_lengths)
</code></pre><h3>After Change</h3><pre><code class='java'>
    specs = pad_sequence(specs, batch_first=True)
    specs = torch.transpose(specs, 1, 2)

    labels = <a id="change">pad_sequence(</a>texts<a id="change">, batch_first=True)</a>

    return specs, labels, torch.tensor(input_lengths), torch.tensor(label_lengths)

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ivankunyankin/quartznet-asr/commit/f5499846f8525773be9824471b65f109603eed5c#diff-09d0cbaf891d623ac245ccf84485a687b554217349ca55557c60b33234b969aeL75' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 64483190</div><div id='project'> Project Name: ivankunyankin/quartznet-asr</div><div id='commit'> Commit Name: f5499846f8525773be9824471b65f109603eed5c</div><div id='time'> Time: 2021-07-03</div><div id='author'> Author: IKunyankin@gmail.com</div><div id='file'> File Name: utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: custom_collate(1)</div><div id='n_method'> N Method Name: custom_collate(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: utils.py</div><div id='n_file'> N File Name: utils.py</div><div id='m_start'> M Start Line: 85</div><div id='m_end'> M End Line: 98</div><div id='n_start'> N Start Line: 88</div><div id='n_end'> N End Line: 94</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        mel_embs = []

        <a id="change">for mel</a> in mels<a id="change">:
            </a>mel<a id="change"> = </a>mel.unsqueeze(0)
            mel_emb, _ = self.mel_rnn(mel)
            mel_emb<a id="change"> = </a>mel_emb.squeeze(0)
            mel_embs.append(mel_emb)

        mel_embs = pad_sequence(</code></pre><h3>After Change</h3><pre><code class='java'>
        max_mel_len = max(mel_lens)
        max_wav_len = max_mel_len * self.hop_len

        pad_mels = <a id="change">pad_sequence(</a>mels<a id="change">, batch_first=True)</a>
        pack_mels = pack_padded_sequence(
            pad_mels, torch.tensor(mel_lens), batch_first=True, enforce_sorted=False
        )
        pack_mel_embs, _ = self.mel_rnn(pack_mels)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/yistlin/universal-vocoder/commit/decd133f652564aab54717a4e8df0316421e35c0#diff-0b303f21197833211aecf17dfcb415a3d2172623cfededbfc805892f128cd01eL63' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 64483220</div><div id='project'> Project Name: yistlin/universal-vocoder</div><div id='commit'> Commit Name: decd133f652564aab54717a4e8df0316421e35c0</div><div id='time'> Time: 2020-10-07</div><div id='author'> Author: yishen992@gmail.com</div><div id='file'> File Name: models/universal_vocoder.py</div><div id='m_class'> M Class Name: UniversalVocoder</div><div id='n_method'> N Class Name: UniversalVocoder</div><div id='m_method'> M Method Name: generate(2)</div><div id='n_method'> N Method Name: generate(2)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: models/universal_vocoder.py</div><div id='n_file'> N File Name: models/universal_vocoder.py</div><div id='m_start'> M Start Line: 78</div><div id='m_end'> M End Line: 108</div><div id='n_start'> N Start Line: 77</div><div id='n_end'> N End Line: 106</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        metric_dict = {}
        result_list = self._calculate_metrics(pos_len_list, topk_index)
        for metric, value in zip(self.metrics, result_list):
            <a id="change">for k</a> in self.topk<a id="change">:
                </a>key<a id="change"> = </a>&quot{}@{}&quot.format(metric, k)
                metric_dict[key]<a id="change"> = </a>round(value[k - 1], 4)
        return metric_dict

    def _check_args(self):</code></pre><h3>After Change</h3><pre><code class='java'>
            scores_matrix = scores_tensor.view(len(user_len_list), -1)
        else:
            scores_list = torch.split(scores_tensor, user_len_list, dim=0)
            scores_matrix = <a id="change">pad_sequence(</a>scores_list<a id="change">, batch_first=True, padding_value=-np.inf)</a>  &#47&#47 nusers x items

        &#47&#47 get topk
        _, topk_index = torch.topk(scores_matrix, max(self.topk), dim=-1)  &#47&#47 nusers x k</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/rucaibox/recbole/commit/df66b6285fec567d1f3ca0d6ee9d9ceb71f792b6#diff-a8acd0f2ac2f4ecd988072df1fbd285b091466958984b6c0d2b75a087c7320a5L59' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 64483198</div><div id='project'> Project Name: rucaibox/recbole</div><div id='commit'> Commit Name: df66b6285fec567d1f3ca0d6ee9d9ceb71f792b6</div><div id='time'> Time: 2020-10-20</div><div id='author'> Author: 1337990880@qq.com</div><div id='file'> File Name: recbole/evaluator/topk_evaluator.py</div><div id='m_class'> M Class Name: TopKEvaluator</div><div id='n_method'> N Class Name: TopKEvaluator</div><div id='m_method'> M Method Name: collect(4)</div><div id='n_method'> N Method Name: collect(3)</div><div id='m_parent_class'> M Parent Class: AbstractEvaluator</div><div id='n_parent_class'> N Parent Class: AbstractEvaluator</div><div id='m_file'> M File Name: recbole/evaluator/topk_evaluator.py</div><div id='n_file'> N File Name: recbole/evaluator/topk_evaluator.py</div><div id='m_start'> M Start Line: 69</div><div id='m_end'> M End Line: 80</div><div id='n_start'> N Start Line: 38</div><div id='n_end'> N End Line: 57</div><BR>