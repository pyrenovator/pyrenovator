<html><h3>Pattern ID :34616
</h3><img src='99436361.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            lower_bound = residual/((L-H)*M)

        lower_bound = lower_bound.cpu().numpy()
        upper_bound<a id="change"> = upper_bound.cpu()</a><a id="change">.numpy()</a>
        if np.greater(lower_bound, upper_bound):
            &#47&#47 raise RuntimeError
            &#47&#47 return None, None, None
            temp = lower_bound</code></pre><h3>After Change</h3><pre><code class='java'>
        sigma2_opt = minimize_scalar(VBsigma2, args=(L, M, cacb, s, residual), bounds=[
                                     lower_bound, upper_bound], method=&quotBounded&quot)
        sigma2 = sigma2_opt.x
        <a id="change">print("Estimated sigma2: "</a>, sigma2<a id="change">)</a>

    &#47&#47 Threshold gamma term
    &#47&#47 Formula above (21) from [1]
    thresh_term = (L+M + sigma2/cacb**2)/2</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/mahdihosseini/rmsgd/commit/9d0f5bf41de2ac931c756d1a7fbe33c1eed3f6ec#diff-27ae518c312ba881f47d05ff1ac2e3495bae8453e3132f825126745e5b2ffcb3L84' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 99436361</div><div id='project'> Project Name: mahdihosseini/rmsgd</div><div id='commit'> Commit Name: 9d0f5bf41de2ac931c756d1a7fbe33c1eed3f6ec</div><div id='time'> Time: 2021-04-14</div><div id='author'> Author: tuli.mathieu@gmail.com</div><div id='file'> File Name: src/adas/matrix_factorization.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: VBMF(4)</div><div id='n_method'> N Method Name: VBMF(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/adas/matrix_factorization.py</div><div id='n_file'> N File Name: src/adas/matrix_factorization.py</div><div id='m_start'> M Start Line: 107</div><div id='m_end'> M End Line: 122</div><div id='n_start'> N Start Line: 84</div><div id='n_end'> N End Line: 85</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        inpainted_image = self.model(image, mask)

        cur_res = <a id="change">inpainted_image[0].permute(1, 2, 0).detach().cpu().numpy()</a>
        cur_res = cur_res[0:origin_height, 0:origin_width, :]
        cur_res<a id="change"> = </a>np.clip(cur_res * 255, 0, 255).astype("uint8")
        cur_res = cv2.cvtColor(cur_res, cv2.COLOR_BGR2RGB)
        return cur_res
</code></pre><h3>After Change</h3><pre><code class='java'>
        if area &lt; self.crop_trigger_size[0] * self.crop_trigger_size[1]:
            return self._run(image, mask)

        <a id="change">print("Trigger crop image"</a><a id="change">)</a>
        boxes = boxes_from_mask(mask)
        crop_result = []
        for box in boxes:
            crop_image, crop_box = self._run_box(image, mask, box)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/sanster/lama-cleaner/commit/43c9c22c7312dd39feac4e3783e9ec080fd64243#diff-c64397576661152777123ab1a485c53dbfa8de21c16999da23c3b18cb8993606L34' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 99436345</div><div id='project'> Project Name: sanster/lama-cleaner</div><div id='commit'> Commit Name: 43c9c22c7312dd39feac4e3783e9ec080fd64243</div><div id='time'> Time: 2022-03-22</div><div id='author'> Author: cwq1913@gmail.com</div><div id='file'> File Name: lama_cleaner/lama/__init__.py</div><div id='m_class'> M Class Name: LaMa</div><div id='n_method'> N Class Name: LaMa</div><div id='m_method'> M Method Name: __call__(3)</div><div id='n_method'> N Method Name: __call__(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: lama_cleaner/lama/__init__.py</div><div id='n_file'> N File Name: lama_cleaner/lama/__init__.py</div><div id='m_start'> M Start Line: 40</div><div id='m_end'> M End Line: 55</div><div id='n_start'> N Start Line: 50</div><div id='n_end'> N End Line: 65</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 Only reconstruct the Y channel image data.
        with torch.no_grad():
            sr_tensor_y = model(lr_tensor_y).clamp_(0., 1.)
            sr_image_y<a id="change"> = sr_tensor_y.mul(255.0).cpu()</a><a id="change">.numpy()</a>.squeeze(0).squeeze(0)
            sr_image = np.array([sr_image_y, lr_ycbcr[..., 1], lr_ycbcr[..., 2]]).transpose([1, 2, 0])
            sr_image = np.clip(imgproc.convert_ycbcr_to_rgb(sr_image), 0.0, 255.0).astype(np.uint8)
            sr_image = Image.fromarray(sr_image)</code></pre><h3>After Change</h3><pre><code class='java'>
        sr_image = Image.fromarray(sr_image)
        sr_image.save(sr_image_path)

    <a id="change">print(f"PSNR: {total_psnr / total_files:.2f}.\n"</a><a id="change">)</a>


if __name__ == "__main__":
    main()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/lornatang/srcnn-pytorch/commit/b957357cc1bbc6e96762df844df48a3e6464fd90#diff-58b7fc05c0526d9a9b3c0b50dda416fcbf0a654e696da4b6df82cbb5a6b2dcfcL154' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 99436360</div><div id='project'> Project Name: lornatang/srcnn-pytorch</div><div id='commit'> Commit Name: b957357cc1bbc6e96762df844df48a3e6464fd90</div><div id='time'> Time: 2021-11-05</div><div id='author'> Author: liuchangyu1111@gmail.com</div><div id='file'> File Name: validate.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: validate.py</div><div id='n_file'> N File Name: validate.py</div><div id='m_start'> M Start Line: 177</div><div id='m_end'> M End Line: 221</div><div id='n_start'> N Start Line: 50</div><div id='n_end'> N End Line: 89</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>


def _apply_embeddings(df, node_embeddings, col_map):
    node_emb_arr = <a id="change">node_embeddings.cpu().detach().numpy()</a>
    node_emb_dict = {i: val for i, val in enumerate(node_emb_arr)}

    for i, node in enumerate(col_map.keys()):
        emb<a id="change"> = </a>pd.DataFrame(df[col_map[node]].map(node_emb_dict).tolist()).add_prefix(
            "n" + str(i) + "_e"
        )
        df = df.join([emb])</code></pre><h3>After Change</h3><pre><code class='java'>
        _apply_heterogeneous_embeddings(
            df, node_embeddings, col_map)
    else:
        <a id="change">print("Apply homogeneous embeddings."</a><a id="change">)</a>
        _apply_homogeneous_embeddings(
            df, node_embeddings, col_map)

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/oap-project/cloudtik/commit/b1cb12787f1e43cfd7987400f6c178507cd30510#diff-4c21c2cb889aa41b903d5e243cb25c4af2f693f43e9451406cc665b97d594df9L29' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 99436357</div><div id='project'> Project Name: oap-project/cloudtik</div><div id='commit'> Commit Name: b1cb12787f1e43cfd7987400f6c178507cd30510</div><div id='time'> Time: 2023-06-25</div><div id='author'> Author: haifeng.chen@intel.com</div><div id='file'> File Name: python/cloudtik/runtime/ai/modeling/graph_modeling/graph_sage/modeling/embeddings.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _apply_embeddings(3)</div><div id='n_method'> N Method Name: _apply_embeddings(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: python/cloudtik/runtime/ai/modeling/graph_modeling/graph_sage/modeling/embeddings.py</div><div id='n_file'> N File Name: python/cloudtik/runtime/ai/modeling/graph_modeling/graph_sage/modeling/embeddings.py</div><div id='m_start'> M Start Line: 30</div><div id='m_end'> M End Line: 44</div><div id='n_start'> N Start Line: 42</div><div id='n_end'> N End Line: 51</div><BR>