<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        train_labeled_dataset, batch_size=args.batch_size[0], shuffle=(train_labeled_sampler is None),
        num_workers=args.workers, pin_memory=True, sampler=train_labeled_sampler, collate_fn=train_labeled_dataset.collate)

    loss_func<a id="change"> = </a><a id="change">nn.BCEWithLogitsLoss(reduction=&quotnone&quot).cuda()</a>
    &#47&#47 define loss function (criterion)
    def criterion(y_pred, y_target):
        is_labeled = ~torch.isnan(y_target)
        flattened_y_pred = y_pred[is_labeled].float()</code></pre><h3>After Change</h3><pre><code class='java'>
            if is_best:
                test_metric = tmp_test_metric
                shutil.copy(logger.get_checkpoint_path(&quotlatest&quot), logger.get_checkpoint_path(&quotbest&quot))
    <a id="change">print(</a><a id="change">"best val performance: {:.3f}".format(</a>best_val_metric<a id="change">))</a>
    print("test performance: {:.3f}".format(test_metric))

    logger.close()
    writer.close()</code></pre>