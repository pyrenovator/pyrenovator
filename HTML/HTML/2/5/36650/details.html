<html><h3>Pattern ID :36650
</h3><img src='104554203.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
			gt_boxes = gts[:, :4]

			&#47&#47 count keeped gts
			total_faces<a id="change"> += </a><a id="change">(ignore == 0).sum()</a>

			if preds.shape[0] == 0: continue
			&#47&#47 gt_boxes: M,4 as x1,y1,x2,y2
			&#47&#47 preds: N,5 as x1,y1,x2,y2,norm_score</code></pre><h3>After Change</h3><pre><code class='java'>

		gt_boxes = [gt_boxes.cpu().float().numpy() for gt_boxes in self.gt_boxes]

		ignore_flags<a id="change"> = </a><a id="change">[ignore_flag.cpu().numpy() for ignore_flag in self.ignore_flags]</a>

		total_faces = 0

		for preds, gts, i_flags in zip(normalized_preds, gt_boxes, ignore_flags):</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/borhanmorphy/fastface/commit/c5da7ce5325ff194e2b96a81245e3834e7bd2c29#diff-a1adb22c09fec882eb4f87aa9faa64f1f30cb652acb7369ab5595766b7df877eL49' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 104554203</div><div id='project'> Project Name: borhanmorphy/fastface</div><div id='commit'> Commit Name: c5da7ce5325ff194e2b96a81245e3834e7bd2c29</div><div id='time'> Time: 2021-05-09</div><div id='author'> Author: borhano.f.42@gmail.com</div><div id='file'> File Name: fastface/metric/widerface_ap.py</div><div id='m_class'> M Class Name: WiderFaceAP</div><div id='n_method'> N Class Name: WiderFaceAP</div><div id='m_method'> M Method Name: compute(1)</div><div id='n_method'> N Method Name: compute(1)</div><div id='m_parent_class'> M Parent Class: Metric</div><div id='n_parent_class'> N Parent Class: Metric</div><div id='m_file'> M File Name: fastface/metric/widerface_ap.py</div><div id='n_file'> N File Name: fastface/metric/widerface_ap.py</div><div id='m_start'> M Start Line: 49</div><div id='m_end'> M End Line: 70</div><div id='n_start'> N Start Line: 55</div><div id='n_end'> N End Line: 74</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        &#47&#47 invert noise for bright regions (bright regions are considered being on average &gt; 0.33 * 255)
        generated_noise = generated_noise.int()
        bright_regions = <a id="change">img.sum(</a>1<a id="change">)</a> &gt; brightness_threshold * img.shape[1]
        for ch in range(img.shape[1]):
            gnch = generated_noise[:, ch]
            gnch[bright_regions] = gnch[bright_regions] * -1
            generated_noise[:, ch]<a id="change"> = </a>gnch

        anom = (anom.int() + generated_noise).clamp(0, 255).byte()
</code></pre><h3>After Change</h3><pre><code class='java'>
        diff = diff.reshape(anom.size(0), -1).sum(1).float().div(np.prod(anom.shape)).abs()
        diffi = ((anom.int() - generated_noise).clamp(0, 255) - anom.int())
        diffi = diffi.reshape(anom.size(0), -1).sum(1).float().div(np.prod(anom.shape)).abs()
        inv = <a id="change">[i for i, (d, di) in enumerate(zip(diff, diffi)) if d &lt; invert_threshold and di &gt; d]</a>
        generated_noise[inv]<a id="change"> = </a>-generated_noise[inv]

        anom = (anom.int() + generated_noise).clamp(0, 255).byte()
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/liznerski/fcdd/commit/d110aa8b141dc13f47156da913a6b4f9d64ddc74#diff-fb7d9650a48b1de740043527c5d5e928e02fb69b57694006eafa311d213e906cL133' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 104554223</div><div id='project'> Project Name: liznerski/fcdd</div><div id='commit'> Commit Name: d110aa8b141dc13f47156da913a6b4f9d64ddc74</div><div id='time'> Time: 2020-10-12</div><div id='author'> Author: p_liznersk13@cs.uni-kl.de</div><div id='file'> File Name: python/fcdd/datasets/online_superviser.py</div><div id='m_class'> M Class Name: OnlineSuperviser</div><div id='n_method'> N Class Name: OnlineSuperviser</div><div id='m_method'> M Method Name: __malformed_normal(8)</div><div id='n_method'> N Method Name: __malformed_normal(8)</div><div id='m_parent_class'> M Parent Class: ImgGTTargetTransform</div><div id='n_parent_class'> N Parent Class: ImgGTTargetTransform</div><div id='m_file'> M File Name: python/fcdd/datasets/online_superviser.py</div><div id='n_file'> N File Name: python/fcdd/datasets/online_superviser.py</div><div id='m_start'> M Start Line: 139</div><div id='m_end'> M End Line: 146</div><div id='n_start'> N Start Line: 143</div><div id='n_end'> N End Line: 151</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

                &#47&#47 TODO vectorize more?
                for single_slot, single_center in single_class:
                    dists<a id="change"> = </a><a id="change">((m_cluster_centers - single_center) ** 2).sum(dim=-1)</a>

                    if (torch.any(dists &lt; (self.config[&quotdiff_cluster_threshold&quot] * 0.5))):  
                        new_slot = single_slot   &#47&#47 TODO check if there is a place to move to
                        label_id = dists.argmin()</code></pre><h3>After Change</h3><pre><code class='java'>

        &#47&#47 Logging
        swapped_quality_levels = []
        single_slots<a id="change"> = </a><a id="change">[elem[0] for elem in single_class]</a>
        single_centers = (elem[1] for elem in single_class)
        single_centers = torch.stack(tuple(single_centers)) if len(single_class) else []

        &#47&#47 check all elements for singles</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/maria-korosteleva/garment-pattern-estimation/commit/4f0a08b91c9d5e37a8b529fb523bd47047507750#diff-66aae7ec57f079963bb4847ebb79bfda4004ba832ee23e11911a14908193967cL1116' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 104554209</div><div id='project'> Project Name: maria-korosteleva/garment-pattern-estimation</div><div id='commit'> Commit Name: 4f0a08b91c9d5e37a8b529fb523bd47047507750</div><div id='time'> Time: 2021-07-26</div><div id='author'> Author: mariako@kaist.ac.kr</div><div id='file'> File Name: nn/metrics.py</div><div id='m_class'> M Class Name: ComposedPatternLoss</div><div id='n_method'> N Class Name: ComposedPatternLoss</div><div id='m_method'> M Method Name: _distribute_clusters(6)</div><div id='n_method'> N Method Name: _distribute_clusters(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: nn/metrics.py</div><div id='n_file'> N File Name: nn/metrics.py</div><div id='m_start'> M Start Line: 1134</div><div id='m_end'> M End Line: 1166</div><div id='n_start'> N Start Line: 1126</div><div id='n_end'> N End Line: 1182</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                batch_tokens.append(&quot &quot.join(tokens))
        
        encoded_batch = self._tokenizer.batch_encode_plus(batch_tokens, add_special_tokens=True, pad_to_max_length=True, return_attention_masks=True)
        length<a id="change"> = </a><a id="change">torch.sum(</a>torch.tensor(encoded_batch[&quotattention_mask&quot], dtype=torch.int32, device=device)<a id="change">, dim=1)</a>
        numerical = torch.tensor(encoded_batch[&quotinput_ids&quot], dtype=torch.int64, device=device)

        decoder_numerical = numerical
</code></pre><h3>After Change</h3><pre><code class='java'>
                batch_tokens.append(&quot &quot.join(tokens))
        encoded_batch = self._tokenizer.batch_encode_plus(batch_tokens, add_special_tokens=True, pad_to_max_length=False, return_attention_masks=False)
        numerical = encoded_batch[&quotinput_ids&quot]
        length<a id="change"> = </a><a id="change">[len(a) for a in encoded_batch[&quotinput_ids&quot]]</a>

        decoder_numerical = numerical

        return SequentialField(length=length, value=numerical, limited=decoder_numerical)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/stanford-oval/genienlp/commit/93dc0ddf85f74c85e61490145df3e9b27ab2e021#diff-9af5dd141b0e34d2f5c949979780fee4bbcf029a9df5dbd3705907a7dc380d84L432' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 104554214</div><div id='project'> Project Name: stanford-oval/genienlp</div><div id='commit'> Commit Name: 93dc0ddf85f74c85e61490145df3e9b27ab2e021</div><div id='time'> Time: 2020-12-01</div><div id='author'> Author: s.j.semnani@gmail.com</div><div id='file'> File Name: genienlp/data_utils/numericalizer/transformer.py</div><div id='m_class'> M Class Name: BartNumericalizer</div><div id='n_method'> N Class Name: BartNumericalizer</div><div id='m_method'> M Method Name: encode_single(5)</div><div id='n_method'> N Method Name: encode_single(5)</div><div id='m_parent_class'> M Parent Class: TransformerNumericalizer</div><div id='n_parent_class'> N Parent Class: TransformerNumericalizer</div><div id='m_file'> M File Name: genienlp/data_utils/numericalizer/transformer.py</div><div id='n_file'> N File Name: genienlp/data_utils/numericalizer/transformer.py</div><div id='m_start'> M Start Line: 444</div><div id='m_end'> M End Line: 446</div><div id='n_start'> N Start Line: 455</div><div id='n_end'> N End Line: 457</div><BR>