<html><h3>Pattern ID :5755
</h3><img src='20179185.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 print("grads: {}".format(grads))
        &#47&#47 print("weights: {}".format(type(weights)))

        gcam<a id="change"> = </a>torch.mul(fmaps, weights).sum(dim=1, keepdim=True)
        gcam = <a id="change">F.relu(</a>gcam<a id="change">)</a>

        gcam = F.interpolate(
            gcam, self.image_shape, mode="bilinear", align_corners=False
        )

        B<a id="change">, C, H, W = </a>gcam.shape
        gcam = gcam.view(B, -1)
        gcam -= gcam.min(dim=1, keepdim=True)[0]
        gcam /= gcam.max(dim=1, keepdim=True)[0]</code></pre><h3>After Change</h3><pre><code class='java'>
            fmaps, weights = self.select_highest_layer()
            gcam = []
            for i in range(self.logits.shape[0]):
                gcam.append(self.generate_helper(<a id="change">fmaps[i].unsqueeze(0</a><a id="change">)</a>, weights[i].unsqueeze(0)))
        else:
            fmaps = self._find(self.fmap_pool, target_layer)
            grads = self._find(self.grad_pool, target_layer)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/karol-g/gcam/commit/4d3673129f7f35d0b6ea05944a037268b4da45b2#diff-978485ec7cfb0b80eb5a414e89c1afc3b49e03fb985bcad877ce02e5af9cfe59L209' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 20179185</div><div id='project'> Project Name: karol-g/gcam</div><div id='commit'> Commit Name: 4d3673129f7f35d0b6ea05944a037268b4da45b2</div><div id='time'> Time: 2020-01-02</div><div id='author'> Author: KarolGotkowski@gmx.de</div><div id='file'> File Name: evaluation_models/grad_cam/grad_cam.py</div><div id='m_class'> M Class Name: GradCAM</div><div id='n_method'> N Class Name: GradCAM</div><div id='m_method'> M Method Name: generate(2)</div><div id='n_method'> N Method Name: generate(2)</div><div id='m_parent_class'> M Parent Class: _BaseWrapper</div><div id='n_parent_class'> N Parent Class: _BaseWrapper</div><div id='m_file'> M File Name: evaluation_models/grad_cam/grad_cam.py</div><div id='n_file'> N File Name: evaluation_models/grad_cam/grad_cam.py</div><div id='m_start'> M Start Line: 209</div><div id='m_end'> M End Line: 228</div><div id='n_start'> N Start Line: 231</div><div id='n_end'> N End Line: 244</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                                 encoder_outputs.unsqueeze(0))

        output = torch.cat((embedded[0], attn_applied[0]), 1)
        output<a id="change"> = </a>self.attn_combine(output).unsqueeze(0)

        output<a id="change"> = </a><a id="change">F.relu(</a>output<a id="change">)</a>
        output, hidden = self.gru(output, hidden)

        output = F.log_softmax(self.out(output[0]), dim=1)
        return output, hidden, attn_weights</code></pre><h3>After Change</h3><pre><code class='java'>
        embedded = self.dropout(self.embedding(_input).view(1, 1, -1))
        attn_weights = F.softmax(self.attn(torch.cat((embedded[0], hidden[0]), 1)), dim=1)
        attn_applied = torch.bmm(attn_weights.unsqueeze(0), encoder_outputs.unsqueeze(0))
        output = F.relu(<a id="change">self.attn_combine(torch.cat((embedded[0], attn_applied[0]), 1)).unsqueeze(0</a><a id="change">)</a>)
        output, hidden = self.gru(output, hidden)
        output = F.log_softmax(self.out(output[0]), dim=1)
        return output, hidden, attn_weights</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/asahi417/lm-question-generation/commit/807e2131b9e761d29682f6ddb83c19ca665d4f44#diff-e793d015281df863ed8422944b8e6710874153c91d0860536cbd78aa762e3e53L84' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 20179195</div><div id='project'> Project Name: asahi417/lm-question-generation</div><div id='commit'> Commit Name: 807e2131b9e761d29682f6ddb83c19ca665d4f44</div><div id='time'> Time: 2022-12-25</div><div id='author'> Author: asahi1992ushio@gmail.com</div><div id='file'> File Name: misc/qag_model/lstm_model/model_training.py</div><div id='m_class'> M Class Name: AttnDecoderRNN</div><div id='n_method'> N Class Name: AttnDecoderRNN</div><div id='m_method'> M Method Name: forward(4)</div><div id='n_method'> N Method Name: forward(4)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: misc/qag_model/lstm_model/model_training.py</div><div id='n_file'> N File Name: misc/qag_model/lstm_model/model_training.py</div><div id='m_start'> M Start Line: 85</div><div id='m_end'> M End Line: 96</div><div id='n_start'> N Start Line: 72</div><div id='n_end'> N End Line: 75</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        assert x.shape[1] == self.channels
        &#47&#47 BxCxL
        theta = torch.mean(x, axis=-1)
        theta<a id="change"> = </a>self.fc1(theta)
        theta = <a id="change">self.relu(</a>theta<a id="change">)</a>
        theta = self.fc2(theta)
        theta<a id="change"> = </a>2 * self.sigmoid(theta) - 1

        relu_coefs = theta.view(-1, self.channels, 2*self.k) * self.lambdas + self.init_v
        &#47&#47 BxCxL -&gt; LxBxCx1</code></pre><h3>After Change</h3><pre><code class='java'>

        elif self.conv_type == &quot2d&quot:
            &#47&#47 BxCxHxW -&gt; HxWxBxCx1
            x_perm = <a id="change">x.permute(2, 3, 0, 1).unsqueeze(-1</a><a id="change">)</a>
            output = x_perm * relu_coefs[:, :, :self.k] + relu_coefs[:, :, self.k:]
            &#47&#47 HxWxBxCx2 -&gt; BxCxHxW
            result = torch.max(output, dim=-1)[0].permute(2, 3, 0, 1)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/islanna/dynamicrelu/commit/1ee4394be4c9e5517d7dc2e5605416b65b321e53#diff-d70d5efd2d147b6729c9722c15ed5d22c4ca92e0b30e9a032d5e1d64b85c468bL52' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 20179163</div><div id='project'> Project Name: islanna/dynamicrelu</div><div id='commit'> Commit Name: 1ee4394be4c9e5517d7dc2e5605416b65b321e53</div><div id='time'> Time: 2020-04-14</div><div id='author'> Author: slizhikova.a.v@gmail.com</div><div id='file'> File Name: dyrelu.py</div><div id='m_class'> M Class Name: DyReLUB</div><div id='n_method'> N Class Name: DyReLUB</div><div id='m_method'> M Method Name: forward(2)</div><div id='n_method'> N Method Name: forward(2)</div><div id='m_parent_class'> M Parent Class: DyReLU</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: dyrelu.py</div><div id='n_file'> N File Name: dyrelu.py</div><div id='m_start'> M Start Line: 55</div><div id='m_end'> M End Line: 66</div><div id='n_start'> N Start Line: 62</div><div id='n_end'> N End Line: 80</div><BR>