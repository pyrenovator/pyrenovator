<html><h3>Pattern ID :18412
</h3><img src='60168694.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            )
        )

        <a id="change">np.random.seed(</a>self.seed<a id="change">)</a>
        torch.manual_seed(self.seed)

        self.sfm_model = SFM_Model(
            d_feat=self.d_feat,</code></pre><h3>After Change</h3><pre><code class='java'>
            )
        )

        <a id="change">if self.seed is not None</a>:
            <a id="change">np.random.seed(</a>self.seed<a id="change">)</a>
            torch.manual_seed(self.seed)

        self.sfm_model = SFM_Model(
            d_feat=self.d_feat,</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 9</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/77884db3a562a795d29e16e844c0c21fa17c26e2#diff-3deabc1688cc58d788c967fe2bfc6d160a2a8933cec2071c8cb62c5cc80b31ccL244' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60168694</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: 77884db3a562a795d29e16e844c0c21fa17c26e2</div><div id='time'> Time: 2020-11-30</div><div id='author'> Author: dw1920@nyu.edu</div><div id='file'> File Name: qlib/contrib/model/pytorch_sfm.py</div><div id='m_class'> M Class Name: SFM</div><div id='n_method'> N Class Name: SFM</div><div id='m_method'> M Method Name: __init__(17)</div><div id='n_method'> N Method Name: __init__(17)</div><div id='m_parent_class'> M Parent Class: Model</div><div id='n_parent_class'> N Parent Class: Model</div><div id='m_file'> M File Name: qlib/contrib/model/pytorch_sfm.py</div><div id='n_file'> N File Name: qlib/contrib/model/pytorch_sfm.py</div><div id='m_start'> M Start Line: 285</div><div id='m_end'> M End Line: 286</div><div id='n_start'> N Start Line: 244</div><div id='n_end'> N End Line: 289</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            )
        )

        <a id="change">np.random.seed(</a>self.seed<a id="change">)</a>
        torch.manual_seed(self.seed)

        self.gru_model = GRUModel(
            d_feat=self.d_feat,</code></pre><h3>After Change</h3><pre><code class='java'>
        self.loss = loss
        self.visible_GPU = GPU
        self.use_gpu = torch.cuda.is_available()
        <a id="change">self.seed</a> = seed

        self.logger.info(
            "GRU parameters setting:"
            "\nd_feat : {}"
            "\nhidden_size : {}"
            "\nnum_layers : {}"
            "\ndropout : {}"
            "\nn_epochs : {}"
            "\nlr : {}"
            "\nmetric : {}"
            "\nbatch_size : {}"
            "\nearly_stop : {}"
            "\noptimizer : {}"
            "\nloss_type : {}"
            "\nvisible_GPU : {}"
            "\nuse_GPU : {}"
            "\nseed : {}".format(
                d_feat,
                hidden_size,
                num_layers,
                dropout,
                n_epochs,
                lr,
                metric,
                batch_size,
                early_stop,
                optimizer.lower(),
                loss,
                GPU,
                self.use_gpu,
                seed,
            )
        )

        <a id="change">if self.seed is not None</a>:
            <a id="change">np.random.seed(</a>self.seed<a id="change">)</a>
            torch.manual_seed(self.seed)

        self.gru_model = GRUModel(
            d_feat=self.d_feat,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/77884db3a562a795d29e16e844c0c21fa17c26e2#diff-c97875df07622cf74cacd52427569a97a609af897a5a57053d9fdd4a8222fbcaL46' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60168695</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: 77884db3a562a795d29e16e844c0c21fa17c26e2</div><div id='time'> Time: 2020-11-30</div><div id='author'> Author: dw1920@nyu.edu</div><div id='file'> File Name: qlib/contrib/model/pytorch_gru.py</div><div id='m_class'> M Class Name: GRU</div><div id='n_method'> N Class Name: GRU</div><div id='m_method'> M Method Name: __init__(14)</div><div id='n_method'> N Method Name: __init__(14)</div><div id='m_parent_class'> M Parent Class: Model</div><div id='n_parent_class'> N Parent Class: Model</div><div id='m_file'> M File Name: qlib/contrib/model/pytorch_gru.py</div><div id='n_file'> N File Name: qlib/contrib/model/pytorch_gru.py</div><div id='m_start'> M Start Line: 116</div><div id='m_end'> M End Line: 117</div><div id='n_start'> N Start Line: 81</div><div id='n_end'> N End Line: 120</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        Seed to be set
    
    np.random.seed(seed)
    <a id="change">random.seed(</a>seed<a id="change">)</a>
    torch.manual_seed(seed)
    if torch.cuda.is_available():
        torch.cuda.manual_seed_all(seed)
</code></pre><h3>After Change</h3><pre><code class='java'>
    seed : int
        Seed to be set
    
    <a id="change">if seed is not None</a>:
        np.random.seed(seed)
        <a id="change">random.seed(</a>seed<a id="change">)</a>
        torch.manual_seed(seed)
        imgaug.seed(seed)

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/deepchecks/deepchecks/commit/b68f44edb585cebaed70a711623258ffda4119a7#diff-0011cb879c95e825887daee8e07ee0d4afda733834a2c5fd45e9977351f728c9L59' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60168693</div><div id='project'> Project Name: deepchecks/deepchecks</div><div id='commit'> Commit Name: b68f44edb585cebaed70a711623258ffda4119a7</div><div id='time'> Time: 2022-02-22</div><div id='author'> Author: matan@deepchecks.com</div><div id='file'> File Name: deepchecks/vision/utils/validation.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: set_seeds(1)</div><div id='n_method'> N Method Name: set_seeds(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: deepchecks/vision/utils/validation.py</div><div id='n_file'> N File Name: deepchecks/vision/utils/validation.py</div><div id='m_start'> M Start Line: 70</div><div id='m_end'> M End Line: 76</div><div id='n_start'> N Start Line: 71</div><div id='n_end'> N End Line: 77</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                seed,
            )
        )
        <a id="change">np.random.seed(</a>self.seed<a id="change">)</a>
        torch.manual_seed(self.seed)
        self.GAT_model = GATModel(
            d_feat=self.d_feat,
            hidden_size=self.hidden_size,</code></pre><h3>After Change</h3><pre><code class='java'>
        self.model_path = model_path
        self.visible_GPU = GPU
        self.use_gpu = torch.cuda.is_available()
        <a id="change">self.seed</a> = seed

        self.logger.info(
            "GATs parameters setting:"
            "\nd_feat : {}"
            "\nhidden_size : {}"
            "\nnum_layers : {}"
            "\ndropout : {}"
            "\nn_epochs : {}"
            "\nlr : {}"
            "\nmetric : {}"
            "\nearly_stop : {}"
            "\noptimizer : {}"
            "\nloss_type : {}"
            "\nbase_model : {}"
            "\nwith_pretrain : {}"
            "\nmodel_path : {}"
            "\nvisible_GPU : {}"
            "\nuse_GPU : {}"
            "\nseed : {}".format(
                d_feat,
                hidden_size,
                num_layers,
                dropout,
                n_epochs,
                lr,
                metric,
                early_stop,
                optimizer.lower(),
                loss,
                base_model,
                with_pretrain,
                model_path,
                GPU,
                self.use_gpu,
                seed,
            )
        )

        <a id="change">if self.seed is not None</a>:
            <a id="change">np.random.seed(</a>self.seed<a id="change">)</a>
            torch.manual_seed(self.seed)

        self.GAT_model = GATModel(
            d_feat=self.d_feat,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/77884db3a562a795d29e16e844c0c21fa17c26e2#diff-e6e141e4418fe3a31c5be85ef0b516bb84fcc584ba8354cff11b095655be690eL49' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60168704</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: 77884db3a562a795d29e16e844c0c21fa17c26e2</div><div id='time'> Time: 2020-11-30</div><div id='author'> Author: dw1920@nyu.edu</div><div id='file'> File Name: qlib/contrib/model/pytorch_gats.py</div><div id='m_class'> M Class Name: GATs</div><div id='n_method'> N Class Name: GATs</div><div id='m_method'> M Method Name: __init__(16)</div><div id='n_method'> N Method Name: __init__(16)</div><div id='m_parent_class'> M Parent Class: Model</div><div id='n_parent_class'> N Parent Class: Model</div><div id='m_file'> M File Name: qlib/contrib/model/pytorch_gats.py</div><div id='n_file'> N File Name: qlib/contrib/model/pytorch_gats.py</div><div id='m_start'> M Start Line: 126</div><div id='m_end'> M End Line: 127</div><div id='n_start'> N Start Line: 88</div><div id='n_end'> N End Line: 131</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            )
        )

        <a id="change">np.random.seed(</a>self.seed<a id="change">)</a>
        torch.manual_seed(self.seed)

        self.ALSTM_model = ALSTMModel(
            d_feat=self.d_feat,</code></pre><h3>After Change</h3><pre><code class='java'>
        self.loss = loss
        self.visible_GPU = GPU
        self.use_gpu = torch.cuda.is_available()
        <a id="change">self.seed</a> = seed

        self.logger.info(
            "ALSTM parameters setting:"
            "\nd_feat : {}"
            "\nhidden_size : {}"
            "\nnum_layers : {}"
            "\ndropout : {}"
            "\nn_epochs : {}"
            "\nlr : {}"
            "\nmetric : {}"
            "\nbatch_size : {}"
            "\nearly_stop : {}"
            "\noptimizer : {}"
            "\nloss_type : {}"
            "\nvisible_GPU : {}"
            "\nuse_GPU : {}"
            "\nseed : {}".format(
                d_feat,
                hidden_size,
                num_layers,
                dropout,
                n_epochs,
                lr,
                metric,
                batch_size,
                early_stop,
                optimizer.lower(),
                loss,
                GPU,
                self.use_gpu,
                seed,
            )
        )

        <a id="change">if self.seed is not None</a>:
            <a id="change">np.random.seed(</a>self.seed<a id="change">)</a>
            torch.manual_seed(self.seed)

        self.ALSTM_model = ALSTMModel(
            d_feat=self.d_feat,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/77884db3a562a795d29e16e844c0c21fa17c26e2#diff-aea46bbef8e49f01b4e11c50df4cac7ad3e735a494524263a185f76eabbaa062L46' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60168705</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: 77884db3a562a795d29e16e844c0c21fa17c26e2</div><div id='time'> Time: 2020-11-30</div><div id='author'> Author: dw1920@nyu.edu</div><div id='file'> File Name: qlib/contrib/model/pytorch_alstm.py</div><div id='m_class'> M Class Name: ALSTM</div><div id='n_method'> N Class Name: ALSTM</div><div id='m_method'> M Method Name: __init__(14)</div><div id='n_method'> N Method Name: __init__(14)</div><div id='m_parent_class'> M Parent Class: Model</div><div id='n_parent_class'> N Parent Class: Model</div><div id='m_file'> M File Name: qlib/contrib/model/pytorch_alstm.py</div><div id='n_file'> N File Name: qlib/contrib/model/pytorch_alstm.py</div><div id='m_start'> M Start Line: 116</div><div id='m_end'> M End Line: 117</div><div id='n_start'> N Start Line: 81</div><div id='n_end'> N End Line: 120</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
  assert seed &gt;=0, &quot{} &gt;= {}&quot.format(seed, 0)
  torch.manual_seed(seed)
  torch.cuda.manual_seed_all(seed)
  <a id="change">np.random.seed(</a>seed<a id="change">)</a>
  random.seed(seed)
  &quot&quot&quot change the deterministic and benchmark maybe cause uncertain convolution behavior. &quot&quot&quot
  torch.backends.cudnn.deterministic = True
  torch.backends.cudnn.benchmark = True</code></pre><h3>After Change</h3><pre><code class='java'>
import torch
&quot&quot&quot set random seed, gl_seed used in worker_init_fn function &quot&quot&quot
def set_seed(seed, gl_seed=0):
  <a id="change">if seed &gt;=0</a> and gl_seed&gt;=0:
    seed += gl_seed
    torch.manual_seed(seed)
    torch.cuda.manual_seed_all(seed)
    <a id="change">np.random.seed(</a>seed<a id="change">)</a>
    random.seed(seed)

  &quot&quot&quot change the deterministic and benchmark maybe cause uncertain convolution behavior. &quot&quot&quot
  &#47&#47 speed-reproducibility tradeoff https://pytorch.org/docs/stable/notes/randomness.html</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/janspiry/distributed-pytorch-template/commit/4ab49f16ca572628924f883f77c0798d35ce865b#diff-ba366573571ef75425a922c6a32e55f7480f4b41457fe437a8e7597429858cfeL5' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60168702</div><div id='project'> Project Name: janspiry/distributed-pytorch-template</div><div id='commit'> Commit Name: 4ab49f16ca572628924f883f77c0798d35ce865b</div><div id='time'> Time: 2022-02-17</div><div id='author'> Author: lw_jiang@foxmail.com</div><div id='file'> File Name: core/util.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: set_seed(2)</div><div id='n_method'> N Method Name: set_seed(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: core/util.py</div><div id='n_file'> N File Name: core/util.py</div><div id='m_start'> M Start Line: 5</div><div id='m_end'> M End Line: 14</div><div id='n_start'> N Start Line: 6</div><div id='n_end'> N End Line: 21</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            )
        )

        <a id="change">np.random.seed(</a>self.seed<a id="change">)</a>
        torch.manual_seed(self.seed)

        self.lstm_model = LSTMModel(
            d_feat=self.d_feat,</code></pre><h3>After Change</h3><pre><code class='java'>
        self.loss = loss
        self.visible_GPU = GPU
        self.use_gpu = torch.cuda.is_available()
        <a id="change">self.seed</a> = seed

        self.logger.info(
            "LSTM parameters setting:"
            "\nd_feat : {}"
            "\nhidden_size : {}"
            "\nnum_layers : {}"
            "\ndropout : {}"
            "\nn_epochs : {}"
            "\nlr : {}"
            "\nmetric : {}"
            "\nbatch_size : {}"
            "\nearly_stop : {}"
            "\noptimizer : {}"
            "\nloss_type : {}"
            "\nvisible_GPU : {}"
            "\nuse_GPU : {}"
            "\nseed : {}".format(
                d_feat,
                hidden_size,
                num_layers,
                dropout,
                n_epochs,
                lr,
                metric,
                batch_size,
                early_stop,
                optimizer.lower(),
                loss,
                GPU,
                self.use_gpu,
                seed,
            )
        )

        <a id="change">if self.seed is not None</a>:
            <a id="change">np.random.seed(</a>self.seed<a id="change">)</a>
            torch.manual_seed(self.seed)

        self.lstm_model = LSTMModel(
            d_feat=self.d_feat,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/77884db3a562a795d29e16e844c0c21fa17c26e2#diff-a20ed2f2ce8af21b59cd44ffb43861a347619cbaddbc1de99a57f4a10edb124aL46' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60168703</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: 77884db3a562a795d29e16e844c0c21fa17c26e2</div><div id='time'> Time: 2020-11-30</div><div id='author'> Author: dw1920@nyu.edu</div><div id='file'> File Name: qlib/contrib/model/pytorch_lstm.py</div><div id='m_class'> M Class Name: LSTM</div><div id='n_method'> N Class Name: LSTM</div><div id='m_method'> M Method Name: __init__(14)</div><div id='n_method'> N Method Name: __init__(14)</div><div id='m_parent_class'> M Parent Class: Model</div><div id='n_parent_class'> N Parent Class: Model</div><div id='m_file'> M File Name: qlib/contrib/model/pytorch_lstm.py</div><div id='n_file'> N File Name: qlib/contrib/model/pytorch_lstm.py</div><div id='m_start'> M Start Line: 116</div><div id='m_end'> M End Line: 117</div><div id='n_start'> N Start Line: 81</div><div id='n_end'> N End Line: 120</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    random.seed(seed)  &#47&#47 Python
    &#47&#47 todo: AB test whether I get the same results with/without this line
    env.action_space.seed(seed)  &#47&#47 probably redundant but I found an article where somebody had a problem with this
    <a id="change">env.seed(</a>seed<a id="change">)</a>  &#47&#47 OpenAI gym

    &#47&#47 todo: AB test impact on FPS metric
    &#47&#47 Deterministic operations for CuDNN, it may impact performances</code></pre><h3>After Change</h3><pre><code class='java'>


def set_random_seeds(env, seed):
    <a id="change">if seed is not None</a>:
        torch.manual_seed(seed)  &#47&#47 PyTorch
        np.random.seed(seed)  &#47&#47 NumPy
        random.seed(seed)  &#47&#47 Python
        &#47&#47 todo: AB test whether I get the same results with/without this line
        env.action_space.seed(seed)  &#47&#47 probably redundant but I found an article where somebody had a problem with this
        <a id="change">env.seed(</a>seed<a id="change">)</a>  &#47&#47 OpenAI gym

        &#47&#47 todo: AB test impact on FPS metric
        &#47&#47 Deterministic operations for CuDNN, it may impact performances</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/gordicaleksa/pytorch-learn-reinforcement-learning/commit/360ecb2a4996c50cbeb54364d69560712ea73f85#diff-9653b8c2ce917a6134298b00c8b3f7d4b7c4dc473a752303f37a870392742127L116' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60168700</div><div id='project'> Project Name: gordicaleksa/pytorch-learn-reinforcement-learning</div><div id='commit'> Commit Name: 360ecb2a4996c50cbeb54364d69560712ea73f85</div><div id='time'> Time: 2021-04-25</div><div id='author'> Author: gordicaleksa@gmail.com</div><div id='file'> File Name: utils/utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: set_random_seeds(2)</div><div id='n_method'> N Method Name: set_random_seeds(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: utils/utils.py</div><div id='n_file'> N File Name: utils/utils.py</div><div id='m_start'> M Start Line: 117</div><div id='m_end'> M End Line: 131</div><div id='n_start'> N Start Line: 117</div><div id='n_end'> N End Line: 132</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            )
        )

        <a id="change">np.random.seed(</a>self.seed<a id="change">)</a>
        torch.manual_seed(self.seed)

        if loss not in {"mse", "binary"}:
            raise NotImplementedError("loss {} is not supported!".format(loss))</code></pre><h3>After Change</h3><pre><code class='java'>
        self.loss_type = loss
        self.visible_GPU = GPU
        self.use_GPU = torch.cuda.is_available()
        <a id="change">self.seed</a> = seed

        self.logger.info(
            "DNN parameters setting:"
            "\nlayers : {}"
            "\nlr : {}"
            "\nmax_steps : {}"
            "\nbatch_size : {}"
            "\nearly_stop_rounds : {}"
            "\neval_steps : {}"
            "\nlr_decay : {}"
            "\nlr_decay_steps : {}"
            "\noptimizer : {}"
            "\nloss_type : {}"
            "\neval_steps : {}"
            "\nseed : {}"
            "\nvisible_GPU : {}"
            "\nuse_GPU : {}".format(
                layers,
                lr,
                max_steps,
                batch_size,
                early_stop_rounds,
                eval_steps,
                lr_decay,
                lr_decay_steps,
                optimizer,
                loss,
                eval_steps,
                seed,
                GPU,
                self.use_GPU,
            )
        )

        <a id="change">if self.seed is not None</a>:
            <a id="change">np.random.seed(</a>self.seed<a id="change">)</a>
            torch.manual_seed(self.seed)

        if loss not in {"mse", "binary"}:
            raise NotImplementedError("loss {} is not supported!".format(loss))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/77884db3a562a795d29e16e844c0c21fa17c26e2#diff-262692c578e458decfd85fcba44547340ec8f0f95ae83157e691e4f10f496179L49' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 60168701</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: 77884db3a562a795d29e16e844c0c21fa17c26e2</div><div id='time'> Time: 2020-11-30</div><div id='author'> Author: dw1920@nyu.edu</div><div id='file'> File Name: qlib/contrib/model/pytorch_nn.py</div><div id='m_class'> M Class Name: DNNModelPytorch</div><div id='n_method'> N Class Name: DNNModelPytorch</div><div id='m_method'> M Method Name: __init__(15)</div><div id='n_method'> N Method Name: __init__(15)</div><div id='m_parent_class'> M Parent Class: Model</div><div id='n_parent_class'> N Parent Class: Model</div><div id='m_file'> M File Name: qlib/contrib/model/pytorch_nn.py</div><div id='n_file'> N File Name: qlib/contrib/model/pytorch_nn.py</div><div id='m_start'> M Start Line: 119</div><div id='m_end'> M End Line: 120</div><div id='n_start'> N Start Line: 84</div><div id='n_end'> N End Line: 123</div><BR>