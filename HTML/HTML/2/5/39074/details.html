<html><h3>Pattern ID :39074
</h3><img src='111259632.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        try:
            entities = pydash.flatten([x.get_entities() for x in docs])
            &#47&#47 filter entities that have no mapping in cache manager
            entities<a id="change"> = </a><a id="change">filter(
                </a>lambda x: x.entity_class in self.index_group.entity_class_to_indices.keys(),
                entities<a id="change">,
            )</a>
            self.process_entities(entities)
        except Exception:
            affected_doc_ids = [doc.idx for doc in docs]
            for doc in docs:</code></pre><h3>After Change</h3><pre><code class='java'>
            for ent in pydash.flatten([x.get_entities() for x in docs]):
                if ent.entity_class not in self.index_group.entity_class_to_indices.keys():
                    continue
                if self.ignore_high_conf and <a id="change">any(
                    </a><a id="change">hit.confidence == LinkRanks.HIGH_CONFIDENCE for hit in ent.hits
                )</a>:
                    continue
                entities_to_process.append(ent)
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/astrazeneca/kazu/commit/2bd98607ab27ff8d921feeba61bb8cc64ff2ff2e#diff-5d0b0ded5b343b5692f05ff69dc8f3b4f8d860427b9eb29f6b3cbe52194fa86cL102' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111259632</div><div id='project'> Project Name: astrazeneca/kazu</div><div id='commit'> Commit Name: 2bd98607ab27ff8d921feeba61bb8cc64ff2ff2e</div><div id='time'> Time: 2022-11-30</div><div id='author'> Author: richard.jackson4@astrazeneca.com</div><div id='file'> File Name: kazu/steps/linking/sapbert.py</div><div id='m_class'> M Class Name: SapBertForEntityLinkingStep</div><div id='n_method'> N Class Name: SapBertForEntityLinkingStep</div><div id='m_method'> M Method Name: _run(2)</div><div id='n_method'> N Method Name: _run(2)</div><div id='m_parent_class'> M Parent Class: BaseStep</div><div id='n_parent_class'> N Parent Class: BaseStep</div><div id='m_file'> M File Name: kazu/steps/linking/sapbert.py</div><div id='n_file'> N File Name: kazu/steps/linking/sapbert.py</div><div id='m_start'> M Start Line: 102</div><div id='m_end'> M End Line: 107</div><div id='n_start'> N Start Line: 106</div><div id='n_end'> N End Line: 116</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    def cleanup(self, doc: Document):
        for section in doc.sections:
            section_ents = set(section.entities)
            filtered_ents<a id="change"> = </a>set(<a id="change">filter(</a>self.combined_filter_fn, section_ents<a id="change">)</a>)

            section_ents.difference_update(filtered_ents)
            section.entities = list(section_ents)</code></pre><h3>After Change</h3><pre><code class='java'>
    def cleanup(self, doc: Document):
        for section in doc.sections:
            section.entities = [
                entity for entity in section.entities if not <a id="change">any(</a><a id="change">f(entity) for f in self.filter_fns)</a>
            ]


class DropUnmappedEntityFilter:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/astrazeneca/kazu/commit/daa9e9e80eb45c234ea8215c3024f70569d849c2#diff-924400bc3adc5aebac61d567fc3f2b2d41dd9528a92527417e3c6cc7ed2deb1dL43' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111259629</div><div id='project'> Project Name: astrazeneca/kazu</div><div id='commit'> Commit Name: daa9e9e80eb45c234ea8215c3024f70569d849c2</div><div id='time'> Time: 2022-11-30</div><div id='author'> Author: rolando.fernandez@astrazeneca.net</div><div id='file'> File Name: kazu/steps/other/cleanup.py</div><div id='m_class'> M Class Name: EntityFilterCleanupAction</div><div id='n_method'> N Class Name: EntityFilterCleanupAction</div><div id='m_method'> M Method Name: cleanup(2)</div><div id='n_method'> N Method Name: cleanup(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: kazu/steps/other/cleanup.py</div><div id='n_file'> N File Name: kazu/steps/other/cleanup.py</div><div id='m_start'> M Start Line: 44</div><div id='m_end'> M End Line: 49</div><div id='n_start'> N Start Line: 24</div><div id='n_end'> N End Line: 27</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    
    list_dir = os.listdir(root)
    list_dir<a id="change"> = </a>list(<a id="change">filter(</a>lambda x: not _is_lightly_output_dir(x), list_dir<a id="change">)</a>)
    is_dir = \
        [os.path.isdir(os.path.join(root, f)) for f in list_dir]
    return any(is_dir)</code></pre><h3>After Change</h3><pre><code class='java'>

    
    with os.scandir(root) as scan_dir:
        return <a id="change">any(</a><a id="change">not _is_lightly_output_dir(f.name) for f in scan_dir \
            if f.is_dir())</a>


def _load_dataset_from_folder(root: str, transform):
    Initializes dataset from folder.</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/lightly-ai/lightly/commit/ca83601cd72fde73ade02a156c213f0b0c07d034#diff-2136b6af625f7dab13d9ffffc0ceead7259de7187a21d750c7a9ec46f655f42dL54' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111259628</div><div id='project'> Project Name: lightly-ai/lightly</div><div id='commit'> Commit Name: ca83601cd72fde73ade02a156c213f0b0c07d034</div><div id='time'> Time: 2021-06-09</div><div id='author'> Author: 65946090+philippmwirth@users.noreply.github.com</div><div id='file'> File Name: lightly/data/_helpers.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _contains_subdirs(1)</div><div id='n_method'> N Method Name: _contains_subdirs(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: lightly/data/_helpers.py</div><div id='n_file'> N File Name: lightly/data/_helpers.py</div><div id='m_start'> M Start Line: 64</div><div id='m_end'> M End Line: 68</div><div id='n_start'> N Start Line: 62</div><div id='n_end'> N End Line: 66</div><BR>