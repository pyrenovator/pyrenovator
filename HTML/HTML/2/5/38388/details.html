<html><h3>Pattern ID :38388
</h3><img src='109701259.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                    stride=self.custom_config["model_arch_args"]["stride_layer_{}".format(i)],
                    padding=self.custom_config["model_arch_args"]["padding_layer_{}".format(i)],
                )
                relu_f = <a id="change">nn.ReLU()</a>
                pool_f = nn.MaxPool2d(kernel_size=self.custom_config["model_arch_args"]["pool_size_layer_{}".format(i)])

                layers.append(conv_f)
                layers.append(relu_f)
                layers.append(pool_f)

                input_dim = self.custom_config["model_arch_args"]["out_channel_layer_{}".format(i)]

        else:
            raise ValueError()

        self.encoder = nn.Sequential(
            *layers
        )

        self.hidden_state_size = self.custom_config["model_arch_args"]["hidden_state_size"]
        self.rnn = nn.GRUCell(input_dim, self.hidden_state_size)
        self.q_value = <a id="change">nn.Linear(</a>self.hidden_state_size, num_outputs<a id="change">)</a>

        &#47&#47 record the custom config
        if self.custom_config["global_state_flag"]:
            state_dim = self.custom_config["space_obs"]["state"].shape</code></pre><h3>After Change</h3><pre><code class='java'>
                    encoder_layer_dim.append(out_dim)

            self.encoder_layer_dim = encoder_layer_dim
            self.obs_size = <a id="change">self.full_obs_space.shape[0]</a>
            input_dim = self.obs_size
            for out_dim in self.encoder_layer_dim:
                layers.append(
                    SlimFC(in_size=input_dim,</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/replicable-marl/marllib/commit/2d4a24632db3e3a2b79e668e480b40ec8052cf2a#diff-a3ae1807964184fc7bd5f50fd265417e9851578c4b06d73479a7675fa6f7ae88L20' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 109701259</div><div id='project'> Project Name: replicable-marl/marllib</div><div id='commit'> Commit Name: 2d4a24632db3e3a2b79e668e480b40ec8052cf2a</div><div id='time'> Time: 2023-02-25</div><div id='author'> Author: hhhusiyi@163.com</div><div id='file'> File Name: marllib/marl/models/zoo/rnn/jointQ_rnn.py</div><div id='m_class'> M Class Name: JointQ_RNN</div><div id='n_method'> N Class Name: JointQ_RNN</div><div id='m_method'> M Method Name: __init__(6)</div><div id='n_method'> N Method Name: __init__(6)</div><div id='m_parent_class'> M Parent Class: nn.Module,TorchModelV2</div><div id='n_parent_class'> N Parent Class: nn.Module,TorchModelV2</div><div id='m_file'> M File Name: marllib/marl/models/zoo/rnn/jointQ_rnn.py</div><div id='n_file'> N File Name: marllib/marl/models/zoo/rnn/jointQ_rnn.py</div><div id='m_start'> M Start Line: 28</div><div id='m_end'> M End Line: 81</div><div id='n_start'> N Start Line: 20</div><div id='n_end'> N End Line: 85</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                    stride=self.custom_config["model_arch_args"]["stride_layer_{}".format(i)],
                    padding=self.custom_config["model_arch_args"]["padding_layer_{}".format(i)],
                )
                relu_f = <a id="change">nn.ReLU()</a>
                pool_f = nn.MaxPool2d(kernel_size=self.custom_config["model_arch_args"]["pool_size_layer_{}".format(i)])

                layers.append(conv_f)
                layers.append(relu_f)
                layers.append(pool_f)

                input_dim = self.custom_config["model_arch_args"]["out_channel_layer_{}".format(i)]

        else:
            raise ValueError()

        self.encoder = nn.Sequential(
            *layers
        )

        self.hidden_state_size = self.custom_config["model_arch_args"]["hidden_state_size"]
        self.mlp = nn.Linear(input_dim, self.hidden_state_size)
        self.q_value = <a id="change">nn.Linear(</a>self.hidden_state_size, num_outputs<a id="change">)</a>

        self.n_agents = self.custom_config["num_agents"]
        &#47&#47 record the custom config
        self.custom_config = self.custom_config</code></pre><h3>After Change</h3><pre><code class='java'>
                    encoder_layer_dim.append(out_dim)

            self.encoder_layer_dim = encoder_layer_dim
            self.obs_size = <a id="change">self.full_obs_space.shape[0]</a>
            input_dim = self.obs_size
            for out_dim in self.encoder_layer_dim:
                layers.append(
                    SlimFC(in_size=input_dim,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/replicable-marl/marllib/commit/2d4a24632db3e3a2b79e668e480b40ec8052cf2a#diff-c1709e0b089bf66b79f80d158029c395b43af7ea071f27a23f50e5cb568efbb9L13' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 109701267</div><div id='project'> Project Name: replicable-marl/marllib</div><div id='commit'> Commit Name: 2d4a24632db3e3a2b79e668e480b40ec8052cf2a</div><div id='time'> Time: 2023-02-25</div><div id='author'> Author: hhhusiyi@163.com</div><div id='file'> File Name: marllib/marl/models/zoo/mlp/jointQ_mlp.py</div><div id='m_class'> M Class Name: JointQ_MLP</div><div id='n_method'> N Class Name: JointQ_MLP</div><div id='m_method'> M Method Name: __init__(6)</div><div id='n_method'> N Method Name: __init__(6)</div><div id='m_parent_class'> M Parent Class: nn.Module,TorchModelV2</div><div id='n_parent_class'> N Parent Class: nn.Module,TorchModelV2</div><div id='m_file'> M File Name: marllib/marl/models/zoo/mlp/jointQ_mlp.py</div><div id='n_file'> N File Name: marllib/marl/models/zoo/mlp/jointQ_mlp.py</div><div id='m_start'> M Start Line: 18</div><div id='m_end'> M End Line: 84</div><div id='n_start'> N Start Line: 20</div><div id='n_end'> N End Line: 84</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            if l_id == len(layer_sizes) - 1:
                if norm_output:
                    layers.append(nn.Sequential(
                        <a id="change">nn.Linear(</a>input_size, int(current_size * current_size * current_channels)<a id="change">)</a>,
                        nn.Sigmoid()
                    ))
                else:
                    layers.append(nn.Sequential(
                        nn.Linear(input_size, int(current_size * current_size * current_channels)),
                    ))
            else:
                layers.append(nn.Sequential(
                    <a id="change">nn.ReLU()</a>,  &#47&#47 input shape (1, current_size, current_size)
                    nn.ConvTranspose2d(
                        in_channels=layer_sizes[l_id],  &#47&#47 input height
                        out_channels=current_channels,</code></pre><h3>After Change</h3><pre><code class='java'>

        layers = []
        current_channels = 1
        current_size = <a id="change">feature_size[0]</a>
        &#47&#47Loop backward through decoding layers in order to work out the dimensions at each layer - in particular the first
        &#47&#47 linear layer needs to know B*current_size*current_size*channels
        for l_id in range(len(channels)):
            if l_id == len(channels) - 1:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jameschapman19/cca_zoo/commit/f1ccf7409a79dfe95a0da520add60e02cad61c3f#diff-3377d0e8ff2e3d41948279d51bf1d82b80f1f48aa340ab1418fd5248633b935eL159' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 109701271</div><div id='project'> Project Name: jameschapman19/cca_zoo</div><div id='commit'> Commit Name: f1ccf7409a79dfe95a0da520add60e02cad61c3f</div><div id='time'> Time: 2021-01-20</div><div id='author'> Author: james.chapman.19@ucl.ac.uk</div><div id='file'> File Name: cca_zoo/deep_models.py</div><div id='m_class'> M Class Name: CNNDecoder</div><div id='n_method'> N Class Name: CNNDecoder</div><div id='m_method'> M Method Name: __init__(8)</div><div id='n_method'> N Method Name: __init__(8)</div><div id='m_parent_class'> M Parent Class: BaseDecoder</div><div id='n_parent_class'> N Parent Class: BaseDecoder</div><div id='m_file'> M File Name: cca_zoo/deep_models.py</div><div id='n_file'> N File Name: cca_zoo/deep_models.py</div><div id='m_start'> M Start Line: 159</div><div id='m_end'> M End Line: 199</div><div id='n_start'> N Start Line: 167</div><div id='n_end'> N End Line: 204</div><BR>