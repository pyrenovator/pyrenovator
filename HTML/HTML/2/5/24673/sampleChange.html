<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    head = build_head(cfg)

    cls_preds, reg_preds = head.forward(feat)
    for cls, reg, stride in <a id="change">zip(</a>cls_preds, reg_preds, [8, 16, 32]<a id="change">)</a>:
        assert cls.shape == (1, 20, 320 // stride, 320 // stride)
        assert reg.shape == (1, (5 + 1) * 4, 320 // stride, 320 // stride)
</code></pre><h3>After Change</h3><pre><code class='java'>
    feat = [torch.rand(1, 1, 320 // stride, 320 // stride) for stride in [8, 16, 32]]

    preds = head.forward(feat)
    num_points<a id="change"> = </a><a id="change">sum([(320 // stride) ** 2 for stride in [8, 16, 32]]</a><a id="change">)</a>
    assert preds.shape == (1, num_points, 80 + (8 + 1) * 4)

    head_cfg = dict(
        name="NanoDetHead",</code></pre>