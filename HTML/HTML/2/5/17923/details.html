<html><h3>Pattern ID :17923
</h3><img src='58814039.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        for idx, (used_mem, max_mem) in enumerate(
                zip(self.gpu_used_mem_list, self.gpu_max_mem_list)):
            print(f"GPU:{idx} used mem {used_mem} B max mem {max_mem} B")
        <a id="change">for </a>idx, (used_mem, max_mem) in <a id="change">enumerate(
                zip(</a>self.cpu_used_mem_list, self.cpu_max_mem_list<a id="change">)</a><a id="change">):
            </a>print(f"CPU:{idx} used mem {used_mem} B max mem {max_mem} B")

    def add(self, device_type: str, index: int, size: int):
        </code></pre><h3>After Change</h3><pre><code class='java'>
        self.init(max_gpu_memory, max_cpu_memory)

    def visit(self):
        <a id="change">logger.info(
            f"CPU used mem {self.cpu_used_mem} B, GPU used mem {self.gpu_used_mem} B"</a><a id="change">
        )</a>

    def add(self, device_type: str, size_in_bytes: int):
        
        登记，设备device_type:index增加size个bytes内存使用</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/tencent/patrickstar/commit/4be35e6c1af4abb7dba9ce7caf52e3be0b244a4c#diff-ee80c48796d40403847fff1c0b7fbe89877d6a36658603dfc0d4f6561b51d6f3L70' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 58814039</div><div id='project'> Project Name: tencent/patrickstar</div><div id='commit'> Commit Name: 4be35e6c1af4abb7dba9ce7caf52e3be0b244a4c</div><div id='time'> Time: 2021-06-23</div><div id='author'> Author: jiaruifang@tencent.com</div><div id='file'> File Name: manager/manager.py</div><div id='m_class'> M Class Name: PatrickStarManager</div><div id='n_method'> N Class Name: PatrickStarManager</div><div id='m_method'> M Method Name: visit(1)</div><div id='n_method'> N Method Name: visit(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: manager/manager.py</div><div id='n_file'> N File Name: manager/manager.py</div><div id='m_start'> M Start Line: 84</div><div id='m_end'> M End Line: 91</div><div id='n_start'> N Start Line: 70</div><div id='n_end'> N End Line: 72</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    now = time.strftime("%Y%m%d_%H%M%S")
    filepath = os.path.join(os.path.abspath(os.getcwd()), "animations")

    <a id="change">for </a>i_batch, (x,y) in <a id="change">enumerate(zip(</a>input_data, input_label<a id="change">)</a><a id="change">):
        </a>x_good = x[0]
        x_good = x_good.reshape((1, x.shape[1], x.shape[-1]))
        y_good = y[0]
        y_good = y_good.reshape((1,1,1))</code></pre><h3>After Change</h3><pre><code class='java'>
    x = input_data
    y = input_label
    x_recon = model(x,y) &#47&#47 has shape [batch_size, seq_len, 159]
    <a id="change">logging.info(&quotxrecon has&quot</a><a id="change">)</a>
    logging.info(x_recon.shape)
    _, seq_len, _ = x.shape

    x_formatted = x[0].reshape((seq_len, -1, 3))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/bioshape-lab/pirounet/commit/149d8ab584d8a5bd20c5f508a727bb53b470cc0f#diff-b846f0a50c78707b6a72060ccf30dec6e1367880274b53faa6ad883a975416a4L349' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 58814040</div><div id='project'> Project Name: bioshape-lab/pirounet</div><div id='commit'> Commit Name: 149d8ab584d8a5bd20c5f508a727bb53b470cc0f</div><div id='time'> Time: 2022-05-17</div><div id='author'> Author: papillon@umail.ucsb.edu</div><div id='file'> File Name: move/generate_f.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: recongeneral(8)</div><div id='n_method'> N Method Name: recongeneral(8)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: move/generate_f.py</div><div id='n_file'> N File Name: move/generate_f.py</div><div id='m_start'> M Start Line: 367</div><div id='m_end'> M End Line: 382</div><div id='n_start'> N Start Line: 384</div><div id='n_end'> N End Line: 388</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        section_id = 0
        for doc in docs:
            for section in doc.sections:
                <a id="change">for </a>token_index, (offsets, word_id) in <a id="change">enumerate(
                    zip(
                        </a>loader.dataset.encodings.encodings[section_id].offsets,
                        loader.dataset.encodings.encodings[section_id].word_ids<a id="change">,
                    )</a><a id="change">
                ):
                    &#47&#47 word_id is None if token is a special token (e.g. [CLS] in bery)
                    </a>if word_id is not None:
                        label = self.config.id2label[
                            confidence_and_labels_tensor[1][section_id][token_index].item()
                        ]</code></pre><h3>After Change</h3><pre><code class='java'>
                &#47&#47 TODO: add BioLabelPreProcessor here
                for i, label in enumerate(word.word_labels_strings):
                    if self.debug:
                        <a id="change">logger.info(
                            f"processing label: {label} for token {section.text[word.word_offsets[i][0]:word.word_offsets[i][1]]}"</a><a id="change">
                        )</a>
                    self.entity_mapper.update_parse_states(
                        label,
                        offsets=word.word_offsets[i],
                        text=section.text,</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/astrazeneca/kazu/commit/4d1b6d74c016688209d82e500016dd8eda45da27#diff-9ec49f69bf2c8adcd8a03e6c8e31f8cdc4c5d41c030cc74bfd06e94922c367ddL60' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 58814042</div><div id='project'> Project Name: astrazeneca/kazu</div><div id='commit'> Commit Name: 4d1b6d74c016688209d82e500016dd8eda45da27</div><div id='time'> Time: 2021-11-16</div><div id='author'> Author: richard.jackson4@astrazeneca.com</div><div id='file'> File Name: azner/steps/ner/hf_token_classification.py</div><div id='m_class'> M Class Name: TransformersModelForTokenClassificationNerStep</div><div id='n_method'> N Class Name: TransformersModelForTokenClassificationNerStep</div><div id='m_method'> M Method Name: _run(2)</div><div id='n_method'> N Method Name: _run(2)</div><div id='m_parent_class'> M Parent Class: BaseStep</div><div id='n_parent_class'> N Parent Class: BaseStep</div><div id='m_file'> M File Name: azner/steps/ner/hf_token_classification.py</div><div id='n_file'> N File Name: azner/steps/ner/hf_token_classification.py</div><div id='m_start'> M Start Line: 61</div><div id='m_end'> M End Line: 103</div><div id='n_start'> N Start Line: 189</div><div id='n_end'> N End Line: 220</div><BR>