<html><h3>Pattern ID :647
</h3><img src='3034174.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            "prev_a": prev_qa[1]
        }

        res = <a id="change">requests.post("https://api.kiri.ai/qa"</a><a id="change">, json=body,
                            headers={"x-api-key": api_key})</a>

        return res["answer"]
</code></pre><h3>After Change</h3><pre><code class='java'>
            "prev_a": prev_qa[1]
        }

        res = <a id="change">requests.post("https://api.kiri.ai/qa", json=body,
                            headers={"x-api-key": api_key}).json()</a>

        return res["answer"]
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 10</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/kiri-ai/kiri/commit/a576973d199c3968f4c3a0c8c53c7fcead140fec#diff-efb4ea2eb9bdd78acec50a5426cd4898eb3bec9897114848746eeb91e2ad7a15L50' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 3034174</div><div id='project'> Project Name: kiri-ai/kiri</div><div id='commit'> Commit Name: a576973d199c3968f4c3a0c8c53c7fcead140fec</div><div id='time'> Time: 2021-01-10</div><div id='author'> Author: ojasaarkristo@gmail.com</div><div id='file'> File Name: kiri/models/qa.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: qa(7)</div><div id='n_method'> N Method Name: qa(7)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: kiri/models/qa.py</div><div id='n_file'> N File Name: kiri/models/qa.py</div><div id='m_start'> M Start Line: 50</div><div id='m_end'> M End Line: 51</div><div id='n_start'> N Start Line: 50</div><div id='n_end'> N End Line: 51</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        sys.exit(1)

    req_body = {"trial_ids": args.trial_ids, "experiment_ids": args.experiment_ids}
    resp = <a id="change">api.post(</a>args.master, <a id="change">"tensorboard"</a><a id="change">, body=req_body)</a>

    res_body = resp.json()

    if args.detach:</code></pre><h3>After Change</h3><pre><code class='java'>
        "trial_ids": args.trial_ids,
        "experiment_ids": args.experiment_ids,
    }
    resp = <a id="change">api.post(args.master, "tensorboard", body=req_body).json()</a>

    if args.detach:
        print(resp["id"])
        return</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/determined-ai/determined/commit/4041e5bed1c9d01f1e3f3e6854722d88dcbb79ee#diff-3fabcf9fdc3d87529b1c10a6236b9731638ad23cc0e93911ec07583c3b249c3aL35' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 3034175</div><div id='project'> Project Name: determined-ai/determined</div><div id='commit'> Commit Name: 4041e5bed1c9d01f1e3f3e6854722d88dcbb79ee</div><div id='time'> Time: 2020-09-01</div><div id='author'> Author: 31023784+eecsliu@users.noreply.github.com</div><div id='file'> File Name: cli/determined_cli/tensorboard.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: start_tensorboard(1)</div><div id='n_method'> N Method Name: start_tensorboard(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: cli/determined_cli/tensorboard.py</div><div id='n_file'> N File Name: cli/determined_cli/tensorboard.py</div><div id='m_start'> M Start Line: 41</div><div id='m_end'> M End Line: 62</div><div id='n_start'> N Start Line: 40</div><div id='n_end'> N End Line: 65</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            "labels": labels
        }

        res = <a id="change">requests.post("https://api.kiri.ai/classification"</a><a id="change">, json=body,
                            headers={"x-api-key": api_key})</a>

        return res["probabilities"]
</code></pre><h3>After Change</h3><pre><code class='java'>
            "labels": labels
        }

        res = <a id="change">requests.post("https://api.kiri.ai/classification", json=body,
                            headers={"x-api-key": api_key}).json()</a>

        return res["probabilities"]
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/kiri-ai/kiri/commit/a576973d199c3968f4c3a0c8c53c7fcead140fec#diff-1e9a868a525eb9b0306aeea46a49002a8a3c127029bd8bf1555a0231588b6c6aL22' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 3034172</div><div id='project'> Project Name: kiri-ai/kiri</div><div id='commit'> Commit Name: a576973d199c3968f4c3a0c8c53c7fcead140fec</div><div id='time'> Time: 2021-01-10</div><div id='author'> Author: ojasaarkristo@gmail.com</div><div id='file'> File Name: kiri/models/classification.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: zero_shot(6)</div><div id='n_method'> N Method Name: zero_shot(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: kiri/models/classification.py</div><div id='n_file'> N File Name: kiri/models/classification.py</div><div id='m_start'> M Start Line: 81</div><div id='m_end'> M End Line: 82</div><div id='n_start'> N Start Line: 81</div><div id='n_end'> N End Line: 82</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            "text": input_text
        }

        res = <a id="change">requests.post("https://api.kiri.ai/summarisation"</a><a id="change">, json=body,
                            headers={"x-api-key": api_key})</a>

        return res["summary"]
</code></pre><h3>After Change</h3><pre><code class='java'>
            "text": input_text
        }

        res = <a id="change">requests.post("https://api.kiri.ai/summarisation", json=body,
                            headers={"x-api-key": api_key}).json()</a>

        return res["summary"]
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/kiri-ai/kiri/commit/a576973d199c3968f4c3a0c8c53c7fcead140fec#diff-1cd8b5faccf43a7299ad6c16304dbb5601e63b0b822a1ebe26b1452c352daf43L11' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 3034173</div><div id='project'> Project Name: kiri-ai/kiri</div><div id='commit'> Commit Name: a576973d199c3968f4c3a0c8c53c7fcead140fec</div><div id='time'> Time: 2021-01-10</div><div id='author'> Author: ojasaarkristo@gmail.com</div><div id='file'> File Name: kiri/models/summary.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: summarise(5)</div><div id='n_method'> N Method Name: summarise(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: kiri/models/summary.py</div><div id='n_file'> N File Name: kiri/models/summary.py</div><div id='m_start'> M Start Line: 32</div><div id='m_end'> M End Line: 33</div><div id='n_start'> N Start Line: 32</div><div id='n_end'> N End Line: 33</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            "text": input_text
        }

        res = <a id="change">requests.post("https://api.kiri.ai/vectorisation"</a><a id="change">, json=body,
                            headers={"x-api-key": api_key})</a>

        return res["vector"]
</code></pre><h3>After Change</h3><pre><code class='java'>
            "text": input_text
        }

        res = <a id="change">requests.post("https://api.kiri.ai/vectorisation", json=body,
                            headers={"x-api-key": api_key}).json()</a>

        return res["vector"]
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/backprop-ai/backprop/commit/a576973d199c3968f4c3a0c8c53c7fcead140fec#diff-ef690fd52bfe0c676d64819e89e0810b0b736bc592ab030d19b4341f127619a6L9' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 3034171</div><div id='project'> Project Name: backprop-ai/backprop</div><div id='commit'> Commit Name: a576973d199c3968f4c3a0c8c53c7fcead140fec</div><div id='time'> Time: 2021-01-10</div><div id='author'> Author: ojasaarkristo@gmail.com</div><div id='file'> File Name: kiri/models/vectorisation.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: vectorise(4)</div><div id='n_method'> N Method Name: vectorise(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: kiri/models/vectorisation.py</div><div id='n_file'> N File Name: kiri/models/vectorisation.py</div><div id='m_start'> M Start Line: 37</div><div id='m_end'> M End Line: 38</div><div id='n_start'> N Start Line: 37</div><div id='n_end'> N End Line: 38</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            "text": input_text
        }

        res = <a id="change">requests.post("https://api.kiri.ai/emotion"</a><a id="change">, json=body,
                            headers={"x-api-key": api_key})</a>

        return res["emotion"]
</code></pre><h3>After Change</h3><pre><code class='java'>
            "text": input_text
        }

        res = <a id="change">requests.post("https://api.kiri.ai/emotion", json=body,
                            headers={"x-api-key": api_key}).json()</a>

        return res["emotion"]
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/kiri-ai/kiri/commit/a576973d199c3968f4c3a0c8c53c7fcead140fec#diff-0d97217a389782f8096e3e3832ff160554c25e78f8a87a86c03c8e2cdb3bf639L11' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 3034181</div><div id='project'> Project Name: kiri-ai/kiri</div><div id='commit'> Commit Name: a576973d199c3968f4c3a0c8c53c7fcead140fec</div><div id='time'> Time: 2021-01-10</div><div id='author'> Author: ojasaarkristo@gmail.com</div><div id='file'> File Name: kiri/models/emotion.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: emotion(5)</div><div id='n_method'> N Method Name: emotion(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: kiri/models/emotion.py</div><div id='n_file'> N File Name: kiri/models/emotion.py</div><div id='m_start'> M Start Line: 32</div><div id='m_end'> M End Line: 33</div><div id='n_start'> N Start Line: 32</div><div id='n_end'> N End Line: 33</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
@pytest.mark.parametrize("server_type", ["ray_server", "ray_server_with_jwt_auth"])
def test_batch_api(server_type, request, kazu_test_config):
    headers = request.getfixturevalue(server_type)
    data = <a id="change">requests.post(
        f"http://127.0.0.1:{kazu_test_config.ray.serve.port}/api/{KAZU}/batch"</a><a id="change">,
        headers=headers,
        json=[
            {"text": "EGFR is an important gene in breast cancer"},
            {
                "sections": {
                    "sec1": "hello this is the first section",
                    "sec2": "the second section mentions BRCA1",
                }
            },
        ],
    )</a>.json()
    doc0_section0 = data[0]["sections"][0]
    assert len(doc0_section0["entities"]) &gt; 0
    assert doc0_section0["entities"][0]["match"] == "EGFR"</code></pre><h3>After Change</h3><pre><code class='java'>
    if should_fail_auth:
        headers = {}

    response = <a id="change">requests.post(
        f"http://127.0.0.1:{kazu_test_config.ray.serve.port}/api/{KAZU}/batch"</a><a id="change">,
        headers=headers,
        json=[
            {"text": "EGFR is an important gene in breast cancer"},
            {
                "sections": {
                    "sec1": "hello this is the first section",
                    "sec2": "the second section mentions BRCA1",
                }
            },
        ],
    )</a>
    if should_fail_auth:
        assert response.status_code == 401
    else:
        data = <a id="change">response.json()</a>
        doc0_section0 = data[0]["sections"][0]
        assert len(doc0_section0["entities"]) &gt; 0
        assert doc0_section0["entities"][0]["match"] == "EGFR"
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/astrazeneca/kazu/commit/37afec29a88375337425bd7ef38e23fea3fea442#diff-967d449fe3bf242df4d474b5630e3db30f71593e9ab9cba6995d7b94bb9b6f06L21' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 3034178</div><div id='project'> Project Name: astrazeneca/kazu</div><div id='commit'> Commit Name: 37afec29a88375337425bd7ef38e23fea3fea442</div><div id='time'> Time: 2022-11-30</div><div id='author'> Author: richard.jackson4@astrazeneca.com</div><div id='file'> File Name: kazu/tests/test_server.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: test_batch_api(4)</div><div id='n_method'> N Method Name: test_batch_api(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: kazu/tests/test_server.py</div><div id='n_file'> N File Name: kazu/tests/test_server.py</div><div id='m_start'> M Start Line: 23</div><div id='m_end'> M End Line: 41</div><div id='n_start'> N Start Line: 31</div><div id='n_end'> N End Line: 58</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        

        &#47&#47 Delete best match
        <a id="change">self.client.post("delete"</a><a id="change">, json=[4])</a>

        &#47&#47 Search for best match
        uid = self.client.get("search?query=feel%20good%20story&limit=1").json()[0]["id"]
</code></pre><h3>After Change</h3><pre><code class='java'>
        

        &#47&#47 Delete best match
        ids = <a id="change">self.client.post("delete", json=[4]).json()</a>
        self.assertEqual(ids, [4])

        &#47&#47 Search for best match
        uid = self.client.get("search?query=feel%20good%20story&limit=1").json()[0]["id"]</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/neuml/txtai/commit/a0bd420890dee0d56d22f1a83719231a4f7574da#diff-3076319477ddc95876de4201e44a393262afee2795b231ce5354045e8050d967L90' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 3034179</div><div id='project'> Project Name: neuml/txtai</div><div id='commit'> Commit Name: a0bd420890dee0d56d22f1a83719231a4f7574da</div><div id='time'> Time: 2021-05-18</div><div id='author'> Author: 561939+davidmezzetti@users.noreply.github.com</div><div id='file'> File Name: test/python/testapi/testembeddings.py</div><div id='m_class'> M Class Name: TestEmbeddings</div><div id='n_method'> N Class Name: TestEmbeddings</div><div id='m_method'> M Method Name: testDelete(1)</div><div id='n_method'> N Method Name: testDelete(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: test/python/testapi/testembeddings.py</div><div id='n_file'> N File Name: test/python/testapi/testembeddings.py</div><div id='m_start'> M Start Line: 96</div><div id='m_end'> M End Line: 96</div><div id='n_start'> N Start Line: 103</div><div id='n_end'> N End Line: 104</div><BR>