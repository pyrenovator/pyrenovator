<html><h3>Pattern ID :7108
</h3><img src='23673081.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        self.input_channel = obs_shape[2]
        self.representation_dim = representation_dim
        self.conv_layers = []
        self.dense_layers = <a id="change">[]</a>
        for layer_spec in architecture[&quotCONV&quot]:
            self.conv_layers.append(nn.Conv2d(self.input_channel, layer_spec[&quotout_dim&quot],
                                              kernel_size=layer_spec[&quotkernel_size&quot], stride=layer_spec[&quotstride&quot]))
            self.input_channel = layer_spec[&quotout_dim&quot]</code></pre><h3>After Change</h3><pre><code class='java'>
            shared_network_layers.append(nn.ReLU())
            self.input_channel = layer_spec[&quotout_dim&quot]

        shared_network_layers.append(<a id="change">nn.Flatten()</a>)
        for ind, layer_spec in enumerate(architecture[&quotDENSE&quot][:-1]):
            in_dim, out_dim = layer_spec.get(&quotin_dim&quot), layer_spec.get(&quotout_dim&quot)
            shared_network_layers.append(nn.Linear(in_dim, out_dim))
            shared_network_layers.append(nn.ReLU())

        self.shared_network<a id="change"> = nn</a><a id="change">.Sequential(</a>*<a id="change">shared_network_layers)</a>

        self.mean_layer = nn.Linear(architecture[&quotDENSE&quot][-1][&quotin_dim&quot], self.representation_dim)

</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/humancompatibleai/eirli/commit/750b1a684e9a1c9f1456ce3e8d59f0f66cd2ccb9#diff-c2419f23ffec37627d9f8f966a5e0a987b6e7440102a6f368b18be92f2c22a80L46' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 23673081</div><div id='project'> Project Name: humancompatibleai/eirli</div><div id='commit'> Commit Name: 750b1a684e9a1c9f1456ce3e8d59f0f66cd2ccb9</div><div id='time'> Time: 2020-07-17</div><div id='author'> Author: codywild@berkeley.edu</div><div id='file'> File Name: algos/encoders.py</div><div id='m_class'> M Class Name: CNNEncoder</div><div id='n_method'> N Class Name: CNNEncoder</div><div id='m_method'> M Method Name: __init__(5)</div><div id='n_method'> N Method Name: __init__(5)</div><div id='m_parent_class'> M Parent Class: Encoder</div><div id='n_parent_class'> N Parent Class: Encoder</div><div id='m_file'> M File Name: algos/encoders.py</div><div id='n_file'> N File Name: algos/encoders.py</div><div id='m_start'> M Start Line: 47</div><div id='m_end'> M End Line: 67</div><div id='n_start'> N Start Line: 46</div><div id='n_end'> N End Line: 60</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        dense_in_dim, = compute_output_shape(observation_space, shared_network_layers)
        dense_arch = [
            &#47&#47 this input size is accurate for Atari, but will be ovewritten for other envs
            <a id="change">{</a>&quotin_dim&quot: 64*7*7<a id="change">}</a>,
        ]
        dense_arch[0][&quotin_dim&quot] = dense_in_dim
        dense_arch[-1][&quotout_dim&quot] = representation_dim</code></pre><h3>After Change</h3><pre><code class='java'>
                                                   kernel_size=layer_spec[&quotkernel_size&quot], stride=layer_spec[&quotstride&quot]))
            deconv_layers.append(nn.ReLU())
            self.input_channel = layer_spec[&quotout_dim&quot]
        self.deconvolution<a id="change"> = </a><a id="change">nn.Sequential(</a>*<a id="change">deconv_layers)</a>
        dense_layers = []
        dense_layers.append(nn.Flatten())

        &#47&#47 now customise the dense layers to handle an appropriate-sized conv output
        dense_in_dim, = compute_output_shape(observation_space, deconv_layers + [<a id="change">nn.Flatten()</a>])
        dense_arch = [{&quotin_dim&quot: dense_in_dim, &quotout_dim&quot: representation_dim}]
        print(dense_arch)
        &#47&#47 apply the dense layers</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/humancompatibleai/eirli/commit/386f0622be7b83f45c94d8ca7ef8c9d5b59f4d11#diff-7b6cc32084df7e0a6941bc1a899e44b49b70998170146371889b15f6324f629dL111' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 23673083</div><div id='project'> Project Name: humancompatibleai/eirli</div><div id='commit'> Commit Name: 386f0622be7b83f45c94d8ca7ef8c9d5b59f4d11</div><div id='time'> Time: 2020-09-08</div><div id='author'> Author: codywild@berkeley.edu</div><div id='file'> File Name: src/il_representations/algos/encoders.py</div><div id='m_class'> M Class Name: BasicCNN</div><div id='n_method'> N Class Name: BasicCNN</div><div id='m_method'> M Method Name: __init__(3)</div><div id='n_method'> N Method Name: __init__(3)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: src/il_representations/algos/encoders.py</div><div id='n_file'> N File Name: src/il_representations/algos/encoders.py</div><div id='m_start'> M Start Line: 115</div><div id='m_end'> M End Line: 133</div><div id='n_start'> N Start Line: 130</div><div id='n_end'> N End Line: 147</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        dense_in_dim, = compute_output_shape(observation_space, shared_network_layers)
        dense_arch = [
            &#47&#47 this input size is accurate for Atari, but will be ovewritten for other envs
            <a id="change">{</a>&quotin_dim&quot: 64*7*7<a id="change">}</a>,
        ]
        dense_arch[0][&quotin_dim&quot] = dense_in_dim
        dense_arch[-1][&quotout_dim&quot] = representation_dim</code></pre><h3>After Change</h3><pre><code class='java'>
                                                   kernel_size=layer_spec[&quotkernel_size&quot], stride=layer_spec[&quotstride&quot]))
            deconv_layers.append(nn.ReLU())
            self.input_channel = layer_spec[&quotout_dim&quot]
        self.deconvolution<a id="change"> = </a><a id="change">nn.Sequential(</a>*<a id="change">deconv_layers)</a>
        dense_layers = []
        dense_layers.append(nn.Flatten())

        &#47&#47 now customise the dense layers to handle an appropriate-sized conv output
        dense_in_dim, = compute_output_shape(observation_space, deconv_layers + [<a id="change">nn.Flatten()</a>])
        dense_arch = [{&quotin_dim&quot: dense_in_dim, &quotout_dim&quot: representation_dim}]
        print(dense_arch)
        &#47&#47 apply the dense layers</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/humancompatibleai/eirli/commit/47b746c31dea0d8172f0f44bbdcb38284e85a453#diff-7b6cc32084df7e0a6941bc1a899e44b49b70998170146371889b15f6324f629dL111' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 23673082</div><div id='project'> Project Name: humancompatibleai/eirli</div><div id='commit'> Commit Name: 47b746c31dea0d8172f0f44bbdcb38284e85a453</div><div id='time'> Time: 2020-09-08</div><div id='author'> Author: codywild@berkeley.edu</div><div id='file'> File Name: src/il_representations/algos/encoders.py</div><div id='m_class'> M Class Name: BasicCNN</div><div id='n_method'> N Class Name: BasicCNN</div><div id='m_method'> M Method Name: __init__(3)</div><div id='n_method'> N Method Name: __init__(3)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: src/il_representations/algos/encoders.py</div><div id='n_file'> N File Name: src/il_representations/algos/encoders.py</div><div id='m_start'> M Start Line: 115</div><div id='m_end'> M End Line: 133</div><div id='n_start'> N Start Line: 130</div><div id='n_end'> N End Line: 147</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        self.input_channel = obs_shape[2]
        self.representation_dim = representation_dim
        self.conv_layers = []
        self.dense_layers = <a id="change">[]</a>
        for layer_spec in architecture[&quotCONV&quot]:
            self.conv_layers.append(nn.Conv2d(self.input_channel, layer_spec[&quotout_dim&quot],
                                              kernel_size=layer_spec[&quotkernel_size&quot], stride=layer_spec[&quotstride&quot]))
            self.input_channel = layer_spec[&quotout_dim&quot]</code></pre><h3>After Change</h3><pre><code class='java'>
            shared_network_layers.append(nn.ReLU())
            self.input_channel = layer_spec[&quotout_dim&quot]

        shared_network_layers.append(<a id="change">nn.Flatten()</a>)
        for ind, layer_spec in enumerate(architecture[&quotDENSE&quot][:-1]):
            in_dim, out_dim = layer_spec.get(&quotin_dim&quot), layer_spec.get(&quotout_dim&quot)
            shared_network_layers.append(nn.Linear(in_dim, out_dim))
            shared_network_layers.append(nn.ReLU())

        self.shared_network<a id="change"> = </a><a id="change">nn.Sequential(</a>*<a id="change">shared_network_layers)</a>

        self.mean_layer = nn.Linear(architecture[&quotDENSE&quot][-1][&quotin_dim&quot], self.representation_dim)

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/humancompatibleai/eirli/commit/02fea1efe4ef929d5b9b3a0871e7c3d513d7cf1c#diff-c2419f23ffec37627d9f8f966a5e0a987b6e7440102a6f368b18be92f2c22a80L41' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 23673085</div><div id='project'> Project Name: humancompatibleai/eirli</div><div id='commit'> Commit Name: 02fea1efe4ef929d5b9b3a0871e7c3d513d7cf1c</div><div id='time'> Time: 2020-07-17</div><div id='author'> Author: codywild@berkeley.edu</div><div id='file'> File Name: algos/encoders.py</div><div id='m_class'> M Class Name: CNNEncoder</div><div id='n_method'> N Class Name: CNNEncoder</div><div id='m_method'> M Method Name: __init__(5)</div><div id='n_method'> N Method Name: __init__(5)</div><div id='m_parent_class'> M Parent Class: Encoder</div><div id='n_parent_class'> N Parent Class: Encoder</div><div id='m_file'> M File Name: algos/encoders.py</div><div id='n_file'> N File Name: algos/encoders.py</div><div id='m_start'> M Start Line: 47</div><div id='m_end'> M End Line: 67</div><div id='n_start'> N Start Line: 46</div><div id='n_end'> N End Line: 60</div><BR>