<html><h3>Pattern ID :11955
</h3><img src='40517043.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    def declare_state_and_memory(self, previous_state: State) -&gt; Tuple[State, Optional[AllocationQuery]]:
        assert previous_state.jit_mode
        &#47&#47 We do everything in place
        <a id="change">return </a>(previous_state<a id="change">, None</a>)
</code></pre><h3>After Change</h3><pre><code class='java'>
        return replace_label

    def declare_state_and_memory(self, previous_state: State) -&gt; Tuple[State, Optional[AllocationQuery]]:
        <a id="change">return </a>(<a id="change">replace(</a>previous_state<a id="change">, jit_mode=True), None</a>)
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/libffcv/ffcv/commit/077164781a063d2e62fad9083c87f19fa6400b65#diff-490812b373c4e8c5caa425fefd5d85d08a9ca7b8c778c221d67e92bf573f1a50L50' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 40517043</div><div id='project'> Project Name: libffcv/ffcv</div><div id='commit'> Commit Name: 077164781a063d2e62fad9083c87f19fa6400b65</div><div id='time'> Time: 2022-01-19</div><div id='author'> Author: ailyas@mit.edu</div><div id='file'> File Name: ffcv/transforms/replace_label.py</div><div id='m_class'> M Class Name: ReplaceLabel</div><div id='n_method'> N Class Name: ReplaceLabel</div><div id='m_method'> M Method Name: declare_state_and_memory(2)</div><div id='n_method'> N Method Name: declare_state_and_memory(2)</div><div id='m_parent_class'> M Parent Class: Operation</div><div id='n_parent_class'> N Parent Class: Operation</div><div id='m_file'> M File Name: ffcv/transforms/replace_label.py</div><div id='n_file'> N File Name: ffcv/transforms/replace_label.py</div><div id='m_start'> M Start Line: 53</div><div id='m_end'> M End Line: 55</div><div id='n_start'> N Start Line: 50</div><div id='n_end'> N End Line: 50</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    
    def declare_state_and_memory(self, previous_state: State) -&gt; Tuple[State, Optional[AllocationQuery]]:
        assert previous_state.stage == Stage.BATCH
        <a id="change">return </a>previous_state<a id="change">, AllocationQuery((3, 32, 32), dtype=np.dtype(&quotuint8&quot))</a>
</code></pre><h3>After Change</h3><pre><code class='java'>
    def declare_state_and_memory(self, previous_state: State) -&gt; Tuple[State, Optional[AllocationQuery]]:
        new_dtype = ch.from_numpy(np.empty((), dtype=previous_state.dtype)).dtype
        assert previous_state.stage == Stage.BATCH
        <a id="change">return </a><a id="change">replace(</a>previous_state<a id="change">, stage=Stage.PYTORCH, dtype=new_dtype), None</a>

class ToDevice(CoreOp):
    def __init__(self, device, non_blocking=True):
        super().__init__()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/libffcv/ffcv/commit/1ca38c6f5007b6c2e80d9d65f8ac7c04207091fd#diff-e32e012a7db1eef59b149125d5d2e863e8e6508389b7833e8a3df62bd770d261L44' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 40517046</div><div id='project'> Project Name: libffcv/ffcv</div><div id='commit'> Commit Name: 1ca38c6f5007b6c2e80d9d65f8ac7c04207091fd</div><div id='time'> Time: 2021-10-22</div><div id='author'> Author: ailyas@mit.edu</div><div id='file'> File Name: ffcv/transforms/ops.py</div><div id='m_class'> M Class Name: ToTensor</div><div id='n_method'> N Class Name: ToTensor</div><div id='m_method'> M Method Name: declare_state_and_memory(2)</div><div id='n_method'> N Method Name: declare_state_and_memory(2)</div><div id='m_parent_class'> M Parent Class: CoreOp</div><div id='n_parent_class'> N Parent Class: CoreOp</div><div id='m_file'> M File Name: ffcv/transforms/ops.py</div><div id='n_file'> N File Name: ffcv/transforms/ops.py</div><div id='m_start'> M Start Line: 46</div><div id='m_end'> M End Line: 46</div><div id='n_start'> N Start Line: 45</div><div id='n_end'> N End Line: 47</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    def declare_state_and_memory(self, previous_state: State) -&gt; Tuple[State, Optional[AllocationQuery]]:
        assert previous_state.jit_mode
        <a id="change">return </a>previous_state<a id="change">, None</a>
</code></pre><h3>After Change</h3><pre><code class='java'>
        return cutout_square

    def declare_state_and_memory(self, previous_state: State) -&gt; Tuple[State, Optional[AllocationQuery]]:
        <a id="change">return </a><a id="change">replace(</a>previous_state<a id="change">, jit_mode=True), None</a>
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/libffcv/ffcv/commit/077164781a063d2e62fad9083c87f19fa6400b65#diff-85ced73d7bd4e200d82bab40c01c4317aac25427f512f3dbaf14326a81a77611L50' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 40517044</div><div id='project'> Project Name: libffcv/ffcv</div><div id='commit'> Commit Name: 077164781a063d2e62fad9083c87f19fa6400b65</div><div id='time'> Time: 2022-01-19</div><div id='author'> Author: ailyas@mit.edu</div><div id='file'> File Name: ffcv/transforms/cutout.py</div><div id='m_class'> M Class Name: Cutout</div><div id='n_method'> N Class Name: Cutout</div><div id='m_method'> M Method Name: declare_state_and_memory(2)</div><div id='n_method'> N Method Name: declare_state_and_memory(2)</div><div id='m_parent_class'> M Parent Class: Operation</div><div id='n_parent_class'> N Parent Class: Operation</div><div id='m_file'> M File Name: ffcv/transforms/cutout.py</div><div id='n_file'> N File Name: ffcv/transforms/cutout.py</div><div id='m_start'> M Start Line: 51</div><div id='m_end'> M End Line: 52</div><div id='n_start'> N Start Line: 52</div><div id='n_end'> N End Line: 52</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    
    def declare_state_and_memory(self, previous_state: State) -&gt; Tuple[State, Optional[AllocationQuery]]:
        assert previous_state.stage == Stage.INDIVIDUAL
        <a id="change">return </a>replace(previous_state, stage=Stage.BATCH)<a id="change">, None</a>

class ToTensor(CoreOp):
    def __init__(self):
        super().__init__()</code></pre><h3>After Change</h3><pre><code class='java'>
        return collate
    
    def declare_state_and_memory(self, previous_state: State) -&gt; Tuple[State, Optional[AllocationQuery]]:
        <a id="change">return </a><a id="change">replace(</a>previous_state<a id="change">), None</a>

class ToTensor(CoreOp):
    def __init__(self):
        super().__init__()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/libffcv/ffcv/commit/a52b9b8e8145068877651f02d785cb7072b69cca#diff-e32e012a7db1eef59b149125d5d2e863e8e6508389b7833e8a3df62bd770d261L31' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 40517045</div><div id='project'> Project Name: libffcv/ffcv</div><div id='commit'> Commit Name: a52b9b8e8145068877651f02d785cb7072b69cca</div><div id='time'> Time: 2021-10-26</div><div id='author'> Author: leclerc@mit.edu</div><div id='file'> File Name: ffcv/transforms/ops.py</div><div id='m_class'> M Class Name: Collate</div><div id='n_method'> N Class Name: Collate</div><div id='m_method'> M Method Name: declare_state_and_memory(2)</div><div id='n_method'> N Method Name: declare_state_and_memory(2)</div><div id='m_parent_class'> M Parent Class: CoreOp</div><div id='n_parent_class'> N Parent Class: CoreOp</div><div id='m_file'> M File Name: ffcv/transforms/ops.py</div><div id='n_file'> N File Name: ffcv/transforms/ops.py</div><div id='m_start'> M Start Line: 32</div><div id='m_end'> M End Line: 33</div><div id='n_start'> N Start Line: 31</div><div id='n_end'> N End Line: 31</div><BR>