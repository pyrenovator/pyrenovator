<html><h3>Pattern ID :25443
</h3><img src='77658528.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        ret[&quotchannels&quot] = []
        if self.weights is None:
            for n_channel in self.n_channels:
                ret[&quotchannels&quot].append(<a id="change">random.choice(</a>n_channel<a id="change">)</a>)
        else:
            assert len(self.n_channels) == len(self.weights)
            for n_channel, weight in zip(self.n_channels, self.weights):</code></pre><h3>After Change</h3><pre><code class='java'>
        ret[&quotchannels&quot] = []
        for n_channel in self.n_channels:
            if weighted_sample &gt; 1.0001:
                now<a id="change"> = </a>(<a id="change">len(</a>n_channel<a id="change">) - </a>1) / (weighted_sample - 1)
                weights = []
                while len(weights) &lt; len(n_channel):
                    weights.append(now)
                    now<a id="change"> += </a>1
            else:
                weights = None
            ret[&quotchannels&quot].append(random.choices(n_channel, weights=weights)[0])</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/mit-han-lab/gan-compression/commit/a5b326292511441dafaebc670ae416a8880cf5f2#diff-00a76494eb47fe6ed26794188883782bf8c1dc38658fab3499688b7be0466daeL10' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 77658528</div><div id='project'> Project Name: mit-han-lab/gan-compression</div><div id='commit'> Commit Name: a5b326292511441dafaebc670ae416a8880cf5f2</div><div id='time'> Time: 2020-10-03</div><div id='author'> Author: lmxyy1999@foxmail.com</div><div id='file'> File Name: configs/resnet_configs.py</div><div id='m_class'> M Class Name: ResnetConfigs</div><div id='n_method'> N Class Name: ResnetConfigs</div><div id='m_method'> M Method Name: sample(2)</div><div id='n_method'> N Method Name: sample(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: configs/resnet_configs.py</div><div id='n_file'> N File Name: configs/resnet_configs.py</div><div id='m_start'> M Start Line: 10</div><div id='m_end'> M End Line: 21</div><div id='n_start'> N Start Line: 10</div><div id='n_end'> N End Line: 23</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

def stream_call(func, *args, **kwargs):
    if _global_streams is not None:
        with torch.cuda.stream(<a id="change">random.choice(</a>_global_streams<a id="change">)</a>):
            return func(*args, **kwargs)
    else:
        return func(*args, **kwargs)</code></pre><h3>After Change</h3><pre><code class='java'>

def stream_call(func, *args, **kwargs):
    if _global_streams is not None:
        _stream_index<a id="change"> = </a>next(_stream_count)<a id="change"> % </a><a id="change">len(</a>_global_streams<a id="change">)</a>
        _stream<a id="change"> = </a>_global_streams[_stream_index]
        with torch.cuda.stream(_stream):
            return func(*args, **kwargs)
    else:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/opendilab/di-treetensor/commit/6a3a7dd0c5c3ae0cd2f2db08b09fc7433c367560#diff-0443c236999e3b6a12cd2f4137dbb739b1b635441fa995182cc4f77f9ec1a7fbL30' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 77658533</div><div id='project'> Project Name: opendilab/di-treetensor</div><div id='commit'> Commit Name: 6a3a7dd0c5c3ae0cd2f2db08b09fc7433c367560</div><div id='time'> Time: 2022-08-13</div><div id='author'> Author: hansbug@buaa.edu.cn</div><div id='file'> File Name: treetensor/torch/stream.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: stream_call(1)</div><div id='n_method'> N Method Name: stream_call(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: treetensor/torch/stream.py</div><div id='n_file'> N File Name: treetensor/torch/stream.py</div><div id='m_start'> M Start Line: 32</div><div id='m_end'> M End Line: 32</div><div id='n_start'> N Start Line: 35</div><div id='n_end'> N End Line: 37</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        ret = {}
        ret[&quotchannels&quot] = []
        for n_channel in self.n_channels:
            ret[&quotchannels&quot].append(<a id="change">random.choice(</a>n_channel<a id="change">)</a>)
        return ret

    def largest(self):</code></pre><h3>After Change</h3><pre><code class='java'>
        ret[&quotchannels&quot] = []
        for n_channel in self.n_channels:
            if weighted_sample &gt; 1.0001:
                now<a id="change"> = </a>(<a id="change">len(</a>n_channel<a id="change">) - </a>1) / (weighted_sample - 1)
                weights = []
                while len(weights) &lt; len(n_channel):
                    weights.append(now)
                    now<a id="change"> += </a>1
            else:
                weights = None
            ret[&quotchannels&quot].append(random.choices(n_channel, weights=weights)[0])</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/mit-han-lab/gan-compression/commit/a5b326292511441dafaebc670ae416a8880cf5f2#diff-1e4e6cd986666e88317e3c5b559b9675dc625bb3b000fb16ba7a49e7569a9170L9' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 77658535</div><div id='project'> Project Name: mit-han-lab/gan-compression</div><div id='commit'> Commit Name: a5b326292511441dafaebc670ae416a8880cf5f2</div><div id='time'> Time: 2020-10-03</div><div id='author'> Author: lmxyy1999@foxmail.com</div><div id='file'> File Name: configs/spade_configs.py</div><div id='m_class'> M Class Name: SPADEConfigs</div><div id='n_method'> N Class Name: SPADEConfigs</div><div id='m_method'> M Method Name: sample(2)</div><div id='n_method'> N Method Name: sample(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: configs/spade_configs.py</div><div id='n_file'> N File Name: configs/spade_configs.py</div><div id='m_start'> M Start Line: 9</div><div id='m_end'> M End Line: 13</div><div id='n_start'> N Start Line: 9</div><div id='n_end'> N End Line: 21</div><BR>