<html><h3>Pattern ID :4613
</h3><img src='16598200.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        cnt = close_p.groupby(&quotdatetime&quot).count()

        print(size.describe(percentiles=np.arange(0.1, 0.9, 0.1)))
        <a id="change">print(</a><a id="change">cnt.describe(percentiles=np.arange(0.1, 0.9, 0.1)))</a>
        &#47&#47 TODO: assert

    def testClose(self):
        close_p = D.features(D.instruments(&quotcsi300&quot), [&quotRef($close, 1)/$close - 1&quot])</code></pre><h3>After Change</h3><pre><code class='java'>
        size = close_p.groupby(&quotdatetime&quot).size()
        cnt = close_p.groupby(&quotdatetime&quot).count()
        size_desc = size.describe(percentiles=np.arange(0.1, 0.9, 0.1))
        cnt_desc<a id="change"> = </a><a id="change">cnt.describe(percentiles=np.arange(0.1, 0.9, 0.1))</a>

        print(size_desc)
        <a id="change">print(</a>cnt_desc<a id="change">)</a>

        self.assertLessEqual(size_desc.loc["max"][0], 305, "Excessive number of CSI300 constituent stocks")
        self.assertLessEqual(size_desc.loc["80%"][0], 290, "Insufficient number of CSI300 constituent stocks")
        </code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/c825c99c2ceb4b0dd23ad121231d7a8399e6b9de#diff-5ef85d93f40c7c27a80c143466a289c135b15ce36d3eb7f6825cd96bb4a430c1L19' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16598200</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: c825c99c2ceb4b0dd23ad121231d7a8399e6b9de</div><div id='time'> Time: 2020-09-26</div><div id='author'> Author: zhu.pengrong@foxmail.com</div><div id='file'> File Name: tests/dataset_tests/test_dataset.py</div><div id='m_class'> M Class Name: TestDataset</div><div id='n_method'> N Class Name: TestDataset</div><div id='m_method'> M Method Name: testCSI300(1)</div><div id='n_method'> N Method Name: testCSI300(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: tests/dataset_tests/test_dataset.py</div><div id='n_file'> N File Name: tests/dataset_tests/test_dataset.py</div><div id='m_start'> M Start Line: 20</div><div id='m_end'> M End Line: 21</div><div id='n_start'> N Start Line: 19</div><div id='n_end'> N End Line: 29</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    def testClose(self):
        close_p = D.features(D.instruments(&quotcsi300&quot), [&quotRef($close, 1)/$close - 1&quot])
        <a id="change">print(</a><a id="change">close_p.describe(percentiles=np.arange(0.1, 0.9, 0.1)))</a>
        &#47&#47 TODO: assert


if __name__ == &quot__main__&quot:</code></pre><h3>After Change</h3><pre><code class='java'>

    def testClose(self):
        close_p = D.features(D.instruments(&quotcsi300&quot), [&quotRef($close, 1)/$close - 1&quot])
        close_desc<a id="change"> = </a><a id="change">close_p.describe(percentiles=np.arange(0.1, 0.9, 0.1))</a>
        <a id="change">print(</a>close_desc<a id="change">)</a>
        self.assertLessEqual(abs(close_desc.loc["80%"][0]), 0.1, "Close value is abnormal")
        self.assertLessEqual(abs(close_desc.loc["max"][0]), 0.2, "Close value is abnormal")
        self.assertGreaterEqual(abs(close_desc.loc["min"][0]), -0.2, "Close value is abnormal")
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/c825c99c2ceb4b0dd23ad121231d7a8399e6b9de#diff-5ef85d93f40c7c27a80c143466a289c135b15ce36d3eb7f6825cd96bb4a430c1L24' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16598199</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: c825c99c2ceb4b0dd23ad121231d7a8399e6b9de</div><div id='time'> Time: 2020-09-26</div><div id='author'> Author: zhu.pengrong@foxmail.com</div><div id='file'> File Name: tests/dataset_tests/test_dataset.py</div><div id='m_class'> M Class Name: TestDataset</div><div id='n_method'> N Class Name: TestDataset</div><div id='m_method'> M Method Name: testClose(1)</div><div id='n_method'> N Method Name: testClose(1)</div><div id='m_parent_class'> M Parent Class: unittest.TestCase</div><div id='n_parent_class'> N Parent Class: unittest.TestCase</div><div id='m_file'> M File Name: tests/dataset_tests/test_dataset.py</div><div id='n_file'> N File Name: tests/dataset_tests/test_dataset.py</div><div id='m_start'> M Start Line: 26</div><div id='m_end'> M End Line: 26</div><div id='n_start'> N Start Line: 33</div><div id='n_end'> N End Line: 37</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    print("-I- packing:")
    print(df_packing.describe())
    print("-I- padding:")
    <a id="change">print(</a><a id="change">df_padding.describe())</a>

    splits = ["train"]
    npacked = df_packing[&quotnpacked&quot].mean()
    ntrain = len(df_padding)</code></pre><h3>After Change</h3><pre><code class='java'>
    print("-I- packing:")
    print(df_packing.describe(percentiles=[0.5, 0.75, 0.9, 0.99]))
    print("-I- padding:")
    described_padding<a id="change"> = </a><a id="change">df_padding.describe(percentiles=[0.5, 0.75, 0.9, 0.99])</a>
    <a id="change">print(</a>described_padding<a id="change">)</a>

    splits = ["train"]
    npacked = df_packing[&quotnpacked&quot].mean()
    ntrain = len(df_padding)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/saareliad/ftpipe/commit/8d2929db3b15f8b4f382d66801f6157e432095e8#diff-da0813bdc2321fc4a6876f0abf8dd6d8559d2e4a4fe5e8d87a11495d898ae1e4L157' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16598198</div><div id='project'> Project Name: saareliad/ftpipe</div><div id='commit'> Commit Name: 8d2929db3b15f8b4f382d66801f6157e432095e8</div><div id='time'> Time: 2020-09-06</div><div id='author'> Author: saareliad@campus.technion.ac.il</div><div id='file'> File Name: data/t5/analyze_t5_packing.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: sum_task(3)</div><div id='n_method'> N Method Name: sum_task(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: data/t5/analyze_t5_packing.py</div><div id='n_file'> N File Name: data/t5/analyze_t5_packing.py</div><div id='m_start'> M Start Line: 175</div><div id='m_end'> M End Line: 175</div><div id='n_start'> N Start Line: 156</div><div id='n_end'> N End Line: 198</div><BR>