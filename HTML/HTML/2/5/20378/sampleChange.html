<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        self.diffusion_prior.load_state_dict(loaded_obj[&quotmodel&quot], strict = strict)
        self.step.copy_(torch.ones_like(self.step) * loaded_obj[&quotstep&quot])

        <a id="change">if </a>only_model:
            return loaded_obj

        self.scaler.load_state_dict(loaded_obj[&quotscaler&quot])</code></pre><h3>After Change</h3><pre><code class='java'>
        if overwrite_lr:
            new_lr = self.optim_kwargs["lr"]

            <a id="change">self.print(</a>f"Overriding LR to be {new_lr}"<a id="change">)</a>

            for group in self.optimizer.param_groups:
                group["lr"] = new_lr

        if self.use_ema:
            assert &quotema&quot in loaded_obj
            self.ema_diffusion_prior.load_state_dict(loaded_obj[&quotema&quot], strict = strict)
            &#47&#47 below not be necessary, but I had a suspicion that this wasn&quott being loaded correctly
            self.ema_diffusion_prior.ema_model.load_state_dict(loaded_obj["ema_model"])

        &#47&#47 sync and inform
        self.wait_for_everyone()
        <a id="change">self.print(f"Loaded model"</a><a id="change">)</a>

        return loaded_obj

    &#47&#47 model functionality</code></pre>