<html><h3>Pattern ID :25841
</h3><img src='78202761.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    if vocab is None :
        dataset = dataset.map(tokenizer, column)
        newVocab = text.Vocab.from_dataset(dataset, column)
        <a id="change">return </a>dataset.map(text.Lookup(newVocab), column), newVocab

    dataset = dataset.map(tokenizer, column)
    return dataset.map(text.Lookup(vocab), column)</code></pre><h3>After Change</h3><pre><code class='java'>
        &gt;&gt;&gt; train_dataset = process(&quotMulti30k&quot, train_dataset, vocab = vocab)
    

    en_pad_value<a id="change"> = </a>vocab[&quoten&quot].tokens_to_ids(&quot&lt;pad&gt;&quot)
    de_pad_value = vocab[&quotde&quot].tokens_to_ids(&quot&lt;pad&gt;&quot)

    en_lookup_op = text.Lookup(vocab[&quoten&quot], unknown_token=&quot&lt;unk&gt;&quot)
    de_lookup_op = text.Lookup(vocab[&quotde&quot], unknown_token=&quot&lt;unk&gt;&quot)

    dataset = dataset.map([en_lookup_op], &quoten&quot)
    dataset = dataset.map([de_lookup_op], &quotde&quot)

    en_pad_op = transforms.PadEnd([max_len], en_pad_value)
    de_pad_op<a id="change"> = </a>transforms.PadEnd([max_len], de_pad_value)

    dataset = dataset.map([en_pad_op], &quoten&quot)
    dataset = dataset.map([de_pad_op], &quotde&quot)

    dataset = <a id="change">dataset.batch(</a>batch_size<a id="change">, drop_remainder=drop_remainder)</a>
    <a id="change">return </a>dataset
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/mindlab-ai/mindnlp/commit/83dbccee5a09c5a0abe9aea09925b5d2d799f83a#diff-5452221024247759130bfc10ffedb4c34b8ebdb564376e7a4464f0adaeae55b1L145' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 78202761</div><div id='project'> Project Name: mindlab-ai/mindnlp</div><div id='commit'> Commit Name: 83dbccee5a09c5a0abe9aea09925b5d2d799f83a</div><div id='time'> Time: 2022-11-19</div><div id='author'> Author: 71267655+Geaming-CHN@users.noreply.github.com</div><div id='file'> File Name: mindnlp/dataset/machine_translation/multi30k.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: Multi30k_Process(5)</div><div id='n_method'> N Method Name: Multi30k_Process(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: mindnlp/dataset/machine_translation/multi30k.py</div><div id='n_file'> N File Name: mindnlp/dataset/machine_translation/multi30k.py</div><div id='m_start'> M Start Line: 146</div><div id='m_end'> M End Line: 187</div><div id='n_start'> N Start Line: 145</div><div id='n_end'> N End Line: 193</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        
        Output of this method will be provided to tasks with optimizer in contract
        
        <a id="change">return </a>self.train_dataset

    def get_valid_loader(self, **kwargs):
        </code></pre><h3>After Change</h3><pre><code class='java'>
            sample, target = self.shard_descriptor[i]
            samples.append(sample)
            targets.append(target)
        samples<a id="change"> = </a>np.array(samples)
        targets<a id="change"> = </a>np.array(targets)
        <a id="change">return </a><a id="change">tf.data.Dataset.from_tensor_slices((samples, targets)).batch(</a>self.train_bs<a id="change">)</a>

    def get_valid_loader(self, **kwargs):
        
        Output of this method will be provided to tasks without optimizer in contract</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/intel/openfl/commit/4f481319b781690e9e6d952a7760a2a74eb931f8#diff-e764084eafc22020ea9ecd124f825585184ef20dc7e7fe14ef1c18461e8d89c8L38' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 78202735</div><div id='project'> Project Name: intel/openfl</div><div id='commit'> Commit Name: 4f481319b781690e9e6d952a7760a2a74eb931f8</div><div id='time'> Time: 2021-08-24</div><div id='author'> Author: ilya.trushkin@intel.com</div><div id='file'> File Name: tests/github/interactive_api_director/experiments/tensorflow_mnist/dataset.py</div><div id='m_class'> M Class Name: FedDataset</div><div id='n_method'> N Class Name: FedDataset</div><div id='m_method'> M Method Name: get_train_loader(1)</div><div id='n_method'> N Method Name: get_train_loader(1)</div><div id='m_parent_class'> M Parent Class: DataInterface</div><div id='n_parent_class'> N Parent Class: DataInterface</div><div id='m_file'> M File Name: tests/github/interactive_api_director/experiments/tensorflow_mnist/dataset.py</div><div id='n_file'> N File Name: tests/github/interactive_api_director/experiments/tensorflow_mnist/dataset.py</div><div id='m_start'> M Start Line: 42</div><div id='m_end'> M End Line: 42</div><div id='n_start'> N Start Line: 34</div><div id='n_end'> N End Line: 41</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        
        Output of this method will be provided to tasks without optimizer in contract
        
        <a id="change">return </a>self.valid_dataset

    def get_train_data_size(self):
        </code></pre><h3>After Change</h3><pre><code class='java'>
        Output of this method will be provided to tasks without optimizer in contract
        
        samples, targets = zip(*[self.shard_descriptor[i] for i in self.val_indices])
        samples<a id="change"> = </a>np.array(samples)
        targets<a id="change"> = </a>np.array(targets)
        <a id="change">return </a><a id="change">tf.data.Dataset.from_tensor_slices((samples, targets)).batch(</a>self.valid_bs<a id="change">)</a>

    def get_train_data_size(self):
        
        Information for aggregation</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/intel/openfl/commit/4f481319b781690e9e6d952a7760a2a74eb931f8#diff-e764084eafc22020ea9ecd124f825585184ef20dc7e7fe14ef1c18461e8d89c8L44' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 78202751</div><div id='project'> Project Name: intel/openfl</div><div id='commit'> Commit Name: 4f481319b781690e9e6d952a7760a2a74eb931f8</div><div id='time'> Time: 2021-08-24</div><div id='author'> Author: ilya.trushkin@intel.com</div><div id='file'> File Name: tests/github/interactive_api_director/experiments/tensorflow_mnist/dataset.py</div><div id='m_class'> M Class Name: FedDataset</div><div id='n_method'> N Class Name: FedDataset</div><div id='m_method'> M Method Name: get_valid_loader(1)</div><div id='n_method'> N Method Name: get_valid_loader(1)</div><div id='m_parent_class'> M Parent Class: DataInterface</div><div id='n_parent_class'> N Parent Class: DataInterface</div><div id='m_file'> M File Name: tests/github/interactive_api_director/experiments/tensorflow_mnist/dataset.py</div><div id='n_file'> N File Name: tests/github/interactive_api_director/experiments/tensorflow_mnist/dataset.py</div><div id='m_start'> M Start Line: 48</div><div id='m_end'> M End Line: 48</div><div id='n_start'> N Start Line: 47</div><div id='n_end'> N End Line: 50</div><BR>