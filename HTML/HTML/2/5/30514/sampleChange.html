<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        return score

    def full_sort_predict(self, interaction):
        <a id="change">pass</a>
</code></pre><h3>After Change</h3><pre><code class='java'>
        user_emb = self.UI_emb(user)
        all_iu_emb = self.IU_emb.weight
        mf = torch.matmul(user_emb, all_iu_emb.transpose(0,1))
        all_il_emb<a id="change"> = </a>self.IL_emb.weight
        item_list = interaction[self.ITEM_ID_LIST]
        item_list_emb = self.LI_emb(item_list)
        fmc<a id="change"> = </a>torch.matmul(item_list_emb, all_il_emb.transpose(0,1))
        fmc<a id="change"> = </a><a id="change">torch.mean(</a>fmc<a id="change">, dim=1)</a>
        score = mf + fmc
        return score
</code></pre>