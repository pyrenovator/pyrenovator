<html><h3>Pattern ID :39073
</h3><img src='111259521.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

    @requests
    def encode(self, docs: DocumentArray, **kwargs):
        chunks<a id="change"> = </a>DocumentArray(
            <a id="change">list(
                </a><a id="change">filter(</a>lambda d: d.mime_type.startswith(&quotimage&quot), docs.traverse_flat([&quotr&quot])<a id="change">)
            )</a>
        )
        images = np.stack(chunks.get_attributes(&quotblob&quot))
        images = self._maybe_move_channel_axis(images)
</code></pre><h3>After Change</h3><pre><code class='java'>
    @requests
    @filter_docs(&quotimage&quot, traversal_path=&quotr&quot)
    def encode(self, docs: DocumentArray, **kwargs):
        <a id="change">if docs is None</a>:
            return

        images = np.stack(docs.get_attributes(&quotblob&quot))</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/jina-ai/examples/commit/8f29ce75fd2854c191a9c1115156552372918ec2#diff-ec7e65255001a4aad1095bb2ac2e37a0321ebcb439210c9825647646a3eb606dL326' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111259521</div><div id='project'> Project Name: jina-ai/examples</div><div id='commit'> Commit Name: 8f29ce75fd2854c191a9c1115156552372918ec2</div><div id='time'> Time: 2021-06-02</div><div id='author'> Author: sebastian.lettner@jina.ai</div><div id='file'> File Name: multimodal-search-pdf/flows/executors.py</div><div id='m_class'> M Class Name: ImageTorchEncoder</div><div id='n_method'> N Class Name: ImageTorchEncoder</div><div id='m_method'> M Method Name: encode(2)</div><div id='n_method'> N Method Name: encode(2)</div><div id='m_parent_class'> M Parent Class: Executor</div><div id='n_parent_class'> N Parent Class: Executor</div><div id='m_file'> M File Name: multimodal-search-pdf/flows/executors.py</div><div id='n_file'> N File Name: multimodal-search-pdf/flows/executors.py</div><div id='m_start'> M Start Line: 326</div><div id='m_end'> M End Line: 330</div><div id='n_start'> N Start Line: 330</div><div id='n_end'> N End Line: 333</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    exclude: List[str] = []
    current_dir = os.path.dirname(os.path.abspath(__file__))
    files = sorted(map(lambda x: x.relative_to(current_dir), Path.cwd().rglob(&quot*.py&quot)))
    files = <a id="change">list(</a><a id="change">filter(</a>lambda x: not any([str(Path(ele)) in str(x) for ele in exclude]), files<a id="change">))</a>

    return_codes<a id="change"> = </a>Parallel(n_jobs=os.cpu_count())(delayed(run_mypy)(file) for file in files)
    if all(v == 0 for v in return_codes):
        return 0
    else:</code></pre><h3>After Change</h3><pre><code class='java'>
        submodule_name = "innereye-deeplearning"
        files = set(current_dir.glob(&quot*.py&quot))
        for path in current_dir.glob(&quot*&quot):
            <a id="change">if path.name != submodule_name</a>:
                files.update(path.rglob(&quot*.py&quot))
        file_list = list(files)
    return run_mypy(sorted(str(file) for file in file_list))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/innereye-deeplearning/commit/1136e23352ac8b4e93705b96bdac9f08120f8399#diff-344abec58e93ca8213cf166ae9214a8c5e073b5fd2e8e6811a95832c1011e646L18' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111259522</div><div id='project'> Project Name: microsoft/innereye-deeplearning</div><div id='commit'> Commit Name: 1136e23352ac8b4e93705b96bdac9f08120f8399</div><div id='time'> Time: 2020-08-14</div><div id='author'> Author: dacart@microsoft.com</div><div id='file'> File Name: mypy_runner.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: mypy_runner.py</div><div id='n_file'> N File Name: mypy_runner.py</div><div id='m_start'> M Start Line: 19</div><div id='m_end'> M End Line: 31</div><div id='n_start'> N Start Line: 52</div><div id='n_end'> N End Line: 65</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    @requests
    def encode(self, docs: &quotDocumentArray&quot, **kwargs):
        chunks<a id="change"> = </a>DocumentArray(
            <a id="change">list(
                </a><a id="change">filter(</a>lambda d: d.mime_type == &quottext/plain&quot, docs.traverse_flat([&quotcc&quot])<a id="change">)
            )</a>
        )
        texts = chunks.get_attributes(&quottext&quot)

        with torch.no_grad():</code></pre><h3>After Change</h3><pre><code class='java'>
    @requests
    @filter_docs(&quottext/plain&quot, traversal_path=&quotc&quot)
    def encode(self, docs: &quotDocumentArray&quot, **kwargs):
        <a id="change">if docs is None</a>:
            return

        texts = docs.get_attributes(&quottext&quot)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jina-ai/examples/commit/8f29ce75fd2854c191a9c1115156552372918ec2#diff-ec7e65255001a4aad1095bb2ac2e37a0321ebcb439210c9825647646a3eb606dL232' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 111259525</div><div id='project'> Project Name: jina-ai/examples</div><div id='commit'> Commit Name: 8f29ce75fd2854c191a9c1115156552372918ec2</div><div id='time'> Time: 2021-06-02</div><div id='author'> Author: sebastian.lettner@jina.ai</div><div id='file'> File Name: multimodal-search-pdf/flows/executors.py</div><div id='m_class'> M Class Name: TextEncoder</div><div id='n_method'> N Class Name: TextEncoder</div><div id='m_method'> M Method Name: encode(2)</div><div id='n_method'> N Method Name: encode(2)</div><div id='m_parent_class'> M Parent Class: Executor</div><div id='n_parent_class'> N Parent Class: Executor</div><div id='m_file'> M File Name: multimodal-search-pdf/flows/executors.py</div><div id='n_file'> N File Name: multimodal-search-pdf/flows/executors.py</div><div id='m_start'> M Start Line: 233</div><div id='m_end'> M End Line: 237</div><div id='n_start'> N Start Line: 238</div><div id='n_end'> N End Line: 241</div><BR>