<html><h3>Pattern ID :16086
</h3><img src='54000439.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 systems. At this point in the script, it is attempted to unify
        &#47&#47 them all to the tones in the IPA standard.
        if self.g2p_lang == "cmn-latn-pinyin" or self.g2p_lang == "cmn":
            phones = <a id="change">phones.replace("."</a>, <a id="change">""</a><a id="change">)</a>  &#47&#47 no idea why espeak puts dots everywhere for Chinese
            phones = phones.replace(&quot1&quot, "˥")
            phones = phones.replace(&quot2&quot, "˧˥")
            phones = phones.replace(&quotɜ&quot, "˨˩")  &#47&#47 I&quotm fairly certain that this is a bug in espeak and ɜ is meant to be 3
            phones = phones.replace(&quot3&quot, "˨˩")  &#47&#47 I&quotm fairly certain that this is a bug in espeak and ɜ is meant to be 3
            phones<a id="change"> = </a>phones.replace(&quot4&quot, "˦˩")
            phones = phones.replace(&quot5&quot, "˧")
            phones = phones.replace(&quot0&quot, "˧")
        if self.g2p_lang == "vi":</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 languages use different tones denoted by different numbering
        &#47&#47 systems. At this point in the script, it is attempted to unify
        &#47&#47 them all to the tones in the IPA standard.
        if <a id="change">self.g2p_lang == "cmn-latn-pinyin" or self.g2p_lang == "cmn"</a>:
            
            handling for the espeak use-case
            </code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/digitalphonetics/ims-toucan/commit/0850235c9c9fafce92f637d36cc940449752a311#diff-0eec6bd93f18520ead82255aad2d6db9e6b96603bb855499825a03a415ee480cL247' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 54000439</div><div id='project'> Project Name: digitalphonetics/ims-toucan</div><div id='commit'> Commit Name: 0850235c9c9fafce92f637d36cc940449752a311</div><div id='time'> Time: 2022-11-06</div><div id='author'> Author: florian.lux@ims.uni-stuttgart.de</div><div id='file'> File Name: Preprocessing/TextFrontend.py</div><div id='m_class'> M Class Name: ArticulatoryCombinedTextFrontend</div><div id='n_method'> N Class Name: ArticulatoryCombinedTextFrontend</div><div id='m_method'> M Method Name: get_phone_string(5)</div><div id='n_method'> N Method Name: get_phone_string(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: Preprocessing/TextFrontend.py</div><div id='n_file'> N File Name: Preprocessing/TextFrontend.py</div><div id='m_start'> M Start Line: 248</div><div id='m_end'> M End Line: 262</div><div id='n_start'> N Start Line: 247</div><div id='n_end'> N End Line: 258</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            self.detector = fasttext.load_model(path)

        &#47&#47 Transform texts to format expected by language detection model
        texts<a id="change"> = </a>[<a id="change">x.lower().replace("\n"</a>, <a id="change">" "</a><a id="change">)</a>.replace("\r\n", " ") for x in texts]

        return [x[0].split("__")[-1] for x in self.detector.predict(texts)[0]]
</code></pre><h3>After Change</h3><pre><code class='java'>
        

        &#47&#47 Backwards compatible to load fasttext model
        if <a id="change">not self.langdetect or isinstance(self.langdetect, str)</a>:
            return self.defaultdetect(texts)

        &#47&#47 Call external language detector</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/neuml/txtai/commit/797da5ac0fba651766548b6844032e47da9c4d1d#diff-2683c30df9fb24fdd118558a17243fa757ba1ce39d29bc5a8de7d46330da4629L117' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 54000471</div><div id='project'> Project Name: neuml/txtai</div><div id='commit'> Commit Name: 797da5ac0fba651766548b6844032e47da9c4d1d</div><div id='time'> Time: 2023-03-10</div><div id='author'> Author: yd2590@columbia.edu</div><div id='file'> File Name: src/python/txtai/pipeline/text/translation.py</div><div id='m_class'> M Class Name: Translation</div><div id='n_method'> N Class Name: Translation</div><div id='m_method'> M Method Name: detect(2)</div><div id='n_method'> N Method Name: detect(3)</div><div id='m_parent_class'> M Parent Class: HFModel</div><div id='n_parent_class'> N Parent Class: HFModel</div><div id='m_file'> M File Name: src/python/txtai/pipeline/text/translation.py</div><div id='n_file'> N File Name: src/python/txtai/pipeline/text/translation.py</div><div id='m_start'> M Start Line: 117</div><div id='m_end'> M End Line: 146</div><div id='n_start'> N Start Line: 129</div><div id='n_end'> N End Line: 133</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        else:
            &#47&#47 USING OLD 20 CLASS DATASET
            weights = f"{weights_dir}/efficientnetb0_from_random.h5"
            weights_notop<a id="change"> = </a><a id="change">weights.replace(".h5"</a>, <a id="change">"-notop.h5"</a><a id="change">)</a>
            if not os.path.exists(weights_notop):
                old_model = tf.keras.Sequential([
                    EfficientNetB0(weights=None,
                                   input_shape=(224, 224, 3),</code></pre><h3>After Change</h3><pre><code class='java'>
        weights_notop = weights_str.replace(".h5", "-notop.h5")

        &#47&#47 Save notop weights if they don&quott exist
        if <a id="change">not os.path.exists(weights_notop) or overwrite</a>:
            model_withtop = EfficientNetB0(weights=None,
                                   input_shape=(224, 224, 3),
                                   classes=num_classes)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/stan-hua/cytoimagenet/commit/58d66c4cc6eed607192ce85534d29f8f8ca9fee4#diff-202824684bac175f9853e38480cec450ea0e7f2d7d85a167cfb0a2f593213726L67' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 54000420</div><div id='project'> Project Name: stan-hua/cytoimagenet</div><div id='commit'> Commit Name: 58d66c4cc6eed607192ce85534d29f8f8ca9fee4</div><div id='time'> Time: 2021-08-23</div><div id='author'> Author: stanley.hua@mail.utoronto.ca</div><div id='file'> File Name: scripts/model_evaluation.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: load_model(4)</div><div id='n_method'> N Method Name: load_model(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: scripts/model_evaluation.py</div><div id='n_file'> N File Name: scripts/model_evaluation.py</div><div id='m_start'> M Start Line: 67</div><div id='m_end'> M End Line: 123</div><div id='n_start'> N Start Line: 68</div><div id='n_end'> N End Line: 125</div><BR>