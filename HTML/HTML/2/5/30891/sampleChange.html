<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        )

        &#47&#47 - log q(z). shape: [batch_shape]
        rates<a id="change"> = </a><a id="change">-</a><a id="change">torch.log(</a>q_z<a id="change">)</a>.sum(-1) / math.log(BASE_LOG)

        &#47&#47 shape: [n_codebook]
        ratebook = to_numpy(rates[i])  &#47&#47 rate for each codebook</code></pre><h3>After Change</h3><pre><code class='java'>
        p_Zlx = pl_module.p_ZlX(x)

        &#47&#47 shape: [1, batch_size, z_dim]
        z = <a id="change">p_Zlx.mean.unsqueeze(0</a><a id="change">)</a>

        &#47&#47 shape: [batch_size, z_dim]
        z_hat, rates, _, __ = pl_module.rate_estimator(z, p_Zlx, pl_module)
        z_hat, rates = z_hat.squeeze(0), rates.squeeze(0)</code></pre>