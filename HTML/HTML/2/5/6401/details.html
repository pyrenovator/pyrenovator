<html><h3>Pattern ID :6401
</h3><img src='22282544.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            for o in output_rows:
                output_row = ""
                if args.remove_with_heuristics:
                    all_input_columns<a id="change"> = </a><a id="change">&quot &quot.join(</a>[o[c] for c in args.input_columns]<a id="change">)</a>
                    input_special_tokens = set(re.findall(&quot[A-Za-z:_.]+_[0-9]&quot, all_input_columns))
                    output_special_tokens = set(re.findall(&quot[A-Za-z:_.]+_[0-9]&quot, o[args.thingtalk_column]))
                    if  not is_subset(output_special_tokens, input_special_tokens) :
                        heuristic_count += 1</code></pre><h3>After Change</h3><pre><code class='java'>
            with open(args.thrown_away, &quotw&quot) as output_file:
                for o in all_thrown_away_rows:
                    output_row = ""
                    <a id="change">for </a>i, column in <a id="change">enumerate(</a>args.output_columns<a id="change">):
                        </a>output_row += o[column]
                        if i &lt; len(args.output_columns)-1:
                            output_row += &quot\t&quot
                    output_file.write(output_row + &quot\n&quot)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/stanford-oval/genienlp/commit/d2eacd4e5c5347cb45907aea9e0a81a54b9fd5bf#diff-ee119052413383bfd6476efcd585c7782e225b9afadedd52e593204c70c2e120L31' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 22282544</div><div id='project'> Project Name: stanford-oval/genienlp</div><div id='commit'> Commit Name: d2eacd4e5c5347cb45907aea9e0a81a54b9fd5bf</div><div id='time'> Time: 2020-05-26</div><div id='author'> Author: s.j.semnani@gmail.com</div><div id='file'> File Name: genienlp/paraphrase/scripts/transform_dataset.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: genienlp/paraphrase/scripts/transform_dataset.py</div><div id='n_file'> N File Name: genienlp/paraphrase/scripts/transform_dataset.py</div><div id='m_start'> M Start Line: 55</div><div id='m_end'> M End Line: 162</div><div id='n_start'> N Start Line: 31</div><div id='n_end'> N End Line: 196</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            for o in output_rows:
                output_row = ""
                if args.remove_with_heuristics:
                    all_input_columns = <a id="change">&quot &quot.join(</a>[o[c] for c in args.input_columns]<a id="change">)</a>
                    input_special_tokens<a id="change"> = </a>set(re.findall(&quot[A-Za-z:_.]+_[0-9]&quot, all_input_columns))
                    output_special_tokens = set(re.findall(&quot[A-Za-z:_.]+_[0-9]&quot, o[args.thingtalk_column]))
                    if  not is_subset(output_special_tokens, input_special_tokens) :
                        heuristic_count += 1</code></pre><h3>After Change</h3><pre><code class='java'>
        if args.thrown_away is not None:
            &#47&#47 write the thrown away exampels into a file
            with open(args.thrown_away, &quotw&quot) as output_file:
                for <a id="change">o</a> in all_thrown_away_rows:
                    output_row = ""
                    <a id="change">for </a>i, column in <a id="change">enumerate(</a>args.output_columns<a id="change">):
                        </a>output_row += o[column]
                        if i &lt; len(args.output_columns)-1:
                            output_row += &quot\t&quot
                    output_file.write(output_row + &quot\n&quot)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/stanford-oval/genienlp/commit/d2eacd4e5c5347cb45907aea9e0a81a54b9fd5bf#diff-ee119052413383bfd6476efcd585c7782e225b9afadedd52e593204c70c2e120L15' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 22282545</div><div id='project'> Project Name: stanford-oval/genienlp</div><div id='commit'> Commit Name: d2eacd4e5c5347cb45907aea9e0a81a54b9fd5bf</div><div id='time'> Time: 2020-05-26</div><div id='author'> Author: s.j.semnani@gmail.com</div><div id='file'> File Name: genienlp/paraphrase/scripts/transform_dataset.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: genienlp/paraphrase/scripts/transform_dataset.py</div><div id='n_file'> N File Name: genienlp/paraphrase/scripts/transform_dataset.py</div><div id='m_start'> M Start Line: 55</div><div id='m_end'> M End Line: 162</div><div id='n_start'> N Start Line: 31</div><div id='n_end'> N End Line: 196</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47        self.images.append(os.path.join(root_dir, row[0] + &quot.jpg&quot))
        &#47&#47        self.masks.append(os.path.join(root_dir, row[0] + &quot_m.png&quot))

        ids = os.listdir(<a id="change">os.path.join(</a>root_dir, &quotimages&quot<a id="change">)</a>)
        self.images<a id="change"> = </a>[os.path.join(root_dir, &quotimages&quot, image_id) for image_id in ids]
        self.masks = [os.path.join(root_dir, &quotmasks&quot, image_id) for image_id in ids]

</code></pre><h3>After Change</h3><pre><code class='java'>
                "You need to implement the classes to index mapping for the dataset"
            )

        with open(file_path, "r") as <a id="change">f</a>:
            csv_reader = csv.reader(f)
            <a id="change">for </a>index, row in <a id="change">enumerate(</a>csv_reader<a id="change">):
                </a>self.images.append(os.path.join(root_dir, row[0] + &quot.jpg&quot))
                self.masks.append(os.path.join(root_dir, row[0] + &quot_m.png&quot))

    def labels(self):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/biasvariancelabs/aitlas/commit/9d2d43424f557c2b37c41651c8c8e2fab652a60e#diff-0aca5ba1d7aa8583441a7293eb1e56b78e89bca29ce04f70e95ca793680ada72L48' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 22282540</div><div id='project'> Project Name: biasvariancelabs/aitlas</div><div id='commit'> Commit Name: 9d2d43424f557c2b37c41651c8c8e2fab652a60e</div><div id='time'> Time: 2020-11-01</div><div id='author'> Author: ivica.dimitrovski@gmail.com</div><div id='file'> File Name: aitlas/datasets/landcover_ai.py</div><div id='m_class'> M Class Name: SegmentationDataset</div><div id='n_method'> N Class Name: SegmentationDataset</div><div id='m_method'> M Method Name: load_dataset(3)</div><div id='n_method'> N Method Name: load_dataset(3)</div><div id='m_parent_class'> M Parent Class: BaseDataset</div><div id='n_parent_class'> N Parent Class: BaseDataset</div><div id='m_file'> M File Name: aitlas/datasets/landcover_ai.py</div><div id='n_file'> N File Name: aitlas/datasets/landcover_ai.py</div><div id='m_start'> M Start Line: 62</div><div id='m_end'> M End Line: 64</div><div id='n_start'> N Start Line: 52</div><div id='n_end'> N End Line: 58</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    log_dir = os.path.join(args.experiment_dir, "logs")

    train_dataset = DatasetFromObj(os.path.join(data_dir, &quottrain.obj&quot), augment=True, bold=True, rotate=True, blur=True)
    val_dataset<a id="change"> = </a>DatasetFromObj(<a id="change">os.path.join(</a>data_dir, &quotval.obj&quot<a id="change">)</a>)
    dataloader = DataLoader(train_dataset, batch_size=args.batch_size, shuffle=True)

    model = Zi2ZiModel(embedding_num=args.embedding_num, embedding_dim=args.embedding_dim,</code></pre><h3>After Change</h3><pre><code class='java'>
    start_epoch = args.resume if args.resume is not None else 0
    global_steps = 0

    for <a id="change">epoch</a> in range(start_epoch, args.epoch):
        &#47&#47 generate dataset every epoch so that different styles of saved char imgs can be trained.
        train_dataset = DatasetFromObj(os.path.join(data_dir, &quottrain.obj&quot),
                                       augment=True, bold=True, rotate=True, blur=True)
        total_batches = math.ceil(len(train_dataset) / args.batch_size)
        dataloader = DataLoader(train_dataset, batch_size=args.batch_size, shuffle=True)
        <a id="change">for </a>bid, batch in <a id="change">enumerate(</a>dataloader<a id="change">):
            </a>model.set_input(batch[0], batch[2], batch[1])
            const_loss, l1_loss, category_loss, cheat_loss = model.optimize_parameters()
            passed = time.time() - start_time
            log_format = "Epoch: [%2d], [%4d/%4d] time: %4.2f, d_loss: %.5f, g_loss: %.5f, " + \</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/euphoriayan/zi2zi-pytorch/commit/d18cdce2416d812c3944db8aef913e06879b022b#diff-ed183d67207df065a11e1289f19d34cc2abbc5448dea952683cfe9728c342b95L41' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 22282541</div><div id='project'> Project Name: euphoriayan/zi2zi-pytorch</div><div id='commit'> Commit Name: d18cdce2416d812c3944db8aef913e06879b022b</div><div id='time'> Time: 2020-06-29</div><div id='author'> Author: ysq58000@foxmail.com</div><div id='file'> File Name: train.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: train.py</div><div id='n_file'> N File Name: train.py</div><div id='m_start'> M Start Line: 43</div><div id='m_end'> M End Line: 75</div><div id='n_start'> N Start Line: 49</div><div id='n_end'> N End Line: 92</div><BR>