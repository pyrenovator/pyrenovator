<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            assert torch.isfinite(
                loss
            ), "Loss should not be infinite - i.e. something went wrong (e.g. input is not in log space)"
        elif <a id="change"></a>self.reduction == "none":
            loss = losses.masked_fill(mask, "nan")
        return loss
</code></pre><h3>After Change</h3><pre><code class='java'>
            if self.reduction == "mean":
                losses = losses.masked_fill(mask, 0.0)
                loss = losses.sum() / lengths.sum()
            elif <a id="change"></a>self.reduction == "sqrt-mean":
                losses = <a id="change">losses.masked_fill(</a>mask, <a id="change">0.0</a><a id="change">)</a>
                loss<a id="change"> = </a>losses.sum() / lengths.sum()
                loss = loss.sqrt()
            assert not torch.isnan(
                loss</code></pre>