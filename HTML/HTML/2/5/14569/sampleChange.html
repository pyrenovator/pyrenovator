<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        &#47&#47what&quots happening here?
        print(&quotREWARD SHAPE: &quot, inputs[&quotreward&quot].shape)
        <a id="change">print(&quotX shape: &quot</a>, x.shape<a id="change">)</a>
        clipped_reward = torch.clamp(inputs["reward"], -1, 1).view(T * B, 1)
        core_input = torch.cat([x, clipped_reward, one_hot_last_action], dim=-1)
        &#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47transformer
        &#47&#47 if self.use_lstm:</code></pre><h3>After Change</h3><pre><code class='java'>
        baseline = self.baseline(core_output)

        &#47&#47 print(&quotPOLICY SHAPE: &quot,policy_logits.shape)
        policy_logits<a id="change"> = </a><a id="change">policy_logits.reshape(</a>T<a id="change">*</a>B, self.num_actions<a id="change">)</a>
        &#47&#47 print(&quotTMP : {} Original : {}&quot.format(policy_logits_tmp[:3, :], policy_logits[:3, :3, :]))
        if self.training:
            &#47&#47 Sample from multinomial distribution for explorationx
            action = torch.multinomial(F.softmax(policy_logits, dim=1), num_samples=1)</code></pre>