<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    optimizer = torch.optim.Adam(milnet.parameters(), lr=args.lr, betas=(0.5, 0.9), weight_decay=args.weight_decay)
    scheduler = torch.optim.lr_scheduler.CosineAnnealingLR(optimizer, args.num_epochs, 0.000005)
    
    <a id="change">if </a>args.new_features == 0:
        bags_csv = &quotdatasets/tcga-dataset/TCGA.csv&quot
    else:
        luad_list = glob.glob(&quotdatasets&quot+os.sep+&quotwsi-tcga-lung&quot+os.sep+&quotLUAD&quot+os.sep+&quot*.csv&quot)
        lusc_list = glob.glob(&quotdatasets&quot+os.sep+&quotwsi-tcga-lung&quot+os.sep+&quotLUSC&quot+os.sep+&quot*.csv&quot)
        luad_df = pd.DataFrame(luad_list)
        luad_df[&quotlabel&quot]<a id="change"> = </a>0
        luad_df.to_csv(&quotdatasets/wsi-tcga-lung/LUAD.csv&quot, index=False)        
        lusc_df = pd.DataFrame(lusc_list)
        lusc_df[&quotlabel&quot] = 1
        <a id="change">lusc_df.to_csv(</a>&quotdatasets/wsi-tcga-lung/LUSC.csv&quot<a id="change">, index=False)</a>        
        bags_path = luad_df.append(lusc_df, ignore_index=True)
        bags_path = shuffle(bags_path)
        bags_path.to_csv(&quotdatasets/wsi-tcga-lung/TCGA.csv&quot, index=False)</code></pre><h3>After Change</h3><pre><code class='java'>
    optimizer = torch.optim.Adam(milnet.parameters(), lr=args.lr, betas=(0.5, 0.9), weight_decay=args.weight_decay)
    scheduler = torch.optim.lr_scheduler.CosineAnnealingLR(optimizer, args.num_epochs, 0.000005)
    
    <a id="change">if </a>args.dataset == &quotTCGA-lung&quot:
        if args.new_features == 0:
            bags_csv = &quotdatasets/tcga-dataset/TCGA.csv&quot
        else:
            bags_csv = &quotdatasets/wsi-tcga-lung/TCGA.csv&quot
    else:
        bags_csv<a id="change"> = </a>os.path.join(&quotdatasets&quot, args.dataset, args.dataset+&quot.csv&quot)
            
        
    bags_path = pd.read_csv(bags_csv)</code></pre>