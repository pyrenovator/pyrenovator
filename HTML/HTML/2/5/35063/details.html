<html><h3>Pattern ID :35063
</h3><img src='100125966.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    return gpu

def cleanup_ddp():
    <a id="change">dist.destroy_process_group()</a>

def reduce_tensor(tensor: Tensor) -&gt; Tensor:
    rt = tensor.clone()
    dist.all_reduce(rt, op=dist.ReduceOp.SUM)</code></pre><h3>After Change</h3><pre><code class='java'>
    return gpu

def cleanup_ddp():
    <a id="change">if dist.is_initialized()</a>:
        <a id="change">dist.destroy_process_group()</a>

def reduce_tensor(tensor: Tensor) -&gt; Tensor:
    rt = tensor.clone()
    dist.all_reduce(rt, op=dist.ReduceOp.SUM)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/sithu31296/semantic-segmentation/commit/f07c22810a11b16fda279f6936cc10f30012b810#diff-9653b8c2ce917a6134298b00c8b3f7d4b7c4dc473a752303f37a870392742127L62' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 100125966</div><div id='project'> Project Name: sithu31296/semantic-segmentation</div><div id='commit'> Commit Name: f07c22810a11b16fda279f6936cc10f30012b810</div><div id='time'> Time: 2021-08-19</div><div id='author'> Author: sithu31296@gmail.com</div><div id='file'> File Name: utils/utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: cleanup_ddp(0)</div><div id='n_method'> N Method Name: cleanup_ddp(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: utils/utils.py</div><div id='n_file'> N File Name: utils/utils.py</div><div id='m_start'> M Start Line: 64</div><div id='m_end'> M End Line: 64</div><div id='n_start'> N Start Line: 62</div><div id='n_end'> N End Line: 64</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 make sure all ranks finish at the same time
        dist.barrier()
        &#47&#47 tear down after test completes
        <a id="change">dist.destroy_process_group()</a>


def distributed_test(world_size=2, backend=&quotnccl&quot):
    A decorator for executing a function (e.g., a unit test) in a distributed manner.</code></pre><h3>After Change</h3><pre><code class='java'>
            else:
                raise e

        <a id="change">if </a>self.init_distributed or <a id="change">dist.is_initialized()</a>:
            &#47&#47 make sure all ranks finish at the same time
            dist.barrier()
            &#47&#47 tear down after test completes
            <a id="change">dist.destroy_process_group()</a>


def distributed_test(world_size=2, backend=&quotnccl&quot):
    A decorator for executing a function (e.g., a unit test) in a distributed manner.</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/deepspeed/commit/7d8ad45d6ac730c56309a917fa667f76eea0b27d#diff-6dfd44de956710597d8b77a3a67b7c5ce247d6a72ddd61510b5664f6d2e5e67eL152' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 100125965</div><div id='project'> Project Name: microsoft/deepspeed</div><div id='commit'> Commit Name: 7d8ad45d6ac730c56309a917fa667f76eea0b27d</div><div id='time'> Time: 2022-08-16</div><div id='author'> Author: jerasley@microsoft.com</div><div id='file'> File Name: tests/unit/common.py</div><div id='m_class'> M Class Name: DistributedTest</div><div id='n_method'> N Class Name: DistributedTest</div><div id='m_method'> M Method Name: _dist_init(4)</div><div id='n_method'> N Method Name: _dist_init(4)</div><div id='m_parent_class'> M Parent Class: ABC</div><div id='n_parent_class'> N Parent Class: ABC</div><div id='m_file'> M File Name: tests/unit/common.py</div><div id='n_file'> N File Name: tests/unit/common.py</div><div id='m_start'> M Start Line: 154</div><div id='m_end'> M End Line: 183</div><div id='n_start'> N Start Line: 156</div><div id='n_end'> N End Line: 190</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    return gpu

def cleanup_ddp():
    <a id="change">dist.destroy_process_group()</a>

def reduce_tensor(tensor: Tensor) -&gt; Tensor:
    rt = tensor.clone()
    dist.all_reduce(rt, op=dist.ReduceOp.SUM)</code></pre><h3>After Change</h3><pre><code class='java'>
    return gpu

def cleanup_ddp():
    <a id="change">if dist.is_initialized()</a>:
        <a id="change">dist.destroy_process_group()</a>

def reduce_tensor(tensor: Tensor) -&gt; Tensor:
    rt = tensor.clone()
    dist.all_reduce(rt, op=dist.ReduceOp.SUM)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/sithu31296/image-classification/commit/8a4393a77d6c2d93f15e39a887f76787e0cb5b53#diff-9653b8c2ce917a6134298b00c8b3f7d4b7c4dc473a752303f37a870392742127L60' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 100125964</div><div id='project'> Project Name: sithu31296/image-classification</div><div id='commit'> Commit Name: 8a4393a77d6c2d93f15e39a887f76787e0cb5b53</div><div id='time'> Time: 2021-08-23</div><div id='author'> Author: sithu31296@gmail.com</div><div id='file'> File Name: utils/utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: cleanup_ddp(0)</div><div id='n_method'> N Method Name: cleanup_ddp(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: utils/utils.py</div><div id='n_file'> N File Name: utils/utils.py</div><div id='m_start'> M Start Line: 61</div><div id='m_end'> M End Line: 61</div><div id='n_start'> N Start Line: 62</div><div id='n_end'> N End Line: 64</div><BR>