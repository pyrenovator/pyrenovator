<html><h3>Pattern ID :33407
</h3><img src='96182393.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        df = pd.DataFrame(df_data)
        if save_to_csv:
            <a id="change">df.to_csv(</a>os.path.join(self.dataset_dir_path, f&quot{dataset}_df.csv&quot)<a id="change">, index=False)</a>

        return df

    def _augment_text(self, text: str) -&gt; str:</code></pre><h3>After Change</h3><pre><code class='java'>
            df = df.drop(df[df[&quotprefix&quot] == &quotutt: &quot].index)

        if save_to_csv:
            <a id="change">if sub_directory</a>:
                save_dir = os.path.join(self.dataset_dir_path, sub_directory)
                if not os.path.exists(save_dir):
                    os.makedirs(save_dir)
                df.to_csv(os.path.join(save_dir, f&quot{dataset}_df.csv&quot), index=False)
            else:
                <a id="change">df.to_csv(</a>os.path.join(self.dataset_dir_path, f&quot{dataset}_df.csv&quot)<a id="change">, index=False)</a>

        return df

    def _token_length_adjuster(self, text, max_length=510) -&gt; str:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/kimdanny/user-simulation-t5/commit/716139e9a388ad4b55d6f121b6f9e764744faa8c#diff-a0d41744710f224aab7942f0648d44c05a30ceec37ae9204bcc444700270877fL278' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 96182393</div><div id='project'> Project Name: kimdanny/user-simulation-t5</div><div id='commit'> Commit Name: 716139e9a388ad4b55d6f121b6f9e764744faa8c</div><div id='time'> Time: 2022-02-09</div><div id='author'> Author: dannykim153@gmail.com</div><div id='file'> File Name: dataset_transformation/dataset_transformer.py</div><div id='m_class'> M Class Name: DatasetTransformer</div><div id='n_method'> N Class Name: DatasetTransformer</div><div id='m_method'> M Method Name: to_mtl_df(5)</div><div id='n_method'> N Method Name: to_mtl_df(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: dataset_transformation/dataset_transformer.py</div><div id='n_file'> N File Name: dataset_transformation/dataset_transformer.py</div><div id='m_start'> M Start Line: 289</div><div id='m_end'> M End Line: 289</div><div id='n_start'> N Start Line: 278</div><div id='n_end'> N End Line: 351</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            new_df.at[i, subject_id_column_name] = new_subjectid

    &#47&#47 Write the colliding subjectids to the collision.csv file
    <a id="change">pd.DataFrame({subject_id_column_name: collisions}).to_csv(
        </a>collision_path<a id="change">, index=False
    )</a>

    &#47&#47 Write the updated dataframe to the new_test_mapping.csv file
    new_df.to_csv(mapping_path, index=False)
</code></pre><h3>After Change</h3><pre><code class='java'>
    subjectid_counts = {}

    &#47&#47 Create a list to store the colliding subjectids
    <a id="change">collisions</a> = []

    &#47&#47 Create a new dataframe to store the updated subjectids
    new_df = df.copy()

    &#47&#47 Loop through each row in the original dataframe
    for i, row in df.iterrows():
        subjectid = row[subject_id_column_name]

        &#47&#47 If the subjectid has not been seen before, add it to the dictionary
        if subjectid not in subjectid_counts:
            subjectid_counts[subjectid] = 0
        else:
            &#47&#47 If the subjectid has been seen before, increment the count and add it to the collisions list
            subjectid_counts[subjectid] += 1
            collisions.append(subjectid)
            &#47&#47 Update the subjectid in the new dataframe
            new_subjectid = f"{subjectid}_v{subjectid_counts[subjectid]}"
            new_df.at[i, subject_id_column_name] = new_subjectid

    &#47&#47 Write the colliding subject IDs to the collision.csv file
    <a id="change">if collisions</a>:
        collision_path = os.path.join(output_path, "collision.csv")
        <a id="change">pd.DataFrame({subject_id_column_name: collisions}).to_csv(
            </a>collision_path<a id="change">, index=False
        )</a>

    &#47&#47 Write the updated dataframe to the updated_test_mapping.csv file
    mapping_path = os.path.join(output_path, "updated_test_mapping.csv")
    df.to_csv(mapping_path, index=False)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/cbica/gandlf/commit/9072e498b40515ec0ecb7446bacc91d5e1cd3c2d#diff-810dce6817e5c529ee5eea42be931b4db7cf044e6f0d1fb7df933d80b7607582L6' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 96182392</div><div id='project'> Project Name: cbica/gandlf</div><div id='commit'> Commit Name: 9072e498b40515ec0ecb7446bacc91d5e1cd3c2d</div><div id='time'> Time: 2023-03-14</div><div id='author'> Author: sid.cre8er@gmail.com</div><div id='file'> File Name: GANDLF/utils/handle_collisions.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: handle_collisions(3)</div><div id='n_method'> N Method Name: handle_collisions(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: GANDLF/utils/handle_collisions.py</div><div id='n_file'> N File Name: GANDLF/utils/handle_collisions.py</div><div id='m_start'> M Start Line: 30</div><div id='m_end'> M End Line: 64</div><div id='n_start'> N Start Line: 30</div><div id='n_end'> N End Line: 62</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        adjusted_df = adjusted_df[[&quotinput_text&quot, &quottarget_text&quot]]

        if save_to_csv:
            <a id="change">adjusted_df.to_csv(</a>os.path.join(self.dataset_dir_path, f&quot{dataset}_df.csv&quot)<a id="change">, index=False)</a>

        return adjusted_df

</code></pre><h3>After Change</h3><pre><code class='java'>
        adjusted_df = adjusted_df[[&quotinput_text&quot, &quottarget_text&quot]]

        if save_to_csv:
            <a id="change">if sub_directory</a>:
                save_dir = os.path.join(self.dataset_dir_path, sub_directory)
                if not os.path.exists(save_dir):
                    os.makedirs(save_dir)
                adjusted_df.to_csv(os.path.join(save_dir, f&quot{dataset}_df.csv&quot), index=False)
            else:
                <a id="change">adjusted_df.to_csv(</a>os.path.join(self.dataset_dir_path, f&quot{dataset}_df.csv&quot)<a id="change">, index=False)</a>

        return adjusted_df

</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/kimdanny/user-simulation-t5/commit/716139e9a388ad4b55d6f121b6f9e764744faa8c#diff-a0d41744710f224aab7942f0648d44c05a30ceec37ae9204bcc444700270877fL343' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 96182387</div><div id='project'> Project Name: kimdanny/user-simulation-t5</div><div id='commit'> Commit Name: 716139e9a388ad4b55d6f121b6f9e764744faa8c</div><div id='time'> Time: 2022-02-09</div><div id='author'> Author: dannykim153@gmail.com</div><div id='file'> File Name: dataset_transformation/dataset_transformer.py</div><div id='m_class'> M Class Name: DatasetTransformer</div><div id='n_method'> N Class Name: DatasetTransformer</div><div id='m_method'> M Method Name: finalise_df(5)</div><div id='n_method'> N Method Name: finalise_df(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: dataset_transformation/dataset_transformer.py</div><div id='n_file'> N File Name: dataset_transformation/dataset_transformer.py</div><div id='m_start'> M Start Line: 354</div><div id='m_end'> M End Line: 368</div><div id='n_start'> N Start Line: 372</div><div id='n_end'> N End Line: 408</div><BR>