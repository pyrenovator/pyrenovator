<html><h3>Pattern ID :26408
</h3><img src='79239341.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

    def _generate_examples(self, filepath, labelpath):
        Yields examples.
        with open(filepath, encoding="utf-8") as f1, <a id="change">open</a><a id="change">(labelpath, encoding="utf-8") as f2:
            </a>src = f1.read().split("\n")[:-1]
            tgt = f2.read().split("\n")[:-1]
            for idx, (s, t) in enumerate(zip(src, tgt)):
                yield idx, {"translation": {self.config.src: s, self.config.tgt: t}}</code></pre><h3>After Change</h3><pre><code class='java'>
        root_dir = _ROOT_DIR[str(self.config.version)]
        data_dir = f"{root_dir}/{self.config.src}-{self.config.tgt}"
        src = tgt = None
        <a id="change">for </a>path, file in archive<a id="change">:
            </a>if data_dir in path:
                if f"{data_dir}/train.{self.config.src}" in path:
                    src = file.read().decode("utf-8").split("\n")[:-1]
                if f"{data_dir}/train.{self.config.tgt}" in path:
                    tgt = <a id="change">file.read()</a>.decode("utf-8").split("\n")[:-1]
            if src and tgt:
                break
        for idx, (s, t) in enumerate(zip(src, tgt)):</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/huggingface/datasets/commit/f7323d8f691326b18bb07ecc106103dd58f4499d#diff-88def1678284cfc73ca77cdede0f2d03160a124418412e3d09aea0cf54c5ed2bL147' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 79239341</div><div id='project'> Project Name: huggingface/datasets</div><div id='commit'> Commit Name: f7323d8f691326b18bb07ecc106103dd58f4499d</div><div id='time'> Time: 2021-12-29</div><div id='author'> Author: 8515462+albertvillanova@users.noreply.github.com</div><div id='file'> File Name: datasets/pib/pib.py</div><div id='m_class'> M Class Name: Pib</div><div id='n_method'> N Class Name: Pib</div><div id='m_method'> M Method Name: _generate_examples(2)</div><div id='n_method'> N Method Name: _generate_examples(3)</div><div id='m_parent_class'> M Parent Class: datasets.GeneratorBasedBuilder</div><div id='n_parent_class'> N Parent Class: datasets.GeneratorBasedBuilder</div><div id='m_file'> M File Name: datasets/pib/pib.py</div><div id='n_file'> N File Name: datasets/pib/pib.py</div><div id='m_start'> M Start Line: 147</div><div id='m_end'> M End Line: 153</div><div id='n_start'> N Start Line: 172</div><div id='n_end'> N End Line: 184</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

            display(HTML(h))
        else:
            <a id="change">with tempfile</a><a id="change">.NamedTemporaryFile(delete=False, suffix=".html") as f:
                </a>path_utils.write_file_contents_as_string(f.name, h)
                url = f"file:///{f.name}"
                webbrowser.open(url, new=2)
</code></pre><h3>After Change</h3><pre><code class='java'>
            magic: Whether to render in a Jupyter notebook or not.
        
        datasets = []
        <a id="change">for </a>output_name, <a id="change">artifact_view</a> in step.outputs.items()<a id="change">:
            </a>df = <a id="change">artifact_view.read()</a>
            datasets.append({"name": output_name, "table": df})
        h = self.generate_html(datasets)
        self.generate_facet(h, magic)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/maiot-io/zenml/commit/e51baa83069396f3ff822267e5250f84af1ad467#diff-5f7833a0b1c6b73ee466162012716f42b44dd5c743a7213a41b53dcda54d9a9eL37' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 79239343</div><div id='project'> Project Name: maiot-io/zenml</div><div id='commit'> Commit Name: e51baa83069396f3ff822267e5250f84af1ad467</div><div id='time'> Time: 2021-11-14</div><div id='author'> Author: htahir111@gmail.com</div><div id='file'> File Name: src/zenml/post_execution/visualizers/facet_statistics_visualizer.py</div><div id='m_class'> M Class Name: FacetStatisticsVisualizer</div><div id='n_method'> N Class Name: FacetStatisticsVisualizer</div><div id='m_method'> M Method Name: visualize(3)</div><div id='n_method'> N Method Name: visualize(3)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/zenml/post_execution/visualizers/facet_statistics_visualizer.py</div><div id='n_file'> N File Name: src/zenml/post_execution/visualizers/facet_statistics_visualizer.py</div><div id='m_start'> M Start Line: 39</div><div id='m_end'> M End Line: 65</div><div id='n_start'> N Start Line: 47</div><div id='n_end'> N End Line: 52</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        data_fields.remove("audio")
        path_idx = data_fields.index("path")

        <a id="change">with open</a><a id="change">(filepath, encoding="utf-8") as f:
            </a>lines = f.readlines()
            headline = lines[0]

            column_names = headline.strip().split("\t")</code></pre><h3>After Change</h3><pre><code class='java'>

        all_field_values = {}
        metadata_found = False
        <a id="change">for </a>path, <a id="change">f</a> in files<a id="change">:
            </a>if path == filepath:
                metadata_found = True
                lines = f.readlines()
                headline = lines[0].decode("utf-8")

                column_names = headline.strip().split("\t")
                assert (
                    column_names == data_fields
                ), f"The file should have {data_fields} as column names, but has {column_names}"
                for line in lines[1:]:
                    field_values = line.decode("utf-8").strip().split("\t")
                    &#47&#47 set full path for mp3 audio file
                    audio_path = "/".join([path_to_clips, field_values[path_idx]])
                    all_field_values[audio_path] = field_values
            elif path.startswith(path_to_clips):
                assert metadata_found, "Found audio clips before the metadata TSV file."
                if not all_field_values:
                    break
                if path in all_field_values:
                    field_values = all_field_values[path]

                    &#47&#47 if data is incomplete, fill with empty values
                    if len(field_values) &lt; len(data_fields):
                        field_values += (len(data_fields) - len(field_values)) * ["&quot&quot"]

                    result = {key: value for key, value in zip(data_fields, field_values)}

                    &#47&#47 set audio feature
                    result["audio"] = {"path": path, "bytes": <a id="change">f.read()</a>}

                    yield path, result
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/datasets/commit/0534a87f60fb9a589138f0773e057c2429f482b7#diff-fa6b2547cb8690de10dc4151010f3ce12300c5488a6277932a571021aac2532fL703' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 79239344</div><div id='project'> Project Name: huggingface/datasets</div><div id='commit'> Commit Name: 0534a87f60fb9a589138f0773e057c2429f482b7</div><div id='time'> Time: 2021-11-19</div><div id='author'> Author: 42851186+lhoestq@users.noreply.github.com</div><div id='file'> File Name: datasets/common_voice/common_voice.py</div><div id='m_class'> M Class Name: CommonVoice</div><div id='n_method'> N Class Name: CommonVoice</div><div id='m_method'> M Method Name: _generate_examples(4)</div><div id='n_method'> N Method Name: _generate_examples(3)</div><div id='m_parent_class'> M Parent Class: datasets.GeneratorBasedBuilder</div><div id='n_parent_class'> N Parent Class: datasets.GeneratorBasedBuilder</div><div id='m_file'> M File Name: datasets/common_voice/common_voice.py</div><div id='n_file'> N File Name: datasets/common_voice/common_voice.py</div><div id='m_start'> M Start Line: 709</div><div id='m_end'> M End Line: 735</div><div id='n_start'> N Start Line: 707</div><div id='n_end'> N End Line: 748</div><BR>