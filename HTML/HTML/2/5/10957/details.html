<html><h3>Pattern ID :10957
</h3><img src='37836529.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    &#47&#47 print("initialize")

    &#47&#47 select device
    device = <a id="change">torch.device("cpu"</a><a id="change">)</a>
    &#47&#47 print("device: %s" % device)

    &#47&#47 load network
    model = Net(model_path)
    model.to(device)
    model.eval()

    &#47&#47 get input
    &#47&#47 img_names = glob.glob(os.path.join(input_path, "*"))
    &#47&#47 num_images = len(img_names)

    &#47&#47 create output folder
    &#47&#47 os.makedirs(output_path, exist_ok=True)

    &#47&#47 print("start processing")

    &#47&#47 for ind, img_name in enumerate(img_names):

        &#47&#47 print("  processing {} ({}/{})".format(img_name, ind + 1, num_images))

        &#47&#47 input
        &#47&#47 img = utils.read_image(img_name)
    w = img.shape[1]
    scale = 640. / max(img.shape[0], img.shape[1])
    target_height, target_width = int(round(img.shape[0] * scale)), int(round(img.shape[1] * scale))
    img_input = utils.resize_image(img)
    &#47&#47 print(img_input.shape)
    img_input<a id="change"> = </a>img_input.to(device)
    &#47&#47 compute
    with torch.no_grad():
        out = model.forward(img_input)</code></pre><h3>After Change</h3><pre><code class='java'>
    target_height, target_width = int(round(img.shape[0] * scale)), int(round(img.shape[1] * scale))
    img_input = utils.resize_image(img)
    &#47&#47 print(img_input.shape)
    <a id="change">if </a><a id="change">torch.cuda.is_available() and not f</a>:
        img_input = img_input.cuda()
    &#47&#47 compute
    with torch.no_grad():</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/kritiksoman/gimp-ml/commit/001b95d59db583a31816d6a84771c6eca3831014#diff-6bc284d7aee4a584f1c1627a18853ea29d4cab63194d0c61e88c6752f9922722L14' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 37836529</div><div id='project'> Project Name: kritiksoman/gimp-ml</div><div id='commit'> Commit Name: 001b95d59db583a31816d6a84771c6eca3831014</div><div id='time'> Time: 2020-09-20</div><div id='author'> Author: kritiksoman@Kritiks-MacBook-Air.local</div><div id='file'> File Name: gimp-plugins/MiDaS/run.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: run_depth(6)</div><div id='n_method'> N Method Name: run_depth(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: gimp-plugins/MiDaS/run.py</div><div id='n_file'> N File Name: gimp-plugins/MiDaS/run.py</div><div id='m_start'> M Start Line: 25</div><div id='m_end'> M End Line: 53</div><div id='n_start'> N Start Line: 14</div><div id='n_end'> N End Line: 57</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            if torch.cuda.is_available():
                self.device = torch.device("cuda")
            elif torch.backends.mps.is_available() and torch.backends.mps.is_built():
                self.device<a id="change"> = </a><a id="change">torch.device("mps"</a><a id="change">)</a>
            else:
                self.device = torch.device("cpu")
        else:
            self.device = device</code></pre><h3>After Change</h3><pre><code class='java'>
            pass
        elif isinstance(raw_count, ad.AnnData):
            &#47&#47 get ambient profile from AnnData.uns
            <a id="change">if </a><a id="change">(ambient_profile is None) and ("ambient_profile_all" in raw_count.uns)</a>:
                print("Found ambient profile in AnnData.uns[&quotambient_profile_all&quot]")
                ambient_profile = raw_count.uns["ambient_profile_all"]
            elif (ambient_profile is None) and (</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/novartis/scar/commit/3e665696fca90371c5571580921855503805bab5#diff-b2119d621ad5c6fc5288c4bfa993ce5cad3d34819006f0b28539e184b025101bL187' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 37836528</div><div id='project'> Project Name: novartis/scar</div><div id='commit'> Commit Name: 3e665696fca90371c5571580921855503805bab5</div><div id='time'> Time: 2023-03-02</div><div id='author'> Author: 43896555+CaibinSh@users.noreply.github.com</div><div id='file'> File Name: scar/main/_scar.py</div><div id='m_class'> M Class Name: model</div><div id='n_method'> N Class Name: model</div><div id='m_method'> M Method Name: __init__(11)</div><div id='n_method'> N Method Name: __init__(11)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: scar/main/_scar.py</div><div id='n_file'> N File Name: scar/main/_scar.py</div><div id='m_start'> M Start Line: 205</div><div id='m_end'> M End Line: 261</div><div id='n_start'> N Start Line: 206</div><div id='n_end'> N End Line: 278</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            if torch.cuda.is_available():
                self.device = torch.device("cuda")
            elif torch.backends.mps.is_available() and torch.backends.mps.is_built():
                self.device<a id="change"> = </a><a id="change">torch.device("mps"</a><a id="change">)</a>
            else:
                self.device = torch.device("cpu")
        else:
            self.device = device</code></pre><h3>After Change</h3><pre><code class='java'>
            if (ambient_profile is None) and ("ambient_profile_all" in raw_count.uns):
                print("Found ambient profile in AnnData.uns[&quotambient_profile_all&quot]")
                ambient_profile = raw_count.uns["ambient_profile_all"]
            elif <a id="change">(ambient_profile is None) and (
                "ambient_profile_all" not in raw_count.uns
            )</a>:
                print(
                    "Ambient profile not found in AnnData.uns[&quotambient_profile&quot], estimating it by averaging pooled cells..."
                )</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/novartis/scar/commit/4f5e05fa5bf6aa413287fb2be73d6ad01a3fc9b3#diff-b2119d621ad5c6fc5288c4bfa993ce5cad3d34819006f0b28539e184b025101bL188' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 37836536</div><div id='project'> Project Name: novartis/scar</div><div id='commit'> Commit Name: 4f5e05fa5bf6aa413287fb2be73d6ad01a3fc9b3</div><div id='time'> Time: 2023-03-02</div><div id='author'> Author: caibin.sheng.res@gmail.com</div><div id='file'> File Name: scar/main/_scar.py</div><div id='m_class'> M Class Name: model</div><div id='n_method'> N Class Name: model</div><div id='m_method'> M Method Name: __init__(11)</div><div id='n_method'> N Method Name: __init__(11)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: scar/main/_scar.py</div><div id='n_file'> N File Name: scar/main/_scar.py</div><div id='m_start'> M Start Line: 206</div><div id='m_end'> M End Line: 206</div><div id='n_start'> N Start Line: 206</div><div id='n_end'> N End Line: 272</div><BR>