<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            preds = []
            true = []
            for batch_x, batch_y_h, batch_y in data_test_loader:
                batch_x = <a id="change">batch_x.cuda()</a>
                batch_y = batch_y.cuda()
                batch_y_h = batch_y_h.cuda()
                output = self.pt_model(batch_x, batch_y_h)
                preds.append(output.detach().cpu().numpy())
                true.append(batch_y.detach().cpu().numpy())
                mse_val<a id="change"> += </a>self.loss(output, batch_y).item()*batch_x.shape[0]
        preds = np.concatenate(preds)
        true = np.concatenate(true)
</code></pre><h3>After Change</h3><pre><code class='java'>
        self.pt_model.load_state_dict(torch.load(self.saved_model))

        with torch.no_grad():
            <a id="change">if self.use_predicted_output</a>:
                true, preds, mse_val = self.eval_epoch_v2(data_test_loader)
            else:
                true<a id="change">, preds, mse_val</a> = self.eval_epoch_v1(data_test_loader)
        preds = np.concatenate(preds)
        true = np.concatenate(true)
</code></pre>