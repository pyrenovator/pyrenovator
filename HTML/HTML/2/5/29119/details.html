<html><h3>Pattern ID :29119
</h3><img src='85794173.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            print("last_sample_time", stream.get_last_sample_time())

            type = stream.get_type()
            <a id="change">print("type"</a>, type.get_name()<a id="change">)</a>

            for t in range(min(stream.get_size(), 1000)):
                print("stream name", stream.get_name(), "t", t, "off", stream.get_size())
</code></pre><h3>After Change</h3><pre><code class='java'>
            gt_dem = np.array(gt_dem_compound["data"].cast())
            gt_dem = gt_dem.reshape((-1, int(np.sqrt(gt_dem.shape[0]))), order="F")

            gt_data_um_compound<a id="change"> = </a>self.pocolog_pybind.pocolog.get_sample(occ_dem_stream, msg_idx)
            gt_data_um<a id="change"> = </a><a id="change">np.array(</a>gt_data_um_compound["data"].cast()<a id="change">)</a>
            gt_data_um = gt_data_um.reshape((-1, int(np.sqrt(gt_data_um.shape[0]))), order="F")

            res_grid = np.array([0.05, 0.05])
            rel_position_z = occ_dem[int(occ_dem.shape[0] // 2), int(occ_dem.shape[1] // 2)]</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/mstoelzle/solving-occlusion/commit/ed2440145acb1157898c7e8bba245ef2de4ac717#diff-cfe207af2c96ac59d9ea664639b1ffb315b70d4b6bd5ced37859da98bc28d61eL71' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 85794173</div><div id='project'> Project Name: mstoelzle/solving-occlusion</div><div id='commit'> Commit Name: ed2440145acb1157898c7e8bba245ef2de4ac717</div><div id='time'> Time: 2021-02-05</div><div id='author'> Author: maximilian@stoelzle.ch</div><div id='file'> File Name: src/dataset_generation/ga_slam_pocolog_dataset_generator.py</div><div id='m_class'> M Class Name: GASlamPocologDatasetGenerator</div><div id='n_method'> N Class Name: GASlamPocologDatasetGenerator</div><div id='m_method'> M Method Name: run(1)</div><div id='n_method'> N Method Name: run(1)</div><div id='m_parent_class'> M Parent Class: BaseDatasetGenerator</div><div id='n_parent_class'> N Parent Class: BaseDatasetGenerator</div><div id='m_file'> M File Name: src/dataset_generation/ga_slam_pocolog_dataset_generator.py</div><div id='n_file'> N File Name: src/dataset_generation/ga_slam_pocolog_dataset_generator.py</div><div id='m_start'> M Start Line: 71</div><div id='m_end'> M End Line: 141</div><div id='n_start'> N Start Line: 71</div><div id='n_end'> N End Line: 111</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        returns the observation, the reward, and a done signal for end of episode
        obs must be a list of numpy arrays
        
        <a id="change">print(f"obs: {self.drone_int.read_obs()}"</a><a id="change">)</a>
        pass
        &#47&#47 return obs, rew, done

    def get_observation_space(self):</code></pre><h3>After Change</h3><pre><code class='java'>
        obs must be a list of numpy arrays
        
        self.drone_int.update()
        obs<a id="change"> = </a>self.drone_int.read_obs()
        &#47&#47 print(f"obs:{obs}")
        o<a id="change"> = </a>[<a id="change">np.array(</a>[obs[0], obs[1], obs[2], self.target, time.time() - obs[4]]<a id="change">, dtype=np.float32)</a>, ]
        r = - np.float32(abs(self.target - obs[0]))
        d = (r &gt;= -1)
        return o, r, d</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/trackmania-rl/tmrl/commit/cd4eb35420d67250b9c25e3bee29a31bb406aa28#diff-46af771659f80bf2faa3da70b704616ada5d7d10f33ac9097db39920f65b3fc2L449' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 85794159</div><div id='project'> Project Name: trackmania-rl/tmrl</div><div id='commit'> Commit Name: cd4eb35420d67250b9c25e3bee29a31bb406aa28</div><div id='time'> Time: 2020-11-04</div><div id='author'> Author: yann.bouteiller@hotmail.fr</div><div id='file'> File Name: agents-rt/agents/custom/custom_gym_interfaces.py</div><div id='m_class'> M Class Name: CogniflyInterfaceTask1</div><div id='n_method'> N Class Name: CogniflyInterfaceTask1</div><div id='m_method'> M Method Name: get_obs_rew_done(1)</div><div id='n_method'> N Method Name: get_obs_rew_done(1)</div><div id='m_parent_class'> M Parent Class: RealTimeGymInterface</div><div id='n_parent_class'> N Parent Class: RealTimeGymInterface</div><div id='m_file'> M File Name: agents-rt/agents/custom/custom_gym_interfaces.py</div><div id='n_file'> N File Name: agents-rt/agents/custom/custom_gym_interfaces.py</div><div id='m_start'> M Start Line: 454</div><div id='m_end'> M End Line: 455</div><div id='n_start'> N Start Line: 459</div><div id='n_end'> N End Line: 465</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    image_features = np.array(image_features)
    trajectory_history = np.array(trajectory_history)
    trajectory_future = np.array(trajectory_future)
    <a id="change">print(&quotimg shape&quot</a>, image_features.shape<a id="change">)</a>
    print(&quothistory shape&quot, trajectory_history.shape)
    print(&quotfuture shape&quot, trajectory_future.shape)

    if not os.path.exists(DATA_PATH):</code></pre><h3>After Change</h3><pre><code class='java'>
    image_history = []
    trajectory_history = []
    trajectory_future = []
    intent_pose<a id="change"> = </a>[]

    for frame_idx in tqdm(range(stride*history, len(all_frames) - stride*future, stride)):
        frame_token = all_frames[frame_idx]
        all_instance_tokens, all_instance_indices = extractor.filter_instances(frame_token, stride, history, future)
        num_insts = len(all_instance_tokens)
        with multiprocessing.Pool(processes=os.cpu_count()) as pool:
            inputs = zip(all_instance_tokens, all_instance_indices, [frame_token]*num_insts, [extractor]*num_insts, [ds]*num_insts)
            results = pool.starmap(get_data_for_instance, inputs)
            [image_history.append(feature) for feature, _, _, _ in results]
            [trajectory_history.append(feature) for _, feature, _, _ in results]
            [trajectory_future.append(feature) for _, _, feature, _ in results]
            [intent_pose.append(feature) for _, _, _, feature in results]
        
    image_history = np.array(image_history)
    trajectory_history = np.array(trajectory_history)
    trajectory_future = np.array(trajectory_future)
    intent_pose<a id="change"> = </a><a id="change">np.array(</a>intent_pose<a id="change">)</a>
    print(&quotimg history shape&quot, image_history.shape)
    print(&quothistory shape&quot, trajectory_history.shape)
    print(&quotfuture shape&quot, trajectory_future.shape)
    print(&quotintent pose shape&quot, intent_pose.shape)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/xushenlz/parksim/commit/5bf389a0e7eca3b376329a58cc1bf99832105114#diff-0d45dcdbc28a28c5efdb0bd7828033709928f44b6d9343261e727a42ccb2b75eL61' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 85794158</div><div id='project'> Project Name: xushenlz/parksim</div><div id='commit'> Commit Name: 5bf389a0e7eca3b376329a58cc1bf99832105114</div><div id='time'> Time: 2022-03-11</div><div id='author'> Author: xushen0118@outlook.com</div><div id='file'> File Name: python/parksim/trajectory_predict/data_processing/create_dataset.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: create_dataset(2)</div><div id='n_method'> N Method Name: create_dataset(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: python/parksim/trajectory_predict/data_processing/create_dataset.py</div><div id='n_file'> N File Name: python/parksim/trajectory_predict/data_processing/create_dataset.py</div><div id='m_start'> M Start Line: 88</div><div id='m_end'> M End Line: 93</div><div id='n_start'> N Start Line: 87</div><div id='n_end'> N End Line: 115</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        loss.backward()
        optimizer.step()
        if batch_idx % log_interval == 0:
            <a id="change">print(f&quotTrain Epoch: {epoch} [{batch_idx * len(data)}/{len(train_loader.dataset)}&quot
                  f&quot({100. * batch_idx / len(train_loader):.0f}%)]\tLoss: {loss.item():.6f}&quot</a><a id="change">)</a>


def test(model, device, test_loader):
    model.eval()</code></pre><h3>After Change</h3><pre><code class='java'>


def train(log_interval, model, device, train_loader, optimizer, epoch):
    loss_list<a id="change"> = </a>[]
    model.train()
    for batch_idx, (data, target) in enumerate(train_loader):
        data, target = data.to(device), target.to(device)
        optimizer.zero_grad()
        output = model(data)
        loss = F.nll_loss(output, target)
        loss.backward()
        optimizer.step()

        loss_list.append(loss.item())
    
    &#47&#47    if batch_idx % log_interval == 0:
    &#47&#47        print(f&quotTrain Epoch: {epoch} [{batch_idx * len(data)}/{len(train_loader.dataset)}&quot
    &#47&#47              f&quot({100. * batch_idx / len(train_loader):.0f}%)]\tLoss: {loss.item():.6f}&quot)
    
    loss_list<a id="change"> = </a><a id="change">np.array(</a>loss_list<a id="change">)</a>
    print(&quotEpoch &quot + str(epoch) + &quot - loss avg: &quot + str(np.mean(loss_list)))


def test(model, device, test_loader):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/mlf-core/machine_learning_determinism_evaluation/commit/b8a499131125427873c07e9dfd65b038937427ba#diff-d1520c97a8d1e38ed50b885655d7b8ef84dd7f39e2c7234690edb2a58e5e19d7L45' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 85794160</div><div id='project'> Project Name: mlf-core/machine_learning_determinism_evaluation</div><div id='commit'> Commit Name: b8a499131125427873c07e9dfd65b038937427ba</div><div id='time'> Time: 2022-05-09</div><div id='author'> Author: luis.kuhn@gmail.com</div><div id='file'> File Name: bin/train_mnist_pytorch.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train(6)</div><div id='n_method'> N Method Name: train(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: bin/train_mnist_pytorch.py</div><div id='n_file'> N File Name: bin/train_mnist_pytorch.py</div><div id='m_start'> M Start Line: 47</div><div id='m_end'> M End Line: 58</div><div id='n_start'> N Start Line: 46</div><div id='n_end'> N End Line: 63</div><BR>