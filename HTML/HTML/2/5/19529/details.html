<html><h3>Pattern ID :19529
</h3><img src='63570442.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    image_embeddings = image_embeddings.detach().numpy()
    text_embeddings = text_embeddings.detach().numpy()

    <a id="change">print("expected_image_embeddings_sum ="</a>, <a id="change">float(</a>np.sum(image_embeddings)<a id="change">))</a>
    print(
        "expected_image_embeddings_part =",
        image_embeddings[0, :5].astype(float).tolist(),
    )</code></pre><h3>After Change</h3><pre><code class='java'>
        show(text_embeddings[0, :5]),
    )
    print()
    <a id="change">print(
        "expected_logits_per_image ="</a>,
        show(logits_per_image)<a id="change">,
    )</a>
    print()
    print("expected_probabilities =", show(logits_per_image.softmax(dim=-1)))

    preprocessed_image_path = os.path.join(</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/lakeraai/onnx_clip/commit/0acfe30d6cad5a1c7f373e6fdaa47fbf17509ef6#diff-f7bc52baaadb2f3a987f17a011dac6744d9c25273be96d45a765ae0f98d5f1f9L39' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 63570442</div><div id='project'> Project Name: lakeraai/onnx_clip</div><div id='commit'> Commit Name: 0acfe30d6cad5a1c7f373e6fdaa47fbf17509ef6</div><div id='time'> Time: 2023-02-01</div><div id='author'> Author: vv@lakera.ai</div><div id='file'> File Name: create_ground_truth_data.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: main(0)</div><div id='n_method'> N Method Name: main(0)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: create_ground_truth_data.py</div><div id='n_file'> N File Name: create_ground_truth_data.py</div><div id='m_start'> M Start Line: 41</div><div id='m_end'> M End Line: 69</div><div id='n_start'> N Start Line: 39</div><div id='n_end'> N End Line: 78</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    for i, gradient_ii in enumerate(single_gradients):
        if not return_results:
            if i == which_to_recover:
                <a id="change">print(</a>float(torch.norm(gradient_ii)), <a id="change">float(</a>single_losses[i]<a id="change">)</a>, <a id="change">"   target"</a><a id="change">)</a>
            else:
                print(float(torch.norm(gradient_ii)), float(single_losses[i]))

        grad_norm.append(float(torch.norm(gradient_ii)))</code></pre><h3>After Change</h3><pre><code class='java'>
            if i == which_to_recover:
                print(f"{float(torch.norm(gradient_ii)):2.4f} | {float(single_losses[i]):4.2f} - target")
            else:
                <a id="change">print(f"{float(torch.norm(gradient_ii)):2.4f} | {float(single_losses[i]):4.2f}"</a><a id="change">)</a>

        grad_norm.append(float(torch.norm(gradient_ii)))
        losses.append(float(single_losses[i]))
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/jonasgeiping/breaching/commit/a72e7801c0d1d59de5cbd90f62103179352d8bd1#diff-8863698bcfbe5ee631e222d0995f9381d630be85cf228c4a69d21bedd1328791L209' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 63570440</div><div id='project'> Project Name: jonasgeiping/breaching</div><div id='commit'> Commit Name: a72e7801c0d1d59de5cbd90f62103179352d8bd1</div><div id='time'> Time: 2022-02-14</div><div id='author'> Author: jonas.geiping@googlemail.com</div><div id='file'> File Name: breaching/cases/malicious_modifications/classattack_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: print_gradients_norm(4)</div><div id='n_method'> N Method Name: print_gradients_norm(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: breaching/cases/malicious_modifications/classattack_utils.py</div><div id='n_file'> N File Name: breaching/cases/malicious_modifications/classattack_utils.py</div><div id='m_start'> M Start Line: 216</div><div id='m_end'> M End Line: 221</div><div id='n_start'> N Start Line: 219</div><div id='n_end'> N End Line: 221</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        threshold_low = float(clean_entropy[int(0.05 * len(clean_entropy))])
        threshold_high = float(clean_entropy[int(0.95 * len(clean_entropy))])
        print(f&quotThreshold: ({threshold_low:5.3f}, {threshold_high:5.3f})&quot)
        percent = <a id="change">float(</a>((poison_entropy &lt; threshold_low) +
                         (poison_entropy &gt; threshold_high)).sum().float() / len(poison_entropy)<a id="change">)</a>
        <a id="change">print(&quotClassification Acc: &quot</a>, percent<a id="change">)</a>

    def check(self, _input) -&gt; torch.Tensor:
        _list = []
        for i, data in enumerate(self.loader):</code></pre><h3>After Change</h3><pre><code class='java'>
                             torch.ones_like(entropy), torch.zeros_like(entropy))
        print(f&quotThreshold: ({threshold_low:5.3f}, {threshold_high:5.3f})&quot)
        print("f1_score:", metrics.f1_score(y_true, y_pred, average=&quotweighted&quot))
        <a id="change">print("precision_score:"</a>, metrics.precision_score(y_true, y_pred, average=&quotweighted&quot)<a id="change">)</a>
        print("recall_score:", metrics.recall_score(y_true, y_pred, average=&quotweighted&quot))
        print("accuracy_score:", metrics.accuracy_score(y_true, y_pred))

    def check(self, _input) -&gt; torch.Tensor:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ain-soph/trojanzoo/commit/b252ab7e9a5f58cee299ad63b05fca46835a6b65#diff-264e4a06fdd2fd8a4284befe023b6d56eaf6a9418263a314d8351d14535d55c0L22' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 63570444</div><div id='project'> Project Name: ain-soph/trojanzoo</div><div id='commit'> Commit Name: b252ab7e9a5f58cee299ad63b05fca46835a6b65</div><div id='time'> Time: 2020-09-13</div><div id='author'> Author: ain-soph@live.com</div><div id='file'> File Name: trojanzoo/defense/backdoor/strip.py</div><div id='m_class'> M Class Name: STRIP</div><div id='n_method'> N Class Name: STRIP</div><div id='m_method'> M Method Name: detect(1)</div><div id='n_method'> N Method Name: detect(1)</div><div id='m_parent_class'> M Parent Class: Defense_Backdoor</div><div id='n_parent_class'> N Parent Class: Defense_Backdoor</div><div id='m_file'> M File Name: trojanzoo/defense/backdoor/strip.py</div><div id='n_file'> N File Name: trojanzoo/defense/backdoor/strip.py</div><div id='m_start'> M Start Line: 35</div><div id='m_end'> M End Line: 43</div><div id='n_start'> N Start Line: 35</div><div id='n_end'> N End Line: 49</div><BR>