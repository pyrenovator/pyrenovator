<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            g = self.group.sample()

            points_g = torch.tensor(self.action(g), device=points.device, dtype=points.dtype) @ points
            basis_g = <a id="change">{
                j: self.sample_j(points_g, j)[0, 0]
                for j, _ in self.js
            }</a>

            g_basis = {
                j: torch.tensor(self.group.irrep(*j)(g), device=points.device, dtype=points.dtype) @ basis_j
                for j, basis_j in basis</code></pre><h3>After Change</h3><pre><code class='java'>
                assert basis_g[j].shape == (1, 1, m, dim, S), (basis_g[j].shape, m, dim, S)
                assert g_basis[j].shape == (1, 1, m, dim, S), (g_basis[j].shape, m, dim, S)
                bg = basis_g[j].cpu().numpy()[0, 0, :, 0, :]
                gb = <a id="change">g_basis[j].cpu().numpy()[0, 0, :, 0, :]</a>
                assert torch.allclose(g_basis[j], basis_g[j], atol=1e-6, rtol=1e-4)
</code></pre>