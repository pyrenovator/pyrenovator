<html><h3>Pattern ID :20496
</h3><img src='66273970.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
           [0, 2]], dtype=int64)
    
    users = to_numpy(log, "user_idx")
    items<a id="change"> = </a>to_numpy(log, "item_idx")
    relevance = <a id="change">to_numpy(</a>log, "relevance"<a id="change">)</a>
    <a id="change">return </a>csr_matrix((relevance<a id="change">, (items, users)</a>))


def to_numpy(log: DataFrame, col: str) -&gt; np.ndarray:</code></pre><h3>After Change</h3><pre><code class='java'>
           [0, 2]], dtype=int64)
    
    df = log.select("user_idx", "item_idx", "relevance").toPandas()
    return csr_matrix((df.relevance<a id="change">, (df.item_idx, df.user_idx)</a>))
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/sb-ai-lab/replay/commit/d64dec49c52992118860248b7aba033c903c12b9#diff-3df8995e7757f58ab72261f4c2270076b4493ad9ba18d64476da3d168e33bedaL277' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 66273970</div><div id='project'> Project Name: sb-ai-lab/replay</div><div id='commit'> Commit Name: d64dec49c52992118860248b7aba033c903c12b9</div><div id='time'> Time: 2020-04-30</div><div id='author'> Author: yytamm@sberbank.ru</div><div id='file'> File Name: sponge_bob_magic/utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: to_csr(1)</div><div id='n_method'> N Method Name: to_csr(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: sponge_bob_magic/utils.py</div><div id='n_file'> N File Name: sponge_bob_magic/utils.py</div><div id='m_start'> M Start Line: 277</div><div id='m_end'> M End Line: 280</div><div id='n_start'> N Start Line: 277</div><div id='n_end'> N End Line: 278</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
           [0, 0],
           [0, 2]], dtype=int64)
    
    users = <a id="change">to_numpy(</a>log, "user_idx"<a id="change">)</a>
    items<a id="change"> = </a>to_numpy(log, "item_idx")
    relevance = to_numpy(log, "relevance")
    <a id="change">return </a>csr_matrix((relevance<a id="change">, (items, users)</a>))


def to_numpy(log: DataFrame, col: str) -&gt; np.ndarray:</code></pre><h3>After Change</h3><pre><code class='java'>
           [0, 2]], dtype=int64)
    
    df = log.select("user_idx", "item_idx", "relevance").toPandas()
    return csr_matrix((df.relevance, (df.item_idx<a id="change">, df.user_idx</a>)))
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/sb-ai-lab/replay/commit/11d2dcf0cc56cfcbaee2c35e801681acf6757d9a#diff-3df8995e7757f58ab72261f4c2270076b4493ad9ba18d64476da3d168e33bedaL263' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 66273968</div><div id='project'> Project Name: sb-ai-lab/replay</div><div id='commit'> Commit Name: 11d2dcf0cc56cfcbaee2c35e801681acf6757d9a</div><div id='time'> Time: 2020-05-07</div><div id='author'> Author: yytamm@sberbank.ru</div><div id='file'> File Name: sponge_bob_magic/utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: to_csr(1)</div><div id='n_method'> N Method Name: to_csr(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: sponge_bob_magic/utils.py</div><div id='n_file'> N File Name: sponge_bob_magic/utils.py</div><div id='m_start'> M Start Line: 277</div><div id='m_end'> M End Line: 280</div><div id='n_start'> N Start Line: 277</div><div id='n_end'> N End Line: 278</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        integration_domain.requires_grad = True

        &#47&#47 Compute integral
        result<a id="change"> = </a>integrate(integration_domain=integration_domain, **integrate_kwargs)
        result_np = to_numpy(result)

        &#47&#47 Check for presence of gradient and correct dtype
        assert hasattr(result, "grad_fn")
        assert get_dtype_name(result) == dtype_name

        &#47&#47 Backprop gradient through integral and get the gradient
        result.backward()
        gradient = integration_domain.grad
        assert get_dtype_name(gradient) == dtype_name

        <a id="change">return </a><a id="change">to_numpy(</a>gradient<a id="change">), result_np</a>

    elif backend == "jax":
        import jax
</code></pre><h3>After Change</h3><pre><code class='java'>

        &#47&#47 Calculate the value and gradient
        value_and_grad_func = jax.value_and_grad(func)
        result<a id="change">, gradient</a> = value_and_grad_func(param)

    elif backend == "tensorflow":
        import tensorflow as tf</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/esa/torchquad/commit/6e2decb33e025d0a819856edad92436fa1ecb5da#diff-dee74a23c9063d25939ff969b2fe43551ff24496c88ef48d11fd08cf0cc631aeL41' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 66273959</div><div id='project'> Project Name: esa/torchquad</div><div id='commit'> Commit Name: 6e2decb33e025d0a819856edad92436fa1ecb5da</div><div id='time'> Time: 2022-03-14</div><div id='author'> Author: ga84muv@mytum.de</div><div id='file'> File Name: torchquad/tests/gradient_test.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: _calculate_gradient(4)</div><div id='n_method'> N Method Name: _calculate_gradient(5)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: torchquad/tests/gradient_test.py</div><div id='n_file'> N File Name: torchquad/tests/gradient_test.py</div><div id='m_start'> M Start Line: 42</div><div id='m_end'> M End Line: 110</div><div id='n_start'> N Start Line: 72</div><div id='n_end'> N End Line: 113</div><BR>