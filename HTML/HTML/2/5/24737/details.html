<html><h3>Pattern ID :24737
</h3><img src='76605414.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                aux_in = torch.empty((global_graph_out.size()[0],
                                      self.polyline_vec_shape)
                                     ).to(self.device)
                aux_gt<a id="change"> = </a><a id="change">torch.empty((global_graph_out.size()[0],
                                      self.polyline_vec_shape)
                                     ).to(</a>self.device<a id="change">)</a>
                for i, idx in enumerate(mask_polyline_indices):
                    aux_in[i] = global_graph_out[i, idx].squeeze(0)
                    aux_gt[i] = x[i, idx].squeeze(0)
                aux_out = self.aux_mlp(aux_in)</code></pre><h3>After Change</h3><pre><code class='java'>
                return pred, aux_out, aux_gt
            else:
                global_graph_out = self.global_graph(x, valid_lens)
                pred<a id="change"> = </a>self.traj_pred_mlp(<a id="change">global_graph_out[:, [0]].squeeze(1</a><a id="change">)</a>)

                return pred, None, None
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/henry1iu/tnt-trajectory-predition/commit/d5edc8d904cf69f92ff3c5f3acdfeb64c820ccca#diff-30a78fb4a0ae3bce4bc75278f5050fe453264ac4857acda73396888cdc4f7b0cL205' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 76605414</div><div id='project'> Project Name: henry1iu/tnt-trajectory-predition</div><div id='commit'> Commit Name: d5edc8d904cf69f92ff3c5f3acdfeb64c820ccca</div><div id='time'> Time: 2021-01-21</div><div id='author'> Author: jb@LIUs-MacBook-Pro.local</div><div id='file'> File Name: core/model/vectornet.py</div><div id='m_class'> M Class Name: OriginalVectorNet</div><div id='n_method'> N Class Name: OriginalVectorNet</div><div id='m_method'> M Method Name: forward(2)</div><div id='n_method'> N Method Name: forward(2)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: core/model/vectornet.py</div><div id='n_file'> N File Name: core/model/vectornet.py</div><div id='m_start'> M Start Line: 213</div><div id='m_end'> M End Line: 242</div><div id='n_start'> N Start Line: 205</div><div id='n_end'> N End Line: 237</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        tgt_in = torch.zeros(btz,1, dtype=torch.long).fill_(self.sos_id).to(device)
        for step in range(self.max_len):
            &#47&#47tgt_mask = target_mask(tgt_in, ignore_id=self.pad_id).to(tgt.device).unsqueeze(-3)
            tgt_mask = <a id="change">subsequent_mask(step+1).to(</a>tgt.device<a id="change">)</a>.unsqueeze(0)
            preds = self.decoder(tgt_in, tgt_mask, enc_out, enc_mask)
            &#47&#47preds[:,step,:] = pred.squeeze(-2)
            y_hat = preds.max(-1)[1]
            &#47&#47print(y_hat)
            &#47&#47print(y_hat)
            tgt_in = torch.cat((tgt_in,y_hat[:,step].unsqueeze(1)), dim=1)
            &#47&#47y_hats[:,step] = y_hat.squeeze(dim=-1)
            &#47&#47y_hats[:,step] = y_hat[:,step]
        y_hats<a id="change"> = </a>tgt_in[:,1:]
        if tgt is None:
            for testing
            golds = None</code></pre><h3>After Change</h3><pre><code class='java'>
            &#47&#47tgt_mask = subsequent_mask(step+1).to(tgt.device).unsqueeze(0)
            tgt_mask = None
            pred = self.decoder(tgt_in, tgt_mask, enc_out, enc_mask)
            preds[:,step,:]<a id="change"> = </a><a id="change">pred.squeeze(-2</a><a id="change">)</a>
            y_hat = pred.max(-1)[1]
            &#47&#47print(y_hat)
            tgt_in = y_hat
            &#47&#47tgt_in = torch.cat((tgt_in,y_hat[:,step].unsqueeze(1)), dim=1)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/qute012/kosr/commit/e19438c9d4d6bd6af0fa84e9fd93a20e2cf2f828#diff-d85a2398855f69db5c8b138eb078442c2f5f0c9443e7ce97f911e4d1b826316bL73' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 76605415</div><div id='project'> Project Name: qute012/kosr</div><div id='commit'> Commit Name: e19438c9d4d6bd6af0fa84e9fd93a20e2cf2f828</div><div id='time'> Time: 2021-02-03</div><div id='author'> Author: ejrwls012@gmail.com</div><div id='file'> File Name: kosr/model/transformer/model.py</div><div id='m_class'> M Class Name: Transformer</div><div id='n_method'> N Class Name: Transformer</div><div id='m_method'> M Method Name: greedy_search(4)</div><div id='n_method'> N Method Name: greedy_search(4)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: kosr/model/transformer/model.py</div><div id='n_file'> N File Name: kosr/model/transformer/model.py</div><div id='m_start'> M Start Line: 86</div><div id='m_end'> M End Line: 98</div><div id='n_start'> N Start Line: 85</div><div id='n_end'> N End Line: 99</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if self._use_dB_normalization:
            audio_segment.normalize(target_db=self._target_dB)
        &#47&#47 获取音频特征
        samples<a id="change"> = </a><a id="change">audio_segment.to(</a>&quotint16&quot<a id="change">)</a>
        waveform = torch.from_numpy(np.expand_dims(samples, 0)).float()
        if self._feature_method == &quotspectrogram&quot:
            &#47&#47 计算声谱图
            feature = spectrogram(waveform=waveform,</code></pre><h3>After Change</h3><pre><code class='java'>
            audio_segment.normalize(target_db=self._target_dB)
        &#47&#47 获取音频特征
        waveform = torch.from_numpy(np.expand_dims(audio_segment.samples, 0)).float()
        feature<a id="change"> = </a><a id="change">self.feat_fun(waveform).squeeze(0</a><a id="change">)</a>.transpose(1, 0).numpy()
        &#47&#47 归一化
        mean = np.mean(feature, 1, keepdims=True)
        std = np.std(feature, 1, keepdims=True)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/yeyupiaoling/audioclassification-pytorch/commit/f9a39f29e647cb3c02b8bb832a8d66c8655e4b1e#diff-16d41d5a471aa7cc4fe1b2a36c807558d42d547e1de4cd47ce61937322983e62L33' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 76605416</div><div id='project'> Project Name: yeyupiaoling/audioclassification-pytorch</div><div id='commit'> Commit Name: f9a39f29e647cb3c02b8bb832a8d66c8655e4b1e</div><div id='time'> Time: 2022-12-06</div><div id='author'> Author: yeyupiaoling@foxmail.com</div><div id='file'> File Name: macls/data_utils/featurizer/audio_featurizer.py</div><div id='m_class'> M Class Name: AudioFeaturizer</div><div id='n_method'> N Class Name: AudioFeaturizer</div><div id='m_method'> M Method Name: featurize(2)</div><div id='n_method'> N Method Name: featurize(2)</div><div id='m_parent_class'> M Parent Class: object</div><div id='n_parent_class'> N Parent Class: object</div><div id='m_file'> M File Name: macls/data_utils/featurizer/audio_featurizer.py</div><div id='n_file'> N File Name: macls/data_utils/featurizer/audio_featurizer.py</div><div id='m_start'> M Start Line: 48</div><div id='m_end'> M End Line: 66</div><div id='n_start'> N Start Line: 57</div><div id='n_end'> N End Line: 58</div><BR>