<html><h3>Pattern ID :8697
</h3><img src='32364847.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    
    df_list = create_df_list(df)
    if local_modeling:
        df_train_list<a id="change"> = </a><a id="change">list()</a>
        df_val_list = list()
        for df in df_list:
            df_train, df_val = _split_df(df, n_lags, n_forecasts, valid_p, inputs_overbleed)
            df_train_list.append(df_train)
            df_val_list.append(df_val)
        df_train, df_val = df_train_list<a id="change">, df_val_list</a>
    else:
        if len(df_list) == 1:
            df_train, df_val = _split_df(df_list[0], n_lags, n_forecasts, valid_p, inputs_overbleed)
        else:</code></pre><h3>After Change</h3><pre><code class='java'>
    if isinstance(df, pd.DataFrame):
        df_is_dict = False
        df_dict = {"__df__": df}
    elif <a id="change"></a>isinstance(df, dict):
        df_is_dict<a id="change"> = </a>True
        df_dict = df
    else:
        <a id="change">raise </a><a id="change">ValueError("Please insert valid df type (i.e. pd.DataFrame, dict)"</a><a id="change">)</a>
    df_train = {}
    df_val = {}
    if local_split:
        for key in df_dict:</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 7</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/ourownstory/neural_prophet/commit/6619741f934957dff2a7fa4ff66620772d41471f#diff-cb8ae2d50e5d5d245ed6fcc8cadf2baf7294fa9ac5c63e819fbfe34f0e4c2552L532' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 32364847</div><div id='project'> Project Name: ourownstory/neural_prophet</div><div id='commit'> Commit Name: 6619741f934957dff2a7fa4ff66620772d41471f</div><div id='time'> Time: 2022-02-14</div><div id='author'> Author: ourownstory@users.noreply.github.com</div><div id='file'> File Name: neuralprophet/df_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: split_df(6)</div><div id='n_method'> N Method Name: split_df(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: neuralprophet/df_utils.py</div><div id='n_file'> N File Name: neuralprophet/df_utils.py</div><div id='m_start'> M Start Line: 532</div><div id='m_end'> M End Line: 548</div><div id='n_start'> N Start Line: 573</div><div id='n_end'> N End Line: 598</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 TODO: filter inputs  by valid name
        &#47&#47  inputs = {k: v for k, v in inputs.items() if k in self.input_names}
        &#47&#47 temporary fix: reorder by expected QA input order
        inps<a id="change"> = </a><a id="change">list(</a>inputs.values()<a id="change">)</a>
        inps[1], inps[2] = inps[2]<a id="change">, inps[1]</a>

        if self.engine_type == ORT_ENGINE:
            return self.model.run(None, dict(zip(self.input_names, inps)))
            &#47&#47 return self.model.run(None, dict(zip(self.input_names, inputs.values())))</code></pre><h3>After Change</h3><pre><code class='java'>
        self._forward(inputs)

    def _forward(self, inputs):
        <a id="change">if </a>not all(name in inputs for name in self.input_names):
            <a id="change">raise </a><a id="change">ValueError(
                f"pipeline expected arrays with names {self.input_names}, received "
                f"inputs: {list(inputs.keys())}"</a><a id="change">
            )</a>

        if self.engine_type == ORT_ENGINE:
            inputs<a id="change"> = </a>{k: v for k, v in inputs.items() if k in self.input_names}
            return self.model.run(None, inputs)
        elif self.engine_type == DEEPSPARSE_ENGINE:
            return self.model.run([inputs[name] for name in self.input_names])</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/neuralmagic/deepsparse/commit/845837b0c5f2ee40d4c8a9d1950ce47b7dafadd6#diff-d37b8da69f82ac62e9495d51de793dd6d36eba477b662e83a2231a0f89d327b9L249' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 32364859</div><div id='project'> Project Name: neuralmagic/deepsparse</div><div id='commit'> Commit Name: 845837b0c5f2ee40d4c8a9d1950ce47b7dafadd6</div><div id='time'> Time: 2021-07-19</div><div id='author'> Author: bfineran@users.noreply.github.com</div><div id='file'> File Name: examples/huggingface-transformers/pipelines.py</div><div id='m_class'> M Class Name: Pipeline</div><div id='n_method'> N Class Name: Pipeline</div><div id='m_method'> M Method Name: _forward(2)</div><div id='n_method'> N Method Name: _forward(2)</div><div id='m_parent_class'> M Parent Class: _ScikitCompat</div><div id='n_parent_class'> N Parent Class: _ScikitCompat</div><div id='m_file'> M File Name: examples/huggingface-transformers/pipelines.py</div><div id='n_file'> N File Name: examples/huggingface-transformers/pipelines.py</div><div id='m_start'> M Start Line: 254</div><div id='m_end'> M End Line: 261</div><div id='n_start'> N Start Line: 250</div><div id='n_end'> N End Line: 260</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        raise ValueError("Please, insert valid df type (pd.DataFrame)")

    &#47&#47 list of IDs
    id_list<a id="change"> = </a><a id="change">list(</a>new_df.ID.unique()<a id="change">)</a>

    return new_df<a id="change">, received_ID_col, received_single_time_series, id_list</a>


def return_df_in_original_format(df, received_ID_col=False, received_single_time_series=True):
    Return dataframe in the original format.</code></pre><h3>After Change</h3><pre><code class='java'>
        list
            list of IDs
    
    <a id="change">if </a>not isinstance(df, pd.DataFrame):
        <a id="change">raise </a><a id="change">ValueError("Provided DataFrame (df) must be of pd.DataFrame type."</a><a id="change">)</a>

    &#47&#47 Create a copy of the dataframe
    df_copy = df.copy(deep=True)

    df_has_id_column = "ID" in df_copy.columns

    &#47&#47 If there is no ID column, then add one with a single value
    if not df_has_id_column:
        log.debug("Provided DataFrame (df) contains a single time series.")
        df_copy["ID"]<a id="change"> = </a>"__df__"
        return df_copy, df_has_id_column, True, ["__df__"]

    &#47&#47 Create a list of unique ID values</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ourownstory/neural_prophet/commit/ddcb2d23c702ca2583d530c67b4ba2fe673cedd0#diff-cb8ae2d50e5d5d245ed6fcc8cadf2baf7294fa9ac5c63e819fbfe34f0e4c2552L25' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 32364852</div><div id='project'> Project Name: ourownstory/neural_prophet</div><div id='commit'> Commit Name: ddcb2d23c702ca2583d530c67b4ba2fe673cedd0</div><div id='time'> Time: 2023-03-01</div><div id='author'> Author: noxan@users.noreply.github.com</div><div id='file'> File Name: neuralprophet/df_utils.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: prep_or_copy_df(1)</div><div id='n_method'> N Method Name: prep_or_copy_df(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: neuralprophet/df_utils.py</div><div id='n_file'> N File Name: neuralprophet/df_utils.py</div><div id='m_start'> M Start Line: 25</div><div id='m_end'> M End Line: 63</div><div id='n_start'> N Start Line: 25</div><div id='n_end'> N End Line: 64</div><BR>