<html><h3>Pattern ID :11785
</h3><img src='39618252.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        )
        binary = binary if binary is not None else True
    else:
        <a id="change">raise </a>TypeError()

    filepath = w2v_prefix + "%s_%s" % (method, embedding_dim)
    if binary is True:</code></pre><h3>After Change</h3><pre><code class='java'>
            **_train_params
        )
        binary = binary if binary is not None else True
    elif <a id="change">method == "d2v"</a>:
        if train_params is not None:
            _train_params.update(train_params)
        docs = [TaggedDocument(doc, [i]) <a id="change">for</a> i, doc in <a id="change">enumerate(</a>items<a id="change">)</a>]
        model<a id="change"> = </a>gensim.models.Doc2Vec(
            docs, **_train_params
        )
        binary = binary if binary is not None else True
    else:
        <a id="change">raise ValueError(</a>"Unknown method: %s" % method<a id="change">)</a>

    filepath = w2v_prefix + "%s_%s" % (method, embedding_dim)
    if binary is True:
        filepath += ".bin"</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 8</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/bigdata-ustc/edunlp/commit/ba2b787742f269d7e1bad1d790e8f51edcab2c54#diff-01bba11381fdf85a117fc6992e9d85ef0d1c94e7f544b43956381616885f198bL70' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 39618252</div><div id='project'> Project Name: bigdata-ustc/edunlp</div><div id='commit'> Commit Name: ba2b787742f269d7e1bad1d790e8f51edcab2c54</div><div id='time'> Time: 2021-05-31</div><div id='author'> Author: tongsw@mail.ustc.edu.cn</div><div id='file'> File Name: EduNLP/Pretrain/gensim_vec.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: train_vector(6)</div><div id='n_method'> N Method Name: train_vector(6)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: EduNLP/Pretrain/gensim_vec.py</div><div id='n_file'> N File Name: EduNLP/Pretrain/gensim_vec.py</div><div id='m_start'> M Start Line: 70</div><div id='m_end'> M End Line: 79</div><div id='n_start'> N Start Line: 101</div><div id='n_end'> N End Line: 142</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        elif domains is None:
            domains = domains_
        else:
            <a id="change">raise </a>ValueError("Unsupported type for variable domains")
        classes, class_to_idx = self._find_classes(os.path.join(self.root, domains[0]))
        for domain in domains:
            domain_path = os.path.join(self.root, domain)</code></pre><h3>After Change</h3><pre><code class='java'>
        classes, class_to_idx = self._find_classes(os.path.join(self.root, domains[0]))
        if type(sub_class_set) == list:
            for class_name in sub_class_set:
                <a id="change">if class_name not in classes</a>:
                    <a id="change">raise ValueError(</a>"Class %s not in the image directory" % class_name<a id="change">)</a>
            classes = sub_class_set
            class_to_idx<a id="change"> = </a>{class_name: i <a id="change">for</a> i, class_name in <a id="change">enumerate(</a>sub_class_set<a id="change">)</a>}
        &#47&#47 for domain in domains:
        &#47&#47     domain_path = os.path.join(self.root, domain)
        &#47&#47     classes_, class_to_idx_ = self._find_classes(domain_path)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/pykale/pykale/commit/de4af503430db630c2c535b949e5f6cf0397a147#diff-a4cd6d20f6604694596740bd23acc2a59689c523900352d1c73c0d971895e0ccL271' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 39618253</div><div id='project'> Project Name: pykale/pykale</div><div id='commit'> Commit Name: de4af503430db630c2c535b949e5f6cf0397a147</div><div id='time'> Time: 2021-07-29</div><div id='author'> Author: szhou20@sheffield.ac.uk</div><div id='file'> File Name: kale/loaddata/multi_domain.py</div><div id='m_class'> M Class Name: MultiDomainImageFolder</div><div id='n_method'> N Class Name: MultiDomainImageFolder</div><div id='m_method'> M Method Name: __init__(10)</div><div id='n_method'> N Method Name: __init__(9)</div><div id='m_parent_class'> M Parent Class: VisionDataset</div><div id='n_parent_class'> N Parent Class: VisionDataset</div><div id='m_file'> M File Name: kale/loaddata/multi_domain.py</div><div id='n_file'> N File Name: kale/loaddata/multi_domain.py</div><div id='m_start'> M Start Line: 283</div><div id='m_end'> M End Line: 299</div><div id='n_start'> N Start Line: 278</div><div id='n_end'> N End Line: 303</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                os.makedirs(self.savepath_dict[d])

    def train_one_epoch(self, **kwargs):
        <a id="change">raise </a>NotImplementedError

    def calc_val_loss(self, **kwargs):
        raise NotImplementedError</code></pre><h3>After Change</h3><pre><code class='java'>
                os.makedirs(self.savepath_dict[d])

    def train_one_epoch(self, data_loader, **kwargs):
        <a id="change">if self.model is None</a>:
            <a id="change">raise ValueError(</a>&quotmodel is not defined.&quot<a id="change">)</a>
        else:
            _metrics = [0] * len(self.metrics_names)
            for i, _batch in <a id="change">enumerate(</a>data_loader<a id="change">)</a>:
                timg = self._get_data_by_name(_batch, &quotimage&quot)
                self.optimizer.zero_grad()

                loss = self.calc_loss_one_batch(self.model(timg), timg, **kwargs)
                loss[0].backward()

                &#47&#47 Adjust learning weights
                self.optimizer.step()

                &#47&#47 Accumulate metrics
                _metrics = [m + l.item() for m, l in zip(_metrics, loss)]
            _metrics<a id="change"> = </a>[m / i <a id="change">for</a> m in _metrics]
            self.record_metrics(_metrics, phase=&quottrain&quot)

    def _get_data_by_name(self, data: dict, name: str):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/royerlab/cytoself/commit/d6114662473b57f7810ce92d8e438b14d2bf9e42#diff-523a645fa31e54102ea3d8c4549d9c4caee9ee4e75e32ac26e816f9dccd684fdL153' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 39618249</div><div id='project'> Project Name: royerlab/cytoself</div><div id='commit'> Commit Name: d6114662473b57f7810ce92d8e438b14d2bf9e42</div><div id='time'> Time: 2022-05-23</div><div id='author'> Author: liamiiliil@gmail.com</div><div id='file'> File Name: cytoself/trainer/basetrainer.py</div><div id='m_class'> M Class Name: BaseTrainer</div><div id='n_method'> N Class Name: BaseTrainer</div><div id='m_method'> M Method Name: train_one_epoch(2)</div><div id='n_method'> N Method Name: train_one_epoch(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: cytoself/trainer/basetrainer.py</div><div id='n_file'> N File Name: cytoself/trainer/basetrainer.py</div><div id='m_start'> M Start Line: 154</div><div id='m_end'> M End Line: 154</div><div id='n_start'> N Start Line: 182</div><div id='n_end'> N End Line: 202</div><BR>