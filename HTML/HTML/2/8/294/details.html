<html><h3>Pattern ID :294
</h3><img src='2108073.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            self.pool = SelectAdaptivePool2d(pool_type=global_pool)
            &#47&#47 NOTE when cl_norm_layer != norm_layer we could flatten here and use cl, but makes no performance diff
            self.norm = norm_layer(self.num_features)
            self.head = nn.Linear(self.num_features, num_classes)<a id="change"> if num_classes &gt; 0</a><a id="change"> else </a><a id="change">nn.Identity()</a>

        named_apply(partial(_init_weights, head_init_scale=head_init_scale), self)

    def get_classifier(self):</code></pre><h3>After Change</h3><pre><code class='java'>
        else:
            &#47&#47 pool -&gt; norm -&gt; fc, the default ConvNeXt ordering (pretrained FB weights)
            self.norm_pre = nn.Identity()
            self.head = <a id="change">nn.Sequential(</a>OrderedDict([
                (&quotglobal_pool&quot, SelectAdaptivePool2d(pool_type=global_pool)),
                (&quotnorm&quot, norm_layer(self.num_features)),
                (&quotflatten&quot, nn.Flatten(1) if global_pool else nn.Identity()),
                (&quotfc&quot, nn.Linear(self.num_features, num_classes)<a id="change"> if num_classes &gt; 0</a><a id="change"> else </a><a id="change">nn.Identity()</a>)
            ])<a id="change">)</a>

        named_apply(partial(_init_weights, head_init_scale=head_init_scale), self)

    def get_classifier(self):</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 7</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/feng-lab/pytorch-image-models/commit/b093dcb46dd2459b6e8af120ad71c9a2b11d6fcd#diff-d5b93269469bb7767f422d51d4683def9f69ea9e76a07dda75b2200878230bbbL194' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 2108073</div><div id='project'> Project Name: feng-lab/pytorch-image-models</div><div id='commit'> Commit Name: b093dcb46dd2459b6e8af120ad71c9a2b11d6fcd</div><div id='time'> Time: 2022-01-14</div><div id='author'> Author: rwightman@gmail.com</div><div id='file'> File Name: timm/models/convnext.py</div><div id='m_class'> M Class Name: ConvNeXt</div><div id='n_method'> N Class Name: ConvNeXt</div><div id='m_method'> M Method Name: __init__(15)</div><div id='n_method'> N Method Name: __init__(15)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: timm/models/convnext.py</div><div id='n_file'> N File Name: timm/models/convnext.py</div><div id='m_start'> M Start Line: 194</div><div id='m_end'> M End Line: 237</div><div id='n_start'> N Start Line: 220</div><div id='n_end'> N End Line: 233</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        for n_out, ksize, p in zip(num_filters, filter_size, pool_size):
            l += [ 
                nn.Conv1d(n_in, n_out, kernel_size=ksize, dilation=2**dilation, padding=2**dilation*(ksize//2)),
                nn.MaxPool1d(p, stride=1, padding=p//2)<a id="change"> if p &gt; 1</a><a id="change"> else </a><a id="change">nn.Identity()</a>,
                nn.GroupNorm(1, n_out), &#47&#47 same as LayerNorm?
                nn.CELU(), 
                nn.Dropout(p=dropout_rate) ]</code></pre><h3>After Change</h3><pre><code class='java'>
        self.net = []
        for n_out, ksize, p in zip(num_filters, filter_size, pool_size):
            self.net.append( 
                <a id="change">nn.Sequential( 
                    </a>nn.Conv1d(n_in, n_out, kernel_size=ksize, dilation=2**dilation, padding=2**dilation*(ksize//2)),
                    nn.MaxPool1d(p, stride=1, padding=p//2)<a id="change"> if p &gt; 1</a><a id="change"> else </a><a id="change">nn.Identity()</a>,
                    nn.GroupNorm(1, n_out), &#47&#47 same as LayerNorm?
                    nn.CELU(), 
                    nn.Dropout(p=dropout_rate)<a id="change"> )</a> )
            n_in = n_out

    def forward(self, x): &#47&#47 (B=1, 4, N)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/keio-bioinformatics/mxfold2/commit/ebb758a037e14c87b2dadc3ad7dbac32f387a668#diff-c9a664b6ab969299efeb624a60d9f43a2f26d097fa73e50c22da2a6220cbabfaL7' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 2108074</div><div id='project'> Project Name: keio-bioinformatics/mxfold2</div><div id='commit'> Commit Name: ebb758a037e14c87b2dadc3ad7dbac32f387a668</div><div id='time'> Time: 2019-12-03</div><div id='author'> Author: satoken@bio.keio.ac.jp</div><div id='file'> File Name: dnnfold/fold/layers.py</div><div id='m_class'> M Class Name: CNNLayer</div><div id='n_method'> N Class Name: CNNLayer</div><div id='m_method'> M Method Name: __init__(8)</div><div id='n_method'> N Method Name: __init__(7)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: dnnfold/fold/layers.py</div><div id='n_file'> N File Name: dnnfold/fold/layers.py</div><div id='m_start'> M Start Line: 9</div><div id='m_end'> M End Line: 18</div><div id='n_start'> N Start Line: 7</div><div id='n_end'> N End Line: 18</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        else:
            &#47&#47 pool -&gt; norm -&gt; fc
            self.pool = SelectAdaptivePool2d(pool_type=global_pool)
            self.head = nn.Linear(self.num_features, num_classes)<a id="change"> if num_classes &gt; 0</a><a id="change"> else </a><a id="change">nn.Identity()</a>

    def forward_features(self, x):
        x = self.stem(x)
        x = self.stages(x)</code></pre><h3>After Change</h3><pre><code class='java'>
                self.num_features, num_classes, pool_type=global_pool, drop_rate=self.drop_rate)
        else:
            &#47&#47 pool -&gt; norm -&gt; fc
            self.head = <a id="change">nn.Sequential(</a>OrderedDict([
                (&quotglobal_pool&quot, SelectAdaptivePool2d(pool_type=global_pool)),
                (&quotnorm&quot, self.head.norm),
                (&quotflatten&quot, nn.Flatten(1) if global_pool else nn.Identity()),
                (&quotdrop&quot, nn.Dropout(self.drop_rate)),
                (&quotfc&quot, nn.Linear(self.num_features, num_classes)<a id="change"> if num_classes &gt; 0</a><a id="change"> else </a><a id="change">nn.Identity()</a>)
            ])<a id="change">)</a>

    def forward_features(self, x):
        x = self.stem(x)
        x = self.stages(x)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/feng-lab/pytorch-image-models/commit/b093dcb46dd2459b6e8af120ad71c9a2b11d6fcd#diff-d5b93269469bb7767f422d51d4683def9f69ea9e76a07dda75b2200878230bbbL244' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 2108076</div><div id='project'> Project Name: feng-lab/pytorch-image-models</div><div id='commit'> Commit Name: b093dcb46dd2459b6e8af120ad71c9a2b11d6fcd</div><div id='time'> Time: 2022-01-14</div><div id='author'> Author: rwightman@gmail.com</div><div id='file'> File Name: timm/models/convnext.py</div><div id='m_class'> M Class Name: ConvNeXt</div><div id='n_method'> N Class Name: ConvNeXt</div><div id='m_method'> M Method Name: reset_classifier(3)</div><div id='n_method'> N Method Name: reset_classifier(3)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: timm/models/convnext.py</div><div id='n_file'> N File Name: timm/models/convnext.py</div><div id='m_start'> M Start Line: 245</div><div id='m_end'> M End Line: 252</div><div id='n_start'> N Start Line: 241</div><div id='n_end'> N End Line: 253</div><BR>