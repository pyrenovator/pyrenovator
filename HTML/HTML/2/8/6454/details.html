<html><h3>Pattern ID :6454
</h3><img src='22357829.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

  def predict_minibatch(self, inputs):
    Predict on a single minibatch of examples.
    model_inputs<a id="change"> = </a><a id="change">[self.preprocess(ex) for ex in inputs]</a>
    outputs = self.model.predict_minibatch(model_inputs)
    return <a id="change">[utils.remap_dict(mo, self.FIELD_RENAMES) for mo in outputs]</a>

  def input_spec(self):
    spec = lit_types.remap_spec(self.model.input_spec(), self.FIELD_RENAMES)
    spec["source_language"] = lit_types.CategoryLabel()</code></pre><h3>After Change</h3><pre><code class='java'>
    raise NotImplementedError("Use predict() instead.")

  def predict_minibatch(self, inputs):
    <a id="change">raise </a><a id="change">NotImplementedError("Use predict() instead."</a><a id="change">)</a>

  def predict(self, inputs):
    Predict on a single minibatch of examples.
    model_inputs = (self.preprocess(ex) for ex in inputs)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 7</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/pair-code/lit/commit/e8c43368b742001e02f0181752f735baea98f0aa#diff-f5c2fd94b417b4f22c0b6141a289197ab2dadaac6cc12cfaa239beb801277510L363' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 22357829</div><div id='project'> Project Name: pair-code/lit</div><div id='commit'> Commit Name: e8c43368b742001e02f0181752f735baea98f0aa</div><div id='time'> Time: 2021-06-10</div><div id='author'> Author: iftenney@google.com</div><div id='file'> File Name: lit_nlp/examples/models/t5.py</div><div id='m_class'> M Class Name: TranslationWrapper</div><div id='n_method'> N Class Name: TranslationWrapper</div><div id='m_method'> M Method Name: predict_minibatch(2)</div><div id='n_method'> N Method Name: predict_minibatch(2)</div><div id='m_parent_class'> M Parent Class: lit_model.Model</div><div id='n_parent_class'> N Parent Class: lit_model.Model</div><div id='m_file'> M File Name: lit_nlp/examples/models/t5.py</div><div id='n_file'> N File Name: lit_nlp/examples/models/t5.py</div><div id='m_start'> M Start Line: 363</div><div id='m_end'> M End Line: 365</div><div id='n_start'> N Start Line: 363</div><div id='n_end'> N End Line: 363</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                    used_by_send_depth_diff = [my_depth - x for x in used_by_depth]
                else:
                    used_by = tgt[&quotcreated_by&quot]
                    used_by_depth<a id="change"> = </a><a id="change">[stage_to_depth[x] for x in used_by]</a>
                    used_by_send_depth_diff = <a id="change">[x - my_depth for x in used_by_depth]</a>

                if used_by_send_depth_diff:
                    stage_max_send_depth = max(used_by_send_depth_diff)
                else:</code></pre><h3>After Change</h3><pre><code class='java'>
                    created_by = tgt[&quotcreated_by&quot]
                    assert isinstance(created_by, int)
                    if created_by == -1:
                        <a id="change">raise </a><a id="change">NotImplementedError(
                            f"we assume model_inputs do not require grad. But got: {name}, {stage_id}"</a><a id="change">)</a>
                    else:
                        created_by_depth = stage_to_depth[created_by]

                    used_by_send_depth_diff = [created_by_depth - my_depth]</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/saareliad/ftpipe/commit/72f9f4e90ae31e899648c9f7699f662adb759088#diff-2c2f82df1e95f8a11f8f9755b364584010639951491f67da6df89869b8c45918L186' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 22357828</div><div id='project'> Project Name: saareliad/ftpipe</div><div id='commit'> Commit Name: 72f9f4e90ae31e899648c9f7699f662adb759088</div><div id='time'> Time: 2020-09-19</div><div id='author'> Author: saareliad@campus.technion.ac.il</div><div id='file'> File Name: models/simple_partitioning_config.py</div><div id='m_class'> M Class Name: PipelineConfig</div><div id='n_method'> N Class Name: PipelineConfig</div><div id='m_method'> M Method Name: max_send_depth_dict(2)</div><div id='n_method'> N Method Name: max_send_depth_dict(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: models/simple_partitioning_config.py</div><div id='n_file'> N File Name: models/simple_partitioning_config.py</div><div id='m_start'> M Start Line: 187</div><div id='m_end'> M End Line: 212</div><div id='n_start'> N Start Line: 187</div><div id='n_end'> N End Line: 219</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

  def predict_minibatch(self, inputs):
    Predict on a single minibatch of examples.
    model_inputs = <a id="change">[self.preprocess(ex) for ex in inputs]</a>
    outputs<a id="change"> = </a>self.model.predict_minibatch(model_inputs)
    outputs = <a id="change">[utils.remap_dict(mo, self.FIELD_RENAMES) for mo in outputs]</a>

    &#47&#47 TODO(gehrmann): temp solution to get ROUGE scores in data table.
    for ex, mo in zip(inputs, outputs):
      score = self._scorer.score(</code></pre><h3>After Change</h3><pre><code class='java'>
    raise NotImplementedError("Use predict() instead.")

  def predict_minibatch(self, inputs):
    <a id="change">raise </a><a id="change">NotImplementedError("Use predict() instead."</a><a id="change">)</a>

  def predict(self, inputs):
    Predict on a single minibatch of examples.
    inputs = list(inputs)  &#47&#47 needs to be referenced below, so keep full list</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/pair-code/lit/commit/e8c43368b742001e02f0181752f735baea98f0aa#diff-f5c2fd94b417b4f22c0b6141a289197ab2dadaac6cc12cfaa239beb801277510L412' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 22357830</div><div id='project'> Project Name: pair-code/lit</div><div id='commit'> Commit Name: e8c43368b742001e02f0181752f735baea98f0aa</div><div id='time'> Time: 2021-06-10</div><div id='author'> Author: iftenney@google.com</div><div id='file'> File Name: lit_nlp/examples/models/t5.py</div><div id='m_class'> M Class Name: SummarizationWrapper</div><div id='n_method'> N Class Name: SummarizationWrapper</div><div id='m_method'> M Method Name: predict_minibatch(2)</div><div id='n_method'> N Method Name: predict_minibatch(2)</div><div id='m_parent_class'> M Parent Class: lit_model.Model</div><div id='n_parent_class'> N Parent Class: lit_model.Model</div><div id='m_file'> M File Name: lit_nlp/examples/models/t5.py</div><div id='n_file'> N File Name: lit_nlp/examples/models/t5.py</div><div id='m_start'> M Start Line: 414</div><div id='m_end'> M End Line: 424</div><div id='n_start'> N Start Line: 418</div><div id='n_end'> N End Line: 418</div><BR>