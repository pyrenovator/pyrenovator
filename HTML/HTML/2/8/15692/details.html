<html><h3>Pattern ID :15692
</h3><img src='53035112.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
def read_data_files_individual(set, args):
    texts = []
    summaries = []
    <a id="change">for </a>lang in ["en"]<a id="change">:
        </a>lang_path = args.data_folder + "{}/".format(lang)
        lang_set_text_path = lang_path + set + "/" + "text/"
        lang_set_summary_path<a id="change"> = </a>lang_path<a id="change"> + set + </a>"/" + "summary/"
        n_docs = len(os.listdir(lang_set_text_path))
        print("For lang {}, there are {} {} documents".format(lang, n_docs, set))
        for i in tqdm(range(n_docs)):</code></pre><h3>After Change</h3><pre><code class='java'>
def read_data_files_individual(set, args):
    texts = []
    summaries = []
    set_text_path = args<a id="change">.data_folder + set + </a>"/" + "text/"
    set_summary_path = args.data_folder + set + "/" + "summary/"
    n_docs = len(os.listdir(set_text_path))
    <a id="change">print(</a><a id="change">"There are {} {} documents".format(</a>n_docs, set<a id="change">))</a>
    for i in tqdm(range(n_docs)):
        text_path_i = set_text_path + "{}_text_{}.txt".format(set, i)
        text_i = "".join(open(text_path_i, "r").readlines())
        texts.append(text_i)</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/ravoxsg/summareranker-acl-22/commit/cb5e8b0f3d68e892109ff4b0cd12e94ffd203254#diff-890a801df89f7b867a95cb1466907a23b401d937044d2d2e176392e2496ca195L22' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 53035112</div><div id='project'> Project Name: ravoxsg/summareranker-acl-22</div><div id='commit'> Commit Name: cb5e8b0f3d68e892109ff4b0cd12e94ffd203254</div><div id='time'> Time: 2022-05-20</div><div id='author'> Author: mathieu.ravaut@gmail.com</div><div id='file'> File Name: src/common/data.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: read_data_files_individual(2)</div><div id='n_method'> N Method Name: read_data_files_individual(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/common/data.py</div><div id='n_file'> N File Name: src/common/data.py</div><div id='m_start'> M Start Line: 22</div><div id='m_end'> M End Line: 36</div><div id='n_start'> N Start Line: 22</div><div id='n_end'> N End Line: 35</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
def read_data_files_individual(set, args):
    texts = []
    summaries = []
    <a id="change">for lang</a> in ["en"]<a id="change">:
        </a>lang_path = args.data_folder + "{}/".format(lang)
        lang_set_text_path = lang_path + set + "/" + "text/"
        lang_set_summary_path<a id="change"> = </a>lang_path<a id="change"> + set + </a>"/" + "summary/"
        n_docs = len(os.listdir(lang_set_text_path))
        print("For lang {}, there are {} {} documents".format(lang, n_docs, set))
        for i in tqdm(range(n_docs)):</code></pre><h3>After Change</h3><pre><code class='java'>
def read_data_files_individual(set, args):
    texts = []
    summaries = []
    set_text_path = args.data_folder + set +<a id="change"> "/" + </a>"text/"
    set_summary_path = args.data_folder + set + "/" + "summary/"
    n_docs = len(os.listdir(set_text_path))
    <a id="change">print(</a><a id="change">"There are {} {} documents".format(</a>n_docs, set<a id="change">))</a>
    for i in tqdm(range(n_docs)):
        text_path_i = set_text_path + "{}_text_{}.txt".format(set, i)
        text_i = "".join(open(text_path_i, "r").readlines())
        texts.append(text_i)</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/ravoxsg/summareranker-acl-22/commit/cb5e8b0f3d68e892109ff4b0cd12e94ffd203254#diff-890a801df89f7b867a95cb1466907a23b401d937044d2d2e176392e2496ca195L19' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 53035115</div><div id='project'> Project Name: ravoxsg/summareranker-acl-22</div><div id='commit'> Commit Name: cb5e8b0f3d68e892109ff4b0cd12e94ffd203254</div><div id='time'> Time: 2022-05-20</div><div id='author'> Author: mathieu.ravaut@gmail.com</div><div id='file'> File Name: src/common/data.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: read_data_files_individual(2)</div><div id='n_method'> N Method Name: read_data_files_individual(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/common/data.py</div><div id='n_file'> N File Name: src/common/data.py</div><div id='m_start'> M Start Line: 22</div><div id='m_end'> M End Line: 36</div><div id='n_start'> N Start Line: 22</div><div id='n_end'> N End Line: 35</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        grads = [utils.vectorize_weight(grad) for grad in grad_list]
        cs = np.zeros((n_clients, n_clients))
        for i in range(n_clients):
            <a id="change">for j</a> in range(n_clients)<a id="change">:
                </a>cs[i][j]<a id="change"> = </a>1<a id="change"> - </a>spatial.distance.cosine(
                    grads[i].tolist(), grads[j].tolist()
                )
        cs -= np.eye(n_clients)</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47         )
        &#47&#47         print("cosine end. cs[{}][{}] = {}".format(i, j, cs[i][j]))
        &#47&#47 cs -= np.eye(n_clients)
        cs = smp.cosine_similarity(feature_vec_list)<a id="change"> - </a>np.eye(n_clients)
        print("cs = {}".format(cs))
        maxcs = np.max(cs, axis=1)
        print("maxcs = {}".format(maxcs))
        &#47&#47 pardoning
        for i in range(n_clients):
            for j in range(n_clients):
                if i != j and maxcs[i] &lt; maxcs[j]:
                    cs[i][j] = cs[i][j] * maxcs[i] / maxcs[j]
        <a id="change">print(</a><a id="change">"cs = {}".format(</a>cs<a id="change">))</a>
        alpha = 1 - (np.max(cs, axis=1))
        print("alpha = {}".format(cs))
        alpha[alpha &gt; 1] = 1
        alpha[alpha &lt; 0] = 0</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/fedml-ai/fedml/commit/7a9a87eb07ec4ad218af6a18663cb93b061d735a#diff-cb204bfb0c88c24d3e499caee204b4c6a0211a1555fed09b011e6bafa335da86L66' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 53035195</div><div id='project'> Project Name: fedml-ai/fedml</div><div id='commit'> Commit Name: 7a9a87eb07ec4ad218af6a18663cb93b061d735a</div><div id='time'> Time: 2022-09-22</div><div id='author'> Author: chaoyanghe.com@gmail.com</div><div id='file'> File Name: python/fedml/core/security/defense/foolsgold_defense.py</div><div id='m_class'> M Class Name: FoolsGoldDefense</div><div id='n_method'> N Class Name: FoolsGoldDefense</div><div id='m_method'> M Method Name: fools_gold_score(1)</div><div id='n_method'> N Method Name: fools_gold_score(1)</div><div id='m_parent_class'> M Parent Class: BaseDefenseMethod</div><div id='n_parent_class'> N Parent Class: BaseDefenseMethod</div><div id='m_file'> M File Name: python/fedml/core/security/defense/foolsgold_defense.py</div><div id='n_file'> N File Name: python/fedml/core/security/defense/foolsgold_defense.py</div><div id='m_start'> M Start Line: 67</div><div id='m_end'> M End Line: 75</div><div id='n_start'> N Start Line: 70</div><div id='n_end'> N End Line: 99</div><BR>