<html><h3>Pattern ID :24597
</h3><img src='76353989.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

def compute_spearmanr_metrics(p: EvalPrediction):
    print(p.label_ids.shape, p.predictions.shape)
    <a id="change">return</a>{
        "spearmanr": spearmanr(p.label_ids, p.predictions)
    }
</code></pre><h3>After Change</h3><pre><code class='java'>

def compute_spearmanr_metrics(task_name, preds, labels):
    &#47&#47 print(p.label_ids.shape, p.predictions.shape)
    <a id="change">if task_name == &quotfluorescence&quot</a><a id="change"> or task_name == &quotstability&quot</a>:
        <a id="change">return</a>{
            "spearmanr": spearmanr(labels, preds)
        }
    else:
        <a id="change">raise </a>KeyError(task_name)


def simple_accuracy(preds, labels):</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 7</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/zjunlp/ontoprotein/commit/74e46a8a86bce07c089f29c0ac7c55a76e1f5230#diff-152fc3b93f7d46d3f68cfbe4f43a843c822fa7d0cc61be5ce35f01abb159b68dL35' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 76353989</div><div id='project'> Project Name: zjunlp/ontoprotein</div><div id='commit'> Commit Name: 74e46a8a86bce07c089f29c0ac7c55a76e1f5230</div><div id='time'> Time: 2022-06-07</div><div id='author'> Author: 50662014+cheng-siyuan@users.noreply.github.com</div><div id='file'> File Name: src/benchmark/metrics.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: compute_spearmanr_metrics(3)</div><div id='n_method'> N Method Name: compute_spearmanr_metrics(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/benchmark/metrics.py</div><div id='n_file'> N File Name: src/benchmark/metrics.py</div><div id='m_start'> M Start Line: 35</div><div id='m_end'> M End Line: 39</div><div id='n_start'> N Start Line: 38</div><div id='n_end'> N End Line: 47</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

def compute_spearmanr_metrics(p: EvalPrediction):
    print(p.label_ids.shape, p.predictions.shape)
    <a id="change">return</a>{
        "spearmanr": spearmanr(p.label_ids, p.predictions)
    }
</code></pre><h3>After Change</h3><pre><code class='java'>

def compute_spearmanr_metrics(task_name, preds, labels):
    &#47&#47 print(p.label_ids.shape, p.predictions.shape)
    <a id="change">if task_name == &quotfluorescence&quot</a><a id="change"> or task_name == &quotstability&quot</a>:
        <a id="change">return</a>{
            "spearmanr": spearmanr(labels, preds)
        }
    else:
        <a id="change">raise </a>KeyError(task_name)


def simple_accuracy(preds, labels):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/zjunlp/ontoprotein/commit/74e46a8a86bce07c089f29c0ac7c55a76e1f5230#diff-152fc3b93f7d46d3f68cfbe4f43a843c822fa7d0cc61be5ce35f01abb159b68dL35' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 76353977</div><div id='project'> Project Name: zjunlp/ontoprotein</div><div id='commit'> Commit Name: 74e46a8a86bce07c089f29c0ac7c55a76e1f5230</div><div id='time'> Time: 2022-06-07</div><div id='author'> Author: 50662014+cheng-siyuan@users.noreply.github.com</div><div id='file'> File Name: src/benchmark/metrics.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: compute_spearmanr_metrics(3)</div><div id='n_method'> N Method Name: compute_spearmanr_metrics(1)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/benchmark/metrics.py</div><div id='n_file'> N File Name: src/benchmark/metrics.py</div><div id='m_start'> M Start Line: 35</div><div id='m_end'> M End Line: 39</div><div id='n_start'> N Start Line: 38</div><div id='n_end'> N End Line: 47</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        
        if start_index is None and end_index is None:
            logger.warning("both start_index and end_index are None, rebase is ignored")
            <a id="change">return</a>

        if start_index &lt; 0 or end_index &lt; 0:
            logger.warning("start_index or end_index cannot be less than 0")
            return</code></pre><h3>After Change</h3><pre><code class='java'>
        
        storage_si = self.start_index
        storage_ei = self.end_index
        <a id="change">if storage_si is None</a><a id="change"> or storage_ei is None</a>:
            <a id="change">raise </a>ValueError("storage.start_index or storage.end_index is None, storage may not exist")

        start_index = storage_si if start_index is None else start_index
        end_index = storage_ei if end_index is None else end_index

        if start_index is None or end_index is None:
            logger.warning("both start_index and end_index are None, or storage does not exist; rebase is ignored")
            <a id="change">return</a>

        if start_index &lt; 0 or end_index &lt; 0:
            logger.warning("start_index or end_index cannot be less than 0")
            return</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/microsoft/qlib/commit/5da33562ddae7f78439d211269232b40f5231857#diff-f65772de27f08c0dd47f7caff3c841d93a0808e109fe9da244ee9c414424cf6aL311' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 76353976</div><div id='project'> Project Name: microsoft/qlib</div><div id='commit'> Commit Name: 5da33562ddae7f78439d211269232b40f5231857</div><div id='time'> Time: 2021-05-25</div><div id='author'> Author: zhu.pengrong@foxmail.com</div><div id='file'> File Name: qlib/data/storage/storage.py</div><div id='m_class'> M Class Name: FeatureStorage</div><div id='n_method'> N Class Name: FeatureStorage</div><div id='m_method'> M Method Name: rebase(3)</div><div id='n_method'> N Method Name: rebase(3)</div><div id='m_parent_class'> M Parent Class: BaseStorage</div><div id='n_parent_class'> N Parent Class: BaseStorage</div><div id='m_file'> M File Name: qlib/data/storage/storage.py</div><div id='n_file'> N File Name: qlib/data/storage/storage.py</div><div id='m_start'> M Start Line: 362</div><div id='m_end'> M End Line: 386</div><div id='n_start'> N Start Line: 416</div><div id='n_end'> N End Line: 446</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    assert len(default) &lt; 2
    if hasattr(obj, "__slots__") and isinstance(obj, type) and is_dataclass(obj):
        try:
            <a id="change">return </a>obj.__dataclass_fields__[field].default
        except KeyError:
            if default:
                return default[0]</code></pre><h3>After Change</h3><pre><code class='java'>
    ):
        try:
            _field = obj.__dataclass_fields__[field]
            <a id="change">if _field.default_factory is not MISSING</a><a id="change"> or _field.default is MISSING</a>:
                <a id="change">raise </a>AttributeError

            <a id="change">return </a>_field.default

        except (KeyError, AttributeError):
            if default:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/mit-ll-responsible-ai/hydra-zen/commit/d40158c18880f7cbb31df12a94be136bc373885b#diff-d4df01140c75f19d451bdffa1c5460c17a95962c0101b6e6549aba5f6b59e56aL39' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 76353973</div><div id='project'> Project Name: mit-ll-responsible-ai/hydra-zen</div><div id='commit'> Commit Name: d40158c18880f7cbb31df12a94be136bc373885b</div><div id='time'> Time: 2022-12-22</div><div id='author'> Author: rsoklaski@gmail.com</div><div id='file'> File Name: src/hydra_zen/structured_configs/_type_guards.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: safe_getattr(2)</div><div id='n_method'> N Method Name: safe_getattr(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/hydra_zen/structured_configs/_type_guards.py</div><div id='n_file'> N File Name: src/hydra_zen/structured_configs/_type_guards.py</div><div id='m_start'> M Start Line: 46</div><div id='m_end'> M End Line: 56</div><div id='n_start'> N Start Line: 50</div><div id='n_end'> N End Line: 67</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
    &#47&#47         target = ops.convert_to_tensor(targets, name="target")

    &#47&#47 with tf.name_scope(name):
    <a id="change">return </a>tf.reduce_mean(
        tf.reduce_sum(
            -(target * tf.math.log(output + epsilon) + (1. - target) * tf.math.log(1. - output + epsilon)), axis=1
        ), name=name</code></pre><h3>After Change</h3><pre><code class='java'>

    

    <a id="change">if False in tf.less_equal(output, [1.0]).numpy()</a><a id="change"> or False in tf.greater_equal(output, [0.0]).numpy()</a>:
        raise Exception("all elements of input should be between 0 and 1")

    epsilon = 3.6e-44
    cal_loss = -(target * tf.math.log(output + epsilon) + (1. - target) * tf.math.log(1. - output + epsilon))
    if reduction == &quotmean&quot:
        <a id="change">return </a>tf.reduce_mean(cal_loss)
    elif reduction == &quotsum&quot:
        return tf.reduce_sum(cal_loss)
    elif reduction == &quotnone&quot:
        return cal_loss
    else:
        <a id="change">raise </a>Exception("The reduction values are &quotmean&quot, &quotsum&quot, and &quotnone&quot.")


def mean_squared_error(output, target, reduction=&quotmean&quot):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tensorlayer/tensorlayerx/commit/21bf2328ccadff5a24520c774d17bfd6d5e05fa4#diff-3c223aba3b10d989eee06bb108c922fd971ff8ab3e4cddf2fb7bc28c495b1918L83' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 76353988</div><div id='project'> Project Name: tensorlayer/tensorlayerx</div><div id='commit'> Commit Name: 21bf2328ccadff5a24520c774d17bfd6d5e05fa4</div><div id='time'> Time: 2022-01-26</div><div id='author'> Author: laicheng_vip@163.com</div><div id='file'> File Name: tensorlayerx/losses/tensorflow_cost.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: binary_cross_entropy(3)</div><div id='n_method'> N Method Name: binary_cross_entropy(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: tensorlayerx/losses/tensorflow_cost.py</div><div id='n_file'> N File Name: tensorlayerx/losses/tensorflow_cost.py</div><div id='m_start'> M Start Line: 83</div><div id='m_end'> M End Line: 116</div><div id='n_start'> N Start Line: 126</div><div id='n_end'> N End Line: 140</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        
        if isinstance(value, dict):
            self._storage_dtype = "struct"
        <a id="change">return </a>value

    def decode_example(self, value):
        Decode example audio file into audio data.</code></pre><h3>After Change</h3><pre><code class='java'>
            buffer = BytesIO()
            sf.write(buffer, value["array"], value["sampling_rate"])
            return {"bytes": buffer.getvalue(), "path": value.get("path")}
        elif <a id="change">value.get("bytes") is not None or value.get("path") is not None</a>:
            <a id="change">return </a>{"bytes": value.get("bytes"), "path": value.get("path")}
        else:
            <a id="change">raise </a>ValueError(
                f"An audio sample should have one of &quotpath&quot or &quotbytes&quot but they are missing or None in {value}."
            )
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/huggingface/datasets/commit/6ca96c707502e0689f9b58d94f46d871fa5a3c9c#diff-a633089cfc19bde2aaf3ab69fe0b274597ce4b9ba9b8d081382f71ee9f767b0dL43' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 76353972</div><div id='project'> Project Name: huggingface/datasets</div><div id='commit'> Commit Name: 6ca96c707502e0689f9b58d94f46d871fa5a3c9c</div><div id='time'> Time: 2022-01-21</div><div id='author'> Author: 42851186+lhoestq@users.noreply.github.com</div><div id='file'> File Name: src/datasets/features/audio.py</div><div id='m_class'> M Class Name: Audio</div><div id='n_method'> N Class Name: Audio</div><div id='m_method'> M Method Name: encode_example(2)</div><div id='n_method'> N Method Name: encode_example(2)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: src/datasets/features/audio.py</div><div id='n_file'> N File Name: src/datasets/features/audio.py</div><div id='m_start'> M Start Line: 43</div><div id='m_end'> M End Line: 54</div><div id='n_start'> N Start Line: 49</div><div id='n_end'> N End Line: 75</div><BR>