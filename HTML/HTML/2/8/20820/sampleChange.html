<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    query_id, query_embedding = query.query.uid, embeddings[0]
    document_ids, document_embeddings = [doc.uid for doc in query.documents], embeddings[1:]

    query_embedding = <a id="change">np.asarray(query_embedding).reshape(1, -1).astype("float32"</a><a id="change">)</a>
    document_embeddings = (
        np.asarray(document_embeddings).reshape(-1, model.index.d).astype("float32")
    )
</code></pre><h3>After Change</h3><pre><code class='java'>
            ids_to_index.append(doc_id)
            embeddings_to_index.append(doc_embedding)
    ids_to_index = np.asarray(ids_to_index).astype("int64")
    embeddings_to_index<a id="change"> = </a><a id="change">np.vstack(embeddings_to_index).astype("float32"</a><a id="change">)</a>
    model.index.add_with_ids(embeddings_to_index, ids_to_index)

    &#47&#47 Ensure that the query is not in the index when we search.
    &#47&#47 https://github.com/facebookresearch/faiss/wiki/Special-operations-on-indexes&#47&#47removing-elements-from-an-index</code></pre>