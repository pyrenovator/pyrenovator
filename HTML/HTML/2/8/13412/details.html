<html><h3>Pattern ID :13412
</h3><img src='45179779.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                
                lam, L, loss = self.progress_history()
                    
                <a id="change">if self._count_finish &gt;= 3</a>:
                    self.message = self.message + "success"
                    <a id="change">break</a>
                elif self.decision_history.count("accept") &gt; 2 and self.decision_history[-1] == "accept" and L[-1] &lt; 0.1 and ((loss[-2] - loss[-1])/loss[-1]) &lt; (self.relative_tolerance/100):
                    self.message = self.message + "success"
                    break
                elif self.L &gt;= (1e9 - 1) and self._count_reject &gt;= 12 and not self.take_low_rho_step():</code></pre><h3>After Change</h3><pre><code class='java'>
                else:
                    self.step_method0()

                <a id="change">if self.save_steps is not None</a><a id="change"> and self.decision_history[-1] == "accept"</a>:
                    self.model.save(os.path.join(self.save_steps, f"{self.model.name}_Iteration_{self.iteration:03d}.yaml"))

                lam, L, loss = self.progress_history()</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 7</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/connorstoneastro/autoprof/commit/54e22993021b3929388b6319d6501791a016bc39#diff-52615ad08cfc1cfad1befd14d3c383d34ae33d73e933e1359265221e8731fb61L457' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 45179779</div><div id='project'> Project Name: connorstoneastro/autoprof</div><div id='commit'> Commit Name: 54e22993021b3929388b6319d6501791a016bc39</div><div id='time'> Time: 2022-12-29</div><div id='author'> Author: connorstone628@gmail.com</div><div id='file'> File Name: autoprof/fit/lm.py</div><div id='m_class'> M Class Name: LM</div><div id='n_method'> N Class Name: LM</div><div id='m_method'> M Method Name: fit(1)</div><div id='n_method'> N Method Name: fit(1)</div><div id='m_parent_class'> M Parent Class: BaseOptimizer</div><div id='n_parent_class'> N Parent Class: BaseOptimizer</div><div id='m_file'> M File Name: autoprof/fit/lm.py</div><div id='n_file'> N File Name: autoprof/fit/lm.py</div><div id='m_start'> M Start Line: 457</div><div id='m_end'> M End Line: 495</div><div id='n_start'> N Start Line: 477</div><div id='n_end'> N End Line: 494</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            else:
                if valid_loss &gt;= self.prev_loss:
                    self.no_improvement += 1
                    <a id="change">if self.no_improvement &gt;= 10</a>:
                        print("Stop training")
                        <a id="change">break</a>
                else:
                    self.no_improvement = 0
            
            self.prev_loss = valid_loss</code></pre><h3>After Change</h3><pre><code class='java'>
            self.train_loss[epoch] = train_loss
            self.valid_loss[epoch] = valid_loss

            <a id="change">if self.anneal_epoch is not None</a><a id="change"> and epoch + 1 == self.anneal_epoch - 1</a>:
                &#47&#47 From the next epoch, learning rate is channged.
                anneal_lr = self.anneal_lr
                for param_group in self.optimizer.param_groups:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tky823/dnn-based_source_separation/commit/633db31aabb9b4ac689d84887b16f1b816ce1291#diff-7c5b1018ab6bf19cc2f7c1fc385abd4adb493c178cdd1548dcae8770f80fb8fdL82' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 45179780</div><div id='project'> Project Name: tky823/dnn-based_source_separation</div><div id='commit'> Commit Name: 633db31aabb9b4ac689d84887b16f1b816ce1291</div><div id='time'> Time: 2021-08-08</div><div id='author'> Author: 40362510+tky823@users.noreply.github.com</div><div id='file'> File Name: egs/musdb18/d3net/src/adhoc_driver.py</div><div id='m_class'> M Class Name: AdhocTrainer</div><div id='n_method'> N Class Name: AdhocTrainer</div><div id='m_method'> M Method Name: run(1)</div><div id='n_method'> N Method Name: run(1)</div><div id='m_parent_class'> M Parent Class: TrainerBase</div><div id='n_parent_class'> N Parent Class: TrainerBase</div><div id='m_file'> M File Name: egs/musdb18/d3net/src/adhoc_driver.py</div><div id='n_file'> N File Name: egs/musdb18/d3net/src/adhoc_driver.py</div><div id='m_start'> M Start Line: 101</div><div id='m_end'> M End Line: 104</div><div id='n_start'> N Start Line: 84</div><div id='n_end'> N End Line: 102</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
                
                lam, L, loss = self.progress_history()
                    
                <a id="change">if self._count_finish &gt;= 3</a>:
                    self.message = self.message + "success"
                    <a id="change">break</a>
                elif self.decision_history.count("accept") &gt; 2 and self.decision_history[-1] == "accept" and L[-1] &lt; 0.1 and ((loss[-2] - loss[-1])/loss[-1]) &lt; (self.relative_tolerance/100):
                    self.message = self.message + "success"
                    break
                elif self.L &gt;= (1e9 - 1) and self._count_reject &gt;= 12 and not self.take_low_rho_step():</code></pre><h3>After Change</h3><pre><code class='java'>
                else:
                    self.step_method0()

                <a id="change">if </a><a id="change">self.save_steps is not None and self.decision_history[-1] == "accept"</a>:
                    self.model.save(os.path.join(self.save_steps, f"{self.model.name}_Iteration_{self.iteration:03d}.yaml"))

                lam, L, loss = self.progress_history()</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/connorstoneastro/autoprof/commit/6cd267bc49a6a3c4f84c05f36540b6a20be36d20#diff-daabd78fa8f6167a7ea2c6fd6fce88e607b57cd475cf1e759da42fe315dcd1acL453' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 45179783</div><div id='project'> Project Name: connorstoneastro/autoprof</div><div id='commit'> Commit Name: 6cd267bc49a6a3c4f84c05f36540b6a20be36d20</div><div id='time'> Time: 2023-01-03</div><div id='author'> Author: connorstone628@gmail.com</div><div id='file'> File Name: build/lib/autoprof/fit/lm.py</div><div id='m_class'> M Class Name: LM</div><div id='n_method'> N Class Name: LM</div><div id='m_method'> M Method Name: fit(1)</div><div id='n_method'> N Method Name: fit(1)</div><div id='m_parent_class'> M Parent Class: BaseOptimizer</div><div id='n_parent_class'> N Parent Class: BaseOptimizer</div><div id='m_file'> M File Name: build/lib/autoprof/fit/lm.py</div><div id='n_file'> N File Name: build/lib/autoprof/fit/lm.py</div><div id='m_start'> M Start Line: 457</div><div id='m_end'> M End Line: 495</div><div id='n_start'> N Start Line: 478</div><div id='n_end'> N End Line: 495</div><BR>