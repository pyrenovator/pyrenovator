<html><h3>Pattern ID :7615
</h3><img src='25296480.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        self.data = []
        self.text_book=None

        self.mask<a id="change">=</a>[]
        if isinstance(lists,list):
            self.data=open(lists,&quotr&quot).readlines()
            self.mask=[item.split(&quot_data&quot)[0]+&quot_seg&quot+item.split(&quot_data&quot)[1][:-1] for item in self.data]
            self.data = [item[:-1] for item in self.data]

        else:
            if isinstance (data_root,list):
                <a id="change">for </a>r1,<a id="change">r2</a> in <a id="change">zip(</a>data_root,pre_lung_root<a id="change">):
                    </a>self.data<a id="change">+=</a>glob.glob(r1+&quot/*.n*&quot)
                    self.mask<a id="change">+=</a>glob.glob(r2+&quot/*.n*&quot)
            else:
                self.data = glob.glob(data_root)
                self.mask=glob.glob(pre_lung_root)</code></pre><h3>After Change</h3><pre><code class='java'>
                                         transforms.Normalize([0, 0, 0], [1, 1, 1])
                                         ])
        print(&quotnum of data:&quot, len(self.data))
        person=[<a id="change">da.split(&quot/&quot)[-2]</a>+&quot_&quot+da.split(&quot/&quot)[-1].split(&quot_&quot)[0]+da.split(&quot/&quot)[-1].split(&quot_&quot)[1] for da in self.data]
        person=list(set(person))
        if self.cls_num == 2:
            cls = [1 - int(data_path.split(&quot/&quot)[-1][0] == &quotc&quot or data_path.index(&quotLIDC&quot)&gt;-1 or</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/chenwwweixiang/opencoviddetector/commit/063ca061d6a3791068c8d3a5b46867a93827fd03#diff-74cad45aefddbfaa7bb449f5cacab993634353f0add41f56dcee2ce9d185cd42L726' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 25296480</div><div id='project'> Project Name: chenwwweixiang/opencoviddetector</div><div id='commit'> Commit Name: 063ca061d6a3791068c8d3a5b46867a93827fd03</div><div id='time'> Time: 2020-04-17</div><div id='author'> Author: chenwx_thu@foxmail.com</div><div id='file'> File Name: data/dataset.py</div><div id='m_class'> M Class Name: NCPJPGtestDataset_new</div><div id='n_method'> N Class Name: NCPJPGtestDataset_new</div><div id='m_method'> M Method Name: __init__(6)</div><div id='n_method'> N Method Name: __init__(8)</div><div id='m_parent_class'> M Parent Class: Dataset</div><div id='n_parent_class'> N Parent Class: Dataset</div><div id='m_file'> M File Name: data/dataset.py</div><div id='n_file'> N File Name: data/dataset.py</div><div id='m_start'> M Start Line: 726</div><div id='m_end'> M End Line: 757</div><div id='n_start'> N Start Line: 732</div><div id='n_end'> N End Line: 744</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

    def forward(self, q, r):
        x = q + self.num_q * r
        Mvt<a id="change"> = </a>self.Mv.unsqueeze(0)

        p = []
        Mv = []

        <a id="change">for </a>qt, <a id="change">xt</a> in <a id="change">zip(</a>q.permute(1, 0), x.permute(1, 0)<a id="change">):
            </a>kt = self.k_emb_layer(qt)
            vt = self.v_emb_layer(xt)

            wt = torch.softmax(torch.matmul(kt, self.Mk), dim=-1)

            &#47&#47 Read Process
            rt<a id="change"> = </a>(wt.unsqueeze(-1) * Mvt).sum(1)
            ft = torch.tanh(self.f_layer(torch.cat([rt, kt], dim=-1)))
            pt = torch.sigmoid(self.p_layer(ft)).squeeze()

            &#47&#47 Write Process
            et = torch.sigmoid(self.e_layer(vt))
            Mvt = Mvt * (1 - (wt.unsqueeze(-1) * et.unsqueeze(1)))
            at<a id="change"> = </a>torch.tanh(self.a_layer(vt))
            Mvt = Mvt + (wt.unsqueeze(-1) * at.unsqueeze(1))

            p.append(pt)</code></pre><h3>After Change</h3><pre><code class='java'>
        &quot&quot&quot
        x = q + self.num_q * r

        batch_size = <a id="change">x.shape[0]</a>
        Mvt = self.Mv0.unsqueeze(0).repeat(batch_size, 1, 1)

        Mv = [Mvt]
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/hcnoh/knowledge-tracing-collection-pytorch/commit/c42b01b83dbe54e94f4294009fbfe8bd910e3638#diff-f2ab9795149528e0325dcc207d9bb2ee66e3cdd4dff09817a550ab5174cc8763L39' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 25296482</div><div id='project'> Project Name: hcnoh/knowledge-tracing-collection-pytorch</div><div id='commit'> Commit Name: c42b01b83dbe54e94f4294009fbfe8bd910e3638</div><div id='time'> Time: 2021-10-06</div><div id='author'> Author: rhc0624@gmail.com</div><div id='file'> File Name: models/dkvmn.py</div><div id='m_class'> M Class Name: DKVMN</div><div id='n_method'> N Class Name: DKVMN</div><div id='m_method'> M Method Name: forward(3)</div><div id='n_method'> N Method Name: forward(3)</div><div id='m_parent_class'> M Parent Class: Module</div><div id='n_parent_class'> N Parent Class: Module</div><div id='m_file'> M File Name: models/dkvmn.py</div><div id='n_file'> N File Name: models/dkvmn.py</div><div id='m_start'> M Start Line: 40</div><div id='m_end'> M End Line: 66</div><div id='n_start'> N Start Line: 50</div><div id='n_end'> N End Line: 87</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        else:
            properties_results = self._test_properties

        imgs<a id="change"> = </a>[]
        target = []

        if dataset.task_type == TaskType.OBJECT_DETECTION:
            for img, labels in zip(batch.images, batch.labels):
                for label in labels:
                    label = label.cpu().detach().numpy()
                    bbox = label[1:]
                    cropped_img = crop_image(img, *bbox)
                    if cropped_img.shape[0] == 0 or cropped_img.shape[1] == 0:
                        continue
                    class_id = int(label[0])
                    imgs += [cropped_img]
                    target += [dataset.label_id_to_name(class_id)]
            property_type = PropertiesInputType.BBOXES
        else:
            <a id="change">for </a>img, <a id="change">classes_ids</a> in <a id="change">zip(</a>batch.images, dataset.get_classes(batch.labels)<a id="change">):
                </a>imgs<a id="change"> += </a>[img] * len(classes_ids)
                target<a id="change"> += </a>list(map(dataset.label_id_to_name, classes_ids))
            property_type = PropertiesInputType.IMAGES

        properties_results[&quottarget&quot] += target</code></pre><h3>After Change</h3><pre><code class='java'>
                    label = label.cpu().detach().numpy()
                    bbox = label[1:]
                    &#47&#47 make sure image is not out of bounds
                    if round(<a id="change">bbox[2]</a>) + min(round(bbox[0]), 0) &lt;= 0 or round(bbox[3]) &lt;= 0 + min(round(bbox[1]), 0):
                        continue
                    class_id = int(label[0])
                    target.append(dataset.label_id_to_name(class_id))</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/deepchecks/deepchecks/commit/e24f853c66c7f8d472985466ff03b0e3a3a4dd1b#diff-85dc2a1793cc68cc7cf037a161eeb7a220ed7f4649a0d9ec8586f623ac8130d0L116' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 25296484</div><div id='project'> Project Name: deepchecks/deepchecks</div><div id='commit'> Commit Name: e24f853c66c7f8d472985466ff03b0e3a3a4dd1b</div><div id='time'> Time: 2022-08-18</div><div id='author'> Author: jonatan.lib@gmail.com</div><div id='file'> File Name: deepchecks/vision/checks/train_test_validation/property_label_correlation_change.py</div><div id='m_class'> M Class Name: PropertyLabelCorrelationChange</div><div id='n_method'> N Class Name: PropertyLabelCorrelationChange</div><div id='m_method'> M Method Name: update(4)</div><div id='n_method'> N Method Name: update(4)</div><div id='m_parent_class'> M Parent Class: TrainTestCheck</div><div id='n_parent_class'> N Parent Class: TrainTestCheck</div><div id='m_file'> M File Name: deepchecks/vision/checks/train_test_validation/property_label_correlation_change.py</div><div id='n_file'> N File Name: deepchecks/vision/checks/train_test_validation/property_label_correlation_change.py</div><div id='m_start'> M Start Line: 125</div><div id='m_end'> M End Line: 148</div><div id='n_start'> N Start Line: 124</div><div id='n_end'> N End Line: 143</div><BR>