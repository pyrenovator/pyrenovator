<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            ``["expm", "cayley"]`` or a custom callable.  Default: ``"expm"``
    
    size = getattr(module, tensor_name).size()
    <a id="change">if </a><a id="change">len(size) &lt; 2</a>:
        raise ValueError(
            "Cannot put grassmannian constraints on a vector. "
            "Got a tensor of size {}".format(size)
        )
    n<a id="change">, k = </a>size[-2:]
    n<a id="change">, k</a> = max(n, k), min(n, k)
    P.register_parametrization(module, tensor_name, Grassmannian(size, triv))
    &#47&#47 The base is already initialised to a random point
    with torch.no_grad():</code></pre><h3>After Change</h3><pre><code class='java'>
            ``["expm", "cayley"]`` or a custom callable.  Default: ``"expm"``
    
    size = getattr(module, tensor_name).size()
    M<a id="change"> = </a>Grassmannian(size, triv)
    P.register_parametrization(module, tensor_name, M)
    setattr(module, tensor_name, <a id="change">M.sample()</a>)


def low_rank(module, tensor_name, rank, triv="expm"):</code></pre>