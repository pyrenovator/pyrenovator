<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    if single: &#47&#47 single means evaluating in a (one vs. all) way
        acc = []
        f1 = []
        <a id="change">for </a>emo_ind in <a id="change">range(</a>4<a id="change">):
            </a>preds_i<a id="change"> = </a>np.argmax(<a id="change">preds[:, emo_ind]</a>, axis=-1)
            truths_i = truths[:, emo_ind]
            acc.append(torch.sum(truths_i == preds_i).item() / len(preds))
            f1.append(f1_score(truths_i, preds_i, average=&quotweighted&quot))</code></pre><h3>After Change</h3><pre><code class='java'>
    truths: (bs, num_emotions)
    &quot&quot&quot

    total = <a id="change">preds.size(0</a><a id="change">)</a>
    num_emo = <a id="change">preds.size(</a>1<a id="change">)</a>

    preds = preds.cpu().detach()
    truths = truths.cpu().detach()
</code></pre>