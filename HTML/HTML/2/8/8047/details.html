<html><h3>Pattern ID :8047
</h3><img src='28566754.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        if data_path[-1]==&quot\n&quot:
            data_path=data_path[:-1]
        if self.cls_num == 2:
            cls<a id="change"> = </a>1 - <a id="change">int(</a>data_path.split(&quot/&quot)[-1][0] == &quotc&quot or data_path.split(&quot/&quot)[-1][1] == &quot.&quot or
                          data_path.split(&quot/&quot)[-3] == &quotILD&quot<a id="change">)</a>
        elif self.cls_num==4:
            if &quothealthy&quot in data_path:
                cls = 0
            elif &quotcap&quot in data_path:</code></pre><h3>After Change</h3><pre><code class='java'>
        if data_path[-1]==&quot\n&quot:
            data_path=data_path[:-1]
        if self.cls_num == 2:
            <a id="change">if self.mod==&quotab&quot</a>:&#47&#47abnormal detection
                cls<a id="change"> = </a>int(&quotpos&quot in data_path)
            else:
                cls<a id="change"> = </a>1<a id="change">-</a>int(&quotild&quot in data_path or &quotcap&quot in data_path)
        elif self.cls_num==3:
            if &quothealthy&quot in data_path:
                cls = 0</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 7</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/chenwwweixiang/opencoviddetector/commit/8909104cb57ef877076c775372e08b8538243526#diff-74cad45aefddbfaa7bb449f5cacab993634353f0add41f56dcee2ce9d185cd42L768' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28566754</div><div id='project'> Project Name: chenwwweixiang/opencoviddetector</div><div id='commit'> Commit Name: 8909104cb57ef877076c775372e08b8538243526</div><div id='time'> Time: 2020-04-18</div><div id='author'> Author: chenwx_thu@foxmail.com</div><div id='file'> File Name: data/dataset.py</div><div id='m_class'> M Class Name: NCPJPGtestDataset_new</div><div id='n_method'> N Class Name: NCPJPGtestDataset_new</div><div id='m_method'> M Method Name: __getitem__(2)</div><div id='n_method'> N Method Name: __getitem__(2)</div><div id='m_parent_class'> M Parent Class: Dataset</div><div id='n_parent_class'> N Parent Class: Dataset</div><div id='m_file'> M File Name: data/dataset.py</div><div id='n_file'> N File Name: data/dataset.py</div><div id='m_start'> M Start Line: 768</div><div id='m_end'> M End Line: 784</div><div id='n_start'> N Start Line: 781</div><div id='n_end'> N End Line: 797</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if data_path[-1]==&quot\n&quot:
            data_path=data_path[:-1]
        if self.cls_num==2:
            cls<a id="change">=</a>1-<a id="change">int(</a>data_path.split(&quot/&quot)[-1][0]==&quotc&quot or data_path.split(&quot/&quot)[-1][1]==&quot.&quot or
                      data_path.split(&quot/&quot)[-2]==&quotmasked_ild&quot<a id="change">)</a>
        elif self.cls_num==4:
            if &quothealthy&quot in data_path:
                cls = 0
            elif &quotcap&quot in data_path:</code></pre><h3>After Change</h3><pre><code class='java'>
        if data_path[-1]==&quot\n&quot:
            data_path=data_path[:-1]
        if self.cls_num==2:
            <a id="change">if self.mod==&quotab&quot</a>:&#47&#47abnormal detection
                cls<a id="change"> = </a>int(&quotpos&quot in data_path)
            else:
                cls<a id="change"> = </a>1<a id="change">-</a>int(&quotild&quot in data_path or &quotcap&quot in data_path)
        elif self.cls_num==3:
            if &quothealthy&quot in data_path:
                cls = 0</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/chenwwweixiang/opencoviddetector/commit/8909104cb57ef877076c775372e08b8538243526#diff-74cad45aefddbfaa7bb449f5cacab993634353f0add41f56dcee2ce9d185cd42L693' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28566759</div><div id='project'> Project Name: chenwwweixiang/opencoviddetector</div><div id='commit'> Commit Name: 8909104cb57ef877076c775372e08b8538243526</div><div id='time'> Time: 2020-04-18</div><div id='author'> Author: chenwx_thu@foxmail.com</div><div id='file'> File Name: data/dataset.py</div><div id='m_class'> M Class Name: NCPJPGDataset_new</div><div id='n_method'> N Class Name: NCPJPGDataset_new</div><div id='m_method'> M Method Name: __getitem__(2)</div><div id='n_method'> N Method Name: __getitem__(2)</div><div id='m_parent_class'> M Parent Class: Dataset</div><div id='n_parent_class'> N Parent Class: Dataset</div><div id='m_file'> M File Name: data/dataset.py</div><div id='n_file'> N File Name: data/dataset.py</div><div id='m_start'> M Start Line: 695</div><div id='m_end'> M End Line: 709</div><div id='n_start'> N Start Line: 696</div><div id='n_end'> N End Line: 710</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        for row in reader:
            row_time = datetime.strptime(row[&quotTimestamp&quot], "%Y-%m-%d %H:%M:%S")
            if ((now - row_time).seconds / 60) &lt; interval:
                violations<a id="change"> += </a><a id="change">int(</a>row[&quotViolatingObjects&quot]<a id="change">)</a>
    if violations &gt; threshold:
        &#47&#47 send notification
        if should_send_email:
            ms = MailService(config)</code></pre><h3>After Change</h3><pre><code class='java'>
    today = str(date.today())

    violations = 0
    <a id="change">if entity_type == &quotCamera&quot</a>:
        file_paths<a id="change"> = </a>[os.path.join(log_dir, entity_info[&quotid&quot], "objects_log", today<a id="change"> + </a>".csv")]
    else:
        &#47&#47 entity_type == &quotArea&quot
        camera_ids<a id="change"> = </a>entity_info[&quotcameras&quot]
        file_paths = [os.path.join(log_dir, camera_id, "objects_log", today + ".csv") for camera_id in camera_ids]

    for file_path in file_paths:</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/neuralet/smart-social-distancing/commit/cc83a5359249689566aff454deb74f361ee3c432#diff-61543c94b6b9e62dd360231676e1266517169b7ab96d3c16929c60e65ef5f869L11' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28566774</div><div id='project'> Project Name: neuralet/smart-social-distancing</div><div id='commit'> Commit Name: cc83a5359249689566aff454deb74f361ee3c432</div><div id='time'> Time: 2020-10-23</div><div id='author'> Author: 42361379+renzodgc@users.noreply.github.com</div><div id='file'> File Name: libs/utils/notifications.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: check_violations(7)</div><div id='n_method'> N Method Name: check_violations(7)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: libs/utils/notifications.py</div><div id='n_file'> N File Name: libs/utils/notifications.py</div><div id='m_start'> M Start Line: 11</div><div id='m_end'> M End Line: 32</div><div id='n_start'> N Start Line: 23</div><div id='n_end'> N End Line: 46</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        pyramid_levels.append(level)
        stride_hh, stride_ww = feature_sizes[0][0] / feature_sizes[level][0], feature_sizes[0][1] / feature_sizes[level][1]
        cur_num_anchors = tf.math.ceil(input_shape[0] / stride_hh) * tf.math.ceil(input_shape[1] / stride_ww)
        total_anchors<a id="change"> -= </a><a id="change">int(</a>cur_num_anchors<a id="change">)</a>
        level += 1
    return pyramid_levels

</code></pre><h3>After Change</h3><pre><code class='java'>
    feature_sizes = get_feature_sizes(input_shape, [pyramid_levels_min, pyramid_levels_min + 10])[pyramid_levels_min:]
    feature_sizes = tf.convert_to_tensor(feature_sizes, dtype="int32")
    num_anchors_at_each_level_cumsum = tf.cumsum(tf.reduce_prod(feature_sizes, axis=-1))
    <a id="change">if num_anchors == "auto"</a>:
        &#47&#47 Pick from [1, 3, 9], 1 for yolox, 3 for yolor, 9 for efficientdet
        picks = tf.convert_to_tensor([1, 3, 9], dtype=tf.int32)
        max_anchors<a id="change"> = </a>num_anchors_at_each_level_cumsum[-1]<a id="change"> * </a>picks
        num_anchors<a id="change"> = </a>picks[tf.argmax(total_anchors &lt; max_anchors)]

    total_anchors = total_anchors // num_anchors
    pyramid_levels_max = pyramid_levels_min + tf.argmax(num_anchors_at_each_level_cumsum &gt; total_anchors) - 1</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/leondgarse/keras_cv_attention_models/commit/df3cf1ce0ac4b02a9c73496b1a583b9a892c7b0a#diff-0b4f97076caf9c1a827dc3bdff3c0c4eb77d00da49f17542a248e3a2920b42d4L100' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 28566767</div><div id='project'> Project Name: leondgarse/keras_cv_attention_models</div><div id='commit'> Commit Name: df3cf1ce0ac4b02a9c73496b1a583b9a892c7b0a</div><div id='time'> Time: 2022-03-25</div><div id='author'> Author: leondgarse@gmail.com</div><div id='file'> File Name: keras_cv_attention_models/coco/anchors_func.py</div><div id='m_class'> M Class Name: AnonimousClass</div><div id='n_method'> N Class Name: AnonimousClass</div><div id='m_method'> M Method Name: get_pyramid_levels_by_anchors(4)</div><div id='n_method'> N Method Name: get_pyramid_levels_by_anchors(4)</div><div id='m_parent_class'> M Parent Class: </div><div id='n_parent_class'> N Parent Class: </div><div id='m_file'> M File Name: keras_cv_attention_models/coco/anchors_func.py</div><div id='n_file'> N File Name: keras_cv_attention_models/coco/anchors_func.py</div><div id='m_start'> M Start Line: 101</div><div id='m_end'> M End Line: 112</div><div id='n_start'> N Start Line: 103</div><div id='n_end'> N End Line: 114</div><BR>