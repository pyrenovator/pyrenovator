<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    tmp_file = in_file + ".tmp"
    subprocess.Popen([&quotcp&quot, in_file, tmp_file])
    sha = subprocess.check_output([&quotsha256sum&quot, tmp_file]).decode()
    out_file<a id="change"> = </a>in_file
    if out_file.endswith(&quot.pth&quot):
        out_file = out_file[:-4]
    final_file = out_file + f&quot-{sha[:8]}.pth&quot
    assert final_file != in_file, \
        "The output filename is the same as the input file."
    <a id="change">print(</a><a id="change">"Output file: {}".format(</a>final_file<a id="change">))</a>
    subprocess.Popen([&quotmv&quot, tmp_file, final_file])


def main():</code></pre><h3>After Change</h3><pre><code class='java'>
        del checkpoint[&quotoptimizer&quot]
    &#47&#47 if it is necessary to remove some sensitive data in checkpoint[&quotmeta&quot],
    &#47&#47 add the code here.
    <a id="change">if torch.__version__ &gt;= &quot1.6&quot</a>:
        <a id="change">torch.save(</a>checkpoint, out_file<a id="change">, _use_new_zipfile_serialization=False)</a>
    else:
        torch.save(checkpoint, out_file)

    if decode:</code></pre>