<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        self.model.eval()
        all_predictions, all_labels = torch.Tensor(), torch.Tensor()
        <a id="change">for </a>features, labels in feature_labels_dataloader<a id="change">:
            </a>outputs<a id="change"> = </a>self.model(features)
            _<a id="change">, predicted = </a>torch.max(outputs, 1)
            all_predictions = torch.cat(<a id="change">[</a>all_predictions, predicted<a id="change"></a>])
            all_labels<a id="change"> = </a>torch.cat([all_labels, labels])

        predictions, test_labels = (all_predictions.detach().numpy(), all_labels.detach().numpy())
        clf_report = classification_report(y_true=test_labels, y_pred=predictions, output_dict=True)</code></pre><h3>After Change</h3><pre><code class='java'>
            test_labels.tensors[0].cpu().detach().numpy(),
        )
        if predictions.shape[1] &gt; 1:
            predictions<a id="change"> = </a><a id="change">np.argmax(</a>predictions<a id="change">, axis=1)</a>

        clf_report = classification_report(
            y_true=test_labels, y_pred=predictions, output_dict=True
        )</code></pre>